(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();function qA(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var WA={exports:{}},pm={},HA={exports:{}},fe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $h=Symbol.for("react.element"),AF=Symbol.for("react.portal"),PF=Symbol.for("react.fragment"),bF=Symbol.for("react.strict_mode"),kF=Symbol.for("react.profiler"),xF=Symbol.for("react.provider"),NF=Symbol.for("react.context"),DF=Symbol.for("react.forward_ref"),OF=Symbol.for("react.suspense"),LF=Symbol.for("react.memo"),MF=Symbol.for("react.lazy"),_S=Symbol.iterator;function VF(t){return t===null||typeof t!="object"?null:(t=_S&&t[_S]||t["@@iterator"],typeof t=="function"?t:null)}var GA={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},KA=Object.assign,QA={};function Ql(t,e,n){this.props=t,this.context=e,this.refs=QA,this.updater=n||GA}Ql.prototype.isReactComponent={};Ql.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Ql.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function YA(){}YA.prototype=Ql.prototype;function sE(t,e,n){this.props=t,this.context=e,this.refs=QA,this.updater=n||GA}var oE=sE.prototype=new YA;oE.constructor=sE;KA(oE,Ql.prototype);oE.isPureReactComponent=!0;var yS=Array.isArray,XA=Object.prototype.hasOwnProperty,aE={current:null},JA={key:!0,ref:!0,__self:!0,__source:!0};function ZA(t,e,n){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)XA.call(e,r)&&!JA.hasOwnProperty(r)&&(i[r]=e[r]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];i.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:$h,type:t,key:s,ref:o,props:i,_owner:aE.current}}function FF(t,e){return{$$typeof:$h,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function lE(t){return typeof t=="object"&&t!==null&&t.$$typeof===$h}function UF(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var vS=/\/+/g;function v_(t,e){return typeof t=="object"&&t!==null&&t.key!=null?UF(""+t.key):e.toString(36)}function yf(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case $h:case AF:o=!0}}if(o)return o=t,i=i(o),t=r===""?"."+v_(o,0):r,yS(i)?(n="",t!=null&&(n=t.replace(vS,"$&/")+"/"),yf(i,e,n,"",function(u){return u})):i!=null&&(lE(i)&&(i=FF(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(vS,"$&/")+"/")+t)),e.push(i)),1;if(o=0,r=r===""?".":r+":",yS(t))for(var a=0;a<t.length;a++){s=t[a];var l=r+v_(s,a);o+=yf(s,e,n,l,i)}else if(l=VF(t),typeof l=="function")for(t=l.call(t),a=0;!(s=t.next()).done;)s=s.value,l=r+v_(s,a++),o+=yf(s,e,n,l,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Md(t,e,n){if(t==null)return t;var r=[],i=0;return yf(t,r,"","",function(s){return e.call(n,s,i++)}),r}function $F(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var yn={current:null},vf={transition:null},BF={ReactCurrentDispatcher:yn,ReactCurrentBatchConfig:vf,ReactCurrentOwner:aE};fe.Children={map:Md,forEach:function(t,e,n){Md(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Md(t,function(){e++}),e},toArray:function(t){return Md(t,function(e){return e})||[]},only:function(t){if(!lE(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};fe.Component=Ql;fe.Fragment=PF;fe.Profiler=kF;fe.PureComponent=sE;fe.StrictMode=bF;fe.Suspense=OF;fe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=BF;fe.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=KA({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=aE.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)XA.call(e,l)&&!JA.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];r.children=a}return{$$typeof:$h,type:t.type,key:i,ref:s,props:r,_owner:o}};fe.createContext=function(t){return t={$$typeof:NF,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:xF,_context:t},t.Consumer=t};fe.createElement=ZA;fe.createFactory=function(t){var e=ZA.bind(null,t);return e.type=t,e};fe.createRef=function(){return{current:null}};fe.forwardRef=function(t){return{$$typeof:DF,render:t}};fe.isValidElement=lE;fe.lazy=function(t){return{$$typeof:MF,_payload:{_status:-1,_result:t},_init:$F}};fe.memo=function(t,e){return{$$typeof:LF,type:t,compare:e===void 0?null:e}};fe.startTransition=function(t){var e=vf.transition;vf.transition={};try{t()}finally{vf.transition=e}};fe.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};fe.useCallback=function(t,e){return yn.current.useCallback(t,e)};fe.useContext=function(t){return yn.current.useContext(t)};fe.useDebugValue=function(){};fe.useDeferredValue=function(t){return yn.current.useDeferredValue(t)};fe.useEffect=function(t,e){return yn.current.useEffect(t,e)};fe.useId=function(){return yn.current.useId()};fe.useImperativeHandle=function(t,e,n){return yn.current.useImperativeHandle(t,e,n)};fe.useInsertionEffect=function(t,e){return yn.current.useInsertionEffect(t,e)};fe.useLayoutEffect=function(t,e){return yn.current.useLayoutEffect(t,e)};fe.useMemo=function(t,e){return yn.current.useMemo(t,e)};fe.useReducer=function(t,e,n){return yn.current.useReducer(t,e,n)};fe.useRef=function(t){return yn.current.useRef(t)};fe.useState=function(t){return yn.current.useState(t)};fe.useSyncExternalStore=function(t,e,n){return yn.current.useSyncExternalStore(t,e,n)};fe.useTransition=function(){return yn.current.useTransition()};fe.version="18.2.0";HA.exports=fe;var gt=HA.exports;const Hn=qA(gt);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zF=gt,jF=Symbol.for("react.element"),qF=Symbol.for("react.fragment"),WF=Object.prototype.hasOwnProperty,HF=zF.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,GF={key:!0,ref:!0,__self:!0,__source:!0};function eP(t,e,n){var r,i={},s=null,o=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)WF.call(e,r)&&!GF.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:jF,type:t,key:s,ref:o,props:i,_owner:HF.current}}pm.Fragment=qF;pm.jsx=eP;pm.jsxs=eP;WA.exports=pm;var K=WA.exports,My={},tP={exports:{}},Zn={},nP={exports:{}},rP={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(q,J){var ee=q.length;q.push(J);e:for(;0<ee;){var xe=ee-1>>>1,Ie=q[xe];if(0<i(Ie,J))q[xe]=J,q[ee]=Ie,ee=xe;else break e}}function n(q){return q.length===0?null:q[0]}function r(q){if(q.length===0)return null;var J=q[0],ee=q.pop();if(ee!==J){q[0]=ee;e:for(var xe=0,Ie=q.length,yr=Ie>>>1;xe<yr;){var ln=2*(xe+1)-1,Le=q[ln],be=ln+1,En=q[be];if(0>i(Le,ee))be<Ie&&0>i(En,Le)?(q[xe]=En,q[be]=ee,xe=be):(q[xe]=Le,q[ln]=ee,xe=ln);else if(be<Ie&&0>i(En,ee))q[xe]=En,q[be]=ee,xe=be;else break e}}return J}function i(q,J){var ee=q.sortIndex-J.sortIndex;return ee!==0?ee:q.id-J.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],u=[],c=1,h=null,f=3,g=!1,_=!1,w=!1,T=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function I(q){for(var J=n(u);J!==null;){if(J.callback===null)r(u);else if(J.startTime<=q)r(u),J.sortIndex=J.expirationTime,e(l,J);else break;J=n(u)}}function C(q){if(w=!1,I(q),!_)if(n(l)!==null)_=!0,fi(P);else{var J=n(u);J!==null&&wn(C,J.startTime-q)}}function P(q,J){_=!1,w&&(w=!1,v(F),F=-1),g=!0;var ee=f;try{for(I(J),h=n(l);h!==null&&(!(h.expirationTime>J)||q&&!an());){var xe=h.callback;if(typeof xe=="function"){h.callback=null,f=h.priorityLevel;var Ie=xe(h.expirationTime<=J);J=t.unstable_now(),typeof Ie=="function"?h.callback=Ie:h===n(l)&&r(l),I(J)}else r(l);h=n(l)}if(h!==null)var yr=!0;else{var ln=n(u);ln!==null&&wn(C,ln.startTime-J),yr=!1}return yr}finally{h=null,f=ee,g=!1}}var b=!1,k=null,F=-1,re=5,X=-1;function an(){return!(t.unstable_now()-X<re)}function $n(){if(k!==null){var q=t.unstable_now();X=q;var J=!0;try{J=k(!0,q)}finally{J?tr():(b=!1,k=null)}}else b=!1}var tr;if(typeof y=="function")tr=function(){y($n)};else if(typeof MessageChannel<"u"){var Ta=new MessageChannel,Iu=Ta.port2;Ta.port1.onmessage=$n,tr=function(){Iu.postMessage(null)}}else tr=function(){T($n,0)};function fi(q){k=q,b||(b=!0,tr())}function wn(q,J){F=T(function(){q(t.unstable_now())},J)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(q){q.callback=null},t.unstable_continueExecution=function(){_||g||(_=!0,fi(P))},t.unstable_forceFrameRate=function(q){0>q||125<q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):re=0<q?Math.floor(1e3/q):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(q){switch(f){case 1:case 2:case 3:var J=3;break;default:J=f}var ee=f;f=J;try{return q()}finally{f=ee}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(q,J){switch(q){case 1:case 2:case 3:case 4:case 5:break;default:q=3}var ee=f;f=q;try{return J()}finally{f=ee}},t.unstable_scheduleCallback=function(q,J,ee){var xe=t.unstable_now();switch(typeof ee=="object"&&ee!==null?(ee=ee.delay,ee=typeof ee=="number"&&0<ee?xe+ee:xe):ee=xe,q){case 1:var Ie=-1;break;case 2:Ie=250;break;case 5:Ie=1073741823;break;case 4:Ie=1e4;break;default:Ie=5e3}return Ie=ee+Ie,q={id:c++,callback:J,priorityLevel:q,startTime:ee,expirationTime:Ie,sortIndex:-1},ee>xe?(q.sortIndex=ee,e(u,q),n(l)===null&&q===n(u)&&(w?(v(F),F=-1):w=!0,wn(C,ee-xe))):(q.sortIndex=Ie,e(l,q),_||g||(_=!0,fi(P))),q},t.unstable_shouldYield=an,t.unstable_wrapCallback=function(q){var J=f;return function(){var ee=f;f=J;try{return q.apply(this,arguments)}finally{f=ee}}}})(rP);nP.exports=rP;var KF=nP.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var iP=gt,Kn=KF;function L(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var sP=new Set,Lc={};function ua(t,e){gl(t,e),gl(t+"Capture",e)}function gl(t,e){for(Lc[t]=e,t=0;t<e.length;t++)sP.add(e[t])}var Di=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Vy=Object.prototype.hasOwnProperty,QF=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,wS={},ES={};function YF(t){return Vy.call(ES,t)?!0:Vy.call(wS,t)?!1:QF.test(t)?ES[t]=!0:(wS[t]=!0,!1)}function XF(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function JF(t,e,n,r){if(e===null||typeof e>"u"||XF(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function vn(t,e,n,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var Gt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Gt[t]=new vn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Gt[e]=new vn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Gt[t]=new vn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Gt[t]=new vn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Gt[t]=new vn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Gt[t]=new vn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Gt[t]=new vn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Gt[t]=new vn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Gt[t]=new vn(t,5,!1,t.toLowerCase(),null,!1,!1)});var uE=/[\-:]([a-z])/g;function cE(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(uE,cE);Gt[e]=new vn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(uE,cE);Gt[e]=new vn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(uE,cE);Gt[e]=new vn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Gt[t]=new vn(t,1,!1,t.toLowerCase(),null,!1,!1)});Gt.xlinkHref=new vn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Gt[t]=new vn(t,1,!1,t.toLowerCase(),null,!0,!0)});function hE(t,e,n,r){var i=Gt.hasOwnProperty(e)?Gt[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(JF(e,n,i,r)&&(n=null),r||i===null?YF(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Bi=iP.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Vd=Symbol.for("react.element"),Va=Symbol.for("react.portal"),Fa=Symbol.for("react.fragment"),dE=Symbol.for("react.strict_mode"),Fy=Symbol.for("react.profiler"),oP=Symbol.for("react.provider"),aP=Symbol.for("react.context"),fE=Symbol.for("react.forward_ref"),Uy=Symbol.for("react.suspense"),$y=Symbol.for("react.suspense_list"),pE=Symbol.for("react.memo"),ts=Symbol.for("react.lazy"),lP=Symbol.for("react.offscreen"),IS=Symbol.iterator;function Ru(t){return t===null||typeof t!="object"?null:(t=IS&&t[IS]||t["@@iterator"],typeof t=="function"?t:null)}var Je=Object.assign,w_;function Xu(t){if(w_===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);w_=e&&e[1]||""}return`
`+w_+t}var E_=!1;function I_(t,e){if(!t||E_)return"";E_=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==s[a]){var l=`
`+i[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{E_=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Xu(t):""}function ZF(t){switch(t.tag){case 5:return Xu(t.type);case 16:return Xu("Lazy");case 13:return Xu("Suspense");case 19:return Xu("SuspenseList");case 0:case 2:case 15:return t=I_(t.type,!1),t;case 11:return t=I_(t.type.render,!1),t;case 1:return t=I_(t.type,!0),t;default:return""}}function By(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Fa:return"Fragment";case Va:return"Portal";case Fy:return"Profiler";case dE:return"StrictMode";case Uy:return"Suspense";case $y:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case aP:return(t.displayName||"Context")+".Consumer";case oP:return(t._context.displayName||"Context")+".Provider";case fE:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case pE:return e=t.displayName||null,e!==null?e:By(t.type)||"Memo";case ts:e=t._payload,t=t._init;try{return By(t(e))}catch{}}return null}function eU(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return By(e);case 8:return e===dE?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Ps(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function uP(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function tU(t){var e=uP(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Fd(t){t._valueTracker||(t._valueTracker=tU(t))}function cP(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=uP(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Yf(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function zy(t,e){var n=e.checked;return Je({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function TS(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Ps(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function hP(t,e){e=e.checked,e!=null&&hE(t,"checked",e,!1)}function jy(t,e){hP(t,e);var n=Ps(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?qy(t,e.type,n):e.hasOwnProperty("defaultValue")&&qy(t,e.type,Ps(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function SS(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function qy(t,e,n){(e!=="number"||Yf(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Ju=Array.isArray;function Ja(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Ps(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function Wy(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(L(91));return Je({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function CS(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(L(92));if(Ju(n)){if(1<n.length)throw Error(L(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Ps(n)}}function dP(t,e){var n=Ps(e.value),r=Ps(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function RS(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function fP(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Hy(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?fP(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Ud,pP=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Ud=Ud||document.createElement("div"),Ud.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Ud.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Mc(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var cc={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},nU=["Webkit","ms","Moz","O"];Object.keys(cc).forEach(function(t){nU.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),cc[e]=cc[t]})});function mP(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||cc.hasOwnProperty(t)&&cc[t]?(""+e).trim():e+"px"}function gP(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=mP(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var rU=Je({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Gy(t,e){if(e){if(rU[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(L(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(L(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(L(61))}if(e.style!=null&&typeof e.style!="object")throw Error(L(62))}}function Ky(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Qy=null;function mE(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Yy=null,Za=null,el=null;function AS(t){if(t=jh(t)){if(typeof Yy!="function")throw Error(L(280));var e=t.stateNode;e&&(e=vm(e),Yy(t.stateNode,t.type,e))}}function _P(t){Za?el?el.push(t):el=[t]:Za=t}function yP(){if(Za){var t=Za,e=el;if(el=Za=null,AS(t),e)for(t=0;t<e.length;t++)AS(e[t])}}function vP(t,e){return t(e)}function wP(){}var T_=!1;function EP(t,e,n){if(T_)return t(e,n);T_=!0;try{return vP(t,e,n)}finally{T_=!1,(Za!==null||el!==null)&&(wP(),yP())}}function Vc(t,e){var n=t.stateNode;if(n===null)return null;var r=vm(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(L(231,e,typeof n));return n}var Xy=!1;if(Di)try{var Au={};Object.defineProperty(Au,"passive",{get:function(){Xy=!0}}),window.addEventListener("test",Au,Au),window.removeEventListener("test",Au,Au)}catch{Xy=!1}function iU(t,e,n,r,i,s,o,a,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(c){this.onError(c)}}var hc=!1,Xf=null,Jf=!1,Jy=null,sU={onError:function(t){hc=!0,Xf=t}};function oU(t,e,n,r,i,s,o,a,l){hc=!1,Xf=null,iU.apply(sU,arguments)}function aU(t,e,n,r,i,s,o,a,l){if(oU.apply(this,arguments),hc){if(hc){var u=Xf;hc=!1,Xf=null}else throw Error(L(198));Jf||(Jf=!0,Jy=u)}}function ca(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function IP(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function PS(t){if(ca(t)!==t)throw Error(L(188))}function lU(t){var e=t.alternate;if(!e){if(e=ca(t),e===null)throw Error(L(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return PS(i),t;if(s===r)return PS(i),e;s=s.sibling}throw Error(L(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o)throw Error(L(189))}}if(n.alternate!==r)throw Error(L(190))}if(n.tag!==3)throw Error(L(188));return n.stateNode.current===n?t:e}function TP(t){return t=lU(t),t!==null?SP(t):null}function SP(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=SP(t);if(e!==null)return e;t=t.sibling}return null}var CP=Kn.unstable_scheduleCallback,bS=Kn.unstable_cancelCallback,uU=Kn.unstable_shouldYield,cU=Kn.unstable_requestPaint,at=Kn.unstable_now,hU=Kn.unstable_getCurrentPriorityLevel,gE=Kn.unstable_ImmediatePriority,RP=Kn.unstable_UserBlockingPriority,Zf=Kn.unstable_NormalPriority,dU=Kn.unstable_LowPriority,AP=Kn.unstable_IdlePriority,mm=null,Zr=null;function fU(t){if(Zr&&typeof Zr.onCommitFiberRoot=="function")try{Zr.onCommitFiberRoot(mm,t,void 0,(t.current.flags&128)===128)}catch{}}var Pr=Math.clz32?Math.clz32:gU,pU=Math.log,mU=Math.LN2;function gU(t){return t>>>=0,t===0?32:31-(pU(t)/mU|0)|0}var $d=64,Bd=4194304;function Zu(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function ep(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~i;a!==0?r=Zu(a):(s&=o,s!==0&&(r=Zu(s)))}else o=n&~i,o!==0?r=Zu(o):s!==0&&(r=Zu(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Pr(e),i=1<<n,r|=t[n],e&=~i;return r}function _U(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function yU(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-Pr(s),a=1<<o,l=i[o];l===-1?(!(a&n)||a&r)&&(i[o]=_U(a,e)):l<=e&&(t.expiredLanes|=a),s&=~a}}function Zy(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function PP(){var t=$d;return $d<<=1,!($d&4194240)&&($d=64),t}function S_(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Bh(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Pr(e),t[e]=n}function vU(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-Pr(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function _E(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Pr(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var Ae=0;function bP(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var kP,yE,xP,NP,DP,ev=!1,zd=[],fs=null,ps=null,ms=null,Fc=new Map,Uc=new Map,rs=[],wU="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function kS(t,e){switch(t){case"focusin":case"focusout":fs=null;break;case"dragenter":case"dragleave":ps=null;break;case"mouseover":case"mouseout":ms=null;break;case"pointerover":case"pointerout":Fc.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Uc.delete(e.pointerId)}}function Pu(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=jh(e),e!==null&&yE(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function EU(t,e,n,r,i){switch(e){case"focusin":return fs=Pu(fs,t,e,n,r,i),!0;case"dragenter":return ps=Pu(ps,t,e,n,r,i),!0;case"mouseover":return ms=Pu(ms,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return Fc.set(s,Pu(Fc.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,Uc.set(s,Pu(Uc.get(s)||null,t,e,n,r,i)),!0}return!1}function OP(t){var e=Eo(t.target);if(e!==null){var n=ca(e);if(n!==null){if(e=n.tag,e===13){if(e=IP(n),e!==null){t.blockedOn=e,DP(t.priority,function(){xP(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function wf(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=tv(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Qy=r,n.target.dispatchEvent(r),Qy=null}else return e=jh(n),e!==null&&yE(e),t.blockedOn=n,!1;e.shift()}return!0}function xS(t,e,n){wf(t)&&n.delete(e)}function IU(){ev=!1,fs!==null&&wf(fs)&&(fs=null),ps!==null&&wf(ps)&&(ps=null),ms!==null&&wf(ms)&&(ms=null),Fc.forEach(xS),Uc.forEach(xS)}function bu(t,e){t.blockedOn===e&&(t.blockedOn=null,ev||(ev=!0,Kn.unstable_scheduleCallback(Kn.unstable_NormalPriority,IU)))}function $c(t){function e(i){return bu(i,t)}if(0<zd.length){bu(zd[0],t);for(var n=1;n<zd.length;n++){var r=zd[n];r.blockedOn===t&&(r.blockedOn=null)}}for(fs!==null&&bu(fs,t),ps!==null&&bu(ps,t),ms!==null&&bu(ms,t),Fc.forEach(e),Uc.forEach(e),n=0;n<rs.length;n++)r=rs[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<rs.length&&(n=rs[0],n.blockedOn===null);)OP(n),n.blockedOn===null&&rs.shift()}var tl=Bi.ReactCurrentBatchConfig,tp=!0;function TU(t,e,n,r){var i=Ae,s=tl.transition;tl.transition=null;try{Ae=1,vE(t,e,n,r)}finally{Ae=i,tl.transition=s}}function SU(t,e,n,r){var i=Ae,s=tl.transition;tl.transition=null;try{Ae=4,vE(t,e,n,r)}finally{Ae=i,tl.transition=s}}function vE(t,e,n,r){if(tp){var i=tv(t,e,n,r);if(i===null)O_(t,e,r,np,n),kS(t,r);else if(EU(i,t,e,n,r))r.stopPropagation();else if(kS(t,r),e&4&&-1<wU.indexOf(t)){for(;i!==null;){var s=jh(i);if(s!==null&&kP(s),s=tv(t,e,n,r),s===null&&O_(t,e,r,np,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else O_(t,e,r,null,n)}}var np=null;function tv(t,e,n,r){if(np=null,t=mE(r),t=Eo(t),t!==null)if(e=ca(t),e===null)t=null;else if(n=e.tag,n===13){if(t=IP(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return np=t,null}function LP(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(hU()){case gE:return 1;case RP:return 4;case Zf:case dU:return 16;case AP:return 536870912;default:return 16}default:return 16}}var as=null,wE=null,Ef=null;function MP(){if(Ef)return Ef;var t,e=wE,n=e.length,r,i="value"in as?as.value:as.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===i[s-r];r++);return Ef=i.slice(t,1<r?1-r:void 0)}function If(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function jd(){return!0}function NS(){return!1}function er(t){function e(n,r,i,s,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?jd:NS,this.isPropagationStopped=NS,this}return Je(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=jd)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=jd)},persist:function(){},isPersistent:jd}),e}var Yl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},EE=er(Yl),zh=Je({},Yl,{view:0,detail:0}),CU=er(zh),C_,R_,ku,gm=Je({},zh,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:IE,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==ku&&(ku&&t.type==="mousemove"?(C_=t.screenX-ku.screenX,R_=t.screenY-ku.screenY):R_=C_=0,ku=t),C_)},movementY:function(t){return"movementY"in t?t.movementY:R_}}),DS=er(gm),RU=Je({},gm,{dataTransfer:0}),AU=er(RU),PU=Je({},zh,{relatedTarget:0}),A_=er(PU),bU=Je({},Yl,{animationName:0,elapsedTime:0,pseudoElement:0}),kU=er(bU),xU=Je({},Yl,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),NU=er(xU),DU=Je({},Yl,{data:0}),OS=er(DU),OU={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},LU={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},MU={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function VU(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=MU[t])?!!e[t]:!1}function IE(){return VU}var FU=Je({},zh,{key:function(t){if(t.key){var e=OU[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=If(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?LU[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:IE,charCode:function(t){return t.type==="keypress"?If(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?If(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),UU=er(FU),$U=Je({},gm,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),LS=er($U),BU=Je({},zh,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:IE}),zU=er(BU),jU=Je({},Yl,{propertyName:0,elapsedTime:0,pseudoElement:0}),qU=er(jU),WU=Je({},gm,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),HU=er(WU),GU=[9,13,27,32],TE=Di&&"CompositionEvent"in window,dc=null;Di&&"documentMode"in document&&(dc=document.documentMode);var KU=Di&&"TextEvent"in window&&!dc,VP=Di&&(!TE||dc&&8<dc&&11>=dc),MS=String.fromCharCode(32),VS=!1;function FP(t,e){switch(t){case"keyup":return GU.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function UP(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Ua=!1;function QU(t,e){switch(t){case"compositionend":return UP(e);case"keypress":return e.which!==32?null:(VS=!0,MS);case"textInput":return t=e.data,t===MS&&VS?null:t;default:return null}}function YU(t,e){if(Ua)return t==="compositionend"||!TE&&FP(t,e)?(t=MP(),Ef=wE=as=null,Ua=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return VP&&e.locale!=="ko"?null:e.data;default:return null}}var XU={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function FS(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!XU[t.type]:e==="textarea"}function $P(t,e,n,r){_P(r),e=rp(e,"onChange"),0<e.length&&(n=new EE("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var fc=null,Bc=null;function JU(t){XP(t,0)}function _m(t){var e=za(t);if(cP(e))return t}function ZU(t,e){if(t==="change")return e}var BP=!1;if(Di){var P_;if(Di){var b_="oninput"in document;if(!b_){var US=document.createElement("div");US.setAttribute("oninput","return;"),b_=typeof US.oninput=="function"}P_=b_}else P_=!1;BP=P_&&(!document.documentMode||9<document.documentMode)}function $S(){fc&&(fc.detachEvent("onpropertychange",zP),Bc=fc=null)}function zP(t){if(t.propertyName==="value"&&_m(Bc)){var e=[];$P(e,Bc,t,mE(t)),EP(JU,e)}}function e4(t,e,n){t==="focusin"?($S(),fc=e,Bc=n,fc.attachEvent("onpropertychange",zP)):t==="focusout"&&$S()}function t4(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return _m(Bc)}function n4(t,e){if(t==="click")return _m(e)}function r4(t,e){if(t==="input"||t==="change")return _m(e)}function i4(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Nr=typeof Object.is=="function"?Object.is:i4;function zc(t,e){if(Nr(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!Vy.call(e,i)||!Nr(t[i],e[i]))return!1}return!0}function BS(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function zS(t,e){var n=BS(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=BS(n)}}function jP(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?jP(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function qP(){for(var t=window,e=Yf();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Yf(t.document)}return e}function SE(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function s4(t){var e=qP(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&jP(n.ownerDocument.documentElement,n)){if(r!==null&&SE(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=zS(n,s);var o=zS(n,r);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var o4=Di&&"documentMode"in document&&11>=document.documentMode,$a=null,nv=null,pc=null,rv=!1;function jS(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;rv||$a==null||$a!==Yf(r)||(r=$a,"selectionStart"in r&&SE(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),pc&&zc(pc,r)||(pc=r,r=rp(nv,"onSelect"),0<r.length&&(e=new EE("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=$a)))}function qd(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Ba={animationend:qd("Animation","AnimationEnd"),animationiteration:qd("Animation","AnimationIteration"),animationstart:qd("Animation","AnimationStart"),transitionend:qd("Transition","TransitionEnd")},k_={},WP={};Di&&(WP=document.createElement("div").style,"AnimationEvent"in window||(delete Ba.animationend.animation,delete Ba.animationiteration.animation,delete Ba.animationstart.animation),"TransitionEvent"in window||delete Ba.transitionend.transition);function ym(t){if(k_[t])return k_[t];if(!Ba[t])return t;var e=Ba[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in WP)return k_[t]=e[n];return t}var HP=ym("animationend"),GP=ym("animationiteration"),KP=ym("animationstart"),QP=ym("transitionend"),YP=new Map,qS="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Gs(t,e){YP.set(t,e),ua(e,[t])}for(var x_=0;x_<qS.length;x_++){var N_=qS[x_],a4=N_.toLowerCase(),l4=N_[0].toUpperCase()+N_.slice(1);Gs(a4,"on"+l4)}Gs(HP,"onAnimationEnd");Gs(GP,"onAnimationIteration");Gs(KP,"onAnimationStart");Gs("dblclick","onDoubleClick");Gs("focusin","onFocus");Gs("focusout","onBlur");Gs(QP,"onTransitionEnd");gl("onMouseEnter",["mouseout","mouseover"]);gl("onMouseLeave",["mouseout","mouseover"]);gl("onPointerEnter",["pointerout","pointerover"]);gl("onPointerLeave",["pointerout","pointerover"]);ua("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ua("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ua("onBeforeInput",["compositionend","keypress","textInput","paste"]);ua("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ua("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ua("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ec="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),u4=new Set("cancel close invalid load scroll toggle".split(" ").concat(ec));function WS(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,aU(r,e,void 0,t),t.currentTarget=null}function XP(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==s&&i.isPropagationStopped())break e;WS(i,a,u),s=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,u=a.currentTarget,a=a.listener,l!==s&&i.isPropagationStopped())break e;WS(i,a,u),s=l}}}if(Jf)throw t=Jy,Jf=!1,Jy=null,t}function Me(t,e){var n=e[lv];n===void 0&&(n=e[lv]=new Set);var r=t+"__bubble";n.has(r)||(JP(e,t,2,!1),n.add(r))}function D_(t,e,n){var r=0;e&&(r|=4),JP(n,t,r,e)}var Wd="_reactListening"+Math.random().toString(36).slice(2);function jc(t){if(!t[Wd]){t[Wd]=!0,sP.forEach(function(n){n!=="selectionchange"&&(u4.has(n)||D_(n,!1,t),D_(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Wd]||(e[Wd]=!0,D_("selectionchange",!1,e))}}function JP(t,e,n,r){switch(LP(e)){case 1:var i=TU;break;case 4:i=SU;break;default:i=vE}n=i.bind(null,e,n,t),i=void 0,!Xy||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function O_(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;o=o.return}for(;a!==null;){if(o=Eo(a),o===null)return;if(l=o.tag,l===5||l===6){r=s=o;continue e}a=a.parentNode}}r=r.return}EP(function(){var u=s,c=mE(n),h=[];e:{var f=YP.get(t);if(f!==void 0){var g=EE,_=t;switch(t){case"keypress":if(If(n)===0)break e;case"keydown":case"keyup":g=UU;break;case"focusin":_="focus",g=A_;break;case"focusout":_="blur",g=A_;break;case"beforeblur":case"afterblur":g=A_;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":g=DS;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":g=AU;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":g=zU;break;case HP:case GP:case KP:g=kU;break;case QP:g=qU;break;case"scroll":g=CU;break;case"wheel":g=HU;break;case"copy":case"cut":case"paste":g=NU;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":g=LS}var w=(e&4)!==0,T=!w&&t==="scroll",v=w?f!==null?f+"Capture":null:f;w=[];for(var y=u,I;y!==null;){I=y;var C=I.stateNode;if(I.tag===5&&C!==null&&(I=C,v!==null&&(C=Vc(y,v),C!=null&&w.push(qc(y,C,I)))),T)break;y=y.return}0<w.length&&(f=new g(f,_,null,n,c),h.push({event:f,listeners:w}))}}if(!(e&7)){e:{if(f=t==="mouseover"||t==="pointerover",g=t==="mouseout"||t==="pointerout",f&&n!==Qy&&(_=n.relatedTarget||n.fromElement)&&(Eo(_)||_[Oi]))break e;if((g||f)&&(f=c.window===c?c:(f=c.ownerDocument)?f.defaultView||f.parentWindow:window,g?(_=n.relatedTarget||n.toElement,g=u,_=_?Eo(_):null,_!==null&&(T=ca(_),_!==T||_.tag!==5&&_.tag!==6)&&(_=null)):(g=null,_=u),g!==_)){if(w=DS,C="onMouseLeave",v="onMouseEnter",y="mouse",(t==="pointerout"||t==="pointerover")&&(w=LS,C="onPointerLeave",v="onPointerEnter",y="pointer"),T=g==null?f:za(g),I=_==null?f:za(_),f=new w(C,y+"leave",g,n,c),f.target=T,f.relatedTarget=I,C=null,Eo(c)===u&&(w=new w(v,y+"enter",_,n,c),w.target=I,w.relatedTarget=T,C=w),T=C,g&&_)t:{for(w=g,v=_,y=0,I=w;I;I=Ra(I))y++;for(I=0,C=v;C;C=Ra(C))I++;for(;0<y-I;)w=Ra(w),y--;for(;0<I-y;)v=Ra(v),I--;for(;y--;){if(w===v||v!==null&&w===v.alternate)break t;w=Ra(w),v=Ra(v)}w=null}else w=null;g!==null&&HS(h,f,g,w,!1),_!==null&&T!==null&&HS(h,T,_,w,!0)}}e:{if(f=u?za(u):window,g=f.nodeName&&f.nodeName.toLowerCase(),g==="select"||g==="input"&&f.type==="file")var P=ZU;else if(FS(f))if(BP)P=r4;else{P=t4;var b=e4}else(g=f.nodeName)&&g.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(P=n4);if(P&&(P=P(t,u))){$P(h,P,n,c);break e}b&&b(t,f,u),t==="focusout"&&(b=f._wrapperState)&&b.controlled&&f.type==="number"&&qy(f,"number",f.value)}switch(b=u?za(u):window,t){case"focusin":(FS(b)||b.contentEditable==="true")&&($a=b,nv=u,pc=null);break;case"focusout":pc=nv=$a=null;break;case"mousedown":rv=!0;break;case"contextmenu":case"mouseup":case"dragend":rv=!1,jS(h,n,c);break;case"selectionchange":if(o4)break;case"keydown":case"keyup":jS(h,n,c)}var k;if(TE)e:{switch(t){case"compositionstart":var F="onCompositionStart";break e;case"compositionend":F="onCompositionEnd";break e;case"compositionupdate":F="onCompositionUpdate";break e}F=void 0}else Ua?FP(t,n)&&(F="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(F="onCompositionStart");F&&(VP&&n.locale!=="ko"&&(Ua||F!=="onCompositionStart"?F==="onCompositionEnd"&&Ua&&(k=MP()):(as=c,wE="value"in as?as.value:as.textContent,Ua=!0)),b=rp(u,F),0<b.length&&(F=new OS(F,t,null,n,c),h.push({event:F,listeners:b}),k?F.data=k:(k=UP(n),k!==null&&(F.data=k)))),(k=KU?QU(t,n):YU(t,n))&&(u=rp(u,"onBeforeInput"),0<u.length&&(c=new OS("onBeforeInput","beforeinput",null,n,c),h.push({event:c,listeners:u}),c.data=k))}XP(h,e)})}function qc(t,e,n){return{instance:t,listener:e,currentTarget:n}}function rp(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Vc(t,n),s!=null&&r.unshift(qc(t,s,i)),s=Vc(t,e),s!=null&&r.push(qc(t,s,i))),t=t.return}return r}function Ra(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function HS(t,e,n,r,i){for(var s=e._reactName,o=[];n!==null&&n!==r;){var a=n,l=a.alternate,u=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&u!==null&&(a=u,i?(l=Vc(n,s),l!=null&&o.unshift(qc(n,l,a))):i||(l=Vc(n,s),l!=null&&o.push(qc(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var c4=/\r\n?/g,h4=/\u0000|\uFFFD/g;function GS(t){return(typeof t=="string"?t:""+t).replace(c4,`
`).replace(h4,"")}function Hd(t,e,n){if(e=GS(e),GS(t)!==e&&n)throw Error(L(425))}function ip(){}var iv=null,sv=null;function ov(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var av=typeof setTimeout=="function"?setTimeout:void 0,d4=typeof clearTimeout=="function"?clearTimeout:void 0,KS=typeof Promise=="function"?Promise:void 0,f4=typeof queueMicrotask=="function"?queueMicrotask:typeof KS<"u"?function(t){return KS.resolve(null).then(t).catch(p4)}:av;function p4(t){setTimeout(function(){throw t})}function L_(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),$c(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);$c(e)}function gs(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function QS(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Xl=Math.random().toString(36).slice(2),Br="__reactFiber$"+Xl,Wc="__reactProps$"+Xl,Oi="__reactContainer$"+Xl,lv="__reactEvents$"+Xl,m4="__reactListeners$"+Xl,g4="__reactHandles$"+Xl;function Eo(t){var e=t[Br];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Oi]||n[Br]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=QS(t);t!==null;){if(n=t[Br])return n;t=QS(t)}return e}t=n,n=t.parentNode}return null}function jh(t){return t=t[Br]||t[Oi],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function za(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(L(33))}function vm(t){return t[Wc]||null}var uv=[],ja=-1;function Ks(t){return{current:t}}function $e(t){0>ja||(t.current=uv[ja],uv[ja]=null,ja--)}function De(t,e){ja++,uv[ja]=t.current,t.current=e}var bs={},sn=Ks(bs),Dn=Ks(!1),Bo=bs;function _l(t,e){var n=t.type.contextTypes;if(!n)return bs;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function On(t){return t=t.childContextTypes,t!=null}function sp(){$e(Dn),$e(sn)}function YS(t,e,n){if(sn.current!==bs)throw Error(L(168));De(sn,e),De(Dn,n)}function ZP(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(L(108,eU(t)||"Unknown",i));return Je({},n,r)}function op(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||bs,Bo=sn.current,De(sn,t),De(Dn,Dn.current),!0}function XS(t,e,n){var r=t.stateNode;if(!r)throw Error(L(169));n?(t=ZP(t,e,Bo),r.__reactInternalMemoizedMergedChildContext=t,$e(Dn),$e(sn),De(sn,t)):$e(Dn),De(Dn,n)}var vi=null,wm=!1,M_=!1;function eb(t){vi===null?vi=[t]:vi.push(t)}function _4(t){wm=!0,eb(t)}function Qs(){if(!M_&&vi!==null){M_=!0;var t=0,e=Ae;try{var n=vi;for(Ae=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}vi=null,wm=!1}catch(i){throw vi!==null&&(vi=vi.slice(t+1)),CP(gE,Qs),i}finally{Ae=e,M_=!1}}return null}var qa=[],Wa=0,ap=null,lp=0,nr=[],rr=0,zo=null,Ei=1,Ii="";function co(t,e){qa[Wa++]=lp,qa[Wa++]=ap,ap=t,lp=e}function tb(t,e,n){nr[rr++]=Ei,nr[rr++]=Ii,nr[rr++]=zo,zo=t;var r=Ei;t=Ii;var i=32-Pr(r)-1;r&=~(1<<i),n+=1;var s=32-Pr(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,Ei=1<<32-Pr(e)+i|n<<i|r,Ii=s+t}else Ei=1<<s|n<<i|r,Ii=t}function CE(t){t.return!==null&&(co(t,1),tb(t,1,0))}function RE(t){for(;t===ap;)ap=qa[--Wa],qa[Wa]=null,lp=qa[--Wa],qa[Wa]=null;for(;t===zo;)zo=nr[--rr],nr[rr]=null,Ii=nr[--rr],nr[rr]=null,Ei=nr[--rr],nr[rr]=null}var Gn=null,qn=null,je=!1,Sr=null;function nb(t,e){var n=or(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function JS(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Gn=t,qn=gs(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Gn=t,qn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=zo!==null?{id:Ei,overflow:Ii}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=or(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Gn=t,qn=null,!0):!1;default:return!1}}function cv(t){return(t.mode&1)!==0&&(t.flags&128)===0}function hv(t){if(je){var e=qn;if(e){var n=e;if(!JS(t,e)){if(cv(t))throw Error(L(418));e=gs(n.nextSibling);var r=Gn;e&&JS(t,e)?nb(r,n):(t.flags=t.flags&-4097|2,je=!1,Gn=t)}}else{if(cv(t))throw Error(L(418));t.flags=t.flags&-4097|2,je=!1,Gn=t}}}function ZS(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Gn=t}function Gd(t){if(t!==Gn)return!1;if(!je)return ZS(t),je=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!ov(t.type,t.memoizedProps)),e&&(e=qn)){if(cv(t))throw rb(),Error(L(418));for(;e;)nb(t,e),e=gs(e.nextSibling)}if(ZS(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(L(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){qn=gs(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}qn=null}}else qn=Gn?gs(t.stateNode.nextSibling):null;return!0}function rb(){for(var t=qn;t;)t=gs(t.nextSibling)}function yl(){qn=Gn=null,je=!1}function AE(t){Sr===null?Sr=[t]:Sr.push(t)}var y4=Bi.ReactCurrentBatchConfig;function Ir(t,e){if(t&&t.defaultProps){e=Je({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}var up=Ks(null),cp=null,Ha=null,PE=null;function bE(){PE=Ha=cp=null}function kE(t){var e=up.current;$e(up),t._currentValue=e}function dv(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function nl(t,e){cp=t,PE=Ha=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(An=!0),t.firstContext=null)}function fr(t){var e=t._currentValue;if(PE!==t)if(t={context:t,memoizedValue:e,next:null},Ha===null){if(cp===null)throw Error(L(308));Ha=t,cp.dependencies={lanes:0,firstContext:t}}else Ha=Ha.next=t;return e}var Io=null;function xE(t){Io===null?Io=[t]:Io.push(t)}function ib(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,xE(e)):(n.next=i.next,i.next=n),e.interleaved=n,Li(t,r)}function Li(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var ns=!1;function NE(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function sb(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Ai(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function _s(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,ye&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,Li(t,n)}return i=r.interleaved,i===null?(e.next=e,xE(r)):(e.next=i.next,i.next=e),r.interleaved=e,Li(t,n)}function Tf(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,_E(t,n)}}function e1(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function hp(t,e,n,r){var i=t.updateQueue;ns=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var l=a,u=l.next;l.next=null,o===null?s=u:o.next=u,o=l;var c=t.alternate;c!==null&&(c=c.updateQueue,a=c.lastBaseUpdate,a!==o&&(a===null?c.firstBaseUpdate=u:a.next=u,c.lastBaseUpdate=l))}if(s!==null){var h=i.baseState;o=0,c=u=l=null,a=s;do{var f=a.lane,g=a.eventTime;if((r&f)===f){c!==null&&(c=c.next={eventTime:g,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var _=t,w=a;switch(f=e,g=n,w.tag){case 1:if(_=w.payload,typeof _=="function"){h=_.call(g,h,f);break e}h=_;break e;case 3:_.flags=_.flags&-65537|128;case 0:if(_=w.payload,f=typeof _=="function"?_.call(g,h,f):_,f==null)break e;h=Je({},h,f);break e;case 2:ns=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,f=i.effects,f===null?i.effects=[a]:f.push(a))}else g={eventTime:g,lane:f,tag:a.tag,payload:a.payload,callback:a.callback,next:null},c===null?(u=c=g,l=h):c=c.next=g,o|=f;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;f=a,a=f.next,f.next=null,i.lastBaseUpdate=f,i.shared.pending=null}}while(1);if(c===null&&(l=h),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=c,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);qo|=o,t.lanes=o,t.memoizedState=h}}function t1(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(L(191,i));i.call(r)}}}var ob=new iP.Component().refs;function fv(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Je({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Em={isMounted:function(t){return(t=t._reactInternals)?ca(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=mn(),i=vs(t),s=Ai(r,i);s.payload=e,n!=null&&(s.callback=n),e=_s(t,s,i),e!==null&&(br(e,t,i,r),Tf(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=mn(),i=vs(t),s=Ai(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=_s(t,s,i),e!==null&&(br(e,t,i,r),Tf(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=mn(),r=vs(t),i=Ai(n,r);i.tag=2,e!=null&&(i.callback=e),e=_s(t,i,r),e!==null&&(br(e,t,r,n),Tf(e,t,r))}};function n1(t,e,n,r,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!zc(n,r)||!zc(i,s):!0}function ab(t,e,n){var r=!1,i=bs,s=e.contextType;return typeof s=="object"&&s!==null?s=fr(s):(i=On(e)?Bo:sn.current,r=e.contextTypes,s=(r=r!=null)?_l(t,i):bs),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Em,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function r1(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Em.enqueueReplaceState(e,e.state,null)}function pv(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs=ob,NE(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=fr(s):(s=On(e)?Bo:sn.current,i.context=_l(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(fv(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Em.enqueueReplaceState(i,i.state,null),hp(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function xu(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(L(309));var r=n.stateNode}if(!r)throw Error(L(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=i.refs;a===ob&&(a=i.refs={}),o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(L(284));if(!n._owner)throw Error(L(290,t))}return t}function Kd(t,e){throw t=Object.prototype.toString.call(e),Error(L(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function i1(t){var e=t._init;return e(t._payload)}function lb(t){function e(v,y){if(t){var I=v.deletions;I===null?(v.deletions=[y],v.flags|=16):I.push(y)}}function n(v,y){if(!t)return null;for(;y!==null;)e(v,y),y=y.sibling;return null}function r(v,y){for(v=new Map;y!==null;)y.key!==null?v.set(y.key,y):v.set(y.index,y),y=y.sibling;return v}function i(v,y){return v=ws(v,y),v.index=0,v.sibling=null,v}function s(v,y,I){return v.index=I,t?(I=v.alternate,I!==null?(I=I.index,I<y?(v.flags|=2,y):I):(v.flags|=2,y)):(v.flags|=1048576,y)}function o(v){return t&&v.alternate===null&&(v.flags|=2),v}function a(v,y,I,C){return y===null||y.tag!==6?(y=j_(I,v.mode,C),y.return=v,y):(y=i(y,I),y.return=v,y)}function l(v,y,I,C){var P=I.type;return P===Fa?c(v,y,I.props.children,C,I.key):y!==null&&(y.elementType===P||typeof P=="object"&&P!==null&&P.$$typeof===ts&&i1(P)===y.type)?(C=i(y,I.props),C.ref=xu(v,y,I),C.return=v,C):(C=bf(I.type,I.key,I.props,null,v.mode,C),C.ref=xu(v,y,I),C.return=v,C)}function u(v,y,I,C){return y===null||y.tag!==4||y.stateNode.containerInfo!==I.containerInfo||y.stateNode.implementation!==I.implementation?(y=q_(I,v.mode,C),y.return=v,y):(y=i(y,I.children||[]),y.return=v,y)}function c(v,y,I,C,P){return y===null||y.tag!==7?(y=No(I,v.mode,C,P),y.return=v,y):(y=i(y,I),y.return=v,y)}function h(v,y,I){if(typeof y=="string"&&y!==""||typeof y=="number")return y=j_(""+y,v.mode,I),y.return=v,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Vd:return I=bf(y.type,y.key,y.props,null,v.mode,I),I.ref=xu(v,null,y),I.return=v,I;case Va:return y=q_(y,v.mode,I),y.return=v,y;case ts:var C=y._init;return h(v,C(y._payload),I)}if(Ju(y)||Ru(y))return y=No(y,v.mode,I,null),y.return=v,y;Kd(v,y)}return null}function f(v,y,I,C){var P=y!==null?y.key:null;if(typeof I=="string"&&I!==""||typeof I=="number")return P!==null?null:a(v,y,""+I,C);if(typeof I=="object"&&I!==null){switch(I.$$typeof){case Vd:return I.key===P?l(v,y,I,C):null;case Va:return I.key===P?u(v,y,I,C):null;case ts:return P=I._init,f(v,y,P(I._payload),C)}if(Ju(I)||Ru(I))return P!==null?null:c(v,y,I,C,null);Kd(v,I)}return null}function g(v,y,I,C,P){if(typeof C=="string"&&C!==""||typeof C=="number")return v=v.get(I)||null,a(y,v,""+C,P);if(typeof C=="object"&&C!==null){switch(C.$$typeof){case Vd:return v=v.get(C.key===null?I:C.key)||null,l(y,v,C,P);case Va:return v=v.get(C.key===null?I:C.key)||null,u(y,v,C,P);case ts:var b=C._init;return g(v,y,I,b(C._payload),P)}if(Ju(C)||Ru(C))return v=v.get(I)||null,c(y,v,C,P,null);Kd(y,C)}return null}function _(v,y,I,C){for(var P=null,b=null,k=y,F=y=0,re=null;k!==null&&F<I.length;F++){k.index>F?(re=k,k=null):re=k.sibling;var X=f(v,k,I[F],C);if(X===null){k===null&&(k=re);break}t&&k&&X.alternate===null&&e(v,k),y=s(X,y,F),b===null?P=X:b.sibling=X,b=X,k=re}if(F===I.length)return n(v,k),je&&co(v,F),P;if(k===null){for(;F<I.length;F++)k=h(v,I[F],C),k!==null&&(y=s(k,y,F),b===null?P=k:b.sibling=k,b=k);return je&&co(v,F),P}for(k=r(v,k);F<I.length;F++)re=g(k,v,F,I[F],C),re!==null&&(t&&re.alternate!==null&&k.delete(re.key===null?F:re.key),y=s(re,y,F),b===null?P=re:b.sibling=re,b=re);return t&&k.forEach(function(an){return e(v,an)}),je&&co(v,F),P}function w(v,y,I,C){var P=Ru(I);if(typeof P!="function")throw Error(L(150));if(I=P.call(I),I==null)throw Error(L(151));for(var b=P=null,k=y,F=y=0,re=null,X=I.next();k!==null&&!X.done;F++,X=I.next()){k.index>F?(re=k,k=null):re=k.sibling;var an=f(v,k,X.value,C);if(an===null){k===null&&(k=re);break}t&&k&&an.alternate===null&&e(v,k),y=s(an,y,F),b===null?P=an:b.sibling=an,b=an,k=re}if(X.done)return n(v,k),je&&co(v,F),P;if(k===null){for(;!X.done;F++,X=I.next())X=h(v,X.value,C),X!==null&&(y=s(X,y,F),b===null?P=X:b.sibling=X,b=X);return je&&co(v,F),P}for(k=r(v,k);!X.done;F++,X=I.next())X=g(k,v,F,X.value,C),X!==null&&(t&&X.alternate!==null&&k.delete(X.key===null?F:X.key),y=s(X,y,F),b===null?P=X:b.sibling=X,b=X);return t&&k.forEach(function($n){return e(v,$n)}),je&&co(v,F),P}function T(v,y,I,C){if(typeof I=="object"&&I!==null&&I.type===Fa&&I.key===null&&(I=I.props.children),typeof I=="object"&&I!==null){switch(I.$$typeof){case Vd:e:{for(var P=I.key,b=y;b!==null;){if(b.key===P){if(P=I.type,P===Fa){if(b.tag===7){n(v,b.sibling),y=i(b,I.props.children),y.return=v,v=y;break e}}else if(b.elementType===P||typeof P=="object"&&P!==null&&P.$$typeof===ts&&i1(P)===b.type){n(v,b.sibling),y=i(b,I.props),y.ref=xu(v,b,I),y.return=v,v=y;break e}n(v,b);break}else e(v,b);b=b.sibling}I.type===Fa?(y=No(I.props.children,v.mode,C,I.key),y.return=v,v=y):(C=bf(I.type,I.key,I.props,null,v.mode,C),C.ref=xu(v,y,I),C.return=v,v=C)}return o(v);case Va:e:{for(b=I.key;y!==null;){if(y.key===b)if(y.tag===4&&y.stateNode.containerInfo===I.containerInfo&&y.stateNode.implementation===I.implementation){n(v,y.sibling),y=i(y,I.children||[]),y.return=v,v=y;break e}else{n(v,y);break}else e(v,y);y=y.sibling}y=q_(I,v.mode,C),y.return=v,v=y}return o(v);case ts:return b=I._init,T(v,y,b(I._payload),C)}if(Ju(I))return _(v,y,I,C);if(Ru(I))return w(v,y,I,C);Kd(v,I)}return typeof I=="string"&&I!==""||typeof I=="number"?(I=""+I,y!==null&&y.tag===6?(n(v,y.sibling),y=i(y,I),y.return=v,v=y):(n(v,y),y=j_(I,v.mode,C),y.return=v,v=y),o(v)):n(v,y)}return T}var vl=lb(!0),ub=lb(!1),qh={},ei=Ks(qh),Hc=Ks(qh),Gc=Ks(qh);function To(t){if(t===qh)throw Error(L(174));return t}function DE(t,e){switch(De(Gc,e),De(Hc,t),De(ei,qh),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Hy(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Hy(e,t)}$e(ei),De(ei,e)}function wl(){$e(ei),$e(Hc),$e(Gc)}function cb(t){To(Gc.current);var e=To(ei.current),n=Hy(e,t.type);e!==n&&(De(Hc,t),De(ei,n))}function OE(t){Hc.current===t&&($e(ei),$e(Hc))}var Ke=Ks(0);function dp(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var V_=[];function LE(){for(var t=0;t<V_.length;t++)V_[t]._workInProgressVersionPrimary=null;V_.length=0}var Sf=Bi.ReactCurrentDispatcher,F_=Bi.ReactCurrentBatchConfig,jo=0,Ye=null,wt=null,Rt=null,fp=!1,mc=!1,Kc=0,v4=0;function Qt(){throw Error(L(321))}function ME(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Nr(t[n],e[n]))return!1;return!0}function VE(t,e,n,r,i,s){if(jo=s,Ye=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Sf.current=t===null||t.memoizedState===null?T4:S4,t=n(r,i),mc){s=0;do{if(mc=!1,Kc=0,25<=s)throw Error(L(301));s+=1,Rt=wt=null,e.updateQueue=null,Sf.current=C4,t=n(r,i)}while(mc)}if(Sf.current=pp,e=wt!==null&&wt.next!==null,jo=0,Rt=wt=Ye=null,fp=!1,e)throw Error(L(300));return t}function FE(){var t=Kc!==0;return Kc=0,t}function Ur(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Rt===null?Ye.memoizedState=Rt=t:Rt=Rt.next=t,Rt}function pr(){if(wt===null){var t=Ye.alternate;t=t!==null?t.memoizedState:null}else t=wt.next;var e=Rt===null?Ye.memoizedState:Rt.next;if(e!==null)Rt=e,wt=t;else{if(t===null)throw Error(L(310));wt=t,t={memoizedState:wt.memoizedState,baseState:wt.baseState,baseQueue:wt.baseQueue,queue:wt.queue,next:null},Rt===null?Ye.memoizedState=Rt=t:Rt=Rt.next=t}return Rt}function Qc(t,e){return typeof e=="function"?e(t):e}function U_(t){var e=pr(),n=e.queue;if(n===null)throw Error(L(311));n.lastRenderedReducer=t;var r=wt,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var a=o=null,l=null,u=s;do{var c=u.lane;if((jo&c)===c)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var h={lane:c,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(a=l=h,o=r):l=l.next=h,Ye.lanes|=c,qo|=c}u=u.next}while(u!==null&&u!==s);l===null?o=r:l.next=a,Nr(r,e.memoizedState)||(An=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,Ye.lanes|=s,qo|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function $_(t){var e=pr(),n=e.queue;if(n===null)throw Error(L(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);Nr(s,e.memoizedState)||(An=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function hb(){}function db(t,e){var n=Ye,r=pr(),i=e(),s=!Nr(r.memoizedState,i);if(s&&(r.memoizedState=i,An=!0),r=r.queue,UE(mb.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||Rt!==null&&Rt.memoizedState.tag&1){if(n.flags|=2048,Yc(9,pb.bind(null,n,r,i,e),void 0,null),Nt===null)throw Error(L(349));jo&30||fb(n,e,i)}return i}function fb(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Ye.updateQueue,e===null?(e={lastEffect:null,stores:null},Ye.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function pb(t,e,n,r){e.value=n,e.getSnapshot=r,gb(e)&&_b(t)}function mb(t,e,n){return n(function(){gb(e)&&_b(t)})}function gb(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Nr(t,n)}catch{return!0}}function _b(t){var e=Li(t,1);e!==null&&br(e,t,1,-1)}function s1(t){var e=Ur();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Qc,lastRenderedState:t},e.queue=t,t=t.dispatch=I4.bind(null,Ye,t),[e.memoizedState,t]}function Yc(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Ye.updateQueue,e===null?(e={lastEffect:null,stores:null},Ye.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function yb(){return pr().memoizedState}function Cf(t,e,n,r){var i=Ur();Ye.flags|=t,i.memoizedState=Yc(1|e,n,void 0,r===void 0?null:r)}function Im(t,e,n,r){var i=pr();r=r===void 0?null:r;var s=void 0;if(wt!==null){var o=wt.memoizedState;if(s=o.destroy,r!==null&&ME(r,o.deps)){i.memoizedState=Yc(e,n,s,r);return}}Ye.flags|=t,i.memoizedState=Yc(1|e,n,s,r)}function o1(t,e){return Cf(8390656,8,t,e)}function UE(t,e){return Im(2048,8,t,e)}function vb(t,e){return Im(4,2,t,e)}function wb(t,e){return Im(4,4,t,e)}function Eb(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Ib(t,e,n){return n=n!=null?n.concat([t]):null,Im(4,4,Eb.bind(null,e,t),n)}function $E(){}function Tb(t,e){var n=pr();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&ME(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function Sb(t,e){var n=pr();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&ME(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function Cb(t,e,n){return jo&21?(Nr(n,e)||(n=PP(),Ye.lanes|=n,qo|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,An=!0),t.memoizedState=n)}function w4(t,e){var n=Ae;Ae=n!==0&&4>n?n:4,t(!0);var r=F_.transition;F_.transition={};try{t(!1),e()}finally{Ae=n,F_.transition=r}}function Rb(){return pr().memoizedState}function E4(t,e,n){var r=vs(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Ab(t))Pb(e,n);else if(n=ib(t,e,n,r),n!==null){var i=mn();br(n,t,r,i),bb(n,e,r)}}function I4(t,e,n){var r=vs(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Ab(t))Pb(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,n);if(i.hasEagerState=!0,i.eagerState=a,Nr(a,o)){var l=e.interleaved;l===null?(i.next=i,xE(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}n=ib(t,e,i,r),n!==null&&(i=mn(),br(n,t,r,i),bb(n,e,r))}}function Ab(t){var e=t.alternate;return t===Ye||e!==null&&e===Ye}function Pb(t,e){mc=fp=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function bb(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,_E(t,n)}}var pp={readContext:fr,useCallback:Qt,useContext:Qt,useEffect:Qt,useImperativeHandle:Qt,useInsertionEffect:Qt,useLayoutEffect:Qt,useMemo:Qt,useReducer:Qt,useRef:Qt,useState:Qt,useDebugValue:Qt,useDeferredValue:Qt,useTransition:Qt,useMutableSource:Qt,useSyncExternalStore:Qt,useId:Qt,unstable_isNewReconciler:!1},T4={readContext:fr,useCallback:function(t,e){return Ur().memoizedState=[t,e===void 0?null:e],t},useContext:fr,useEffect:o1,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Cf(4194308,4,Eb.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Cf(4194308,4,t,e)},useInsertionEffect:function(t,e){return Cf(4,2,t,e)},useMemo:function(t,e){var n=Ur();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Ur();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=E4.bind(null,Ye,t),[r.memoizedState,t]},useRef:function(t){var e=Ur();return t={current:t},e.memoizedState=t},useState:s1,useDebugValue:$E,useDeferredValue:function(t){return Ur().memoizedState=t},useTransition:function(){var t=s1(!1),e=t[0];return t=w4.bind(null,t[1]),Ur().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Ye,i=Ur();if(je){if(n===void 0)throw Error(L(407));n=n()}else{if(n=e(),Nt===null)throw Error(L(349));jo&30||fb(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,o1(mb.bind(null,r,s,t),[t]),r.flags|=2048,Yc(9,pb.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=Ur(),e=Nt.identifierPrefix;if(je){var n=Ii,r=Ei;n=(r&~(1<<32-Pr(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Kc++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=v4++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},S4={readContext:fr,useCallback:Tb,useContext:fr,useEffect:UE,useImperativeHandle:Ib,useInsertionEffect:vb,useLayoutEffect:wb,useMemo:Sb,useReducer:U_,useRef:yb,useState:function(){return U_(Qc)},useDebugValue:$E,useDeferredValue:function(t){var e=pr();return Cb(e,wt.memoizedState,t)},useTransition:function(){var t=U_(Qc)[0],e=pr().memoizedState;return[t,e]},useMutableSource:hb,useSyncExternalStore:db,useId:Rb,unstable_isNewReconciler:!1},C4={readContext:fr,useCallback:Tb,useContext:fr,useEffect:UE,useImperativeHandle:Ib,useInsertionEffect:vb,useLayoutEffect:wb,useMemo:Sb,useReducer:$_,useRef:yb,useState:function(){return $_(Qc)},useDebugValue:$E,useDeferredValue:function(t){var e=pr();return wt===null?e.memoizedState=t:Cb(e,wt.memoizedState,t)},useTransition:function(){var t=$_(Qc)[0],e=pr().memoizedState;return[t,e]},useMutableSource:hb,useSyncExternalStore:db,useId:Rb,unstable_isNewReconciler:!1};function El(t,e){try{var n="",r=e;do n+=ZF(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function B_(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function mv(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var R4=typeof WeakMap=="function"?WeakMap:Map;function kb(t,e,n){n=Ai(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){gp||(gp=!0,Cv=r),mv(t,e)},n}function xb(t,e,n){n=Ai(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){mv(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){mv(t,e),typeof r!="function"&&(ys===null?ys=new Set([this]):ys.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function a1(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new R4;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=$4.bind(null,t,e,n),e.then(t,t))}function l1(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function u1(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Ai(-1,1),e.tag=2,_s(n,e,1))),n.lanes|=1),t)}var A4=Bi.ReactCurrentOwner,An=!1;function cn(t,e,n,r){e.child=t===null?ub(e,null,n,r):vl(e,t.child,n,r)}function c1(t,e,n,r,i){n=n.render;var s=e.ref;return nl(e,i),r=VE(t,e,n,r,s,i),n=FE(),t!==null&&!An?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Mi(t,e,i)):(je&&n&&CE(e),e.flags|=1,cn(t,e,r,i),e.child)}function h1(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!KE(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,Nb(t,e,s,r,i)):(t=bf(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:zc,n(o,r)&&t.ref===e.ref)return Mi(t,e,i)}return e.flags|=1,t=ws(s,r),t.ref=e.ref,t.return=e,e.child=t}function Nb(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(zc(s,r)&&t.ref===e.ref)if(An=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(An=!0);else return e.lanes=t.lanes,Mi(t,e,i)}return gv(t,e,n,r,i)}function Db(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},De(Ka,Bn),Bn|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,De(Ka,Bn),Bn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,De(Ka,Bn),Bn|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,De(Ka,Bn),Bn|=r;return cn(t,e,i,n),e.child}function Ob(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function gv(t,e,n,r,i){var s=On(n)?Bo:sn.current;return s=_l(e,s),nl(e,i),n=VE(t,e,n,r,s,i),r=FE(),t!==null&&!An?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Mi(t,e,i)):(je&&r&&CE(e),e.flags|=1,cn(t,e,n,i),e.child)}function d1(t,e,n,r,i){if(On(n)){var s=!0;op(e)}else s=!1;if(nl(e,i),e.stateNode===null)Rf(t,e),ab(e,n,r),pv(e,n,r,i),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=fr(u):(u=On(n)?Bo:sn.current,u=_l(e,u));var c=n.getDerivedStateFromProps,h=typeof c=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==u)&&r1(e,o,r,u),ns=!1;var f=e.memoizedState;o.state=f,hp(e,r,o,i),l=e.memoizedState,a!==r||f!==l||Dn.current||ns?(typeof c=="function"&&(fv(e,n,c,r),l=e.memoizedState),(a=ns||n1(e,n,a,r,f,l,u))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=u,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,sb(t,e),a=e.memoizedProps,u=e.type===e.elementType?a:Ir(e.type,a),o.props=u,h=e.pendingProps,f=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=fr(l):(l=On(n)?Bo:sn.current,l=_l(e,l));var g=n.getDerivedStateFromProps;(c=typeof g=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==h||f!==l)&&r1(e,o,r,l),ns=!1,f=e.memoizedState,o.state=f,hp(e,r,o,i);var _=e.memoizedState;a!==h||f!==_||Dn.current||ns?(typeof g=="function"&&(fv(e,n,g,r),_=e.memoizedState),(u=ns||n1(e,n,u,r,f,_,l)||!1)?(c||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,_,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,_,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=_),o.props=r,o.state=_,o.context=l,r=u):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),r=!1)}return _v(t,e,n,r,s,i)}function _v(t,e,n,r,i,s){Ob(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&XS(e,n,!1),Mi(t,e,s);r=e.stateNode,A4.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=vl(e,t.child,null,s),e.child=vl(e,null,a,s)):cn(t,e,a,s),e.memoizedState=r.state,i&&XS(e,n,!0),e.child}function Lb(t){var e=t.stateNode;e.pendingContext?YS(t,e.pendingContext,e.pendingContext!==e.context):e.context&&YS(t,e.context,!1),DE(t,e.containerInfo)}function f1(t,e,n,r,i){return yl(),AE(i),e.flags|=256,cn(t,e,n,r),e.child}var yv={dehydrated:null,treeContext:null,retryLane:0};function vv(t){return{baseLanes:t,cachePool:null,transitions:null}}function Mb(t,e,n){var r=e.pendingProps,i=Ke.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(i&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),De(Ke,i&1),t===null)return hv(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=Cm(o,r,0,null),t=No(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=vv(n),e.memoizedState=yv,t):BE(e,o));if(i=t.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return P4(t,e,o,r,a,i,n);if(s){s=r.fallback,o=e.mode,i=t.child,a=i.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=ws(i,l),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?s=ws(a,s):(s=No(s,o,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=t.child.memoizedState,o=o===null?vv(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=yv,r}return s=t.child,t=s.sibling,r=ws(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function BE(t,e){return e=Cm({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Qd(t,e,n,r){return r!==null&&AE(r),vl(e,t.child,null,n),t=BE(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function P4(t,e,n,r,i,s,o){if(n)return e.flags&256?(e.flags&=-257,r=B_(Error(L(422))),Qd(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=Cm({mode:"visible",children:r.children},i,0,null),s=No(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&vl(e,t.child,null,o),e.child.memoizedState=vv(o),e.memoizedState=yv,s);if(!(e.mode&1))return Qd(t,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,s=Error(L(419)),r=B_(s,r,void 0),Qd(t,e,o,r)}if(a=(o&t.childLanes)!==0,An||a){if(r=Nt,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Li(t,i),br(r,t,i,-1))}return GE(),r=B_(Error(L(421))),Qd(t,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=B4.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,qn=gs(i.nextSibling),Gn=e,je=!0,Sr=null,t!==null&&(nr[rr++]=Ei,nr[rr++]=Ii,nr[rr++]=zo,Ei=t.id,Ii=t.overflow,zo=e),e=BE(e,r.children),e.flags|=4096,e)}function p1(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),dv(t.return,e,n)}function z_(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function Vb(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(cn(t,e,r.children,n),r=Ke.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&p1(t,n,e);else if(t.tag===19)p1(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(De(Ke,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&dp(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),z_(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&dp(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}z_(e,!0,n,null,s);break;case"together":z_(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Rf(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Mi(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),qo|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(L(153));if(e.child!==null){for(t=e.child,n=ws(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=ws(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function b4(t,e,n){switch(e.tag){case 3:Lb(e),yl();break;case 5:cb(e);break;case 1:On(e.type)&&op(e);break;case 4:DE(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;De(up,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(De(Ke,Ke.current&1),e.flags|=128,null):n&e.child.childLanes?Mb(t,e,n):(De(Ke,Ke.current&1),t=Mi(t,e,n),t!==null?t.sibling:null);De(Ke,Ke.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return Vb(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),De(Ke,Ke.current),r)break;return null;case 22:case 23:return e.lanes=0,Db(t,e,n)}return Mi(t,e,n)}var Fb,wv,Ub,$b;Fb=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};wv=function(){};Ub=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,To(ei.current);var s=null;switch(n){case"input":i=zy(t,i),r=zy(t,r),s=[];break;case"select":i=Je({},i,{value:void 0}),r=Je({},r,{value:void 0}),s=[];break;case"textarea":i=Wy(t,i),r=Wy(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=ip)}Gy(n,r);var o;n=null;for(u in i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var a=i[u];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Lc.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in r){var l=r[u];if(a=i!=null?i[u]:void 0,r.hasOwnProperty(u)&&l!==a&&(l!=null||a!=null))if(u==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(s||(s=[]),s.push(u,n)),n=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Lc.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&Me("scroll",t),s||a===l||(s=[])):(s=s||[]).push(u,l))}n&&(s=s||[]).push("style",n);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};$b=function(t,e,n,r){n!==r&&(e.flags|=4)};function Nu(t,e){if(!je)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Yt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function k4(t,e,n){var r=e.pendingProps;switch(RE(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Yt(e),null;case 1:return On(e.type)&&sp(),Yt(e),null;case 3:return r=e.stateNode,wl(),$e(Dn),$e(sn),LE(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Gd(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Sr!==null&&(Pv(Sr),Sr=null))),wv(t,e),Yt(e),null;case 5:OE(e);var i=To(Gc.current);if(n=e.type,t!==null&&e.stateNode!=null)Ub(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(L(166));return Yt(e),null}if(t=To(ei.current),Gd(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[Br]=e,r[Wc]=s,t=(e.mode&1)!==0,n){case"dialog":Me("cancel",r),Me("close",r);break;case"iframe":case"object":case"embed":Me("load",r);break;case"video":case"audio":for(i=0;i<ec.length;i++)Me(ec[i],r);break;case"source":Me("error",r);break;case"img":case"image":case"link":Me("error",r),Me("load",r);break;case"details":Me("toggle",r);break;case"input":TS(r,s),Me("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Me("invalid",r);break;case"textarea":CS(r,s),Me("invalid",r)}Gy(n,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?r.textContent!==a&&(s.suppressHydrationWarning!==!0&&Hd(r.textContent,a,t),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&Hd(r.textContent,a,t),i=["children",""+a]):Lc.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Me("scroll",r)}switch(n){case"input":Fd(r),SS(r,s,!0);break;case"textarea":Fd(r),RS(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=ip)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=fP(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[Br]=e,t[Wc]=r,Fb(t,e,!1,!1),e.stateNode=t;e:{switch(o=Ky(n,r),n){case"dialog":Me("cancel",t),Me("close",t),i=r;break;case"iframe":case"object":case"embed":Me("load",t),i=r;break;case"video":case"audio":for(i=0;i<ec.length;i++)Me(ec[i],t);i=r;break;case"source":Me("error",t),i=r;break;case"img":case"image":case"link":Me("error",t),Me("load",t),i=r;break;case"details":Me("toggle",t),i=r;break;case"input":TS(t,r),i=zy(t,r),Me("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=Je({},r,{value:void 0}),Me("invalid",t);break;case"textarea":CS(t,r),i=Wy(t,r),Me("invalid",t);break;default:i=r}Gy(n,i),a=i;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?gP(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&pP(t,l)):s==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&Mc(t,l):typeof l=="number"&&Mc(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Lc.hasOwnProperty(s)?l!=null&&s==="onScroll"&&Me("scroll",t):l!=null&&hE(t,s,l,o))}switch(n){case"input":Fd(t),SS(t,r,!1);break;case"textarea":Fd(t),RS(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Ps(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?Ja(t,!!r.multiple,s,!1):r.defaultValue!=null&&Ja(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=ip)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Yt(e),null;case 6:if(t&&e.stateNode!=null)$b(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(L(166));if(n=To(Gc.current),To(ei.current),Gd(e)){if(r=e.stateNode,n=e.memoizedProps,r[Br]=e,(s=r.nodeValue!==n)&&(t=Gn,t!==null))switch(t.tag){case 3:Hd(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Hd(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Br]=e,e.stateNode=r}return Yt(e),null;case 13:if($e(Ke),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(je&&qn!==null&&e.mode&1&&!(e.flags&128))rb(),yl(),e.flags|=98560,s=!1;else if(s=Gd(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(L(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(L(317));s[Br]=e}else yl(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Yt(e),s=!1}else Sr!==null&&(Pv(Sr),Sr=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Ke.current&1?It===0&&(It=3):GE())),e.updateQueue!==null&&(e.flags|=4),Yt(e),null);case 4:return wl(),wv(t,e),t===null&&jc(e.stateNode.containerInfo),Yt(e),null;case 10:return kE(e.type._context),Yt(e),null;case 17:return On(e.type)&&sp(),Yt(e),null;case 19:if($e(Ke),s=e.memoizedState,s===null)return Yt(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)Nu(s,!1);else{if(It!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=dp(t),o!==null){for(e.flags|=128,Nu(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return De(Ke,Ke.current&1|2),e.child}t=t.sibling}s.tail!==null&&at()>Il&&(e.flags|=128,r=!0,Nu(s,!1),e.lanes=4194304)}else{if(!r)if(t=dp(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Nu(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!je)return Yt(e),null}else 2*at()-s.renderingStartTime>Il&&n!==1073741824&&(e.flags|=128,r=!0,Nu(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=at(),e.sibling=null,n=Ke.current,De(Ke,r?n&1|2:n&1),e):(Yt(e),null);case 22:case 23:return HE(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Bn&1073741824&&(Yt(e),e.subtreeFlags&6&&(e.flags|=8192)):Yt(e),null;case 24:return null;case 25:return null}throw Error(L(156,e.tag))}function x4(t,e){switch(RE(e),e.tag){case 1:return On(e.type)&&sp(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return wl(),$e(Dn),$e(sn),LE(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return OE(e),null;case 13:if($e(Ke),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(L(340));yl()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return $e(Ke),null;case 4:return wl(),null;case 10:return kE(e.type._context),null;case 22:case 23:return HE(),null;case 24:return null;default:return null}}var Yd=!1,Jt=!1,N4=typeof WeakSet=="function"?WeakSet:Set,H=null;function Ga(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){nt(t,e,r)}else n.current=null}function Ev(t,e,n){try{n()}catch(r){nt(t,e,r)}}var m1=!1;function D4(t,e){if(iv=tp,t=qP(),SE(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,u=0,c=0,h=t,f=null;t:for(;;){for(var g;h!==n||i!==0&&h.nodeType!==3||(a=o+i),h!==s||r!==0&&h.nodeType!==3||(l=o+r),h.nodeType===3&&(o+=h.nodeValue.length),(g=h.firstChild)!==null;)f=h,h=g;for(;;){if(h===t)break t;if(f===n&&++u===i&&(a=o),f===s&&++c===r&&(l=o),(g=h.nextSibling)!==null)break;h=f,f=h.parentNode}h=g}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(sv={focusedElem:t,selectionRange:n},tp=!1,H=e;H!==null;)if(e=H,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,H=t;else for(;H!==null;){e=H;try{var _=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(_!==null){var w=_.memoizedProps,T=_.memoizedState,v=e.stateNode,y=v.getSnapshotBeforeUpdate(e.elementType===e.type?w:Ir(e.type,w),T);v.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var I=e.stateNode.containerInfo;I.nodeType===1?I.textContent="":I.nodeType===9&&I.documentElement&&I.removeChild(I.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(L(163))}}catch(C){nt(e,e.return,C)}if(t=e.sibling,t!==null){t.return=e.return,H=t;break}H=e.return}return _=m1,m1=!1,_}function gc(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&Ev(e,n,s)}i=i.next}while(i!==r)}}function Tm(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Iv(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function Bb(t){var e=t.alternate;e!==null&&(t.alternate=null,Bb(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Br],delete e[Wc],delete e[lv],delete e[m4],delete e[g4])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function zb(t){return t.tag===5||t.tag===3||t.tag===4}function g1(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||zb(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Tv(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=ip));else if(r!==4&&(t=t.child,t!==null))for(Tv(t,e,n),t=t.sibling;t!==null;)Tv(t,e,n),t=t.sibling}function Sv(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Sv(t,e,n),t=t.sibling;t!==null;)Sv(t,e,n),t=t.sibling}var Bt=null,Tr=!1;function Ki(t,e,n){for(n=n.child;n!==null;)jb(t,e,n),n=n.sibling}function jb(t,e,n){if(Zr&&typeof Zr.onCommitFiberUnmount=="function")try{Zr.onCommitFiberUnmount(mm,n)}catch{}switch(n.tag){case 5:Jt||Ga(n,e);case 6:var r=Bt,i=Tr;Bt=null,Ki(t,e,n),Bt=r,Tr=i,Bt!==null&&(Tr?(t=Bt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Bt.removeChild(n.stateNode));break;case 18:Bt!==null&&(Tr?(t=Bt,n=n.stateNode,t.nodeType===8?L_(t.parentNode,n):t.nodeType===1&&L_(t,n),$c(t)):L_(Bt,n.stateNode));break;case 4:r=Bt,i=Tr,Bt=n.stateNode.containerInfo,Tr=!0,Ki(t,e,n),Bt=r,Tr=i;break;case 0:case 11:case 14:case 15:if(!Jt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&Ev(n,e,o),i=i.next}while(i!==r)}Ki(t,e,n);break;case 1:if(!Jt&&(Ga(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){nt(n,e,a)}Ki(t,e,n);break;case 21:Ki(t,e,n);break;case 22:n.mode&1?(Jt=(r=Jt)||n.memoizedState!==null,Ki(t,e,n),Jt=r):Ki(t,e,n);break;default:Ki(t,e,n)}}function _1(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new N4),e.forEach(function(r){var i=z4.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function wr(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:Bt=a.stateNode,Tr=!1;break e;case 3:Bt=a.stateNode.containerInfo,Tr=!0;break e;case 4:Bt=a.stateNode.containerInfo,Tr=!0;break e}a=a.return}if(Bt===null)throw Error(L(160));jb(s,o,i),Bt=null,Tr=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(u){nt(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)qb(e,t),e=e.sibling}function qb(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(wr(e,t),Vr(t),r&4){try{gc(3,t,t.return),Tm(3,t)}catch(w){nt(t,t.return,w)}try{gc(5,t,t.return)}catch(w){nt(t,t.return,w)}}break;case 1:wr(e,t),Vr(t),r&512&&n!==null&&Ga(n,n.return);break;case 5:if(wr(e,t),Vr(t),r&512&&n!==null&&Ga(n,n.return),t.flags&32){var i=t.stateNode;try{Mc(i,"")}catch(w){nt(t,t.return,w)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&hP(i,s),Ky(a,o);var u=Ky(a,s);for(o=0;o<l.length;o+=2){var c=l[o],h=l[o+1];c==="style"?gP(i,h):c==="dangerouslySetInnerHTML"?pP(i,h):c==="children"?Mc(i,h):hE(i,c,h,u)}switch(a){case"input":jy(i,s);break;case"textarea":dP(i,s);break;case"select":var f=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var g=s.value;g!=null?Ja(i,!!s.multiple,g,!1):f!==!!s.multiple&&(s.defaultValue!=null?Ja(i,!!s.multiple,s.defaultValue,!0):Ja(i,!!s.multiple,s.multiple?[]:"",!1))}i[Wc]=s}catch(w){nt(t,t.return,w)}}break;case 6:if(wr(e,t),Vr(t),r&4){if(t.stateNode===null)throw Error(L(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(w){nt(t,t.return,w)}}break;case 3:if(wr(e,t),Vr(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{$c(e.containerInfo)}catch(w){nt(t,t.return,w)}break;case 4:wr(e,t),Vr(t);break;case 13:wr(e,t),Vr(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(qE=at())),r&4&&_1(t);break;case 22:if(c=n!==null&&n.memoizedState!==null,t.mode&1?(Jt=(u=Jt)||c,wr(e,t),Jt=u):wr(e,t),Vr(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!c&&t.mode&1)for(H=t,c=t.child;c!==null;){for(h=H=c;H!==null;){switch(f=H,g=f.child,f.tag){case 0:case 11:case 14:case 15:gc(4,f,f.return);break;case 1:Ga(f,f.return);var _=f.stateNode;if(typeof _.componentWillUnmount=="function"){r=f,n=f.return;try{e=r,_.props=e.memoizedProps,_.state=e.memoizedState,_.componentWillUnmount()}catch(w){nt(r,n,w)}}break;case 5:Ga(f,f.return);break;case 22:if(f.memoizedState!==null){v1(h);continue}}g!==null?(g.return=f,H=g):v1(h)}c=c.sibling}e:for(c=null,h=t;;){if(h.tag===5){if(c===null){c=h;try{i=h.stateNode,u?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=h.stateNode,l=h.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=mP("display",o))}catch(w){nt(t,t.return,w)}}}else if(h.tag===6){if(c===null)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(w){nt(t,t.return,w)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;c===h&&(c=null),h=h.return}c===h&&(c=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:wr(e,t),Vr(t),r&4&&_1(t);break;case 21:break;default:wr(e,t),Vr(t)}}function Vr(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(zb(n)){var r=n;break e}n=n.return}throw Error(L(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(Mc(i,""),r.flags&=-33);var s=g1(t);Sv(t,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,a=g1(t);Tv(t,a,o);break;default:throw Error(L(161))}}catch(l){nt(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function O4(t,e,n){H=t,Wb(t)}function Wb(t,e,n){for(var r=(t.mode&1)!==0;H!==null;){var i=H,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||Yd;if(!o){var a=i.alternate,l=a!==null&&a.memoizedState!==null||Jt;a=Yd;var u=Jt;if(Yd=o,(Jt=l)&&!u)for(H=i;H!==null;)o=H,l=o.child,o.tag===22&&o.memoizedState!==null?w1(i):l!==null?(l.return=o,H=l):w1(i);for(;s!==null;)H=s,Wb(s),s=s.sibling;H=i,Yd=a,Jt=u}y1(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,H=s):y1(t)}}function y1(t){for(;H!==null;){var e=H;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Jt||Tm(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Jt)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:Ir(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&t1(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}t1(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var c=u.memoizedState;if(c!==null){var h=c.dehydrated;h!==null&&$c(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(L(163))}Jt||e.flags&512&&Iv(e)}catch(f){nt(e,e.return,f)}}if(e===t){H=null;break}if(n=e.sibling,n!==null){n.return=e.return,H=n;break}H=e.return}}function v1(t){for(;H!==null;){var e=H;if(e===t){H=null;break}var n=e.sibling;if(n!==null){n.return=e.return,H=n;break}H=e.return}}function w1(t){for(;H!==null;){var e=H;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Tm(4,e)}catch(l){nt(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(l){nt(e,i,l)}}var s=e.return;try{Iv(e)}catch(l){nt(e,s,l)}break;case 5:var o=e.return;try{Iv(e)}catch(l){nt(e,o,l)}}}catch(l){nt(e,e.return,l)}if(e===t){H=null;break}var a=e.sibling;if(a!==null){a.return=e.return,H=a;break}H=e.return}}var L4=Math.ceil,mp=Bi.ReactCurrentDispatcher,zE=Bi.ReactCurrentOwner,hr=Bi.ReactCurrentBatchConfig,ye=0,Nt=null,_t=null,qt=0,Bn=0,Ka=Ks(0),It=0,Xc=null,qo=0,Sm=0,jE=0,_c=null,Cn=null,qE=0,Il=1/0,_i=null,gp=!1,Cv=null,ys=null,Xd=!1,ls=null,_p=0,yc=0,Rv=null,Af=-1,Pf=0;function mn(){return ye&6?at():Af!==-1?Af:Af=at()}function vs(t){return t.mode&1?ye&2&&qt!==0?qt&-qt:y4.transition!==null?(Pf===0&&(Pf=PP()),Pf):(t=Ae,t!==0||(t=window.event,t=t===void 0?16:LP(t.type)),t):1}function br(t,e,n,r){if(50<yc)throw yc=0,Rv=null,Error(L(185));Bh(t,n,r),(!(ye&2)||t!==Nt)&&(t===Nt&&(!(ye&2)&&(Sm|=n),It===4&&is(t,qt)),Ln(t,r),n===1&&ye===0&&!(e.mode&1)&&(Il=at()+500,wm&&Qs()))}function Ln(t,e){var n=t.callbackNode;yU(t,e);var r=ep(t,t===Nt?qt:0);if(r===0)n!==null&&bS(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&bS(n),e===1)t.tag===0?_4(E1.bind(null,t)):eb(E1.bind(null,t)),f4(function(){!(ye&6)&&Qs()}),n=null;else{switch(bP(r)){case 1:n=gE;break;case 4:n=RP;break;case 16:n=Zf;break;case 536870912:n=AP;break;default:n=Zf}n=Zb(n,Hb.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function Hb(t,e){if(Af=-1,Pf=0,ye&6)throw Error(L(327));var n=t.callbackNode;if(rl()&&t.callbackNode!==n)return null;var r=ep(t,t===Nt?qt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=yp(t,r);else{e=r;var i=ye;ye|=2;var s=Kb();(Nt!==t||qt!==e)&&(_i=null,Il=at()+500,xo(t,e));do try{F4();break}catch(a){Gb(t,a)}while(1);bE(),mp.current=s,ye=i,_t!==null?e=0:(Nt=null,qt=0,e=It)}if(e!==0){if(e===2&&(i=Zy(t),i!==0&&(r=i,e=Av(t,i))),e===1)throw n=Xc,xo(t,0),is(t,r),Ln(t,at()),n;if(e===6)is(t,r);else{if(i=t.current.alternate,!(r&30)&&!M4(i)&&(e=yp(t,r),e===2&&(s=Zy(t),s!==0&&(r=s,e=Av(t,s))),e===1))throw n=Xc,xo(t,0),is(t,r),Ln(t,at()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(L(345));case 2:ho(t,Cn,_i);break;case 3:if(is(t,r),(r&130023424)===r&&(e=qE+500-at(),10<e)){if(ep(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){mn(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=av(ho.bind(null,t,Cn,_i),e);break}ho(t,Cn,_i);break;case 4:if(is(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var o=31-Pr(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=at()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*L4(r/1960))-r,10<r){t.timeoutHandle=av(ho.bind(null,t,Cn,_i),r);break}ho(t,Cn,_i);break;case 5:ho(t,Cn,_i);break;default:throw Error(L(329))}}}return Ln(t,at()),t.callbackNode===n?Hb.bind(null,t):null}function Av(t,e){var n=_c;return t.current.memoizedState.isDehydrated&&(xo(t,e).flags|=256),t=yp(t,e),t!==2&&(e=Cn,Cn=n,e!==null&&Pv(e)),t}function Pv(t){Cn===null?Cn=t:Cn.push.apply(Cn,t)}function M4(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!Nr(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function is(t,e){for(e&=~jE,e&=~Sm,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Pr(e),r=1<<n;t[n]=-1,e&=~r}}function E1(t){if(ye&6)throw Error(L(327));rl();var e=ep(t,0);if(!(e&1))return Ln(t,at()),null;var n=yp(t,e);if(t.tag!==0&&n===2){var r=Zy(t);r!==0&&(e=r,n=Av(t,r))}if(n===1)throw n=Xc,xo(t,0),is(t,e),Ln(t,at()),n;if(n===6)throw Error(L(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,ho(t,Cn,_i),Ln(t,at()),null}function WE(t,e){var n=ye;ye|=1;try{return t(e)}finally{ye=n,ye===0&&(Il=at()+500,wm&&Qs())}}function Wo(t){ls!==null&&ls.tag===0&&!(ye&6)&&rl();var e=ye;ye|=1;var n=hr.transition,r=Ae;try{if(hr.transition=null,Ae=1,t)return t()}finally{Ae=r,hr.transition=n,ye=e,!(ye&6)&&Qs()}}function HE(){Bn=Ka.current,$e(Ka)}function xo(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,d4(n)),_t!==null)for(n=_t.return;n!==null;){var r=n;switch(RE(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&sp();break;case 3:wl(),$e(Dn),$e(sn),LE();break;case 5:OE(r);break;case 4:wl();break;case 13:$e(Ke);break;case 19:$e(Ke);break;case 10:kE(r.type._context);break;case 22:case 23:HE()}n=n.return}if(Nt=t,_t=t=ws(t.current,null),qt=Bn=e,It=0,Xc=null,jE=Sm=qo=0,Cn=_c=null,Io!==null){for(e=0;e<Io.length;e++)if(n=Io[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}n.pending=r}Io=null}return t}function Gb(t,e){do{var n=_t;try{if(bE(),Sf.current=pp,fp){for(var r=Ye.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}fp=!1}if(jo=0,Rt=wt=Ye=null,mc=!1,Kc=0,zE.current=null,n===null||n.return===null){It=1,Xc=e,_t=null;break}e:{var s=t,o=n.return,a=n,l=e;if(e=qt,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,c=a,h=c.tag;if(!(c.mode&1)&&(h===0||h===11||h===15)){var f=c.alternate;f?(c.updateQueue=f.updateQueue,c.memoizedState=f.memoizedState,c.lanes=f.lanes):(c.updateQueue=null,c.memoizedState=null)}var g=l1(o);if(g!==null){g.flags&=-257,u1(g,o,a,s,e),g.mode&1&&a1(s,u,e),e=g,l=u;var _=e.updateQueue;if(_===null){var w=new Set;w.add(l),e.updateQueue=w}else _.add(l);break e}else{if(!(e&1)){a1(s,u,e),GE();break e}l=Error(L(426))}}else if(je&&a.mode&1){var T=l1(o);if(T!==null){!(T.flags&65536)&&(T.flags|=256),u1(T,o,a,s,e),AE(El(l,a));break e}}s=l=El(l,a),It!==4&&(It=2),_c===null?_c=[s]:_c.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var v=kb(s,l,e);e1(s,v);break e;case 1:a=l;var y=s.type,I=s.stateNode;if(!(s.flags&128)&&(typeof y.getDerivedStateFromError=="function"||I!==null&&typeof I.componentDidCatch=="function"&&(ys===null||!ys.has(I)))){s.flags|=65536,e&=-e,s.lanes|=e;var C=xb(s,a,e);e1(s,C);break e}}s=s.return}while(s!==null)}Yb(n)}catch(P){e=P,_t===n&&n!==null&&(_t=n=n.return);continue}break}while(1)}function Kb(){var t=mp.current;return mp.current=pp,t===null?pp:t}function GE(){(It===0||It===3||It===2)&&(It=4),Nt===null||!(qo&268435455)&&!(Sm&268435455)||is(Nt,qt)}function yp(t,e){var n=ye;ye|=2;var r=Kb();(Nt!==t||qt!==e)&&(_i=null,xo(t,e));do try{V4();break}catch(i){Gb(t,i)}while(1);if(bE(),ye=n,mp.current=r,_t!==null)throw Error(L(261));return Nt=null,qt=0,It}function V4(){for(;_t!==null;)Qb(_t)}function F4(){for(;_t!==null&&!uU();)Qb(_t)}function Qb(t){var e=Jb(t.alternate,t,Bn);t.memoizedProps=t.pendingProps,e===null?Yb(t):_t=e,zE.current=null}function Yb(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=x4(n,e),n!==null){n.flags&=32767,_t=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{It=6,_t=null;return}}else if(n=k4(n,e,Bn),n!==null){_t=n;return}if(e=e.sibling,e!==null){_t=e;return}_t=e=t}while(e!==null);It===0&&(It=5)}function ho(t,e,n){var r=Ae,i=hr.transition;try{hr.transition=null,Ae=1,U4(t,e,n,r)}finally{hr.transition=i,Ae=r}return null}function U4(t,e,n,r){do rl();while(ls!==null);if(ye&6)throw Error(L(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(L(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(vU(t,s),t===Nt&&(_t=Nt=null,qt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Xd||(Xd=!0,Zb(Zf,function(){return rl(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=hr.transition,hr.transition=null;var o=Ae;Ae=1;var a=ye;ye|=4,zE.current=null,D4(t,n),qb(n,t),s4(sv),tp=!!iv,sv=iv=null,t.current=n,O4(n),cU(),ye=a,Ae=o,hr.transition=s}else t.current=n;if(Xd&&(Xd=!1,ls=t,_p=i),s=t.pendingLanes,s===0&&(ys=null),fU(n.stateNode),Ln(t,at()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(gp)throw gp=!1,t=Cv,Cv=null,t;return _p&1&&t.tag!==0&&rl(),s=t.pendingLanes,s&1?t===Rv?yc++:(yc=0,Rv=t):yc=0,Qs(),null}function rl(){if(ls!==null){var t=bP(_p),e=hr.transition,n=Ae;try{if(hr.transition=null,Ae=16>t?16:t,ls===null)var r=!1;else{if(t=ls,ls=null,_p=0,ye&6)throw Error(L(331));var i=ye;for(ye|=4,H=t.current;H!==null;){var s=H,o=s.child;if(H.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var u=a[l];for(H=u;H!==null;){var c=H;switch(c.tag){case 0:case 11:case 15:gc(8,c,s)}var h=c.child;if(h!==null)h.return=c,H=h;else for(;H!==null;){c=H;var f=c.sibling,g=c.return;if(Bb(c),c===u){H=null;break}if(f!==null){f.return=g,H=f;break}H=g}}}var _=s.alternate;if(_!==null){var w=_.child;if(w!==null){_.child=null;do{var T=w.sibling;w.sibling=null,w=T}while(w!==null)}}H=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,H=o;else e:for(;H!==null;){if(s=H,s.flags&2048)switch(s.tag){case 0:case 11:case 15:gc(9,s,s.return)}var v=s.sibling;if(v!==null){v.return=s.return,H=v;break e}H=s.return}}var y=t.current;for(H=y;H!==null;){o=H;var I=o.child;if(o.subtreeFlags&2064&&I!==null)I.return=o,H=I;else e:for(o=y;H!==null;){if(a=H,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Tm(9,a)}}catch(P){nt(a,a.return,P)}if(a===o){H=null;break e}var C=a.sibling;if(C!==null){C.return=a.return,H=C;break e}H=a.return}}if(ye=i,Qs(),Zr&&typeof Zr.onPostCommitFiberRoot=="function")try{Zr.onPostCommitFiberRoot(mm,t)}catch{}r=!0}return r}finally{Ae=n,hr.transition=e}}return!1}function I1(t,e,n){e=El(n,e),e=kb(t,e,1),t=_s(t,e,1),e=mn(),t!==null&&(Bh(t,1,e),Ln(t,e))}function nt(t,e,n){if(t.tag===3)I1(t,t,n);else for(;e!==null;){if(e.tag===3){I1(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(ys===null||!ys.has(r))){t=El(n,t),t=xb(e,t,1),e=_s(e,t,1),t=mn(),e!==null&&(Bh(e,1,t),Ln(e,t));break}}e=e.return}}function $4(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=mn(),t.pingedLanes|=t.suspendedLanes&n,Nt===t&&(qt&n)===n&&(It===4||It===3&&(qt&130023424)===qt&&500>at()-qE?xo(t,0):jE|=n),Ln(t,e)}function Xb(t,e){e===0&&(t.mode&1?(e=Bd,Bd<<=1,!(Bd&130023424)&&(Bd=4194304)):e=1);var n=mn();t=Li(t,e),t!==null&&(Bh(t,e,n),Ln(t,n))}function B4(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),Xb(t,n)}function z4(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(L(314))}r!==null&&r.delete(e),Xb(t,n)}var Jb;Jb=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Dn.current)An=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return An=!1,b4(t,e,n);An=!!(t.flags&131072)}else An=!1,je&&e.flags&1048576&&tb(e,lp,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Rf(t,e),t=e.pendingProps;var i=_l(e,sn.current);nl(e,n),i=VE(null,e,r,t,i,n);var s=FE();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,On(r)?(s=!0,op(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,NE(e),i.updater=Em,e.stateNode=i,i._reactInternals=e,pv(e,r,t,n),e=_v(null,e,r,!0,s,n)):(e.tag=0,je&&s&&CE(e),cn(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Rf(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=q4(r),t=Ir(r,t),i){case 0:e=gv(null,e,r,t,n);break e;case 1:e=d1(null,e,r,t,n);break e;case 11:e=c1(null,e,r,t,n);break e;case 14:e=h1(null,e,r,Ir(r.type,t),n);break e}throw Error(L(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Ir(r,i),gv(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Ir(r,i),d1(t,e,r,i,n);case 3:e:{if(Lb(e),t===null)throw Error(L(387));r=e.pendingProps,s=e.memoizedState,i=s.element,sb(t,e),hp(e,r,null,n);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=El(Error(L(423)),e),e=f1(t,e,r,n,i);break e}else if(r!==i){i=El(Error(L(424)),e),e=f1(t,e,r,n,i);break e}else for(qn=gs(e.stateNode.containerInfo.firstChild),Gn=e,je=!0,Sr=null,n=ub(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(yl(),r===i){e=Mi(t,e,n);break e}cn(t,e,r,n)}e=e.child}return e;case 5:return cb(e),t===null&&hv(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,ov(r,i)?o=null:s!==null&&ov(r,s)&&(e.flags|=32),Ob(t,e),cn(t,e,o,n),e.child;case 6:return t===null&&hv(e),null;case 13:return Mb(t,e,n);case 4:return DE(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=vl(e,null,r,n):cn(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Ir(r,i),c1(t,e,r,i,n);case 7:return cn(t,e,e.pendingProps,n),e.child;case 8:return cn(t,e,e.pendingProps.children,n),e.child;case 12:return cn(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,De(up,r._currentValue),r._currentValue=o,s!==null)if(Nr(s.value,o)){if(s.children===i.children&&!Dn.current){e=Mi(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(s.tag===1){l=Ai(-1,n&-n),l.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var c=u.pending;c===null?l.next=l:(l.next=c.next,c.next=l),u.pending=l}}s.lanes|=n,l=s.alternate,l!==null&&(l.lanes|=n),dv(s.return,n,e),a.lanes|=n;break}l=l.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(L(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),dv(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}cn(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,nl(e,n),i=fr(i),r=r(i),e.flags|=1,cn(t,e,r,n),e.child;case 14:return r=e.type,i=Ir(r,e.pendingProps),i=Ir(r.type,i),h1(t,e,r,i,n);case 15:return Nb(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Ir(r,i),Rf(t,e),e.tag=1,On(r)?(t=!0,op(e)):t=!1,nl(e,n),ab(e,r,i),pv(e,r,i,n),_v(null,e,r,!0,t,n);case 19:return Vb(t,e,n);case 22:return Db(t,e,n)}throw Error(L(156,e.tag))};function Zb(t,e){return CP(t,e)}function j4(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function or(t,e,n,r){return new j4(t,e,n,r)}function KE(t){return t=t.prototype,!(!t||!t.isReactComponent)}function q4(t){if(typeof t=="function")return KE(t)?1:0;if(t!=null){if(t=t.$$typeof,t===fE)return 11;if(t===pE)return 14}return 2}function ws(t,e){var n=t.alternate;return n===null?(n=or(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function bf(t,e,n,r,i,s){var o=2;if(r=t,typeof t=="function")KE(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Fa:return No(n.children,i,s,e);case dE:o=8,i|=8;break;case Fy:return t=or(12,n,e,i|2),t.elementType=Fy,t.lanes=s,t;case Uy:return t=or(13,n,e,i),t.elementType=Uy,t.lanes=s,t;case $y:return t=or(19,n,e,i),t.elementType=$y,t.lanes=s,t;case lP:return Cm(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case oP:o=10;break e;case aP:o=9;break e;case fE:o=11;break e;case pE:o=14;break e;case ts:o=16,r=null;break e}throw Error(L(130,t==null?t:typeof t,""))}return e=or(o,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function No(t,e,n,r){return t=or(7,t,r,e),t.lanes=n,t}function Cm(t,e,n,r){return t=or(22,t,r,e),t.elementType=lP,t.lanes=n,t.stateNode={isHidden:!1},t}function j_(t,e,n){return t=or(6,t,null,e),t.lanes=n,t}function q_(t,e,n){return e=or(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function W4(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=S_(0),this.expirationTimes=S_(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=S_(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function QE(t,e,n,r,i,s,o,a,l){return t=new W4(t,e,n,a,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=or(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},NE(s),t}function H4(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Va,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function ek(t){if(!t)return bs;t=t._reactInternals;e:{if(ca(t)!==t||t.tag!==1)throw Error(L(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(On(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(L(171))}if(t.tag===1){var n=t.type;if(On(n))return ZP(t,n,e)}return e}function tk(t,e,n,r,i,s,o,a,l){return t=QE(n,r,!0,t,i,s,o,a,l),t.context=ek(null),n=t.current,r=mn(),i=vs(n),s=Ai(r,i),s.callback=e??null,_s(n,s,i),t.current.lanes=i,Bh(t,i,r),Ln(t,r),t}function Rm(t,e,n,r){var i=e.current,s=mn(),o=vs(i);return n=ek(n),e.context===null?e.context=n:e.pendingContext=n,e=Ai(s,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=_s(i,e,o),t!==null&&(br(t,i,o,s),Tf(t,i,o)),o}function vp(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function T1(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function YE(t,e){T1(t,e),(t=t.alternate)&&T1(t,e)}function G4(){return null}var nk=typeof reportError=="function"?reportError:function(t){console.error(t)};function XE(t){this._internalRoot=t}Am.prototype.render=XE.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(L(409));Rm(t,e,null,null)};Am.prototype.unmount=XE.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Wo(function(){Rm(null,t,null,null)}),e[Oi]=null}};function Am(t){this._internalRoot=t}Am.prototype.unstable_scheduleHydration=function(t){if(t){var e=NP();t={blockedOn:null,target:t,priority:e};for(var n=0;n<rs.length&&e!==0&&e<rs[n].priority;n++);rs.splice(n,0,t),n===0&&OP(t)}};function JE(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Pm(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function S1(){}function K4(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var u=vp(o);s.call(u)}}var o=tk(e,r,t,0,null,!1,!1,"",S1);return t._reactRootContainer=o,t[Oi]=o.current,jc(t.nodeType===8?t.parentNode:t),Wo(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var u=vp(l);a.call(u)}}var l=QE(t,0,!1,null,null,!1,!1,"",S1);return t._reactRootContainer=l,t[Oi]=l.current,jc(t.nodeType===8?t.parentNode:t),Wo(function(){Rm(e,l,n,r)}),l}function bm(t,e,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var a=i;i=function(){var l=vp(o);a.call(l)}}Rm(e,o,t,i)}else o=K4(n,e,t,i,r);return vp(o)}kP=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Zu(e.pendingLanes);n!==0&&(_E(e,n|1),Ln(e,at()),!(ye&6)&&(Il=at()+500,Qs()))}break;case 13:Wo(function(){var r=Li(t,1);if(r!==null){var i=mn();br(r,t,1,i)}}),YE(t,1)}};yE=function(t){if(t.tag===13){var e=Li(t,134217728);if(e!==null){var n=mn();br(e,t,134217728,n)}YE(t,134217728)}};xP=function(t){if(t.tag===13){var e=vs(t),n=Li(t,e);if(n!==null){var r=mn();br(n,t,e,r)}YE(t,e)}};NP=function(){return Ae};DP=function(t,e){var n=Ae;try{return Ae=t,e()}finally{Ae=n}};Yy=function(t,e,n){switch(e){case"input":if(jy(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=vm(r);if(!i)throw Error(L(90));cP(r),jy(r,i)}}}break;case"textarea":dP(t,n);break;case"select":e=n.value,e!=null&&Ja(t,!!n.multiple,e,!1)}};vP=WE;wP=Wo;var Q4={usingClientEntryPoint:!1,Events:[jh,za,vm,_P,yP,WE]},Du={findFiberByHostInstance:Eo,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},Y4={bundleType:Du.bundleType,version:Du.version,rendererPackageName:Du.rendererPackageName,rendererConfig:Du.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Bi.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=TP(t),t===null?null:t.stateNode},findFiberByHostInstance:Du.findFiberByHostInstance||G4,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Jd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Jd.isDisabled&&Jd.supportsFiber)try{mm=Jd.inject(Y4),Zr=Jd}catch{}}Zn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Q4;Zn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!JE(e))throw Error(L(200));return H4(t,e,null,n)};Zn.createRoot=function(t,e){if(!JE(t))throw Error(L(299));var n=!1,r="",i=nk;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=QE(t,1,!1,null,null,n,!1,r,i),t[Oi]=e.current,jc(t.nodeType===8?t.parentNode:t),new XE(e)};Zn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(L(188)):(t=Object.keys(t).join(","),Error(L(268,t)));return t=TP(e),t=t===null?null:t.stateNode,t};Zn.flushSync=function(t){return Wo(t)};Zn.hydrate=function(t,e,n){if(!Pm(e))throw Error(L(200));return bm(null,t,e,!0,n)};Zn.hydrateRoot=function(t,e,n){if(!JE(t))throw Error(L(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",o=nk;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=tk(e,null,t,1,n??null,i,!1,s,o),t[Oi]=e.current,jc(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new Am(e)};Zn.render=function(t,e,n){if(!Pm(e))throw Error(L(200));return bm(null,t,e,!1,n)};Zn.unmountComponentAtNode=function(t){if(!Pm(t))throw Error(L(40));return t._reactRootContainer?(Wo(function(){bm(null,null,t,!1,function(){t._reactRootContainer=null,t[Oi]=null})}),!0):!1};Zn.unstable_batchedUpdates=WE;Zn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Pm(n))throw Error(L(200));if(t==null||t._reactInternals===void 0)throw Error(L(38));return bm(t,e,n,!1,r)};Zn.version="18.2.0-next-9e3b772b8-20220608";function rk(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(rk)}catch(t){console.error(t)}}rk(),tP.exports=Zn;var X4=tP.exports,C1=X4;My.createRoot=C1.createRoot,My.hydrateRoot=C1.hydrateRoot;var Pn=function(){return Pn=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},Pn.apply(this,arguments)};function ZE(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}function wp(t,e,n){if(n||arguments.length===2)for(var r=0,i=e.length,s;r<i;r++)(s||!(r in e))&&(s||(s=Array.prototype.slice.call(e,0,r)),s[r]=e[r]);return t.concat(s||Array.prototype.slice.call(e))}var Ve="-ms-",vc="-moz-",Te="-webkit-",ik="comm",km="rule",e0="decl",J4="@import",sk="@keyframes",Z4="@layer",e$=Math.abs,t0=String.fromCharCode,bv=Object.assign;function t$(t,e){return At(t,0)^45?(((e<<2^At(t,0))<<2^At(t,1))<<2^At(t,2))<<2^At(t,3):0}function ok(t){return t.trim()}function yi(t,e){return(t=e.exec(t))?t[0]:t}function le(t,e,n){return t.replace(e,n)}function kf(t,e){return t.indexOf(e)}function At(t,e){return t.charCodeAt(e)|0}function Tl(t,e,n){return t.slice(e,n)}function $r(t){return t.length}function ak(t){return t.length}function tc(t,e){return e.push(t),t}function n$(t,e){return t.map(e).join("")}function R1(t,e){return t.filter(function(n){return!yi(n,e)})}var xm=1,Sl=1,lk=0,mr=0,mt=0,Jl="";function Nm(t,e,n,r,i,s,o,a){return{value:t,root:e,parent:n,type:r,props:i,children:s,line:xm,column:Sl,length:o,return:"",siblings:a}}function es(t,e){return bv(Nm("",null,null,"",null,null,0,t.siblings),t,{length:-t.length},e)}function Aa(t){for(;t.root;)t=es(t.root,{children:[t]});tc(t,t.siblings)}function r$(){return mt}function i$(){return mt=mr>0?At(Jl,--mr):0,Sl--,mt===10&&(Sl=1,xm--),mt}function kr(){return mt=mr<lk?At(Jl,mr++):0,Sl++,mt===10&&(Sl=1,xm++),mt}function Do(){return At(Jl,mr)}function xf(){return mr}function Dm(t,e){return Tl(Jl,t,e)}function kv(t){switch(t){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function s$(t){return xm=Sl=1,lk=$r(Jl=t),mr=0,[]}function o$(t){return Jl="",t}function W_(t){return ok(Dm(mr-1,xv(t===91?t+2:t===40?t+1:t)))}function a$(t){for(;(mt=Do())&&mt<33;)kr();return kv(t)>2||kv(mt)>3?"":" "}function l$(t,e){for(;--e&&kr()&&!(mt<48||mt>102||mt>57&&mt<65||mt>70&&mt<97););return Dm(t,xf()+(e<6&&Do()==32&&kr()==32))}function xv(t){for(;kr();)switch(mt){case t:return mr;case 34:case 39:t!==34&&t!==39&&xv(mt);break;case 40:t===41&&xv(t);break;case 92:kr();break}return mr}function u$(t,e){for(;kr()&&t+mt!==47+10;)if(t+mt===42+42&&Do()===47)break;return"/*"+Dm(e,mr-1)+"*"+t0(t===47?t:kr())}function c$(t){for(;!kv(Do());)kr();return Dm(t,mr)}function h$(t){return o$(Nf("",null,null,null,[""],t=s$(t),0,[0],t))}function Nf(t,e,n,r,i,s,o,a,l){for(var u=0,c=0,h=o,f=0,g=0,_=0,w=1,T=1,v=1,y=0,I="",C=i,P=s,b=r,k=I;T;)switch(_=y,y=kr()){case 40:if(_!=108&&At(k,h-1)==58){kf(k+=le(W_(y),"&","&\f"),"&\f")!=-1&&(v=-1);break}case 34:case 39:case 91:k+=W_(y);break;case 9:case 10:case 13:case 32:k+=a$(_);break;case 92:k+=l$(xf()-1,7);continue;case 47:switch(Do()){case 42:case 47:tc(d$(u$(kr(),xf()),e,n,l),l);break;default:k+="/"}break;case 123*w:a[u++]=$r(k)*v;case 125*w:case 59:case 0:switch(y){case 0:case 125:T=0;case 59+c:v==-1&&(k=le(k,/\f/g,"")),g>0&&$r(k)-h&&tc(g>32?P1(k+";",r,n,h-1,l):P1(le(k," ","")+";",r,n,h-2,l),l);break;case 59:k+=";";default:if(tc(b=A1(k,e,n,u,c,i,a,I,C=[],P=[],h,s),s),y===123)if(c===0)Nf(k,e,b,b,C,s,h,a,P);else switch(f===99&&At(k,3)===110?100:f){case 100:case 108:case 109:case 115:Nf(t,b,b,r&&tc(A1(t,b,b,0,0,i,a,I,i,C=[],h,P),P),i,P,h,a,r?C:P);break;default:Nf(k,b,b,b,[""],P,0,a,P)}}u=c=g=0,w=v=1,I=k="",h=o;break;case 58:h=1+$r(k),g=_;default:if(w<1){if(y==123)--w;else if(y==125&&w++==0&&i$()==125)continue}switch(k+=t0(y),y*w){case 38:v=c>0?1:(k+="\f",-1);break;case 44:a[u++]=($r(k)-1)*v,v=1;break;case 64:Do()===45&&(k+=W_(kr())),f=Do(),c=h=$r(I=k+=c$(xf())),y++;break;case 45:_===45&&$r(k)==2&&(w=0)}}return s}function A1(t,e,n,r,i,s,o,a,l,u,c,h){for(var f=i-1,g=i===0?s:[""],_=ak(g),w=0,T=0,v=0;w<r;++w)for(var y=0,I=Tl(t,f+1,f=e$(T=o[w])),C=t;y<_;++y)(C=ok(T>0?g[y]+" "+I:le(I,/&\f/g,g[y])))&&(l[v++]=C);return Nm(t,e,n,i===0?km:a,l,u,c,h)}function d$(t,e,n,r){return Nm(t,e,n,ik,t0(r$()),Tl(t,2,-2),0,r)}function P1(t,e,n,r,i){return Nm(t,e,n,e0,Tl(t,0,r),Tl(t,r+1,-1),r,i)}function uk(t,e,n){switch(t$(t,e)){case 5103:return Te+"print-"+t+t;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Te+t+t;case 4789:return vc+t+t;case 5349:case 4246:case 4810:case 6968:case 2756:return Te+t+vc+t+Ve+t+t;case 5936:switch(At(t,e+11)){case 114:return Te+t+Ve+le(t,/[svh]\w+-[tblr]{2}/,"tb")+t;case 108:return Te+t+Ve+le(t,/[svh]\w+-[tblr]{2}/,"tb-rl")+t;case 45:return Te+t+Ve+le(t,/[svh]\w+-[tblr]{2}/,"lr")+t}case 6828:case 4268:case 2903:return Te+t+Ve+t+t;case 6165:return Te+t+Ve+"flex-"+t+t;case 5187:return Te+t+le(t,/(\w+).+(:[^]+)/,Te+"box-$1$2"+Ve+"flex-$1$2")+t;case 5443:return Te+t+Ve+"flex-item-"+le(t,/flex-|-self/g,"")+(yi(t,/flex-|baseline/)?"":Ve+"grid-row-"+le(t,/flex-|-self/g,""))+t;case 4675:return Te+t+Ve+"flex-line-pack"+le(t,/align-content|flex-|-self/g,"")+t;case 5548:return Te+t+Ve+le(t,"shrink","negative")+t;case 5292:return Te+t+Ve+le(t,"basis","preferred-size")+t;case 6060:return Te+"box-"+le(t,"-grow","")+Te+t+Ve+le(t,"grow","positive")+t;case 4554:return Te+le(t,/([^-])(transform)/g,"$1"+Te+"$2")+t;case 6187:return le(le(le(t,/(zoom-|grab)/,Te+"$1"),/(image-set)/,Te+"$1"),t,"")+t;case 5495:case 3959:return le(t,/(image-set\([^]*)/,Te+"$1$`$1");case 4968:return le(le(t,/(.+:)(flex-)?(.*)/,Te+"box-pack:$3"+Ve+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+Te+t+t;case 4200:if(!yi(t,/flex-|baseline/))return Ve+"grid-column-align"+Tl(t,e)+t;break;case 2592:case 3360:return Ve+le(t,"template-","")+t;case 4384:case 3616:return n&&n.some(function(r,i){return e=i,yi(r.props,/grid-\w+-end/)})?~kf(t+(n=n[e].value),"span")?t:Ve+le(t,"-start","")+t+Ve+"grid-row-span:"+(~kf(n,"span")?yi(n,/\d+/):+yi(n,/\d+/)-+yi(t,/\d+/))+";":Ve+le(t,"-start","")+t;case 4896:case 4128:return n&&n.some(function(r){return yi(r.props,/grid-\w+-start/)})?t:Ve+le(le(t,"-end","-span"),"span ","")+t;case 4095:case 3583:case 4068:case 2532:return le(t,/(.+)-inline(.+)/,Te+"$1$2")+t;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if($r(t)-1-e>6)switch(At(t,e+1)){case 109:if(At(t,e+4)!==45)break;case 102:return le(t,/(.+:)(.+)-([^]+)/,"$1"+Te+"$2-$3$1"+vc+(At(t,e+3)==108?"$3":"$2-$3"))+t;case 115:return~kf(t,"stretch")?uk(le(t,"stretch","fill-available"),e,n)+t:t}break;case 5152:case 5920:return le(t,/(.+?):(\d+)(\s*\/\s*(span)?\s*(\d+))?(.*)/,function(r,i,s,o,a,l,u){return Ve+i+":"+s+u+(o?Ve+i+"-span:"+(a?l:+l-+s)+u:"")+t});case 4949:if(At(t,e+6)===121)return le(t,":",":"+Te)+t;break;case 6444:switch(At(t,At(t,14)===45?18:11)){case 120:return le(t,/(.+:)([^;\s!]+)(;|(\s+)?!.+)?/,"$1"+Te+(At(t,14)===45?"inline-":"")+"box$3$1"+Te+"$2$3$1"+Ve+"$2box$3")+t;case 100:return le(t,":",":"+Ve)+t}break;case 5719:case 2647:case 2135:case 3927:case 2391:return le(t,"scroll-","scroll-snap-")+t}return t}function Ep(t,e){for(var n="",r=0;r<t.length;r++)n+=e(t[r],r,t,e)||"";return n}function f$(t,e,n,r){switch(t.type){case Z4:if(t.children.length)break;case J4:case e0:return t.return=t.return||t.value;case ik:return"";case sk:return t.return=t.value+"{"+Ep(t.children,r)+"}";case km:if(!$r(t.value=t.props.join(",")))return""}return $r(n=Ep(t.children,r))?t.return=t.value+"{"+n+"}":""}function p$(t){var e=ak(t);return function(n,r,i,s){for(var o="",a=0;a<e;a++)o+=t[a](n,r,i,s)||"";return o}}function m$(t){return function(e){e.root||(e=e.return)&&t(e)}}function g$(t,e,n,r){if(t.length>-1&&!t.return)switch(t.type){case e0:t.return=uk(t.value,t.length,n);return;case sk:return Ep([es(t,{value:le(t.value,"@","@"+Te)})],r);case km:if(t.length)return n$(n=t.props,function(i){switch(yi(i,r=/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":Aa(es(t,{props:[le(i,/:(read-\w+)/,":"+vc+"$1")]})),Aa(es(t,{props:[i]})),bv(t,{props:R1(n,r)});break;case"::placeholder":Aa(es(t,{props:[le(i,/:(plac\w+)/,":"+Te+"input-$1")]})),Aa(es(t,{props:[le(i,/:(plac\w+)/,":"+vc+"$1")]})),Aa(es(t,{props:[le(i,/:(plac\w+)/,Ve+"input-$1")]})),Aa(es(t,{props:[i]})),bv(t,{props:R1(n,r)});break}return""})}}var _$={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},Cl=typeof process<"u"&&process.env!==void 0&&({}.REACT_APP_SC_ATTR||{}.SC_ATTR)||"data-styled",n0=typeof window<"u"&&"HTMLElement"in window,y$=!!(typeof SC_DISABLE_SPEEDY=="boolean"?SC_DISABLE_SPEEDY:typeof process<"u"&&process.env!==void 0&&{}.REACT_APP_SC_DISABLE_SPEEDY!==void 0&&{}.REACT_APP_SC_DISABLE_SPEEDY!==""?{}.REACT_APP_SC_DISABLE_SPEEDY!=="false"&&{}.REACT_APP_SC_DISABLE_SPEEDY:typeof process<"u"&&process.env!==void 0&&{}.SC_DISABLE_SPEEDY!==void 0&&{}.SC_DISABLE_SPEEDY!==""&&{}.SC_DISABLE_SPEEDY!=="false"&&{}.SC_DISABLE_SPEEDY),Om=Object.freeze([]),Rl=Object.freeze({});function v$(t,e,n){return n===void 0&&(n=Rl),t.theme!==n.theme&&t.theme||e||n.theme}var ck=new Set(["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","use","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","marker","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"]),w$=/[!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~-]+/g,E$=/(^-|-$)/g;function b1(t){return t.replace(w$,"-").replace(E$,"")}var I$=/(a)(d)/gi,k1=function(t){return String.fromCharCode(t+(t>25?39:97))};function Nv(t){var e,n="";for(e=Math.abs(t);e>52;e=e/52|0)n=k1(e%52)+n;return(k1(e%52)+n).replace(I$,"$1-$2")}var H_,Qa=function(t,e){for(var n=e.length;n;)t=33*t^e.charCodeAt(--n);return t},hk=function(t){return Qa(5381,t)};function T$(t){return Nv(hk(t)>>>0)}function S$(t){return t.displayName||t.name||"Component"}function G_(t){return typeof t=="string"&&!0}var dk=typeof Symbol=="function"&&Symbol.for,fk=dk?Symbol.for("react.memo"):60115,C$=dk?Symbol.for("react.forward_ref"):60112,R$={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},A$={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},pk={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},P$=((H_={})[C$]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},H_[fk]=pk,H_);function x1(t){return("type"in(e=t)&&e.type.$$typeof)===fk?pk:"$$typeof"in t?P$[t.$$typeof]:R$;var e}var b$=Object.defineProperty,k$=Object.getOwnPropertyNames,N1=Object.getOwnPropertySymbols,x$=Object.getOwnPropertyDescriptor,N$=Object.getPrototypeOf,D1=Object.prototype;function mk(t,e,n){if(typeof e!="string"){if(D1){var r=N$(e);r&&r!==D1&&mk(t,r,n)}var i=k$(e);N1&&(i=i.concat(N1(e)));for(var s=x1(t),o=x1(e),a=0;a<i.length;++a){var l=i[a];if(!(l in A$||n&&n[l]||o&&l in o||s&&l in s)){var u=x$(e,l);try{b$(t,l,u)}catch{}}}}return t}function Al(t){return typeof t=="function"}function r0(t){return typeof t=="object"&&"styledComponentId"in t}function So(t,e){return t&&e?"".concat(t," ").concat(e):t||e||""}function O1(t,e){if(t.length===0)return"";for(var n=t[0],r=1;r<t.length;r++)n+=e?e+t[r]:t[r];return n}function Jc(t){return t!==null&&typeof t=="object"&&t.constructor.name===Object.name&&!("props"in t&&t.$$typeof)}function Dv(t,e,n){if(n===void 0&&(n=!1),!n&&!Jc(t)&&!Array.isArray(t))return e;if(Array.isArray(e))for(var r=0;r<e.length;r++)t[r]=Dv(t[r],e[r]);else if(Jc(e))for(var r in e)t[r]=Dv(t[r],e[r]);return t}function i0(t,e){Object.defineProperty(t,"toString",{value:e})}function Wh(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return new Error("An error occurred. See https://github.com/styled-components/styled-components/blob/main/packages/styled-components/src/utils/errors.md#".concat(t," for more information.").concat(e.length>0?" Args: ".concat(e.join(", ")):""))}var D$=function(){function t(e){this.groupSizes=new Uint32Array(512),this.length=512,this.tag=e}return t.prototype.indexOfGroup=function(e){for(var n=0,r=0;r<e;r++)n+=this.groupSizes[r];return n},t.prototype.insertRules=function(e,n){if(e>=this.groupSizes.length){for(var r=this.groupSizes,i=r.length,s=i;e>=s;)if((s<<=1)<0)throw Wh(16,"".concat(e));this.groupSizes=new Uint32Array(s),this.groupSizes.set(r),this.length=s;for(var o=i;o<s;o++)this.groupSizes[o]=0}for(var a=this.indexOfGroup(e+1),l=(o=0,n.length);o<l;o++)this.tag.insertRule(a,n[o])&&(this.groupSizes[e]++,a++)},t.prototype.clearGroup=function(e){if(e<this.length){var n=this.groupSizes[e],r=this.indexOfGroup(e),i=r+n;this.groupSizes[e]=0;for(var s=r;s<i;s++)this.tag.deleteRule(r)}},t.prototype.getGroup=function(e){var n="";if(e>=this.length||this.groupSizes[e]===0)return n;for(var r=this.groupSizes[e],i=this.indexOfGroup(e),s=i+r,o=i;o<s;o++)n+="".concat(this.tag.getRule(o)).concat(`/*!sc*/
`);return n},t}(),Df=new Map,Ip=new Map,K_=1,Zd=function(t){if(Df.has(t))return Df.get(t);for(;Ip.has(K_);)K_++;var e=K_++;return Df.set(t,e),Ip.set(e,t),e},O$=function(t,e){Df.set(t,e),Ip.set(e,t)},L$="style[".concat(Cl,"][").concat("data-styled-version",'="').concat("6.0.7",'"]'),M$=new RegExp("^".concat(Cl,'\\.g(\\d+)\\[id="([\\w\\d-]+)"\\].*?"([^"]*)')),V$=function(t,e,n){for(var r,i=n.split(","),s=0,o=i.length;s<o;s++)(r=i[s])&&t.registerName(e,r)},F$=function(t,e){for(var n,r=((n=e.textContent)!==null&&n!==void 0?n:"").split(`/*!sc*/
`),i=[],s=0,o=r.length;s<o;s++){var a=r[s].trim();if(a){var l=a.match(M$);if(l){var u=0|parseInt(l[1],10),c=l[2];u!==0&&(O$(c,u),V$(t,c,l[3]),t.getTag().insertRules(u,i)),i.length=0}else i.push(a)}}};function U$(){return typeof __webpack_nonce__<"u"?__webpack_nonce__:null}var gk=function(t){var e=document.head,n=t||e,r=document.createElement("style"),i=function(a){var l=Array.from(a.querySelectorAll("style[".concat(Cl,"]")));return l[l.length-1]}(n),s=i!==void 0?i.nextSibling:null;r.setAttribute(Cl,"active"),r.setAttribute("data-styled-version","6.0.7");var o=U$();return o&&r.setAttribute("nonce",o),n.insertBefore(r,s),r},$$=function(){function t(e){this.element=gk(e),this.element.appendChild(document.createTextNode("")),this.sheet=function(n){if(n.sheet)return n.sheet;for(var r=document.styleSheets,i=0,s=r.length;i<s;i++){var o=r[i];if(o.ownerNode===n)return o}throw Wh(17)}(this.element),this.length=0}return t.prototype.insertRule=function(e,n){try{return this.sheet.insertRule(n,e),this.length++,!0}catch{return!1}},t.prototype.deleteRule=function(e){this.sheet.deleteRule(e),this.length--},t.prototype.getRule=function(e){var n=this.sheet.cssRules[e];return n&&n.cssText?n.cssText:""},t}(),B$=function(){function t(e){this.element=gk(e),this.nodes=this.element.childNodes,this.length=0}return t.prototype.insertRule=function(e,n){if(e<=this.length&&e>=0){var r=document.createTextNode(n);return this.element.insertBefore(r,this.nodes[e]||null),this.length++,!0}return!1},t.prototype.deleteRule=function(e){this.element.removeChild(this.nodes[e]),this.length--},t.prototype.getRule=function(e){return e<this.length?this.nodes[e].textContent:""},t}(),z$=function(){function t(e){this.rules=[],this.length=0}return t.prototype.insertRule=function(e,n){return e<=this.length&&(this.rules.splice(e,0,n),this.length++,!0)},t.prototype.deleteRule=function(e){this.rules.splice(e,1),this.length--},t.prototype.getRule=function(e){return e<this.length?this.rules[e]:""},t}(),L1=n0,j$={isServer:!n0,useCSSOMInjection:!y$},_k=function(){function t(e,n,r){e===void 0&&(e=Rl),n===void 0&&(n={});var i=this;this.options=Pn(Pn({},j$),e),this.gs=n,this.names=new Map(r),this.server=!!e.isServer,!this.server&&n0&&L1&&(L1=!1,function(s){for(var o=document.querySelectorAll(L$),a=0,l=o.length;a<l;a++){var u=o[a];u&&u.getAttribute(Cl)!=="active"&&(F$(s,u),u.parentNode&&u.parentNode.removeChild(u))}}(this)),i0(this,function(){return function(s){for(var o=s.getTag(),a=o.length,l="",u=function(h){var f=function(v){return Ip.get(v)}(h);if(f===void 0)return"continue";var g=s.names.get(f),_=o.getGroup(h);if(g===void 0||_.length===0)return"continue";var w="".concat(Cl,".g").concat(h,'[id="').concat(f,'"]'),T="";g!==void 0&&g.forEach(function(v){v.length>0&&(T+="".concat(v,","))}),l+="".concat(_).concat(w,'{content:"').concat(T,'"}').concat(`/*!sc*/
`)},c=0;c<a;c++)u(c);return l}(i)})}return t.registerId=function(e){return Zd(e)},t.prototype.reconstructWithOptions=function(e,n){return n===void 0&&(n=!0),new t(Pn(Pn({},this.options),e),this.gs,n&&this.names||void 0)},t.prototype.allocateGSInstance=function(e){return this.gs[e]=(this.gs[e]||0)+1},t.prototype.getTag=function(){return this.tag||(this.tag=(e=function(n){var r=n.useCSSOMInjection,i=n.target;return n.isServer?new z$(i):r?new $$(i):new B$(i)}(this.options),new D$(e)));var e},t.prototype.hasNameForId=function(e,n){return this.names.has(e)&&this.names.get(e).has(n)},t.prototype.registerName=function(e,n){if(Zd(e),this.names.has(e))this.names.get(e).add(n);else{var r=new Set;r.add(n),this.names.set(e,r)}},t.prototype.insertRules=function(e,n,r){this.registerName(e,n),this.getTag().insertRules(Zd(e),r)},t.prototype.clearNames=function(e){this.names.has(e)&&this.names.get(e).clear()},t.prototype.clearRules=function(e){this.getTag().clearGroup(Zd(e)),this.clearNames(e)},t.prototype.clearTag=function(){this.tag=void 0},t}(),q$=/&/g,W$=/^\s*\/\/.*$/gm;function yk(t,e){return t.map(function(n){return n.type==="rule"&&(n.value="".concat(e," ").concat(n.value),n.value=n.value.replaceAll(",",",".concat(e," ")),n.props=n.props.map(function(r){return"".concat(e," ").concat(r)})),Array.isArray(n.children)&&n.type!=="@keyframes"&&(n.children=yk(n.children,e)),n})}function H$(t){var e,n,r,i=t===void 0?Rl:t,s=i.options,o=s===void 0?Rl:s,a=i.plugins,l=a===void 0?Om:a,u=function(f,g,_){return _===n||_.startsWith(n)&&_.endsWith(n)&&_.replaceAll(n,"").length>0?".".concat(e):f},c=l.slice();c.push(function(f){f.type===km&&f.value.includes("&")&&(f.props[0]=f.props[0].replace(q$,n).replace(r,u))}),o.prefix&&c.push(g$),c.push(f$);var h=function(f,g,_,w){g===void 0&&(g=""),_===void 0&&(_=""),w===void 0&&(w="&"),e=w,n=g,r=new RegExp("\\".concat(n,"\\b"),"g");var T=f.replace(W$,""),v=h$(_||g?"".concat(_," ").concat(g," { ").concat(T," }"):T);o.namespace&&(v=yk(v,o.namespace));var y=[];return Ep(v,p$(c.concat(m$(function(I){return y.push(I)})))),y};return h.hash=l.length?l.reduce(function(f,g){return g.name||Wh(15),Qa(f,g.name)},5381).toString():"",h}var G$=new _k,Ov=H$(),vk=Hn.createContext({shouldForwardProp:void 0,styleSheet:G$,stylis:Ov});vk.Consumer;Hn.createContext(void 0);function M1(){return gt.useContext(vk)}var K$=function(){function t(e,n){var r=this;this.inject=function(i,s){s===void 0&&(s=Ov);var o=r.name+s.hash;i.hasNameForId(r.id,o)||i.insertRules(r.id,o,s(r.rules,o,"@keyframes"))},this.name=e,this.id="sc-keyframes-".concat(e),this.rules=n,i0(this,function(){throw Wh(12,String(r.name))})}return t.prototype.getName=function(e){return e===void 0&&(e=Ov),this.name+e.hash},t}(),Q$=function(t){return t>="A"&&t<="Z"};function V1(t){for(var e="",n=0;n<t.length;n++){var r=t[n];if(n===1&&r==="-"&&t[0]==="-")return t;Q$(r)?e+="-"+r.toLowerCase():e+=r}return e.startsWith("ms-")?"-"+e:e}var wk=function(t){return t==null||t===!1||t===""},Ek=function(t){var e,n,r=[];for(var i in t){var s=t[i];t.hasOwnProperty(i)&&!wk(s)&&(Array.isArray(s)&&s.isCss||Al(s)?r.push("".concat(V1(i),":"),s,";"):Jc(s)?r.push.apply(r,wp(wp(["".concat(i," {")],Ek(s),!1),["}"],!1)):r.push("".concat(V1(i),": ").concat((e=i,(n=s)==null||typeof n=="boolean"||n===""?"":typeof n!="number"||n===0||e in _$||e.startsWith("--")?String(n).trim():"".concat(n,"px")),";")))}return r};function Oo(t,e,n,r){if(wk(t))return[];if(r0(t))return[".".concat(t.styledComponentId)];if(Al(t)){if(!Al(s=t)||s.prototype&&s.prototype.isReactComponent||!e)return[t];var i=t(e);return Oo(i,e,n,r)}var s;return t instanceof K$?n?(t.inject(n,r),[t.getName(r)]):[t]:Jc(t)?Ek(t):Array.isArray(t)?Array.prototype.concat.apply(Om,t.map(function(o){return Oo(o,e,n,r)})):[t.toString()]}function Y$(t){for(var e=0;e<t.length;e+=1){var n=t[e];if(Al(n)&&!r0(n))return!1}return!0}var X$=hk("6.0.7"),J$=function(){function t(e,n,r){this.rules=e,this.staticRulesId="",this.isStatic=(r===void 0||r.isStatic)&&Y$(e),this.componentId=n,this.baseHash=Qa(X$,n),this.baseStyle=r,_k.registerId(n)}return t.prototype.generateAndInjectStyles=function(e,n,r){var i=this.baseStyle?this.baseStyle.generateAndInjectStyles(e,n,r):"";if(this.isStatic&&!r.hash)if(this.staticRulesId&&n.hasNameForId(this.componentId,this.staticRulesId))i=So(i,this.staticRulesId);else{var s=O1(Oo(this.rules,e,n,r)),o=Nv(Qa(this.baseHash,s)>>>0);if(!n.hasNameForId(this.componentId,o)){var a=r(s,".".concat(o),void 0,this.componentId);n.insertRules(this.componentId,o,a)}i=So(i,o),this.staticRulesId=o}else{for(var l=Qa(this.baseHash,r.hash),u="",c=0;c<this.rules.length;c++){var h=this.rules[c];if(typeof h=="string")u+=h;else if(h){var f=O1(Oo(h,e,n,r));l=Qa(l,f),u+=f}}if(u){var g=Nv(l>>>0);n.hasNameForId(this.componentId,g)||n.insertRules(this.componentId,g,r(u,".".concat(g),void 0,this.componentId)),i=So(i,g)}}return i},t}(),Ik=Hn.createContext(void 0);Ik.Consumer;var Q_={};function Z$(t,e,n){var r=r0(t),i=t,s=!G_(t),o=e.attrs,a=o===void 0?Om:o,l=e.componentId,u=l===void 0?function(I,C){var P=typeof I!="string"?"sc":b1(I);Q_[P]=(Q_[P]||0)+1;var b="".concat(P,"-").concat(T$("6.0.7"+P+Q_[P]));return C?"".concat(C,"-").concat(b):b}(e.displayName,e.parentComponentId):l,c=e.displayName;c===void 0&&function(I){return G_(I)?"styled.".concat(I):"Styled(".concat(S$(I),")")}(t);var h=e.displayName&&e.componentId?"".concat(b1(e.displayName),"-").concat(e.componentId):e.componentId||u,f=r&&i.attrs?i.attrs.concat(a).filter(Boolean):a,g=e.shouldForwardProp;if(r&&i.shouldForwardProp){var _=i.shouldForwardProp;if(e.shouldForwardProp){var w=e.shouldForwardProp;g=function(I,C){return _(I,C)&&w(I,C)}}else g=_}var T=new J$(n,h,r?i.componentStyle:void 0);function v(I,C){return function(P,b,k){var F=P.attrs,re=P.componentStyle,X=P.defaultProps,an=P.foldedComponentIds,$n=P.styledComponentId,tr=P.target,Ta=Hn.useContext(Ik),Iu=M1(),fi=P.shouldForwardProp||Iu.shouldForwardProp,wn=function(yr,ln,Le){for(var be,En=Pn(Pn({},ln),{className:void 0,theme:Le}),Sa=0;Sa<yr.length;Sa+=1){var In=Al(be=yr[Sa])?be(En):be;for(var vr in In)En[vr]=vr==="className"?So(En[vr],In[vr]):vr==="style"?Pn(Pn({},En[vr]),In[vr]):In[vr]}return ln.className&&(En.className=So(En.className,ln.className)),En}(F,b,v$(b,Ta,X)||Rl),q=wn.as||tr,J={};for(var ee in wn)wn[ee]===void 0||ee[0]==="$"||ee==="as"||ee==="theme"||(ee==="forwardedAs"?J.as=wn.forwardedAs:fi&&!fi(ee,q)||(J[ee]=wn[ee]));var xe=function(yr,ln){var Le=M1(),be=yr.generateAndInjectStyles(ln,Le.styleSheet,Le.stylis);return be}(re,wn),Ie=So(an,$n);return xe&&(Ie+=" "+xe),wn.className&&(Ie+=" "+wn.className),J[G_(q)&&!ck.has(q)?"class":"className"]=Ie,J.ref=k,gt.createElement(q,J)}(y,I,C)}var y=Hn.forwardRef(v);return y.attrs=f,y.componentStyle=T,y.shouldForwardProp=g,y.foldedComponentIds=r?So(i.foldedComponentIds,i.styledComponentId):"",y.styledComponentId=h,y.target=r?i.target:t,Object.defineProperty(y,"defaultProps",{get:function(){return this._foldedDefaultProps},set:function(I){this._foldedDefaultProps=r?function(C){for(var P=[],b=1;b<arguments.length;b++)P[b-1]=arguments[b];for(var k=0,F=P;k<F.length;k++)Dv(C,F[k],!0);return C}({},i.defaultProps,I):I}}),i0(y,function(){return".".concat(y.styledComponentId)}),s&&mk(y,t,{attrs:!0,componentStyle:!0,displayName:!0,foldedComponentIds:!0,shouldForwardProp:!0,styledComponentId:!0,target:!0}),y}function F1(t,e){for(var n=[t[0]],r=0,i=e.length;r<i;r+=1)n.push(e[r],t[r+1]);return n}var U1=function(t){return Object.assign(t,{isCss:!0})};function eB(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Al(t)||Jc(t)){var r=t;return U1(Oo(F1(Om,wp([r],e,!0))))}var i=t;return e.length===0&&i.length===1&&typeof i[0]=="string"?Oo(i):U1(Oo(F1(i,e)))}function Lv(t,e,n){if(n===void 0&&(n=Rl),!e)throw Wh(1,e);var r=function(i){for(var s=[],o=1;o<arguments.length;o++)s[o-1]=arguments[o];return t(e,n,eB.apply(void 0,wp([i],s,!1)))};return r.attrs=function(i){return Lv(t,e,Pn(Pn({},n),{attrs:Array.prototype.concat(n.attrs,i).filter(Boolean)}))},r.withConfig=function(i){return Lv(t,e,Pn(Pn({},n),i))},r}var Tk=function(t){return Lv(Z$,t)},Zl=Tk;ck.forEach(function(t){Zl[t]=Tk(t)});var Sk={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},$1=Hn.createContext&&Hn.createContext(Sk),Es=globalThis&&globalThis.__assign||function(){return Es=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},Es.apply(this,arguments)},tB=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};function Ck(t){return t&&t.map(function(e,n){return Hn.createElement(e.tag,Es({key:n},e.attr),Ck(e.child))})}function Ys(t){return function(e){return Hn.createElement(nB,Es({attr:Es({},t.attr)},e),Ck(t.child))}}function nB(t){var e=function(n){var r=t.attr,i=t.size,s=t.title,o=tB(t,["attr","size","title"]),a=i||n.size||"1em",l;return n.className&&(l=n.className),t.className&&(l=(l?l+" ":"")+t.className),Hn.createElement("svg",Es({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,r,o,{className:l,style:Es(Es({color:t.color||n.color},n.style),t.style),height:a,width:a,xmlns:"http://www.w3.org/2000/svg"}),s&&Hn.createElement("title",null,s),t.children)};return $1!==void 0?Hn.createElement($1.Consumer,null,function(n){return e(n)}):e(Sk)}function rB(t){return Ys({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"}},{tag:"path",attr:{d:"M11 5.08V2c-5 .5-9 4.81-9 10s4 9.5 9 10v-3.08c-3-.48-6-3.4-6-6.92s3-6.44 6-6.92zM18.97 11H22c-.47-5-4-8.53-9-9v3.08C16 5.51 18.54 8 18.97 11zM13 18.92V22c5-.47 8.53-4 9-9h-3.03c-.43 3-2.97 5.49-5.97 5.92z"}}]})(t)}function iB(t){return Ys({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"}},{tag:"path",attr:{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm3.5-9c.83 0 1.5-.67 1.5-1.5S16.33 8 15.5 8 14 8.67 14 9.5s.67 1.5 1.5 1.5zm-7 0c.83 0 1.5-.67 1.5-1.5S9.33 8 8.5 8 7 8.67 7 9.5 7.67 11 8.5 11zm3.5 6.5c2.33 0 4.31-1.46 5.11-3.5H6.89c.8 2.04 2.78 3.5 5.11 3.5z"}}]})(t)}function sB(t){return Ys({tag:"svg",attr:{fill:"currentColor",viewBox:"0 0 16 16"},child:[{tag:"path",attr:{d:"M0 2a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H4.414a1 1 0 0 0-.707.293L.854 15.146A.5.5 0 0 1 0 14.793V2zm3.5 1a.5.5 0 0 0 0 1h9a.5.5 0 0 0 0-1h-9zm0 2.5a.5.5 0 0 0 0 1h9a.5.5 0 0 0 0-1h-9zm0 2.5a.5.5 0 0 0 0 1h5a.5.5 0 0 0 0-1h-5z"}}]})(t)}function oB(t){return Ys({tag:"svg",attr:{fill:"currentColor",viewBox:"0 0 16 16"},child:[{tag:"path",attr:{d:"M5 3a3 3 0 0 1 6 0v5a3 3 0 0 1-6 0V3z"}},{tag:"path",attr:{d:"M3.5 6.5A.5.5 0 0 1 4 7v1a4 4 0 0 0 8 0V7a.5.5 0 0 1 1 0v1a5 5 0 0 1-4.5 4.975V15h3a.5.5 0 0 1 0 1h-7a.5.5 0 0 1 0-1h3v-2.025A5 5 0 0 1 3 8V7a.5.5 0 0 1 .5-.5z"}}]})(t)}function Rk(t){return Ys({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"1"}},{tag:"circle",attr:{cx:"12",cy:"5",r:"1"}},{tag:"circle",attr:{cx:"12",cy:"19",r:"1"}}]})(t)}function Ak(t){return Ys({tag:"svg",attr:{viewBox:"0 0 1024 1024"},child:[{tag:"path",attr:{d:"M909.6 854.5L649.9 594.8C690.2 542.7 712 479 712 412c0-80.2-31.3-155.4-87.9-212.1-56.6-56.7-132-87.9-212.1-87.9s-155.5 31.3-212.1 87.9C143.2 256.5 112 331.8 112 412c0 80.1 31.3 155.5 87.9 212.1C256.5 680.8 331.8 712 412 712c67 0 130.6-21.8 182.7-62l259.7 259.6a8.2 8.2 0 0 0 11.6 0l43.6-43.5a8.2 8.2 0 0 0 0-11.6zM570.4 570.4C528 612.7 471.8 636 412 636s-116-23.3-158.4-65.6C211.3 528 188 471.8 188 412s23.3-116.1 65.6-158.4C296 211.3 352.2 188 412 188s116.1 23.2 158.4 65.6S636 352.2 636 412s-23.3 116.1-65.6 158.4z"}}]})(t)}const aB=({messages:t})=>{var r;const[e,n]=gt.useState("");return gt.useEffect(()=>{n(Math.floor(Math.random()*5e3))},[]),K.jsxs(lB,{children:[K.jsx("img",{src:`https://avatars.dicebear.com/api/human/b${e}.svg`,alt:"avatar",className:"avatar"}),K.jsxs("div",{className:"info",children:[K.jsx("h2",{children:"ChatRoom"}),K.jsx("p",{children:(r=t[t.length-1])==null?void 0:r.message})]})]})},lB=Zl.div`
    display:grid;
    grid-template-columns:auto 1fr;
    gap:1rem;
    padding:1rem;
    border-bottom: 1px solid grey;
    background: white;
    cursor: pointer;
    .avatar{
        width:3rem;
        height:3rem;
        object-fit:cover;
    }
    .info h2{
        font-size: 1rem;
        margin-bottom: 0.5rem;
    }
    
`,Hh=gt.createContext(),uB=({reducer:t,initialState:e,children:n})=>K.jsx(Hh.Provider,{value:gt.useReducer(t,e),children:n}),cB=({messages:t})=>{const[e,n]=gt.useContext(Hh),{user:r}=e;return K.jsxs(hB,{children:[K.jsxs("div",{className:"header",children:[K.jsx("img",{src:r==null?void 0:r.photoURL,alt:"",className:"userImg"}),K.jsxs("div",{className:"rheader",children:[K.jsx("button",{className:"btn",children:K.jsx(rB,{className:"icon"})}),K.jsx("button",{className:"btn",children:K.jsx(sB,{className:"icon"})}),K.jsx("button",{className:"btn",children:K.jsx(Rk,{className:"icon"})})]})]}),K.jsx("div",{className:"search",children:K.jsxs("div",{className:"search-container",children:[K.jsx(Ak,{className:"search-icon icon"}),K.jsx("input",{type:"text",placeholder:"start a new chat"})]})}),K.jsx("div",{className:"chats",children:K.jsx(aB,{messages:t})})]})},hB=Zl.div`
   display:grid;
   grid-template-rows: auto auto 1fr;
   .header{
        display:grid;
        grid-template-columns:1fr auto;
        padding:1rem;
        gap:10rem;
   }
   .rheader{
    display:grid;
    grid-template-columns: repeat(3, 1fr);
    gap:0.5rem;
   }
   .avatar{
    font-size:2rem;
   }
   .icon{
    font-size:1.5rem;
    color:gray;
   }

   .userImg {
        height: 3rem;
        width: 3rem;
        border-radius: 1.5rem;
   }
   .btn{
    border: none;
    background: transparent;
   }

   .search{
    background: #f6f6f6;
    padding: 0.5rem;
   }

   .search-container{
    background:white;
    width:100%;
    border-radius: 0.5rem;
    display:grid;
    grid-template-columns: auto auto;
    align-items:center;
    gap:0.2rem;
   }

   .search-icon{
        color: gray;
   }

   .search-container input{
    border:none;
    outline:none;
   }
`;function dB(t){return Ys({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M355.9 161.1c-8.6 0-15.6 7-15.6 15.6v194.4c0 20.3-8 40.4-22 55.1-13.9 14.6-35.2 23.7-55.5 23.7h-13.6c-19.6 0-39.5-8.9-54.8-24.6-15.2-15.5-23.9-35.6-23.9-55.2V119.3c0-14.9 6.2-28.9 17.3-39.5 11.1-10.5 25.7-16.3 41-16.3 15.1 0 29.3 5.8 39.8 16.2 10.5 10.5 16.4 24.6 16.4 39.6v234.2c0 17.1-13.6 32.2-29 32.2-13.6 0-28.2-12.9-28.2-32.2V219.9c0-8.6-7-15.6-15.6-15.6s-15.6 7-15.6 15.6v133.6c0 35.5 25.5 62.3 59.4 62.3 16.5 0 31.7-6.1 42.7-17.3 11.3-11.4 17.5-27.4 17.5-45V119.3c0-23.4-9.1-45.4-25.7-61.8C274 41 252 32 228.5 32s-45.5 9-62.2 25.5c-16.7 16.5-25.9 38.4-25.9 61.9v250.8c0 28.7 12.2 57.9 32.6 78 20.9 20.6 47.9 31.9 76.1 31.9h13.6c27.6 0 55.3-11.7 75.9-32.1 10.2-10.1 18.2-21.7 23.9-34.6 5.9-13.5 8.9-27.7 8.9-42.1V176.7c.1-8.6-6.9-15.6-15.5-15.6z"}}]})(t)}function Pk(t,e){return function(){return t.apply(e,arguments)}}const{toString:fB}=Object.prototype,{getPrototypeOf:s0}=Object,Lm=(t=>e=>{const n=fB.call(e);return t[n]||(t[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),ci=t=>(t=t.toLowerCase(),e=>Lm(e)===t),Mm=t=>e=>typeof e===t,{isArray:eu}=Array,Zc=Mm("undefined");function pB(t){return t!==null&&!Zc(t)&&t.constructor!==null&&!Zc(t.constructor)&&dr(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const bk=ci("ArrayBuffer");function mB(t){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(t):e=t&&t.buffer&&bk(t.buffer),e}const gB=Mm("string"),dr=Mm("function"),kk=Mm("number"),Vm=t=>t!==null&&typeof t=="object",_B=t=>t===!0||t===!1,Of=t=>{if(Lm(t)!=="object")return!1;const e=s0(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},yB=ci("Date"),vB=ci("File"),wB=ci("Blob"),EB=ci("FileList"),IB=t=>Vm(t)&&dr(t.pipe),TB=t=>{let e;return t&&(typeof FormData=="function"&&t instanceof FormData||dr(t.append)&&((e=Lm(t))==="formdata"||e==="object"&&dr(t.toString)&&t.toString()==="[object FormData]"))},SB=ci("URLSearchParams"),CB=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Gh(t,e,{allOwnKeys:n=!1}={}){if(t===null||typeof t>"u")return;let r,i;if(typeof t!="object"&&(t=[t]),eu(t))for(r=0,i=t.length;r<i;r++)e.call(null,t[r],r,t);else{const s=n?Object.getOwnPropertyNames(t):Object.keys(t),o=s.length;let a;for(r=0;r<o;r++)a=s[r],e.call(null,t[a],a,t)}}function xk(t,e){e=e.toLowerCase();const n=Object.keys(t);let r=n.length,i;for(;r-- >0;)if(i=n[r],e===i.toLowerCase())return i;return null}const Nk=(()=>typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global)(),Dk=t=>!Zc(t)&&t!==Nk;function Mv(){const{caseless:t}=Dk(this)&&this||{},e={},n=(r,i)=>{const s=t&&xk(e,i)||i;Of(e[s])&&Of(r)?e[s]=Mv(e[s],r):Of(r)?e[s]=Mv({},r):eu(r)?e[s]=r.slice():e[s]=r};for(let r=0,i=arguments.length;r<i;r++)arguments[r]&&Gh(arguments[r],n);return e}const RB=(t,e,n,{allOwnKeys:r}={})=>(Gh(e,(i,s)=>{n&&dr(i)?t[s]=Pk(i,n):t[s]=i},{allOwnKeys:r}),t),AB=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),PB=(t,e,n,r)=>{t.prototype=Object.create(e.prototype,r),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:e.prototype}),n&&Object.assign(t.prototype,n)},bB=(t,e,n,r)=>{let i,s,o;const a={};if(e=e||{},t==null)return e;do{for(i=Object.getOwnPropertyNames(t),s=i.length;s-- >0;)o=i[s],(!r||r(o,t,e))&&!a[o]&&(e[o]=t[o],a[o]=!0);t=n!==!1&&s0(t)}while(t&&(!n||n(t,e))&&t!==Object.prototype);return e},kB=(t,e,n)=>{t=String(t),(n===void 0||n>t.length)&&(n=t.length),n-=e.length;const r=t.indexOf(e,n);return r!==-1&&r===n},xB=t=>{if(!t)return null;if(eu(t))return t;let e=t.length;if(!kk(e))return null;const n=new Array(e);for(;e-- >0;)n[e]=t[e];return n},NB=(t=>e=>t&&e instanceof t)(typeof Uint8Array<"u"&&s0(Uint8Array)),DB=(t,e)=>{const r=(t&&t[Symbol.iterator]).call(t);let i;for(;(i=r.next())&&!i.done;){const s=i.value;e.call(t,s[0],s[1])}},OB=(t,e)=>{let n;const r=[];for(;(n=t.exec(e))!==null;)r.push(n);return r},LB=ci("HTMLFormElement"),MB=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,r,i){return r.toUpperCase()+i}),B1=(({hasOwnProperty:t})=>(e,n)=>t.call(e,n))(Object.prototype),VB=ci("RegExp"),Ok=(t,e)=>{const n=Object.getOwnPropertyDescriptors(t),r={};Gh(n,(i,s)=>{let o;(o=e(i,s,t))!==!1&&(r[s]=o||i)}),Object.defineProperties(t,r)},FB=t=>{Ok(t,(e,n)=>{if(dr(t)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const r=t[n];if(dr(r)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},UB=(t,e)=>{const n={},r=i=>{i.forEach(s=>{n[s]=!0})};return eu(t)?r(t):r(String(t).split(e)),n},$B=()=>{},BB=(t,e)=>(t=+t,Number.isFinite(t)?t:e),Y_="abcdefghijklmnopqrstuvwxyz",z1="0123456789",Lk={DIGIT:z1,ALPHA:Y_,ALPHA_DIGIT:Y_+Y_.toUpperCase()+z1},zB=(t=16,e=Lk.ALPHA_DIGIT)=>{let n="";const{length:r}=e;for(;t--;)n+=e[Math.random()*r|0];return n};function jB(t){return!!(t&&dr(t.append)&&t[Symbol.toStringTag]==="FormData"&&t[Symbol.iterator])}const qB=t=>{const e=new Array(10),n=(r,i)=>{if(Vm(r)){if(e.indexOf(r)>=0)return;if(!("toJSON"in r)){e[i]=r;const s=eu(r)?[]:{};return Gh(r,(o,a)=>{const l=n(o,i+1);!Zc(l)&&(s[a]=l)}),e[i]=void 0,s}}return r};return n(t,0)},WB=ci("AsyncFunction"),HB=t=>t&&(Vm(t)||dr(t))&&dr(t.then)&&dr(t.catch),N={isArray:eu,isArrayBuffer:bk,isBuffer:pB,isFormData:TB,isArrayBufferView:mB,isString:gB,isNumber:kk,isBoolean:_B,isObject:Vm,isPlainObject:Of,isUndefined:Zc,isDate:yB,isFile:vB,isBlob:wB,isRegExp:VB,isFunction:dr,isStream:IB,isURLSearchParams:SB,isTypedArray:NB,isFileList:EB,forEach:Gh,merge:Mv,extend:RB,trim:CB,stripBOM:AB,inherits:PB,toFlatObject:bB,kindOf:Lm,kindOfTest:ci,endsWith:kB,toArray:xB,forEachEntry:DB,matchAll:OB,isHTMLForm:LB,hasOwnProperty:B1,hasOwnProp:B1,reduceDescriptors:Ok,freezeMethods:FB,toObjectSet:UB,toCamelCase:MB,noop:$B,toFiniteNumber:BB,findKey:xk,global:Nk,isContextDefined:Dk,ALPHABET:Lk,generateString:zB,isSpecCompliantForm:jB,toJSONObject:qB,isAsyncFn:WB,isThenable:HB};function _e(t,e,n,r,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",e&&(this.code=e),n&&(this.config=n),r&&(this.request=r),i&&(this.response=i)}N.inherits(_e,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:N.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const Mk=_e.prototype,Vk={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{Vk[t]={value:t}});Object.defineProperties(_e,Vk);Object.defineProperty(Mk,"isAxiosError",{value:!0});_e.from=(t,e,n,r,i,s)=>{const o=Object.create(Mk);return N.toFlatObject(t,o,function(l){return l!==Error.prototype},a=>a!=="isAxiosError"),_e.call(o,t.message,e,n,r,i),o.cause=t,o.name=t.name,s&&Object.assign(o,s),o};const GB=null;function Vv(t){return N.isPlainObject(t)||N.isArray(t)}function Fk(t){return N.endsWith(t,"[]")?t.slice(0,-2):t}function j1(t,e,n){return t?t.concat(e).map(function(i,s){return i=Fk(i),!n&&s?"["+i+"]":i}).join(n?".":""):e}function KB(t){return N.isArray(t)&&!t.some(Vv)}const QB=N.toFlatObject(N,{},null,function(e){return/^is[A-Z]/.test(e)});function Fm(t,e,n){if(!N.isObject(t))throw new TypeError("target must be an object");e=e||new FormData,n=N.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(w,T){return!N.isUndefined(T[w])});const r=n.metaTokens,i=n.visitor||c,s=n.dots,o=n.indexes,l=(n.Blob||typeof Blob<"u"&&Blob)&&N.isSpecCompliantForm(e);if(!N.isFunction(i))throw new TypeError("visitor must be a function");function u(_){if(_===null)return"";if(N.isDate(_))return _.toISOString();if(!l&&N.isBlob(_))throw new _e("Blob is not supported. Use a Buffer instead.");return N.isArrayBuffer(_)||N.isTypedArray(_)?l&&typeof Blob=="function"?new Blob([_]):Buffer.from(_):_}function c(_,w,T){let v=_;if(_&&!T&&typeof _=="object"){if(N.endsWith(w,"{}"))w=r?w:w.slice(0,-2),_=JSON.stringify(_);else if(N.isArray(_)&&KB(_)||(N.isFileList(_)||N.endsWith(w,"[]"))&&(v=N.toArray(_)))return w=Fk(w),v.forEach(function(I,C){!(N.isUndefined(I)||I===null)&&e.append(o===!0?j1([w],C,s):o===null?w:w+"[]",u(I))}),!1}return Vv(_)?!0:(e.append(j1(T,w,s),u(_)),!1)}const h=[],f=Object.assign(QB,{defaultVisitor:c,convertValue:u,isVisitable:Vv});function g(_,w){if(!N.isUndefined(_)){if(h.indexOf(_)!==-1)throw Error("Circular reference detected in "+w.join("."));h.push(_),N.forEach(_,function(v,y){(!(N.isUndefined(v)||v===null)&&i.call(e,v,N.isString(y)?y.trim():y,w,f))===!0&&g(v,w?w.concat(y):[y])}),h.pop()}}if(!N.isObject(t))throw new TypeError("data must be an object");return g(t),e}function q1(t){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(r){return e[r]})}function o0(t,e){this._pairs=[],t&&Fm(t,this,e)}const Uk=o0.prototype;Uk.append=function(e,n){this._pairs.push([e,n])};Uk.toString=function(e){const n=e?function(r){return e.call(this,r,q1)}:q1;return this._pairs.map(function(i){return n(i[0])+"="+n(i[1])},"").join("&")};function YB(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function $k(t,e,n){if(!e)return t;const r=n&&n.encode||YB,i=n&&n.serialize;let s;if(i?s=i(e,n):s=N.isURLSearchParams(e)?e.toString():new o0(e,n).toString(r),s){const o=t.indexOf("#");o!==-1&&(t=t.slice(0,o)),t+=(t.indexOf("?")===-1?"?":"&")+s}return t}class XB{constructor(){this.handlers=[]}use(e,n,r){return this.handlers.push({fulfilled:e,rejected:n,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){N.forEach(this.handlers,function(r){r!==null&&e(r)})}}const W1=XB,Bk={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},JB=typeof URLSearchParams<"u"?URLSearchParams:o0,ZB=typeof FormData<"u"?FormData:null,e3=typeof Blob<"u"?Blob:null,t3=(()=>{let t;return typeof navigator<"u"&&((t=navigator.product)==="ReactNative"||t==="NativeScript"||t==="NS")?!1:typeof window<"u"&&typeof document<"u"})(),n3=(()=>typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function")(),Cr={isBrowser:!0,classes:{URLSearchParams:JB,FormData:ZB,Blob:e3},isStandardBrowserEnv:t3,isStandardBrowserWebWorkerEnv:n3,protocols:["http","https","file","blob","url","data"]};function r3(t,e){return Fm(t,new Cr.classes.URLSearchParams,Object.assign({visitor:function(n,r,i,s){return Cr.isNode&&N.isBuffer(n)?(this.append(r,n.toString("base64")),!1):s.defaultVisitor.apply(this,arguments)}},e))}function i3(t){return N.matchAll(/\w+|\[(\w*)]/g,t).map(e=>e[0]==="[]"?"":e[1]||e[0])}function s3(t){const e={},n=Object.keys(t);let r;const i=n.length;let s;for(r=0;r<i;r++)s=n[r],e[s]=t[s];return e}function zk(t){function e(n,r,i,s){let o=n[s++];const a=Number.isFinite(+o),l=s>=n.length;return o=!o&&N.isArray(i)?i.length:o,l?(N.hasOwnProp(i,o)?i[o]=[i[o],r]:i[o]=r,!a):((!i[o]||!N.isObject(i[o]))&&(i[o]=[]),e(n,r,i[o],s)&&N.isArray(i[o])&&(i[o]=s3(i[o])),!a)}if(N.isFormData(t)&&N.isFunction(t.entries)){const n={};return N.forEachEntry(t,(r,i)=>{e(i3(r),i,n,0)}),n}return null}function o3(t,e,n){if(N.isString(t))try{return(e||JSON.parse)(t),N.trim(t)}catch(r){if(r.name!=="SyntaxError")throw r}return(n||JSON.stringify)(t)}const a0={transitional:Bk,adapter:Cr.isNode?"http":"xhr",transformRequest:[function(e,n){const r=n.getContentType()||"",i=r.indexOf("application/json")>-1,s=N.isObject(e);if(s&&N.isHTMLForm(e)&&(e=new FormData(e)),N.isFormData(e))return i&&i?JSON.stringify(zk(e)):e;if(N.isArrayBuffer(e)||N.isBuffer(e)||N.isStream(e)||N.isFile(e)||N.isBlob(e))return e;if(N.isArrayBufferView(e))return e.buffer;if(N.isURLSearchParams(e))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let a;if(s){if(r.indexOf("application/x-www-form-urlencoded")>-1)return r3(e,this.formSerializer).toString();if((a=N.isFileList(e))||r.indexOf("multipart/form-data")>-1){const l=this.env&&this.env.FormData;return Fm(a?{"files[]":e}:e,l&&new l,this.formSerializer)}}return s||i?(n.setContentType("application/json",!1),o3(e)):e}],transformResponse:[function(e){const n=this.transitional||a0.transitional,r=n&&n.forcedJSONParsing,i=this.responseType==="json";if(e&&N.isString(e)&&(r&&!this.responseType||i)){const o=!(n&&n.silentJSONParsing)&&i;try{return JSON.parse(e)}catch(a){if(o)throw a.name==="SyntaxError"?_e.from(a,_e.ERR_BAD_RESPONSE,this,null,this.response):a}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Cr.classes.FormData,Blob:Cr.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};N.forEach(["delete","get","head","post","put","patch"],t=>{a0.headers[t]={}});const l0=a0,a3=N.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),l3=t=>{const e={};let n,r,i;return t&&t.split(`
`).forEach(function(o){i=o.indexOf(":"),n=o.substring(0,i).trim().toLowerCase(),r=o.substring(i+1).trim(),!(!n||e[n]&&a3[n])&&(n==="set-cookie"?e[n]?e[n].push(r):e[n]=[r]:e[n]=e[n]?e[n]+", "+r:r)}),e},H1=Symbol("internals");function Ou(t){return t&&String(t).trim().toLowerCase()}function Lf(t){return t===!1||t==null?t:N.isArray(t)?t.map(Lf):String(t)}function u3(t){const e=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=n.exec(t);)e[r[1]]=r[2];return e}const c3=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function X_(t,e,n,r,i){if(N.isFunction(r))return r.call(this,e,n);if(i&&(e=n),!!N.isString(e)){if(N.isString(r))return e.indexOf(r)!==-1;if(N.isRegExp(r))return r.test(e)}}function h3(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,n,r)=>n.toUpperCase()+r)}function d3(t,e){const n=N.toCamelCase(" "+e);["get","set","has"].forEach(r=>{Object.defineProperty(t,r+n,{value:function(i,s,o){return this[r].call(this,e,i,s,o)},configurable:!0})})}class Um{constructor(e){e&&this.set(e)}set(e,n,r){const i=this;function s(a,l,u){const c=Ou(l);if(!c)throw new Error("header name must be a non-empty string");const h=N.findKey(i,c);(!h||i[h]===void 0||u===!0||u===void 0&&i[h]!==!1)&&(i[h||l]=Lf(a))}const o=(a,l)=>N.forEach(a,(u,c)=>s(u,c,l));return N.isPlainObject(e)||e instanceof this.constructor?o(e,n):N.isString(e)&&(e=e.trim())&&!c3(e)?o(l3(e),n):e!=null&&s(n,e,r),this}get(e,n){if(e=Ou(e),e){const r=N.findKey(this,e);if(r){const i=this[r];if(!n)return i;if(n===!0)return u3(i);if(N.isFunction(n))return n.call(this,i,r);if(N.isRegExp(n))return n.exec(i);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,n){if(e=Ou(e),e){const r=N.findKey(this,e);return!!(r&&this[r]!==void 0&&(!n||X_(this,this[r],r,n)))}return!1}delete(e,n){const r=this;let i=!1;function s(o){if(o=Ou(o),o){const a=N.findKey(r,o);a&&(!n||X_(r,r[a],a,n))&&(delete r[a],i=!0)}}return N.isArray(e)?e.forEach(s):s(e),i}clear(e){const n=Object.keys(this);let r=n.length,i=!1;for(;r--;){const s=n[r];(!e||X_(this,this[s],s,e,!0))&&(delete this[s],i=!0)}return i}normalize(e){const n=this,r={};return N.forEach(this,(i,s)=>{const o=N.findKey(r,s);if(o){n[o]=Lf(i),delete n[s];return}const a=e?h3(s):String(s).trim();a!==s&&delete n[s],n[a]=Lf(i),r[a]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const n=Object.create(null);return N.forEach(this,(r,i)=>{r!=null&&r!==!1&&(n[i]=e&&N.isArray(r)?r.join(", "):r)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,n])=>e+": "+n).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...n){const r=new this(e);return n.forEach(i=>r.set(i)),r}static accessor(e){const r=(this[H1]=this[H1]={accessors:{}}).accessors,i=this.prototype;function s(o){const a=Ou(o);r[a]||(d3(i,o),r[a]=!0)}return N.isArray(e)?e.forEach(s):s(e),this}}Um.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);N.reduceDescriptors(Um.prototype,({value:t},e)=>{let n=e[0].toUpperCase()+e.slice(1);return{get:()=>t,set(r){this[n]=r}}});N.freezeMethods(Um);const Pi=Um;function J_(t,e){const n=this||l0,r=e||n,i=Pi.from(r.headers);let s=r.data;return N.forEach(t,function(a){s=a.call(n,s,i.normalize(),e?e.status:void 0)}),i.normalize(),s}function jk(t){return!!(t&&t.__CANCEL__)}function Kh(t,e,n){_e.call(this,t??"canceled",_e.ERR_CANCELED,e,n),this.name="CanceledError"}N.inherits(Kh,_e,{__CANCEL__:!0});function f3(t,e,n){const r=n.config.validateStatus;!n.status||!r||r(n.status)?t(n):e(new _e("Request failed with status code "+n.status,[_e.ERR_BAD_REQUEST,_e.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}const p3=Cr.isStandardBrowserEnv?function(){return{write:function(n,r,i,s,o,a){const l=[];l.push(n+"="+encodeURIComponent(r)),N.isNumber(i)&&l.push("expires="+new Date(i).toGMTString()),N.isString(s)&&l.push("path="+s),N.isString(o)&&l.push("domain="+o),a===!0&&l.push("secure"),document.cookie=l.join("; ")},read:function(n){const r=document.cookie.match(new RegExp("(^|;\\s*)("+n+")=([^;]*)"));return r?decodeURIComponent(r[3]):null},remove:function(n){this.write(n,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}();function m3(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function g3(t,e){return e?t.replace(/\/+$/,"")+"/"+e.replace(/^\/+/,""):t}function qk(t,e){return t&&!m3(e)?g3(t,e):e}const _3=Cr.isStandardBrowserEnv?function(){const e=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");let r;function i(s){let o=s;return e&&(n.setAttribute("href",o),o=n.href),n.setAttribute("href",o),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:n.pathname.charAt(0)==="/"?n.pathname:"/"+n.pathname}}return r=i(window.location.href),function(o){const a=N.isString(o)?i(o):o;return a.protocol===r.protocol&&a.host===r.host}}():function(){return function(){return!0}}();function y3(t){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}function v3(t,e){t=t||10;const n=new Array(t),r=new Array(t);let i=0,s=0,o;return e=e!==void 0?e:1e3,function(l){const u=Date.now(),c=r[s];o||(o=u),n[i]=l,r[i]=u;let h=s,f=0;for(;h!==i;)f+=n[h++],h=h%t;if(i=(i+1)%t,i===s&&(s=(s+1)%t),u-o<e)return;const g=c&&u-c;return g?Math.round(f*1e3/g):void 0}}function G1(t,e){let n=0;const r=v3(50,250);return i=>{const s=i.loaded,o=i.lengthComputable?i.total:void 0,a=s-n,l=r(a),u=s<=o;n=s;const c={loaded:s,total:o,progress:o?s/o:void 0,bytes:a,rate:l||void 0,estimated:l&&o&&u?(o-s)/l:void 0,event:i};c[e?"download":"upload"]=!0,t(c)}}const w3=typeof XMLHttpRequest<"u",E3=w3&&function(t){return new Promise(function(n,r){let i=t.data;const s=Pi.from(t.headers).normalize(),o=t.responseType;let a;function l(){t.cancelToken&&t.cancelToken.unsubscribe(a),t.signal&&t.signal.removeEventListener("abort",a)}N.isFormData(i)&&(Cr.isStandardBrowserEnv||Cr.isStandardBrowserWebWorkerEnv?s.setContentType(!1):s.setContentType("multipart/form-data;",!1));let u=new XMLHttpRequest;if(t.auth){const g=t.auth.username||"",_=t.auth.password?unescape(encodeURIComponent(t.auth.password)):"";s.set("Authorization","Basic "+btoa(g+":"+_))}const c=qk(t.baseURL,t.url);u.open(t.method.toUpperCase(),$k(c,t.params,t.paramsSerializer),!0),u.timeout=t.timeout;function h(){if(!u)return;const g=Pi.from("getAllResponseHeaders"in u&&u.getAllResponseHeaders()),w={data:!o||o==="text"||o==="json"?u.responseText:u.response,status:u.status,statusText:u.statusText,headers:g,config:t,request:u};f3(function(v){n(v),l()},function(v){r(v),l()},w),u=null}if("onloadend"in u?u.onloadend=h:u.onreadystatechange=function(){!u||u.readyState!==4||u.status===0&&!(u.responseURL&&u.responseURL.indexOf("file:")===0)||setTimeout(h)},u.onabort=function(){u&&(r(new _e("Request aborted",_e.ECONNABORTED,t,u)),u=null)},u.onerror=function(){r(new _e("Network Error",_e.ERR_NETWORK,t,u)),u=null},u.ontimeout=function(){let _=t.timeout?"timeout of "+t.timeout+"ms exceeded":"timeout exceeded";const w=t.transitional||Bk;t.timeoutErrorMessage&&(_=t.timeoutErrorMessage),r(new _e(_,w.clarifyTimeoutError?_e.ETIMEDOUT:_e.ECONNABORTED,t,u)),u=null},Cr.isStandardBrowserEnv){const g=(t.withCredentials||_3(c))&&t.xsrfCookieName&&p3.read(t.xsrfCookieName);g&&s.set(t.xsrfHeaderName,g)}i===void 0&&s.setContentType(null),"setRequestHeader"in u&&N.forEach(s.toJSON(),function(_,w){u.setRequestHeader(w,_)}),N.isUndefined(t.withCredentials)||(u.withCredentials=!!t.withCredentials),o&&o!=="json"&&(u.responseType=t.responseType),typeof t.onDownloadProgress=="function"&&u.addEventListener("progress",G1(t.onDownloadProgress,!0)),typeof t.onUploadProgress=="function"&&u.upload&&u.upload.addEventListener("progress",G1(t.onUploadProgress)),(t.cancelToken||t.signal)&&(a=g=>{u&&(r(!g||g.type?new Kh(null,t,u):g),u.abort(),u=null)},t.cancelToken&&t.cancelToken.subscribe(a),t.signal&&(t.signal.aborted?a():t.signal.addEventListener("abort",a)));const f=y3(c);if(f&&Cr.protocols.indexOf(f)===-1){r(new _e("Unsupported protocol "+f+":",_e.ERR_BAD_REQUEST,t));return}u.send(i||null)})},Mf={http:GB,xhr:E3};N.forEach(Mf,(t,e)=>{if(t){try{Object.defineProperty(t,"name",{value:e})}catch{}Object.defineProperty(t,"adapterName",{value:e})}});const Wk={getAdapter:t=>{t=N.isArray(t)?t:[t];const{length:e}=t;let n,r;for(let i=0;i<e&&(n=t[i],!(r=N.isString(n)?Mf[n.toLowerCase()]:n));i++);if(!r)throw r===!1?new _e(`Adapter ${n} is not supported by the environment`,"ERR_NOT_SUPPORT"):new Error(N.hasOwnProp(Mf,n)?`Adapter '${n}' is not available in the build`:`Unknown adapter '${n}'`);if(!N.isFunction(r))throw new TypeError("adapter is not a function");return r},adapters:Mf};function Z_(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new Kh(null,t)}function K1(t){return Z_(t),t.headers=Pi.from(t.headers),t.data=J_.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),Wk.getAdapter(t.adapter||l0.adapter)(t).then(function(r){return Z_(t),r.data=J_.call(t,t.transformResponse,r),r.headers=Pi.from(r.headers),r},function(r){return jk(r)||(Z_(t),r&&r.response&&(r.response.data=J_.call(t,t.transformResponse,r.response),r.response.headers=Pi.from(r.response.headers))),Promise.reject(r)})}const Q1=t=>t instanceof Pi?t.toJSON():t;function Pl(t,e){e=e||{};const n={};function r(u,c,h){return N.isPlainObject(u)&&N.isPlainObject(c)?N.merge.call({caseless:h},u,c):N.isPlainObject(c)?N.merge({},c):N.isArray(c)?c.slice():c}function i(u,c,h){if(N.isUndefined(c)){if(!N.isUndefined(u))return r(void 0,u,h)}else return r(u,c,h)}function s(u,c){if(!N.isUndefined(c))return r(void 0,c)}function o(u,c){if(N.isUndefined(c)){if(!N.isUndefined(u))return r(void 0,u)}else return r(void 0,c)}function a(u,c,h){if(h in e)return r(u,c);if(h in t)return r(void 0,u)}const l={url:s,method:s,data:s,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:a,headers:(u,c)=>i(Q1(u),Q1(c),!0)};return N.forEach(Object.keys(Object.assign({},t,e)),function(c){const h=l[c]||i,f=h(t[c],e[c],c);N.isUndefined(f)&&h!==a||(n[c]=f)}),n}const Hk="1.5.0",u0={};["object","boolean","number","function","string","symbol"].forEach((t,e)=>{u0[t]=function(r){return typeof r===t||"a"+(e<1?"n ":" ")+t}});const Y1={};u0.transitional=function(e,n,r){function i(s,o){return"[Axios v"+Hk+"] Transitional option '"+s+"'"+o+(r?". "+r:"")}return(s,o,a)=>{if(e===!1)throw new _e(i(o," has been removed"+(n?" in "+n:"")),_e.ERR_DEPRECATED);return n&&!Y1[o]&&(Y1[o]=!0,console.warn(i(o," has been deprecated since v"+n+" and will be removed in the near future"))),e?e(s,o,a):!0}};function I3(t,e,n){if(typeof t!="object")throw new _e("options must be an object",_e.ERR_BAD_OPTION_VALUE);const r=Object.keys(t);let i=r.length;for(;i-- >0;){const s=r[i],o=e[s];if(o){const a=t[s],l=a===void 0||o(a,s,t);if(l!==!0)throw new _e("option "+s+" must be "+l,_e.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new _e("Unknown option "+s,_e.ERR_BAD_OPTION)}}const Fv={assertOptions:I3,validators:u0},Qi=Fv.validators;class Tp{constructor(e){this.defaults=e,this.interceptors={request:new W1,response:new W1}}request(e,n){typeof e=="string"?(n=n||{},n.url=e):n=e||{},n=Pl(this.defaults,n);const{transitional:r,paramsSerializer:i,headers:s}=n;r!==void 0&&Fv.assertOptions(r,{silentJSONParsing:Qi.transitional(Qi.boolean),forcedJSONParsing:Qi.transitional(Qi.boolean),clarifyTimeoutError:Qi.transitional(Qi.boolean)},!1),i!=null&&(N.isFunction(i)?n.paramsSerializer={serialize:i}:Fv.assertOptions(i,{encode:Qi.function,serialize:Qi.function},!0)),n.method=(n.method||this.defaults.method||"get").toLowerCase();let o=s&&N.merge(s.common,s[n.method]);s&&N.forEach(["delete","get","head","post","put","patch","common"],_=>{delete s[_]}),n.headers=Pi.concat(o,s);const a=[];let l=!0;this.interceptors.request.forEach(function(w){typeof w.runWhen=="function"&&w.runWhen(n)===!1||(l=l&&w.synchronous,a.unshift(w.fulfilled,w.rejected))});const u=[];this.interceptors.response.forEach(function(w){u.push(w.fulfilled,w.rejected)});let c,h=0,f;if(!l){const _=[K1.bind(this),void 0];for(_.unshift.apply(_,a),_.push.apply(_,u),f=_.length,c=Promise.resolve(n);h<f;)c=c.then(_[h++],_[h++]);return c}f=a.length;let g=n;for(h=0;h<f;){const _=a[h++],w=a[h++];try{g=_(g)}catch(T){w.call(this,T);break}}try{c=K1.call(this,g)}catch(_){return Promise.reject(_)}for(h=0,f=u.length;h<f;)c=c.then(u[h++],u[h++]);return c}getUri(e){e=Pl(this.defaults,e);const n=qk(e.baseURL,e.url);return $k(n,e.params,e.paramsSerializer)}}N.forEach(["delete","get","head","options"],function(e){Tp.prototype[e]=function(n,r){return this.request(Pl(r||{},{method:e,url:n,data:(r||{}).data}))}});N.forEach(["post","put","patch"],function(e){function n(r){return function(s,o,a){return this.request(Pl(a||{},{method:e,headers:r?{"Content-Type":"multipart/form-data"}:{},url:s,data:o}))}}Tp.prototype[e]=n(),Tp.prototype[e+"Form"]=n(!0)});const Vf=Tp;class c0{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(s){n=s});const r=this;this.promise.then(i=>{if(!r._listeners)return;let s=r._listeners.length;for(;s-- >0;)r._listeners[s](i);r._listeners=null}),this.promise.then=i=>{let s;const o=new Promise(a=>{r.subscribe(a),s=a}).then(i);return o.cancel=function(){r.unsubscribe(s)},o},e(function(s,o,a){r.reason||(r.reason=new Kh(s,o,a),n(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const n=this._listeners.indexOf(e);n!==-1&&this._listeners.splice(n,1)}static source(){let e;return{token:new c0(function(i){e=i}),cancel:e}}}const T3=c0;function S3(t){return function(n){return t.apply(null,n)}}function C3(t){return N.isObject(t)&&t.isAxiosError===!0}const Uv={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Uv).forEach(([t,e])=>{Uv[e]=t});const R3=Uv;function Gk(t){const e=new Vf(t),n=Pk(Vf.prototype.request,e);return N.extend(n,Vf.prototype,e,{allOwnKeys:!0}),N.extend(n,e,null,{allOwnKeys:!0}),n.create=function(i){return Gk(Pl(t,i))},n}const yt=Gk(l0);yt.Axios=Vf;yt.CanceledError=Kh;yt.CancelToken=T3;yt.isCancel=jk;yt.VERSION=Hk;yt.toFormData=Fm;yt.AxiosError=_e;yt.Cancel=yt.CanceledError;yt.all=function(e){return Promise.all(e)};yt.spread=S3;yt.isAxiosError=C3;yt.mergeConfig=Pl;yt.AxiosHeaders=Pi;yt.formToJSON=t=>zk(N.isHTMLForm(t)?new FormData(t):t);yt.getAdapter=Wk.getAdapter;yt.HttpStatusCode=R3;yt.default=yt;const A3=yt,Kk=A3.create({baseURL:"/api/v1"}),P3=t=>{var h;const{messages:e}=t,[n,r]=gt.useState(""),[i,s]=gt.useState(""),[o,a]=gt.useContext(Hh),{user:l}=o,u=f=>{f.preventDefault(),s(g=>f.target.value)},c=async f=>{f.preventDefault(),await Kk.post("/messages/new",{message:i,name:l.displayName,timestamp:new Date().toUTCString(),received:!0}),console.log(l.displayName),s(g=>"")};return gt.useEffect(()=>{r(Math.floor(Math.random()*5e3))},[]),K.jsxs(b3,{children:[K.jsxs("div",{className:"header",children:[K.jsx("img",{src:`https://avatars.dicebear.com/api/human/b${n}.svg`,alt:"",className:"avatar"}),K.jsxs("div",{className:"info",children:[K.jsx("h2",{children:"ChatRoom"}),K.jsx("p",{children:(h=e[e.length-1])==null?void 0:h.timestamp})]}),K.jsxs("div",{className:"rheader",children:[K.jsx("button",{className:"btn",children:K.jsx(Ak,{className:"search-icon icon"})}),K.jsx("button",{className:"btn",children:K.jsx(dB,{className:"icon"})}),K.jsx("button",{className:"btn",children:K.jsx(Rk,{className:"icon"})})]})]}),K.jsx("div",{className:"body",children:e.map(f=>{const{_id:g,message:_,name:w,timestamp:T,received:v}=f;return K.jsxs("p",{className:w===l.displayName?"message receiver":"message",children:[K.jsx("span",{className:"name",children:w}),_,K.jsx("span",{className:"timestamp",children:T})]},g)})}),K.jsxs("div",{className:"footer",children:[K.jsx(iB,{className:"icon"}),K.jsxs("form",{method:"post",children:[K.jsx("input",{type:"text",placeholder:"Type a message",value:i,onChange:u}),K.jsx("button",{type:"submit",onClick:c,children:"send a message"})]}),K.jsx(oB,{className:"icon"})]})]})},b3=Zl.div`
    display: grid;
    grid-template-rows: auto 1fr auto;
    padding:1rem;
    height:90vh;
    .header{
        display:grid;
        grid-template-columns: auto 1fr auto;
        padding: 1rem;
        align-items:center;
        border-bottom: 1px solid lightgray;
        gap: 0.5rem;
        background: white;
    }

    .avatar{
        width:3rem;
        height:3rem;
        object-fit:cover;
    }

    .icon{
    font-size:1.5rem;
    color:gray;
   }
   
   .btn{
    border: none;
    background: transparent;
   }

   .info h2{
        font-size: 1rem;
        margin-bottom: 0.5rem;
    }

    .body{
        padding:1rem;
        overflow:scroll;
    }

    .message{
        position:relative;
        background:red;
        width:fit-content;
        border-radius:1rem;
        background: white;
        margin-bottom: 1.5rem;
        font-size: 1rem;
        padding:0.5rem;
    }

    .receiver{
        margin-left:auto;
        background: #dcf8c6;
    }

    .timestamp{
        font-size: xx-small;
    }

    .name{
        position:absolute;
        top: -1rem;
        font-weight: 800;
        font-size: small;
    }

    .footer{
        display:grid;
        grid-template-columns: auto 1fr auto;
        gap:1rem;
        align-items:center;
    }

    .footer form{
        display:grid;
        grid-template-columns: 1fr auto;

    }

    .footer form input{
        outline-width: 0;
        border:none;
        padding:1rem;
        border-radius: 2rem;
    }

    .footer form button{
        display: none;
    }
`;var Qk={exports:{}};/*!
 * Pusher JavaScript Library v8.3.0
 * https://pusher.com/
 *
 * Copyright 2020, Pusher
 * Released under the MIT licence.
 */(function(t,e){(function(r,i){t.exports=i()})(window,function(){return function(n){var r={};function i(s){if(r[s])return r[s].exports;var o=r[s]={i:s,l:!1,exports:{}};return n[s].call(o.exports,o,o.exports,i),o.l=!0,o.exports}return i.m=n,i.c=r,i.d=function(s,o,a){i.o(s,o)||Object.defineProperty(s,o,{enumerable:!0,get:a})},i.r=function(s){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(s,"__esModule",{value:!0})},i.t=function(s,o){if(o&1&&(s=i(s)),o&8||o&4&&typeof s=="object"&&s&&s.__esModule)return s;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:s}),o&2&&typeof s!="string")for(var l in s)i.d(a,l,(function(u){return s[u]}).bind(null,l));return a},i.n=function(s){var o=s&&s.__esModule?function(){return s.default}:function(){return s};return i.d(o,"a",o),o},i.o=function(s,o){return Object.prototype.hasOwnProperty.call(s,o)},i.p="",i(i.s=2)}([function(n,r,i){var s=this&&this.__extends||function(){var w=function(T,v){return w=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(y,I){y.__proto__=I}||function(y,I){for(var C in I)I.hasOwnProperty(C)&&(y[C]=I[C])},w(T,v)};return function(T,v){w(T,v);function y(){this.constructor=T}T.prototype=v===null?Object.create(v):(y.prototype=v.prototype,new y)}}();Object.defineProperty(r,"__esModule",{value:!0});var o=256,a=function(){function w(T){T===void 0&&(T="="),this._paddingCharacter=T}return w.prototype.encodedLength=function(T){return this._paddingCharacter?(T+2)/3*4|0:(T*8+5)/6|0},w.prototype.encode=function(T){for(var v="",y=0;y<T.length-2;y+=3){var I=T[y]<<16|T[y+1]<<8|T[y+2];v+=this._encodeByte(I>>>3*6&63),v+=this._encodeByte(I>>>2*6&63),v+=this._encodeByte(I>>>1*6&63),v+=this._encodeByte(I>>>0*6&63)}var C=T.length-y;if(C>0){var I=T[y]<<16|(C===2?T[y+1]<<8:0);v+=this._encodeByte(I>>>3*6&63),v+=this._encodeByte(I>>>2*6&63),C===2?v+=this._encodeByte(I>>>1*6&63):v+=this._paddingCharacter||"",v+=this._paddingCharacter||""}return v},w.prototype.maxDecodedLength=function(T){return this._paddingCharacter?T/4*3|0:(T*6+7)/8|0},w.prototype.decodedLength=function(T){return this.maxDecodedLength(T.length-this._getPaddingLength(T))},w.prototype.decode=function(T){if(T.length===0)return new Uint8Array(0);for(var v=this._getPaddingLength(T),y=T.length-v,I=new Uint8Array(this.maxDecodedLength(y)),C=0,P=0,b=0,k=0,F=0,re=0,X=0;P<y-4;P+=4)k=this._decodeChar(T.charCodeAt(P+0)),F=this._decodeChar(T.charCodeAt(P+1)),re=this._decodeChar(T.charCodeAt(P+2)),X=this._decodeChar(T.charCodeAt(P+3)),I[C++]=k<<2|F>>>4,I[C++]=F<<4|re>>>2,I[C++]=re<<6|X,b|=k&o,b|=F&o,b|=re&o,b|=X&o;if(P<y-1&&(k=this._decodeChar(T.charCodeAt(P)),F=this._decodeChar(T.charCodeAt(P+1)),I[C++]=k<<2|F>>>4,b|=k&o,b|=F&o),P<y-2&&(re=this._decodeChar(T.charCodeAt(P+2)),I[C++]=F<<4|re>>>2,b|=re&o),P<y-3&&(X=this._decodeChar(T.charCodeAt(P+3)),I[C++]=re<<6|X,b|=X&o),b!==0)throw new Error("Base64Coder: incorrect characters for decoding");return I},w.prototype._encodeByte=function(T){var v=T;return v+=65,v+=25-T>>>8&0-65-26+97,v+=51-T>>>8&26-97-52+48,v+=61-T>>>8&52-48-62+43,v+=62-T>>>8&62-43-63+47,String.fromCharCode(v)},w.prototype._decodeChar=function(T){var v=o;return v+=(42-T&T-44)>>>8&-o+T-43+62,v+=(46-T&T-48)>>>8&-o+T-47+63,v+=(47-T&T-58)>>>8&-o+T-48+52,v+=(64-T&T-91)>>>8&-o+T-65+0,v+=(96-T&T-123)>>>8&-o+T-97+26,v},w.prototype._getPaddingLength=function(T){var v=0;if(this._paddingCharacter){for(var y=T.length-1;y>=0&&T[y]===this._paddingCharacter;y--)v++;if(T.length<4||v>2)throw new Error("Base64Coder: incorrect padding")}return v},w}();r.Coder=a;var l=new a;function u(w){return l.encode(w)}r.encode=u;function c(w){return l.decode(w)}r.decode=c;var h=function(w){s(T,w);function T(){return w!==null&&w.apply(this,arguments)||this}return T.prototype._encodeByte=function(v){var y=v;return y+=65,y+=25-v>>>8&0-65-26+97,y+=51-v>>>8&26-97-52+48,y+=61-v>>>8&52-48-62+45,y+=62-v>>>8&62-45-63+95,String.fromCharCode(y)},T.prototype._decodeChar=function(v){var y=o;return y+=(44-v&v-46)>>>8&-o+v-45+62,y+=(94-v&v-96)>>>8&-o+v-95+63,y+=(47-v&v-58)>>>8&-o+v-48+52,y+=(64-v&v-91)>>>8&-o+v-65+0,y+=(96-v&v-123)>>>8&-o+v-97+26,y},T}(a);r.URLSafeCoder=h;var f=new h;function g(w){return f.encode(w)}r.encodeURLSafe=g;function _(w){return f.decode(w)}r.decodeURLSafe=_,r.encodedLength=function(w){return l.encodedLength(w)},r.maxDecodedLength=function(w){return l.maxDecodedLength(w)},r.decodedLength=function(w){return l.decodedLength(w)}},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var s="utf8: invalid string",o="utf8: invalid source encoding";function a(c){for(var h=new Uint8Array(l(c)),f=0,g=0;g<c.length;g++){var _=c.charCodeAt(g);_<128?h[f++]=_:_<2048?(h[f++]=192|_>>6,h[f++]=128|_&63):_<55296?(h[f++]=224|_>>12,h[f++]=128|_>>6&63,h[f++]=128|_&63):(g++,_=(_&1023)<<10,_|=c.charCodeAt(g)&1023,_+=65536,h[f++]=240|_>>18,h[f++]=128|_>>12&63,h[f++]=128|_>>6&63,h[f++]=128|_&63)}return h}r.encode=a;function l(c){for(var h=0,f=0;f<c.length;f++){var g=c.charCodeAt(f);if(g<128)h+=1;else if(g<2048)h+=2;else if(g<55296)h+=3;else if(g<=57343){if(f>=c.length-1)throw new Error(s);f++,h+=4}else throw new Error(s)}return h}r.encodedLength=l;function u(c){for(var h=[],f=0;f<c.length;f++){var g=c[f];if(g&128){var _=void 0;if(g<224){if(f>=c.length)throw new Error(o);var w=c[++f];if((w&192)!==128)throw new Error(o);g=(g&31)<<6|w&63,_=128}else if(g<240){if(f>=c.length-1)throw new Error(o);var w=c[++f],T=c[++f];if((w&192)!==128||(T&192)!==128)throw new Error(o);g=(g&15)<<12|(w&63)<<6|T&63,_=2048}else if(g<248){if(f>=c.length-2)throw new Error(o);var w=c[++f],T=c[++f],v=c[++f];if((w&192)!==128||(T&192)!==128||(v&192)!==128)throw new Error(o);g=(g&15)<<18|(w&63)<<12|(T&63)<<6|v&63,_=65536}else throw new Error(o);if(g<_||g>=55296&&g<=57343)throw new Error(o);if(g>=65536){if(g>1114111)throw new Error(o);g-=65536,h.push(String.fromCharCode(55296|g>>10)),g=56320|g&1023}}h.push(String.fromCharCode(g))}return h.join("")}r.decode=u},function(n,r,i){n.exports=i(3).default},function(n,r,i){i.r(r);class s{constructor(d,p){this.lastId=0,this.prefix=d,this.name=p}create(d){this.lastId++;var p=this.lastId,E=this.prefix+p,S=this.name+"["+p+"]",x=!1,U=function(){x||(d.apply(null,arguments),x=!0)};return this[p]=U,{number:p,id:E,name:S,callback:U}}remove(d){delete this[d.number]}}var o=new s("_pusher_script_","Pusher.ScriptReceivers"),a={VERSION:"8.3.0",PROTOCOL:7,wsPort:80,wssPort:443,wsPath:"",httpHost:"sockjs.pusher.com",httpPort:80,httpsPort:443,httpPath:"/pusher",stats_host:"stats.pusher.com",authEndpoint:"/pusher/auth",authTransport:"ajax",activityTimeout:12e4,pongTimeout:3e4,unavailableTimeout:1e4,userAuthentication:{endpoint:"/pusher/user-auth",transport:"ajax"},channelAuthorization:{endpoint:"/pusher/auth",transport:"ajax"},cdn_http:"http://js.pusher.com",cdn_https:"https://js.pusher.com",dependency_suffix:""},l=a;class u{constructor(d){this.options=d,this.receivers=d.receivers||o,this.loading={}}load(d,p,E){var S=this;if(S.loading[d]&&S.loading[d].length>0)S.loading[d].push(E);else{S.loading[d]=[E];var x=oe.createScriptRequest(S.getPath(d,p)),U=S.receivers.create(function(G){if(S.receivers.remove(U),S.loading[d]){var ie=S.loading[d];delete S.loading[d];for(var we=function(dt){dt||x.cleanup()},Ce=0;Ce<ie.length;Ce++)ie[Ce](G,we)}});x.send(U)}}getRoot(d){var p,E=oe.getDocument().location.protocol;return d&&d.useTLS||E==="https:"?p=this.options.cdn_https:p=this.options.cdn_http,p.replace(/\/*$/,"")+"/"+this.options.version}getPath(d,p){return this.getRoot(p)+"/"+d+this.options.suffix+".js"}}var c=new s("_pusher_dependencies","Pusher.DependenciesReceivers"),h=new u({cdn_http:l.cdn_http,cdn_https:l.cdn_https,version:l.VERSION,suffix:l.dependency_suffix,receivers:c});const f={baseUrl:"https://pusher.com",urls:{authenticationEndpoint:{path:"/docs/channels/server_api/authenticating_users"},authorizationEndpoint:{path:"/docs/channels/server_api/authorizing-users/"},javascriptQuickStart:{path:"/docs/javascript_quick_start"},triggeringClientEvents:{path:"/docs/client_api_guide/client_events#trigger-events"},encryptedChannelSupport:{fullUrl:"https://github.com/pusher/pusher-js/tree/cc491015371a4bde5743d1c87a0fbac0feb53195#encrypted-channel-support"}}};var _={buildLogSuffix:function(m){const d="See:",p=f.urls[m];if(!p)return"";let E;return p.fullUrl?E=p.fullUrl:p.path&&(E=f.baseUrl+p.path),E?`${d} ${E}`:""}},w;(function(m){m.UserAuthentication="user-authentication",m.ChannelAuthorization="channel-authorization"})(w||(w={}));class T extends Error{constructor(d){super(d),Object.setPrototypeOf(this,new.target.prototype)}}class v extends Error{constructor(d){super(d),Object.setPrototypeOf(this,new.target.prototype)}}class y extends Error{constructor(d){super(d),Object.setPrototypeOf(this,new.target.prototype)}}class I extends Error{constructor(d){super(d),Object.setPrototypeOf(this,new.target.prototype)}}class C extends Error{constructor(d){super(d),Object.setPrototypeOf(this,new.target.prototype)}}class P extends Error{constructor(d){super(d),Object.setPrototypeOf(this,new.target.prototype)}}class b extends Error{constructor(d){super(d),Object.setPrototypeOf(this,new.target.prototype)}}class k extends Error{constructor(d){super(d),Object.setPrototypeOf(this,new.target.prototype)}}class F extends Error{constructor(d,p){super(p),this.status=d,Object.setPrototypeOf(this,new.target.prototype)}}var X=function(m,d,p,E,S){const x=oe.createXHR();x.open("POST",p.endpoint,!0),x.setRequestHeader("Content-Type","application/x-www-form-urlencoded");for(var U in p.headers)x.setRequestHeader(U,p.headers[U]);if(p.headersProvider!=null){let G=p.headersProvider();for(var U in G)x.setRequestHeader(U,G[U])}return x.onreadystatechange=function(){if(x.readyState===4)if(x.status===200){let G,ie=!1;try{G=JSON.parse(x.responseText),ie=!0}catch{S(new F(200,`JSON returned from ${E.toString()} endpoint was invalid, yet status code was 200. Data was: ${x.responseText}`),null)}ie&&S(null,G)}else{let G="";switch(E){case w.UserAuthentication:G=_.buildLogSuffix("authenticationEndpoint");break;case w.ChannelAuthorization:G=`Clients must be authorized to join private or presence channels. ${_.buildLogSuffix("authorizationEndpoint")}`;break}S(new F(x.status,`Unable to retrieve auth string from ${E.toString()} endpoint - received status: ${x.status} from ${p.endpoint}. ${G}`),null)}},x.send(d),x};function an(m){return wn(Iu(m))}var $n=String.fromCharCode,tr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Ta=function(m){var d=m.charCodeAt(0);return d<128?m:d<2048?$n(192|d>>>6)+$n(128|d&63):$n(224|d>>>12&15)+$n(128|d>>>6&63)+$n(128|d&63)},Iu=function(m){return m.replace(/[^\x00-\x7F]/g,Ta)},fi=function(m){var d=[0,2,1][m.length%3],p=m.charCodeAt(0)<<16|(m.length>1?m.charCodeAt(1):0)<<8|(m.length>2?m.charCodeAt(2):0),E=[tr.charAt(p>>>18),tr.charAt(p>>>12&63),d>=2?"=":tr.charAt(p>>>6&63),d>=1?"=":tr.charAt(p&63)];return E.join("")},wn=window.btoa||function(m){return m.replace(/[\s\S]{1,3}/g,fi)};class q{constructor(d,p,E,S){this.clear=p,this.timer=d(()=>{this.timer&&(this.timer=S(this.timer))},E)}isRunning(){return this.timer!==null}ensureAborted(){this.timer&&(this.clear(this.timer),this.timer=null)}}var J=q;function ee(m){window.clearTimeout(m)}function xe(m){window.clearInterval(m)}class Ie extends J{constructor(d,p){super(setTimeout,ee,d,function(E){return p(),null})}}class yr extends J{constructor(d,p){super(setInterval,xe,d,function(E){return p(),E})}}var ln={now(){return Date.now?Date.now():new Date().valueOf()},defer(m){return new Ie(0,m)},method(m,...d){var p=Array.prototype.slice.call(arguments,1);return function(E){return E[m].apply(E,p.concat(arguments))}}},Le=ln;function be(m,...d){for(var p=0;p<d.length;p++){var E=d[p];for(var S in E)E[S]&&E[S].constructor&&E[S].constructor===Object?m[S]=be(m[S]||{},E[S]):m[S]=E[S]}return m}function En(){for(var m=["Pusher"],d=0;d<arguments.length;d++)typeof arguments[d]=="string"?m.push(arguments[d]):m.push(xd(arguments[d]));return m.join(" : ")}function Sa(m,d){var p=Array.prototype.indexOf;if(m===null)return-1;if(p&&m.indexOf===p)return m.indexOf(d);for(var E=0,S=m.length;E<S;E++)if(m[E]===d)return E;return-1}function In(m,d){for(var p in m)Object.prototype.hasOwnProperty.call(m,p)&&d(m[p],p,m)}function vr(m){var d=[];return In(m,function(p,E){d.push(E)}),d}function PM(m){var d=[];return In(m,function(p){d.push(p)}),d}function Tu(m,d,p){for(var E=0;E<m.length;E++)d.call(p||window,m[E],E,m)}function GT(m,d){for(var p=[],E=0;E<m.length;E++)p.push(d(m[E],E,m,p));return p}function bM(m,d){var p={};return In(m,function(E,S){p[S]=d(E)}),p}function KT(m,d){d=d||function(S){return!!S};for(var p=[],E=0;E<m.length;E++)d(m[E],E,m,p)&&p.push(m[E]);return p}function QT(m,d){var p={};return In(m,function(E,S){(d&&d(E,S,m,p)||E)&&(p[S]=E)}),p}function kM(m){var d=[];return In(m,function(p,E){d.push([E,p])}),d}function YT(m,d){for(var p=0;p<m.length;p++)if(d(m[p],p,m))return!0;return!1}function xM(m,d){for(var p=0;p<m.length;p++)if(!d(m[p],p,m))return!1;return!0}function NM(m){return bM(m,function(d){return typeof d=="object"&&(d=xd(d)),encodeURIComponent(an(d.toString()))})}function DM(m){var d=QT(m,function(E){return E!==void 0}),p=GT(kM(NM(d)),Le.method("join","=")).join("&");return p}function OM(m){var d=[],p=[];return function E(S,x){var U,G,ie;switch(typeof S){case"object":if(!S)return null;for(U=0;U<d.length;U+=1)if(d[U]===S)return{$ref:p[U]};if(d.push(S),p.push(x),Object.prototype.toString.apply(S)==="[object Array]")for(ie=[],U=0;U<S.length;U+=1)ie[U]=E(S[U],x+"["+U+"]");else{ie={};for(G in S)Object.prototype.hasOwnProperty.call(S,G)&&(ie[G]=E(S[G],x+"["+JSON.stringify(G)+"]"))}return ie;case"number":case"string":case"boolean":return S}}(m,"$")}function xd(m){try{return JSON.stringify(m)}catch{return JSON.stringify(OM(m))}}class LM{constructor(){this.globalLog=d=>{window.console&&window.console.log&&window.console.log(d)}}debug(...d){this.log(this.globalLog,d)}warn(...d){this.log(this.globalLogWarn,d)}error(...d){this.log(this.globalLogError,d)}globalLogWarn(d){window.console&&window.console.warn?window.console.warn(d):this.globalLog(d)}globalLogError(d){window.console&&window.console.error?window.console.error(d):this.globalLogWarn(d)}log(d,...p){var E=En.apply(this,arguments);g_.log?g_.log(E):g_.logToConsole&&d.bind(this)(E)}}var Ge=new LM,MM=function(m,d,p,E,S){(p.headers!==void 0||p.headersProvider!=null)&&Ge.warn(`To send headers with the ${E.toString()} request, you must use AJAX, rather than JSONP.`);var x=m.nextAuthCallbackID.toString();m.nextAuthCallbackID++;var U=m.getDocument(),G=U.createElement("script");m.auth_callbacks[x]=function(Ce){S(null,Ce)};var ie="Pusher.auth_callbacks['"+x+"']";G.src=p.endpoint+"?callback="+encodeURIComponent(ie)+"&"+d;var we=U.getElementsByTagName("head")[0]||U.documentElement;we.insertBefore(G,we.firstChild)},VM=MM;class FM{constructor(d){this.src=d}send(d){var p=this,E="Error loading "+p.src;p.script=document.createElement("script"),p.script.id=d.id,p.script.src=p.src,p.script.type="text/javascript",p.script.charset="UTF-8",p.script.addEventListener?(p.script.onerror=function(){d.callback(E)},p.script.onload=function(){d.callback(null)}):p.script.onreadystatechange=function(){(p.script.readyState==="loaded"||p.script.readyState==="complete")&&d.callback(null)},p.script.async===void 0&&document.attachEvent&&/opera/i.test(navigator.userAgent)?(p.errorScript=document.createElement("script"),p.errorScript.id=d.id+"_error",p.errorScript.text=d.name+"('"+E+"');",p.script.async=p.errorScript.async=!1):p.script.async=!0;var S=document.getElementsByTagName("head")[0];S.insertBefore(p.script,S.firstChild),p.errorScript&&S.insertBefore(p.errorScript,p.script.nextSibling)}cleanup(){this.script&&(this.script.onload=this.script.onerror=null,this.script.onreadystatechange=null),this.script&&this.script.parentNode&&this.script.parentNode.removeChild(this.script),this.errorScript&&this.errorScript.parentNode&&this.errorScript.parentNode.removeChild(this.errorScript),this.script=null,this.errorScript=null}}class UM{constructor(d,p){this.url=d,this.data=p}send(d){if(!this.request){var p=DM(this.data),E=this.url+"/"+d.number+"?"+p;this.request=oe.createScriptRequest(E),this.request.send(d)}}cleanup(){this.request&&this.request.cleanup()}}var $M=function(m,d){return function(p,E){var S="http"+(d?"s":"")+"://",x=S+(m.host||m.options.host)+m.options.path,U=oe.createJSONPRequest(x,p),G=oe.ScriptReceivers.create(function(ie,we){o.remove(G),U.cleanup(),we&&we.host&&(m.host=we.host),E&&E(ie,we)});U.send(G)}},BM={name:"jsonp",getAgent:$M},zM=BM;function o_(m,d,p){var E=m+(d.useTLS?"s":""),S=d.useTLS?d.hostTLS:d.hostNonTLS;return E+"://"+S+p}function a_(m,d){var p="/app/"+m,E="?protocol="+l.PROTOCOL+"&client=js&version="+l.VERSION+(d?"&"+d:"");return p+E}var jM={getInitial:function(m,d){var p=(d.httpPath||"")+a_(m,"flash=false");return o_("ws",d,p)}},qM={getInitial:function(m,d){var p=(d.httpPath||"/pusher")+a_(m);return o_("http",d,p)}},WM={getInitial:function(m,d){return o_("http",d,d.httpPath||"/pusher")},getPath:function(m,d){return a_(m)}};class HM{constructor(){this._callbacks={}}get(d){return this._callbacks[l_(d)]}add(d,p,E){var S=l_(d);this._callbacks[S]=this._callbacks[S]||[],this._callbacks[S].push({fn:p,context:E})}remove(d,p,E){if(!d&&!p&&!E){this._callbacks={};return}var S=d?[l_(d)]:vr(this._callbacks);p||E?this.removeCallback(S,p,E):this.removeAllCallbacks(S)}removeCallback(d,p,E){Tu(d,function(S){this._callbacks[S]=KT(this._callbacks[S]||[],function(x){return p&&p!==x.fn||E&&E!==x.context}),this._callbacks[S].length===0&&delete this._callbacks[S]},this)}removeAllCallbacks(d){Tu(d,function(p){delete this._callbacks[p]},this)}}function l_(m){return"_"+m}class pi{constructor(d){this.callbacks=new HM,this.global_callbacks=[],this.failThrough=d}bind(d,p,E){return this.callbacks.add(d,p,E),this}bind_global(d){return this.global_callbacks.push(d),this}unbind(d,p,E){return this.callbacks.remove(d,p,E),this}unbind_global(d){return d?(this.global_callbacks=KT(this.global_callbacks||[],p=>p!==d),this):(this.global_callbacks=[],this)}unbind_all(){return this.unbind(),this.unbind_global(),this}emit(d,p,E){for(var S=0;S<this.global_callbacks.length;S++)this.global_callbacks[S](d,p);var x=this.callbacks.get(d),U=[];if(E?U.push(p,E):p&&U.push(p),x&&x.length>0)for(var S=0;S<x.length;S++)x[S].fn.apply(x[S].context||window,U);else this.failThrough&&this.failThrough(d,p);return this}}class GM extends pi{constructor(d,p,E,S,x){super(),this.initialize=oe.transportConnectionInitializer,this.hooks=d,this.name=p,this.priority=E,this.key=S,this.options=x,this.state="new",this.timeline=x.timeline,this.activityTimeout=x.activityTimeout,this.id=this.timeline.generateUniqueID()}handlesActivityChecks(){return!!this.hooks.handlesActivityChecks}supportsPing(){return!!this.hooks.supportsPing}connect(){if(this.socket||this.state!=="initialized")return!1;var d=this.hooks.urls.getInitial(this.key,this.options);try{this.socket=this.hooks.getSocket(d,this.options)}catch(p){return Le.defer(()=>{this.onError(p),this.changeState("closed")}),!1}return this.bindListeners(),Ge.debug("Connecting",{transport:this.name,url:d}),this.changeState("connecting"),!0}close(){return this.socket?(this.socket.close(),!0):!1}send(d){return this.state==="open"?(Le.defer(()=>{this.socket&&this.socket.send(d)}),!0):!1}ping(){this.state==="open"&&this.supportsPing()&&this.socket.ping()}onOpen(){this.hooks.beforeOpen&&this.hooks.beforeOpen(this.socket,this.hooks.urls.getPath(this.key,this.options)),this.changeState("open"),this.socket.onopen=void 0}onError(d){this.emit("error",{type:"WebSocketError",error:d}),this.timeline.error(this.buildTimelineMessage({error:d.toString()}))}onClose(d){d?this.changeState("closed",{code:d.code,reason:d.reason,wasClean:d.wasClean}):this.changeState("closed"),this.unbindListeners(),this.socket=void 0}onMessage(d){this.emit("message",d)}onActivity(){this.emit("activity")}bindListeners(){this.socket.onopen=()=>{this.onOpen()},this.socket.onerror=d=>{this.onError(d)},this.socket.onclose=d=>{this.onClose(d)},this.socket.onmessage=d=>{this.onMessage(d)},this.supportsPing()&&(this.socket.onactivity=()=>{this.onActivity()})}unbindListeners(){this.socket&&(this.socket.onopen=void 0,this.socket.onerror=void 0,this.socket.onclose=void 0,this.socket.onmessage=void 0,this.supportsPing()&&(this.socket.onactivity=void 0))}changeState(d,p){this.state=d,this.timeline.info(this.buildTimelineMessage({state:d,params:p})),this.emit(d,p)}buildTimelineMessage(d){return be({cid:this.id},d)}}class Ca{constructor(d){this.hooks=d}isSupported(d){return this.hooks.isSupported(d)}createConnection(d,p,E,S){return new GM(this.hooks,d,p,E,S)}}var KM=new Ca({urls:jM,handlesActivityChecks:!1,supportsPing:!1,isInitialized:function(){return!!oe.getWebSocketAPI()},isSupported:function(){return!!oe.getWebSocketAPI()},getSocket:function(m){return oe.createWebSocket(m)}}),XT={urls:qM,handlesActivityChecks:!1,supportsPing:!0,isInitialized:function(){return!0}},JT=be({getSocket:function(m){return oe.HTTPFactory.createStreamingSocket(m)}},XT),ZT=be({getSocket:function(m){return oe.HTTPFactory.createPollingSocket(m)}},XT),eS={isSupported:function(){return oe.isXHRSupported()}},QM=new Ca(be({},JT,eS)),YM=new Ca(be({},ZT,eS)),XM={ws:KM,xhr_streaming:QM,xhr_polling:YM},Nd=XM,JM=new Ca({file:"sockjs",urls:WM,handlesActivityChecks:!0,supportsPing:!1,isSupported:function(){return!0},isInitialized:function(){return window.SockJS!==void 0},getSocket:function(m,d){return new window.SockJS(m,null,{js_path:h.getPath("sockjs",{useTLS:d.useTLS}),ignore_null_origin:d.ignoreNullOrigin})},beforeOpen:function(m,d){m.send(JSON.stringify({path:d}))}}),tS={isSupported:function(m){var d=oe.isXDRSupported(m.useTLS);return d}},ZM=new Ca(be({},JT,tS)),eV=new Ca(be({},ZT,tS));Nd.xdr_streaming=ZM,Nd.xdr_polling=eV,Nd.sockjs=JM;var tV=Nd;class nV extends pi{constructor(){super();var d=this;window.addEventListener!==void 0&&(window.addEventListener("online",function(){d.emit("online")},!1),window.addEventListener("offline",function(){d.emit("offline")},!1))}isOnline(){return window.navigator.onLine===void 0?!0:window.navigator.onLine}}var rV=new nV;class iV{constructor(d,p,E){this.manager=d,this.transport=p,this.minPingDelay=E.minPingDelay,this.maxPingDelay=E.maxPingDelay,this.pingDelay=void 0}createConnection(d,p,E,S){S=be({},S,{activityTimeout:this.pingDelay});var x=this.transport.createConnection(d,p,E,S),U=null,G=function(){x.unbind("open",G),x.bind("closed",ie),U=Le.now()},ie=we=>{if(x.unbind("closed",ie),we.code===1002||we.code===1003)this.manager.reportDeath();else if(!we.wasClean&&U){var Ce=Le.now()-U;Ce<2*this.maxPingDelay&&(this.manager.reportDeath(),this.pingDelay=Math.max(Ce/2,this.minPingDelay))}};return x.bind("open",G),x}isSupported(d){return this.manager.isAlive()&&this.transport.isSupported(d)}}const nS={decodeMessage:function(m){try{var d=JSON.parse(m.data),p=d.data;if(typeof p=="string")try{p=JSON.parse(d.data)}catch{}var E={event:d.event,channel:d.channel,data:p};return d.user_id&&(E.user_id=d.user_id),E}catch(S){throw{type:"MessageParseError",error:S,data:m.data}}},encodeMessage:function(m){return JSON.stringify(m)},processHandshake:function(m){var d=nS.decodeMessage(m);if(d.event==="pusher:connection_established"){if(!d.data.activity_timeout)throw"No activity timeout specified in handshake";return{action:"connected",id:d.data.socket_id,activityTimeout:d.data.activity_timeout*1e3}}else{if(d.event==="pusher:error")return{action:this.getCloseAction(d.data),error:this.getCloseError(d.data)};throw"Invalid handshake"}},getCloseAction:function(m){return m.code<4e3?m.code>=1002&&m.code<=1004?"backoff":null:m.code===4e3?"tls_only":m.code<4100?"refused":m.code<4200?"backoff":m.code<4300?"retry":"refused"},getCloseError:function(m){return m.code!==1e3&&m.code!==1001?{type:"PusherError",data:{code:m.code,message:m.reason||m.message}}:null}};var oo=nS;class sV extends pi{constructor(d,p){super(),this.id=d,this.transport=p,this.activityTimeout=p.activityTimeout,this.bindListeners()}handlesActivityChecks(){return this.transport.handlesActivityChecks()}send(d){return this.transport.send(d)}send_event(d,p,E){var S={event:d,data:p};return E&&(S.channel=E),Ge.debug("Event sent",S),this.send(oo.encodeMessage(S))}ping(){this.transport.supportsPing()?this.transport.ping():this.send_event("pusher:ping",{})}close(){this.transport.close()}bindListeners(){var d={message:E=>{var S;try{S=oo.decodeMessage(E)}catch(x){this.emit("error",{type:"MessageParseError",error:x,data:E.data})}if(S!==void 0){switch(Ge.debug("Event recd",S),S.event){case"pusher:error":this.emit("error",{type:"PusherError",data:S.data});break;case"pusher:ping":this.emit("ping");break;case"pusher:pong":this.emit("pong");break}this.emit("message",S)}},activity:()=>{this.emit("activity")},error:E=>{this.emit("error",E)},closed:E=>{p(),E&&E.code&&this.handleCloseEvent(E),this.transport=null,this.emit("closed")}},p=()=>{In(d,(E,S)=>{this.transport.unbind(S,E)})};In(d,(E,S)=>{this.transport.bind(S,E)})}handleCloseEvent(d){var p=oo.getCloseAction(d),E=oo.getCloseError(d);E&&this.emit("error",E),p&&this.emit(p,{action:p,error:E})}}class oV{constructor(d,p){this.transport=d,this.callback=p,this.bindListeners()}close(){this.unbindListeners(),this.transport.close()}bindListeners(){this.onMessage=d=>{this.unbindListeners();var p;try{p=oo.processHandshake(d)}catch(E){this.finish("error",{error:E}),this.transport.close();return}p.action==="connected"?this.finish("connected",{connection:new sV(p.id,this.transport),activityTimeout:p.activityTimeout}):(this.finish(p.action,{error:p.error}),this.transport.close())},this.onClosed=d=>{this.unbindListeners();var p=oo.getCloseAction(d)||"backoff",E=oo.getCloseError(d);this.finish(p,{error:E})},this.transport.bind("message",this.onMessage),this.transport.bind("closed",this.onClosed)}unbindListeners(){this.transport.unbind("message",this.onMessage),this.transport.unbind("closed",this.onClosed)}finish(d,p){this.callback(be({transport:this.transport,action:d},p))}}class aV{constructor(d,p){this.timeline=d,this.options=p||{}}send(d,p){this.timeline.isEmpty()||this.timeline.send(oe.TimelineTransport.getAgent(this,d),p)}}class u_ extends pi{constructor(d,p){super(function(E,S){Ge.debug("No callbacks on "+d+" for "+E)}),this.name=d,this.pusher=p,this.subscribed=!1,this.subscriptionPending=!1,this.subscriptionCancelled=!1}authorize(d,p){return p(null,{auth:""})}trigger(d,p){if(d.indexOf("client-")!==0)throw new T("Event '"+d+"' does not start with 'client-'");if(!this.subscribed){var E=_.buildLogSuffix("triggeringClientEvents");Ge.warn(`Client event triggered before channel 'subscription_succeeded' event . ${E}`)}return this.pusher.send_event(d,p,this.name)}disconnect(){this.subscribed=!1,this.subscriptionPending=!1}handleEvent(d){var p=d.event,E=d.data;if(p==="pusher_internal:subscription_succeeded")this.handleSubscriptionSucceededEvent(d);else if(p==="pusher_internal:subscription_count")this.handleSubscriptionCountEvent(d);else if(p.indexOf("pusher_internal:")!==0){var S={};this.emit(p,E,S)}}handleSubscriptionSucceededEvent(d){this.subscriptionPending=!1,this.subscribed=!0,this.subscriptionCancelled?this.pusher.unsubscribe(this.name):this.emit("pusher:subscription_succeeded",d.data)}handleSubscriptionCountEvent(d){d.data.subscription_count&&(this.subscriptionCount=d.data.subscription_count),this.emit("pusher:subscription_count",d.data)}subscribe(){this.subscribed||(this.subscriptionPending=!0,this.subscriptionCancelled=!1,this.authorize(this.pusher.connection.socket_id,(d,p)=>{d?(this.subscriptionPending=!1,Ge.error(d.toString()),this.emit("pusher:subscription_error",Object.assign({},{type:"AuthError",error:d.message},d instanceof F?{status:d.status}:{}))):this.pusher.send_event("pusher:subscribe",{auth:p.auth,channel_data:p.channel_data,channel:this.name})}))}unsubscribe(){this.subscribed=!1,this.pusher.send_event("pusher:unsubscribe",{channel:this.name})}cancelSubscription(){this.subscriptionCancelled=!0}reinstateSubscription(){this.subscriptionCancelled=!1}}class c_ extends u_{authorize(d,p){return this.pusher.config.channelAuthorizer({channelName:this.name,socketId:d},p)}}class lV{constructor(){this.reset()}get(d){return Object.prototype.hasOwnProperty.call(this.members,d)?{id:d,info:this.members[d]}:null}each(d){In(this.members,(p,E)=>{d(this.get(E))})}setMyID(d){this.myID=d}onSubscription(d){this.members=d.presence.hash,this.count=d.presence.count,this.me=this.get(this.myID)}addMember(d){return this.get(d.user_id)===null&&this.count++,this.members[d.user_id]=d.user_info,this.get(d.user_id)}removeMember(d){var p=this.get(d.user_id);return p&&(delete this.members[d.user_id],this.count--),p}reset(){this.members={},this.count=0,this.myID=null,this.me=null}}var uV=function(m,d,p,E){function S(x){return x instanceof p?x:new p(function(U){U(x)})}return new(p||(p=Promise))(function(x,U){function G(Ce){try{we(E.next(Ce))}catch(dt){U(dt)}}function ie(Ce){try{we(E.throw(Ce))}catch(dt){U(dt)}}function we(Ce){Ce.done?x(Ce.value):S(Ce.value).then(G,ie)}we((E=E.apply(m,d||[])).next())})};class cV extends c_{constructor(d,p){super(d,p),this.members=new lV}authorize(d,p){super.authorize(d,(E,S)=>uV(this,void 0,void 0,function*(){if(!E)if(S=S,S.channel_data!=null){var x=JSON.parse(S.channel_data);this.members.setMyID(x.user_id)}else if(yield this.pusher.user.signinDonePromise,this.pusher.user.user_data!=null)this.members.setMyID(this.pusher.user.user_data.id);else{let U=_.buildLogSuffix("authorizationEndpoint");Ge.error(`Invalid auth response for channel '${this.name}', expected 'channel_data' field. ${U}, or the user should be signed in.`),p("Invalid auth response");return}p(E,S)}))}handleEvent(d){var p=d.event;if(p.indexOf("pusher_internal:")===0)this.handleInternalEvent(d);else{var E=d.data,S={};d.user_id&&(S.user_id=d.user_id),this.emit(p,E,S)}}handleInternalEvent(d){var p=d.event,E=d.data;switch(p){case"pusher_internal:subscription_succeeded":this.handleSubscriptionSucceededEvent(d);break;case"pusher_internal:subscription_count":this.handleSubscriptionCountEvent(d);break;case"pusher_internal:member_added":var S=this.members.addMember(E);this.emit("pusher:member_added",S);break;case"pusher_internal:member_removed":var x=this.members.removeMember(E);x&&this.emit("pusher:member_removed",x);break}}handleSubscriptionSucceededEvent(d){this.subscriptionPending=!1,this.subscribed=!0,this.subscriptionCancelled?this.pusher.unsubscribe(this.name):(this.members.onSubscription(d.data),this.emit("pusher:subscription_succeeded",this.members))}disconnect(){this.members.reset(),super.disconnect()}}var hV=i(1),h_=i(0);class dV extends c_{constructor(d,p,E){super(d,p),this.key=null,this.nacl=E}authorize(d,p){super.authorize(d,(E,S)=>{if(E){p(E,S);return}let x=S.shared_secret;if(!x){p(new Error(`No shared_secret key in auth payload for encrypted channel: ${this.name}`),null);return}this.key=Object(h_.decode)(x),delete S.shared_secret,p(null,S)})}trigger(d,p){throw new P("Client events are not currently supported for encrypted channels")}handleEvent(d){var p=d.event,E=d.data;if(p.indexOf("pusher_internal:")===0||p.indexOf("pusher:")===0){super.handleEvent(d);return}this.handleEncryptedEvent(p,E)}handleEncryptedEvent(d,p){if(!this.key){Ge.debug("Received encrypted event before key has been retrieved from the authEndpoint");return}if(!p.ciphertext||!p.nonce){Ge.error("Unexpected format for encrypted event, expected object with `ciphertext` and `nonce` fields, got: "+p);return}let E=Object(h_.decode)(p.ciphertext);if(E.length<this.nacl.secretbox.overheadLength){Ge.error(`Expected encrypted event ciphertext length to be ${this.nacl.secretbox.overheadLength}, got: ${E.length}`);return}let S=Object(h_.decode)(p.nonce);if(S.length<this.nacl.secretbox.nonceLength){Ge.error(`Expected encrypted event nonce length to be ${this.nacl.secretbox.nonceLength}, got: ${S.length}`);return}let x=this.nacl.secretbox.open(E,S,this.key);if(x===null){Ge.debug("Failed to decrypt an event, probably because it was encrypted with a different key. Fetching a new key from the authEndpoint..."),this.authorize(this.pusher.connection.socket_id,(U,G)=>{if(U){Ge.error(`Failed to make a request to the authEndpoint: ${G}. Unable to fetch new key, so dropping encrypted event`);return}if(x=this.nacl.secretbox.open(E,S,this.key),x===null){Ge.error("Failed to decrypt event with new key. Dropping encrypted event");return}this.emit(d,this.getDataToEmit(x))});return}this.emit(d,this.getDataToEmit(x))}getDataToEmit(d){let p=Object(hV.decode)(d);try{return JSON.parse(p)}catch{return p}}}class fV extends pi{constructor(d,p){super(),this.state="initialized",this.connection=null,this.key=d,this.options=p,this.timeline=this.options.timeline,this.usingTLS=this.options.useTLS,this.errorCallbacks=this.buildErrorCallbacks(),this.connectionCallbacks=this.buildConnectionCallbacks(this.errorCallbacks),this.handshakeCallbacks=this.buildHandshakeCallbacks(this.errorCallbacks);var E=oe.getNetwork();E.bind("online",()=>{this.timeline.info({netinfo:"online"}),(this.state==="connecting"||this.state==="unavailable")&&this.retryIn(0)}),E.bind("offline",()=>{this.timeline.info({netinfo:"offline"}),this.connection&&this.sendActivityCheck()}),this.updateStrategy()}connect(){if(!(this.connection||this.runner)){if(!this.strategy.isSupported()){this.updateState("failed");return}this.updateState("connecting"),this.startConnecting(),this.setUnavailableTimer()}}send(d){return this.connection?this.connection.send(d):!1}send_event(d,p,E){return this.connection?this.connection.send_event(d,p,E):!1}disconnect(){this.disconnectInternally(),this.updateState("disconnected")}isUsingTLS(){return this.usingTLS}startConnecting(){var d=(p,E)=>{p?this.runner=this.strategy.connect(0,d):E.action==="error"?(this.emit("error",{type:"HandshakeError",error:E.error}),this.timeline.error({handshakeError:E.error})):(this.abortConnecting(),this.handshakeCallbacks[E.action](E))};this.runner=this.strategy.connect(0,d)}abortConnecting(){this.runner&&(this.runner.abort(),this.runner=null)}disconnectInternally(){if(this.abortConnecting(),this.clearRetryTimer(),this.clearUnavailableTimer(),this.connection){var d=this.abandonConnection();d.close()}}updateStrategy(){this.strategy=this.options.getStrategy({key:this.key,timeline:this.timeline,useTLS:this.usingTLS})}retryIn(d){this.timeline.info({action:"retry",delay:d}),d>0&&this.emit("connecting_in",Math.round(d/1e3)),this.retryTimer=new Ie(d||0,()=>{this.disconnectInternally(),this.connect()})}clearRetryTimer(){this.retryTimer&&(this.retryTimer.ensureAborted(),this.retryTimer=null)}setUnavailableTimer(){this.unavailableTimer=new Ie(this.options.unavailableTimeout,()=>{this.updateState("unavailable")})}clearUnavailableTimer(){this.unavailableTimer&&this.unavailableTimer.ensureAborted()}sendActivityCheck(){this.stopActivityCheck(),this.connection.ping(),this.activityTimer=new Ie(this.options.pongTimeout,()=>{this.timeline.error({pong_timed_out:this.options.pongTimeout}),this.retryIn(0)})}resetActivityCheck(){this.stopActivityCheck(),this.connection&&!this.connection.handlesActivityChecks()&&(this.activityTimer=new Ie(this.activityTimeout,()=>{this.sendActivityCheck()}))}stopActivityCheck(){this.activityTimer&&this.activityTimer.ensureAborted()}buildConnectionCallbacks(d){return be({},d,{message:p=>{this.resetActivityCheck(),this.emit("message",p)},ping:()=>{this.send_event("pusher:pong",{})},activity:()=>{this.resetActivityCheck()},error:p=>{this.emit("error",p)},closed:()=>{this.abandonConnection(),this.shouldRetry()&&this.retryIn(1e3)}})}buildHandshakeCallbacks(d){return be({},d,{connected:p=>{this.activityTimeout=Math.min(this.options.activityTimeout,p.activityTimeout,p.connection.activityTimeout||1/0),this.clearUnavailableTimer(),this.setConnection(p.connection),this.socket_id=this.connection.id,this.updateState("connected",{socket_id:this.socket_id})}})}buildErrorCallbacks(){let d=p=>E=>{E.error&&this.emit("error",{type:"WebSocketError",error:E.error}),p(E)};return{tls_only:d(()=>{this.usingTLS=!0,this.updateStrategy(),this.retryIn(0)}),refused:d(()=>{this.disconnect()}),backoff:d(()=>{this.retryIn(1e3)}),retry:d(()=>{this.retryIn(0)})}}setConnection(d){this.connection=d;for(var p in this.connectionCallbacks)this.connection.bind(p,this.connectionCallbacks[p]);this.resetActivityCheck()}abandonConnection(){if(this.connection){this.stopActivityCheck();for(var d in this.connectionCallbacks)this.connection.unbind(d,this.connectionCallbacks[d]);var p=this.connection;return this.connection=null,p}}updateState(d,p){var E=this.state;if(this.state=d,E!==d){var S=d;S==="connected"&&(S+=" with new socket ID "+p.socket_id),Ge.debug("State changed",E+" -> "+S),this.timeline.info({state:d,params:p}),this.emit("state_change",{previous:E,current:d}),this.emit(d,p)}}shouldRetry(){return this.state==="connecting"||this.state==="connected"}}class pV{constructor(){this.channels={}}add(d,p){return this.channels[d]||(this.channels[d]=mV(d,p)),this.channels[d]}all(){return PM(this.channels)}find(d){return this.channels[d]}remove(d){var p=this.channels[d];return delete this.channels[d],p}disconnect(){In(this.channels,function(d){d.disconnect()})}}function mV(m,d){if(m.indexOf("private-encrypted-")===0){if(d.config.nacl)return mi.createEncryptedChannel(m,d,d.config.nacl);let p="Tried to subscribe to a private-encrypted- channel but no nacl implementation available",E=_.buildLogSuffix("encryptedChannelSupport");throw new P(`${p}. ${E}`)}else{if(m.indexOf("private-")===0)return mi.createPrivateChannel(m,d);if(m.indexOf("presence-")===0)return mi.createPresenceChannel(m,d);if(m.indexOf("#")===0)throw new v('Cannot create a channel with name "'+m+'".');return mi.createChannel(m,d)}}var gV={createChannels(){return new pV},createConnectionManager(m,d){return new fV(m,d)},createChannel(m,d){return new u_(m,d)},createPrivateChannel(m,d){return new c_(m,d)},createPresenceChannel(m,d){return new cV(m,d)},createEncryptedChannel(m,d,p){return new dV(m,d,p)},createTimelineSender(m,d){return new aV(m,d)},createHandshake(m,d){return new oV(m,d)},createAssistantToTheTransportManager(m,d,p){return new iV(m,d,p)}},mi=gV;class rS{constructor(d){this.options=d||{},this.livesLeft=this.options.lives||1/0}getAssistant(d){return mi.createAssistantToTheTransportManager(this,d,{minPingDelay:this.options.minPingDelay,maxPingDelay:this.options.maxPingDelay})}isAlive(){return this.livesLeft>0}reportDeath(){this.livesLeft-=1}}class ao{constructor(d,p){this.strategies=d,this.loop=!!p.loop,this.failFast=!!p.failFast,this.timeout=p.timeout,this.timeoutLimit=p.timeoutLimit}isSupported(){return YT(this.strategies,Le.method("isSupported"))}connect(d,p){var E=this.strategies,S=0,x=this.timeout,U=null,G=(ie,we)=>{we?p(null,we):(S=S+1,this.loop&&(S=S%E.length),S<E.length?(x&&(x=x*2,this.timeoutLimit&&(x=Math.min(x,this.timeoutLimit))),U=this.tryStrategy(E[S],d,{timeout:x,failFast:this.failFast},G)):p(!0))};return U=this.tryStrategy(E[S],d,{timeout:x,failFast:this.failFast},G),{abort:function(){U.abort()},forceMinPriority:function(ie){d=ie,U&&U.forceMinPriority(ie)}}}tryStrategy(d,p,E,S){var x=null,U=null;return E.timeout>0&&(x=new Ie(E.timeout,function(){U.abort(),S(!0)})),U=d.connect(p,function(G,ie){G&&x&&x.isRunning()&&!E.failFast||(x&&x.ensureAborted(),S(G,ie))}),{abort:function(){x&&x.ensureAborted(),U.abort()},forceMinPriority:function(G){U.forceMinPriority(G)}}}}class d_{constructor(d){this.strategies=d}isSupported(){return YT(this.strategies,Le.method("isSupported"))}connect(d,p){return _V(this.strategies,d,function(E,S){return function(x,U){if(S[E].error=x,x){yV(S)&&p(!0);return}Tu(S,function(G){G.forceMinPriority(U.transport.priority)}),p(null,U)}})}}function _V(m,d,p){var E=GT(m,function(S,x,U,G){return S.connect(d,p(x,G))});return{abort:function(){Tu(E,vV)},forceMinPriority:function(S){Tu(E,function(x){x.forceMinPriority(S)})}}}function yV(m){return xM(m,function(d){return!!d.error})}function vV(m){!m.error&&!m.aborted&&(m.abort(),m.aborted=!0)}class wV{constructor(d,p,E){this.strategy=d,this.transports=p,this.ttl=E.ttl||1800*1e3,this.usingTLS=E.useTLS,this.timeline=E.timeline}isSupported(){return this.strategy.isSupported()}connect(d,p){var E=this.usingTLS,S=EV(E),x=S&&S.cacheSkipCount?S.cacheSkipCount:0,U=[this.strategy];if(S&&S.timestamp+this.ttl>=Le.now()){var G=this.transports[S.transport];G&&(["ws","wss"].includes(S.transport)||x>3?(this.timeline.info({cached:!0,transport:S.transport,latency:S.latency}),U.push(new ao([G],{timeout:S.latency*2+1e3,failFast:!0}))):x++)}var ie=Le.now(),we=U.pop().connect(d,function Ce(dt,Ld){dt?(iS(E),U.length>0?(ie=Le.now(),we=U.pop().connect(d,Ce)):p(dt)):(IV(E,Ld.transport.name,Le.now()-ie,x),p(null,Ld))});return{abort:function(){we.abort()},forceMinPriority:function(Ce){d=Ce,we&&we.forceMinPriority(Ce)}}}}function f_(m){return"pusherTransport"+(m?"TLS":"NonTLS")}function EV(m){var d=oe.getLocalStorage();if(d)try{var p=d[f_(m)];if(p)return JSON.parse(p)}catch{iS(m)}return null}function IV(m,d,p,E){var S=oe.getLocalStorage();if(S)try{S[f_(m)]=xd({timestamp:Le.now(),transport:d,latency:p,cacheSkipCount:E})}catch{}}function iS(m){var d=oe.getLocalStorage();if(d)try{delete d[f_(m)]}catch{}}class Dd{constructor(d,{delay:p}){this.strategy=d,this.options={delay:p}}isSupported(){return this.strategy.isSupported()}connect(d,p){var E=this.strategy,S,x=new Ie(this.options.delay,function(){S=E.connect(d,p)});return{abort:function(){x.ensureAborted(),S&&S.abort()},forceMinPriority:function(U){d=U,S&&S.forceMinPriority(U)}}}}class Su{constructor(d,p,E){this.test=d,this.trueBranch=p,this.falseBranch=E}isSupported(){var d=this.test()?this.trueBranch:this.falseBranch;return d.isSupported()}connect(d,p){var E=this.test()?this.trueBranch:this.falseBranch;return E.connect(d,p)}}class TV{constructor(d){this.strategy=d}isSupported(){return this.strategy.isSupported()}connect(d,p){var E=this.strategy.connect(d,function(S,x){x&&E.abort(),p(S,x)});return E}}function Cu(m){return function(){return m.isSupported()}}var SV=function(m,d,p){var E={};function S(mS,TF,SF,CF,RF){var gS=p(m,mS,TF,SF,CF,RF);return E[mS]=gS,gS}var x=Object.assign({},d,{hostNonTLS:m.wsHost+":"+m.wsPort,hostTLS:m.wsHost+":"+m.wssPort,httpPath:m.wsPath}),U=Object.assign({},x,{useTLS:!0}),G=Object.assign({},d,{hostNonTLS:m.httpHost+":"+m.httpPort,hostTLS:m.httpHost+":"+m.httpsPort,httpPath:m.httpPath}),ie={loop:!0,timeout:15e3,timeoutLimit:6e4},we=new rS({minPingDelay:1e4,maxPingDelay:m.activityTimeout}),Ce=new rS({lives:2,minPingDelay:1e4,maxPingDelay:m.activityTimeout}),dt=S("ws","ws",3,x,we),Ld=S("wss","ws",3,U,we),yF=S("sockjs","sockjs",1,G),uS=S("xhr_streaming","xhr_streaming",1,G,Ce),vF=S("xdr_streaming","xdr_streaming",1,G,Ce),cS=S("xhr_polling","xhr_polling",1,G),wF=S("xdr_polling","xdr_polling",1,G),hS=new ao([dt],ie),EF=new ao([Ld],ie),IF=new ao([yF],ie),dS=new ao([new Su(Cu(uS),uS,vF)],ie),fS=new ao([new Su(Cu(cS),cS,wF)],ie),pS=new ao([new Su(Cu(dS),new d_([dS,new Dd(fS,{delay:4e3})]),fS)],ie),__=new Su(Cu(pS),pS,IF),y_;return d.useTLS?y_=new d_([hS,new Dd(__,{delay:2e3})]):y_=new d_([hS,new Dd(EF,{delay:2e3}),new Dd(__,{delay:5e3})]),new wV(new TV(new Su(Cu(dt),y_,__)),E,{ttl:18e5,timeline:d.timeline,useTLS:d.useTLS})},CV=SV,RV=function(){var m=this;m.timeline.info(m.buildTimelineMessage({transport:m.name+(m.options.useTLS?"s":"")})),m.hooks.isInitialized()?m.changeState("initialized"):m.hooks.file?(m.changeState("initializing"),h.load(m.hooks.file,{useTLS:m.options.useTLS},function(d,p){m.hooks.isInitialized()?(m.changeState("initialized"),p(!0)):(d&&m.onError(d),m.onClose(),p(!1))})):m.onClose()},AV={getRequest:function(m){var d=new window.XDomainRequest;return d.ontimeout=function(){m.emit("error",new y),m.close()},d.onerror=function(p){m.emit("error",p),m.close()},d.onprogress=function(){d.responseText&&d.responseText.length>0&&m.onChunk(200,d.responseText)},d.onload=function(){d.responseText&&d.responseText.length>0&&m.onChunk(200,d.responseText),m.emit("finished",200),m.close()},d},abortRequest:function(m){m.ontimeout=m.onerror=m.onprogress=m.onload=null,m.abort()}},PV=AV;const bV=256*1024;class kV extends pi{constructor(d,p,E){super(),this.hooks=d,this.method=p,this.url=E}start(d){this.position=0,this.xhr=this.hooks.getRequest(this),this.unloader=()=>{this.close()},oe.addUnloadListener(this.unloader),this.xhr.open(this.method,this.url,!0),this.xhr.setRequestHeader&&this.xhr.setRequestHeader("Content-Type","application/json"),this.xhr.send(d)}close(){this.unloader&&(oe.removeUnloadListener(this.unloader),this.unloader=null),this.xhr&&(this.hooks.abortRequest(this.xhr),this.xhr=null)}onChunk(d,p){for(;;){var E=this.advanceBuffer(p);if(E)this.emit("chunk",{status:d,data:E});else break}this.isBufferTooLong(p)&&this.emit("buffer_too_long")}advanceBuffer(d){var p=d.slice(this.position),E=p.indexOf(`
`);return E!==-1?(this.position+=E+1,p.slice(0,E)):null}isBufferTooLong(d){return this.position===d.length&&d.length>bV}}var p_;(function(m){m[m.CONNECTING=0]="CONNECTING",m[m.OPEN=1]="OPEN",m[m.CLOSED=3]="CLOSED"})(p_||(p_={}));var lo=p_,xV=1;class NV{constructor(d,p){this.hooks=d,this.session=oS(1e3)+"/"+MV(8),this.location=DV(p),this.readyState=lo.CONNECTING,this.openStream()}send(d){return this.sendRaw(JSON.stringify([d]))}ping(){this.hooks.sendHeartbeat(this)}close(d,p){this.onClose(d,p,!0)}sendRaw(d){if(this.readyState===lo.OPEN)try{return oe.createSocketRequest("POST",sS(OV(this.location,this.session))).start(d),!0}catch{return!1}else return!1}reconnect(){this.closeStream(),this.openStream()}onClose(d,p,E){this.closeStream(),this.readyState=lo.CLOSED,this.onclose&&this.onclose({code:d,reason:p,wasClean:E})}onChunk(d){if(d.status===200){this.readyState===lo.OPEN&&this.onActivity();var p,E=d.data.slice(0,1);switch(E){case"o":p=JSON.parse(d.data.slice(1)||"{}"),this.onOpen(p);break;case"a":p=JSON.parse(d.data.slice(1)||"[]");for(var S=0;S<p.length;S++)this.onEvent(p[S]);break;case"m":p=JSON.parse(d.data.slice(1)||"null"),this.onEvent(p);break;case"h":this.hooks.onHeartbeat(this);break;case"c":p=JSON.parse(d.data.slice(1)||"[]"),this.onClose(p[0],p[1],!0);break}}}onOpen(d){this.readyState===lo.CONNECTING?(d&&d.hostname&&(this.location.base=LV(this.location.base,d.hostname)),this.readyState=lo.OPEN,this.onopen&&this.onopen()):this.onClose(1006,"Server lost session",!0)}onEvent(d){this.readyState===lo.OPEN&&this.onmessage&&this.onmessage({data:d})}onActivity(){this.onactivity&&this.onactivity()}onError(d){this.onerror&&this.onerror(d)}openStream(){this.stream=oe.createSocketRequest("POST",sS(this.hooks.getReceiveURL(this.location,this.session))),this.stream.bind("chunk",d=>{this.onChunk(d)}),this.stream.bind("finished",d=>{this.hooks.onFinished(this,d)}),this.stream.bind("buffer_too_long",()=>{this.reconnect()});try{this.stream.start()}catch(d){Le.defer(()=>{this.onError(d),this.onClose(1006,"Could not start streaming",!1)})}}closeStream(){this.stream&&(this.stream.unbind_all(),this.stream.close(),this.stream=null)}}function DV(m){var d=/([^\?]*)\/*(\??.*)/.exec(m);return{base:d[1],queryString:d[2]}}function OV(m,d){return m.base+"/"+d+"/xhr_send"}function sS(m){var d=m.indexOf("?")===-1?"?":"&";return m+d+"t="+ +new Date+"&n="+xV++}function LV(m,d){var p=/(https?:\/\/)([^\/:]+)((\/|:)?.*)/.exec(m);return p[1]+d+p[3]}function oS(m){return oe.randomInt(m)}function MV(m){for(var d=[],p=0;p<m;p++)d.push(oS(32).toString(32));return d.join("")}var VV=NV,FV={getReceiveURL:function(m,d){return m.base+"/"+d+"/xhr_streaming"+m.queryString},onHeartbeat:function(m){m.sendRaw("[]")},sendHeartbeat:function(m){m.sendRaw("[]")},onFinished:function(m,d){m.onClose(1006,"Connection interrupted ("+d+")",!1)}},UV=FV,$V={getReceiveURL:function(m,d){return m.base+"/"+d+"/xhr"+m.queryString},onHeartbeat:function(){},sendHeartbeat:function(m){m.sendRaw("[]")},onFinished:function(m,d){d===200?m.reconnect():m.onClose(1006,"Connection interrupted ("+d+")",!1)}},BV=$V,zV={getRequest:function(m){var d=oe.getXHRAPI(),p=new d;return p.onreadystatechange=p.onprogress=function(){switch(p.readyState){case 3:p.responseText&&p.responseText.length>0&&m.onChunk(p.status,p.responseText);break;case 4:p.responseText&&p.responseText.length>0&&m.onChunk(p.status,p.responseText),m.emit("finished",p.status),m.close();break}},p},abortRequest:function(m){m.onreadystatechange=null,m.abort()}},jV=zV,qV={createStreamingSocket(m){return this.createSocket(UV,m)},createPollingSocket(m){return this.createSocket(BV,m)},createSocket(m,d){return new VV(m,d)},createXHR(m,d){return this.createRequest(jV,m,d)},createRequest(m,d,p){return new kV(m,d,p)}},aS=qV;aS.createXDR=function(m,d){return this.createRequest(PV,m,d)};var WV=aS,HV={nextAuthCallbackID:1,auth_callbacks:{},ScriptReceivers:o,DependenciesReceivers:c,getDefaultStrategy:CV,Transports:tV,transportConnectionInitializer:RV,HTTPFactory:WV,TimelineTransport:zM,getXHRAPI(){return window.XMLHttpRequest},getWebSocketAPI(){return window.WebSocket||window.MozWebSocket},setup(m){window.Pusher=m;var d=()=>{this.onDocumentBody(m.ready)};window.JSON?d():h.load("json2",{},d)},getDocument(){return document},getProtocol(){return this.getDocument().location.protocol},getAuthorizers(){return{ajax:X,jsonp:VM}},onDocumentBody(m){document.body?m():setTimeout(()=>{this.onDocumentBody(m)},0)},createJSONPRequest(m,d){return new UM(m,d)},createScriptRequest(m){return new FM(m)},getLocalStorage(){try{return window.localStorage}catch{return}},createXHR(){return this.getXHRAPI()?this.createXMLHttpRequest():this.createMicrosoftXHR()},createXMLHttpRequest(){var m=this.getXHRAPI();return new m},createMicrosoftXHR(){return new ActiveXObject("Microsoft.XMLHTTP")},getNetwork(){return rV},createWebSocket(m){var d=this.getWebSocketAPI();return new d(m)},createSocketRequest(m,d){if(this.isXHRSupported())return this.HTTPFactory.createXHR(m,d);if(this.isXDRSupported(d.indexOf("https:")===0))return this.HTTPFactory.createXDR(m,d);throw"Cross-origin HTTP requests are not supported"},isXHRSupported(){var m=this.getXHRAPI();return!!m&&new m().withCredentials!==void 0},isXDRSupported(m){var d=m?"https:":"http:",p=this.getProtocol();return!!window.XDomainRequest&&p===d},addUnloadListener(m){window.addEventListener!==void 0?window.addEventListener("unload",m,!1):window.attachEvent!==void 0&&window.attachEvent("onunload",m)},removeUnloadListener(m){window.addEventListener!==void 0?window.removeEventListener("unload",m,!1):window.detachEvent!==void 0&&window.detachEvent("onunload",m)},randomInt(m){return Math.floor(function(){return(window.crypto||window.msCrypto).getRandomValues(new Uint32Array(1))[0]/Math.pow(2,32)}()*m)}},oe=HV,m_;(function(m){m[m.ERROR=3]="ERROR",m[m.INFO=6]="INFO",m[m.DEBUG=7]="DEBUG"})(m_||(m_={}));var Od=m_;class GV{constructor(d,p,E){this.key=d,this.session=p,this.events=[],this.options=E||{},this.sent=0,this.uniqueID=0}log(d,p){d<=this.options.level&&(this.events.push(be({},p,{timestamp:Le.now()})),this.options.limit&&this.events.length>this.options.limit&&this.events.shift())}error(d){this.log(Od.ERROR,d)}info(d){this.log(Od.INFO,d)}debug(d){this.log(Od.DEBUG,d)}isEmpty(){return this.events.length===0}send(d,p){var E=be({session:this.session,bundle:this.sent+1,key:this.key,lib:"js",version:this.options.version,cluster:this.options.cluster,features:this.options.features,timeline:this.events},this.options.params);return this.events=[],d(E,(S,x)=>{S||this.sent++,p&&p(S,x)}),!0}generateUniqueID(){return this.uniqueID++,this.uniqueID}}class KV{constructor(d,p,E,S){this.name=d,this.priority=p,this.transport=E,this.options=S||{}}isSupported(){return this.transport.isSupported({useTLS:this.options.useTLS})}connect(d,p){if(this.isSupported()){if(this.priority<d)return lS(new I,p)}else return lS(new k,p);var E=!1,S=this.transport.createConnection(this.name,this.priority,this.options.key,this.options),x=null,U=function(){S.unbind("initialized",U),S.connect()},G=function(){x=mi.createHandshake(S,function(dt){E=!0,Ce(),p(null,dt)})},ie=function(dt){Ce(),p(dt)},we=function(){Ce();var dt;dt=xd(S),p(new C(dt))},Ce=function(){S.unbind("initialized",U),S.unbind("open",G),S.unbind("error",ie),S.unbind("closed",we)};return S.bind("initialized",U),S.bind("open",G),S.bind("error",ie),S.bind("closed",we),S.initialize(),{abort:()=>{E||(Ce(),x?x.close():S.close())},forceMinPriority:dt=>{E||this.priority<dt&&(x?x.close():S.close())}}}}function lS(m,d){return Le.defer(function(){d(m)}),{abort:function(){},forceMinPriority:function(){}}}const{Transports:QV}=oe;var YV=function(m,d,p,E,S,x){var U=QV[p];if(!U)throw new b(p);var G=(!m.enabledTransports||Sa(m.enabledTransports,d)!==-1)&&(!m.disabledTransports||Sa(m.disabledTransports,d)===-1),ie;return G?(S=Object.assign({ignoreNullOrigin:m.ignoreNullOrigin},S),ie=new KV(d,E,x?x.getAssistant(U):U,S)):ie=XV,ie},XV={isSupported:function(){return!1},connect:function(m,d){var p=Le.defer(function(){d(new k)});return{abort:function(){p.ensureAborted()},forceMinPriority:function(){}}}};function JV(m){if(m==null)throw"You must pass an options object";if(m.cluster==null)throw"Options object must provide a cluster";"disableStats"in m&&Ge.warn("The disableStats option is deprecated in favor of enableStats")}const ZV=(m,d)=>{var p="socket_id="+encodeURIComponent(m.socketId);for(var E in d.params)p+="&"+encodeURIComponent(E)+"="+encodeURIComponent(d.params[E]);if(d.paramsProvider!=null){let S=d.paramsProvider();for(var E in S)p+="&"+encodeURIComponent(E)+"="+encodeURIComponent(S[E])}return p};var eF=m=>{if(typeof oe.getAuthorizers()[m.transport]>"u")throw`'${m.transport}' is not a recognized auth transport`;return(d,p)=>{const E=ZV(d,m);oe.getAuthorizers()[m.transport](oe,E,m,w.UserAuthentication,p)}};const tF=(m,d)=>{var p="socket_id="+encodeURIComponent(m.socketId);p+="&channel_name="+encodeURIComponent(m.channelName);for(var E in d.params)p+="&"+encodeURIComponent(E)+"="+encodeURIComponent(d.params[E]);if(d.paramsProvider!=null){let S=d.paramsProvider();for(var E in S)p+="&"+encodeURIComponent(E)+"="+encodeURIComponent(S[E])}return p};var nF=m=>{if(typeof oe.getAuthorizers()[m.transport]>"u")throw`'${m.transport}' is not a recognized auth transport`;return(d,p)=>{const E=tF(d,m);oe.getAuthorizers()[m.transport](oe,E,m,w.ChannelAuthorization,p)}};const rF=(m,d,p)=>{const E={authTransport:d.transport,authEndpoint:d.endpoint,auth:{params:d.params,headers:d.headers}};return(S,x)=>{const U=m.channel(S.channelName);p(U,E).authorize(S.socketId,x)}};function iF(m,d){let p={activityTimeout:m.activityTimeout||l.activityTimeout,cluster:m.cluster,httpPath:m.httpPath||l.httpPath,httpPort:m.httpPort||l.httpPort,httpsPort:m.httpsPort||l.httpsPort,pongTimeout:m.pongTimeout||l.pongTimeout,statsHost:m.statsHost||l.stats_host,unavailableTimeout:m.unavailableTimeout||l.unavailableTimeout,wsPath:m.wsPath||l.wsPath,wsPort:m.wsPort||l.wsPort,wssPort:m.wssPort||l.wssPort,enableStats:uF(m),httpHost:sF(m),useTLS:lF(m),wsHost:oF(m),userAuthenticator:cF(m),channelAuthorizer:dF(m,d)};return"disabledTransports"in m&&(p.disabledTransports=m.disabledTransports),"enabledTransports"in m&&(p.enabledTransports=m.enabledTransports),"ignoreNullOrigin"in m&&(p.ignoreNullOrigin=m.ignoreNullOrigin),"timelineParams"in m&&(p.timelineParams=m.timelineParams),"nacl"in m&&(p.nacl=m.nacl),p}function sF(m){return m.httpHost?m.httpHost:m.cluster?`sockjs-${m.cluster}.pusher.com`:l.httpHost}function oF(m){return m.wsHost?m.wsHost:aF(m.cluster)}function aF(m){return`ws-${m}.pusher.com`}function lF(m){return oe.getProtocol()==="https:"?!0:m.forceTLS!==!1}function uF(m){return"enableStats"in m?m.enableStats:"disableStats"in m?!m.disableStats:!1}function cF(m){const d=Object.assign(Object.assign({},l.userAuthentication),m.userAuthentication);return"customHandler"in d&&d.customHandler!=null?d.customHandler:eF(d)}function hF(m,d){let p;return"channelAuthorization"in m?p=Object.assign(Object.assign({},l.channelAuthorization),m.channelAuthorization):(p={transport:m.authTransport||l.authTransport,endpoint:m.authEndpoint||l.authEndpoint},"auth"in m&&("params"in m.auth&&(p.params=m.auth.params),"headers"in m.auth&&(p.headers=m.auth.headers)),"authorizer"in m&&(p.customHandler=rF(d,p,m.authorizer))),p}function dF(m,d){const p=hF(m,d);return"customHandler"in p&&p.customHandler!=null?p.customHandler:nF(p)}class fF extends pi{constructor(d){super(function(p,E){Ge.debug(`No callbacks on watchlist events for ${p}`)}),this.pusher=d,this.bindWatchlistInternalEvent()}handleEvent(d){d.data.events.forEach(p=>{this.emit(p.name,p)})}bindWatchlistInternalEvent(){this.pusher.connection.bind("message",d=>{var p=d.event;p==="pusher_internal:watchlist_events"&&this.handleEvent(d)})}}function pF(){let m,d;return{promise:new Promise((E,S)=>{m=E,d=S}),resolve:m,reject:d}}var mF=pF;class gF extends pi{constructor(d){super(function(p,E){Ge.debug("No callbacks on user for "+p)}),this.signin_requested=!1,this.user_data=null,this.serverToUserChannel=null,this.signinDonePromise=null,this._signinDoneResolve=null,this._onAuthorize=(p,E)=>{if(p){Ge.warn(`Error during signin: ${p}`),this._cleanup();return}this.pusher.send_event("pusher:signin",{auth:E.auth,user_data:E.user_data})},this.pusher=d,this.pusher.connection.bind("state_change",({previous:p,current:E})=>{p!=="connected"&&E==="connected"&&this._signin(),p==="connected"&&E!=="connected"&&(this._cleanup(),this._newSigninPromiseIfNeeded())}),this.watchlist=new fF(d),this.pusher.connection.bind("message",p=>{var E=p.event;E==="pusher:signin_success"&&this._onSigninSuccess(p.data),this.serverToUserChannel&&this.serverToUserChannel.name===p.channel&&this.serverToUserChannel.handleEvent(p)})}signin(){this.signin_requested||(this.signin_requested=!0,this._signin())}_signin(){this.signin_requested&&(this._newSigninPromiseIfNeeded(),this.pusher.connection.state==="connected"&&this.pusher.config.userAuthenticator({socketId:this.pusher.connection.socket_id},this._onAuthorize))}_onSigninSuccess(d){try{this.user_data=JSON.parse(d.user_data)}catch{Ge.error(`Failed parsing user data after signin: ${d.user_data}`),this._cleanup();return}if(typeof this.user_data.id!="string"||this.user_data.id===""){Ge.error(`user_data doesn't contain an id. user_data: ${this.user_data}`),this._cleanup();return}this._signinDoneResolve(),this._subscribeChannels()}_subscribeChannels(){const d=p=>{p.subscriptionPending&&p.subscriptionCancelled?p.reinstateSubscription():!p.subscriptionPending&&this.pusher.connection.state==="connected"&&p.subscribe()};this.serverToUserChannel=new u_(`#server-to-user-${this.user_data.id}`,this.pusher),this.serverToUserChannel.bind_global((p,E)=>{p.indexOf("pusher_internal:")===0||p.indexOf("pusher:")===0||this.emit(p,E)}),d(this.serverToUserChannel)}_cleanup(){this.user_data=null,this.serverToUserChannel&&(this.serverToUserChannel.unbind_all(),this.serverToUserChannel.disconnect(),this.serverToUserChannel=null),this.signin_requested&&this._signinDoneResolve()}_newSigninPromiseIfNeeded(){if(!this.signin_requested||this.signinDonePromise&&!this.signinDonePromise.done)return;const{promise:d,resolve:p,reject:E}=mF();d.done=!1;const S=()=>{d.done=!0};d.then(S).catch(S),this.signinDonePromise=d,this._signinDoneResolve=p}}class Ut{static ready(){Ut.isReady=!0;for(var d=0,p=Ut.instances.length;d<p;d++)Ut.instances[d].connect()}static getClientFeatures(){return vr(QT({ws:oe.Transports.ws},function(d){return d.isSupported({})}))}constructor(d,p){_F(d),JV(p),this.key=d,this.config=iF(p,this),this.channels=mi.createChannels(),this.global_emitter=new pi,this.sessionID=oe.randomInt(1e9),this.timeline=new GV(this.key,this.sessionID,{cluster:this.config.cluster,features:Ut.getClientFeatures(),params:this.config.timelineParams||{},limit:50,level:Od.INFO,version:l.VERSION}),this.config.enableStats&&(this.timelineSender=mi.createTimelineSender(this.timeline,{host:this.config.statsHost,path:"/timeline/v2/"+oe.TimelineTransport.name}));var E=S=>oe.getDefaultStrategy(this.config,S,YV);this.connection=mi.createConnectionManager(this.key,{getStrategy:E,timeline:this.timeline,activityTimeout:this.config.activityTimeout,pongTimeout:this.config.pongTimeout,unavailableTimeout:this.config.unavailableTimeout,useTLS:!!this.config.useTLS}),this.connection.bind("connected",()=>{this.subscribeAll(),this.timelineSender&&this.timelineSender.send(this.connection.isUsingTLS())}),this.connection.bind("message",S=>{var x=S.event,U=x.indexOf("pusher_internal:")===0;if(S.channel){var G=this.channel(S.channel);G&&G.handleEvent(S)}U||this.global_emitter.emit(S.event,S.data)}),this.connection.bind("connecting",()=>{this.channels.disconnect()}),this.connection.bind("disconnected",()=>{this.channels.disconnect()}),this.connection.bind("error",S=>{Ge.warn(S)}),Ut.instances.push(this),this.timeline.info({instances:Ut.instances.length}),this.user=new gF(this),Ut.isReady&&this.connect()}channel(d){return this.channels.find(d)}allChannels(){return this.channels.all()}connect(){if(this.connection.connect(),this.timelineSender&&!this.timelineSenderTimer){var d=this.connection.isUsingTLS(),p=this.timelineSender;this.timelineSenderTimer=new yr(6e4,function(){p.send(d)})}}disconnect(){this.connection.disconnect(),this.timelineSenderTimer&&(this.timelineSenderTimer.ensureAborted(),this.timelineSenderTimer=null)}bind(d,p,E){return this.global_emitter.bind(d,p,E),this}unbind(d,p,E){return this.global_emitter.unbind(d,p,E),this}bind_global(d){return this.global_emitter.bind_global(d),this}unbind_global(d){return this.global_emitter.unbind_global(d),this}unbind_all(d){return this.global_emitter.unbind_all(),this}subscribeAll(){var d;for(d in this.channels.channels)this.channels.channels.hasOwnProperty(d)&&this.subscribe(d)}subscribe(d){var p=this.channels.add(d,this);return p.subscriptionPending&&p.subscriptionCancelled?p.reinstateSubscription():!p.subscriptionPending&&this.connection.state==="connected"&&p.subscribe(),p}unsubscribe(d){var p=this.channels.find(d);p&&p.subscriptionPending?p.cancelSubscription():(p=this.channels.remove(d),p&&p.subscribed&&p.unsubscribe())}send_event(d,p,E){return this.connection.send_event(d,p,E)}shouldUseTLS(){return this.config.useTLS}signin(){this.user.signin()}}Ut.instances=[],Ut.isReady=!1,Ut.logToConsole=!1,Ut.Runtime=oe,Ut.ScriptReceivers=oe.ScriptReceivers,Ut.DependenciesReceivers=oe.DependenciesReceivers,Ut.auth_callbacks=oe.auth_callbacks;var g_=r.default=Ut;function _F(m){if(m==null)throw"You must pass your app key when you instantiate Pusher."}oe.setup(Ut)}])})})(Qk);var k3=Qk.exports;const x3=qA(k3);function N3(t){return Ys({tag:"svg",attr:{version:"1.1",x:"0px",y:"0px",viewBox:"0 0 48 48",enableBackground:"new 0 0 48 48"},child:[{tag:"path",attr:{fill:"#FFC107",d:`M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12\r
	c0-6.627,5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24\r
	c0,11.045,8.955,20,20,20c11.045,0,20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z`}},{tag:"path",attr:{fill:"#FF3D00",d:`M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657\r
	C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z`}},{tag:"path",attr:{fill:"#4CAF50",d:`M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36\r
	c-5.202,0-9.619-3.317-11.283-7.946l-6.522,5.025C9.505,39.556,16.227,44,24,44z`}},{tag:"path",attr:{fill:"#1976D2",d:`M43.611,20.083H42V20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.571\r
	c0.001-0.001,0.002-0.001,0.003-0.002l6.19,5.238C36.971,39.205,44,34,44,24C44,22.659,43.862,21.35,43.611,20.083z`}}]})(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yk={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V=function(t,e){if(!t)throw tu(e)},tu=function(t){return new Error("Firebase Database ("+Yk.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xk=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},D3=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[n++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[n++],o=t[n++],a=t[n++],l=((i&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const s=t[n++],o=t[n++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},h0={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){const s=t[i],o=i+1<t.length,a=o?t[i+1]:0,l=i+2<t.length,u=l?t[i+2]:0,c=s>>2,h=(s&3)<<4|a>>4;let f=(a&15)<<2|u>>6,g=u&63;l||(g=64,o||(f=64)),r.push(n[c],n[h],n[f],n[g])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Xk(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):D3(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){const s=n[t.charAt(i++)],a=i<t.length?n[t.charAt(i)]:0;++i;const u=i<t.length?n[t.charAt(i)]:64;++i;const h=i<t.length?n[t.charAt(i)]:64;if(++i,s==null||a==null||u==null||h==null)throw new O3;const f=s<<2|a>>4;if(r.push(f),u!==64){const g=a<<4&240|u>>2;if(r.push(g),h!==64){const _=u<<6&192|h;r.push(_)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class O3 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Jk=function(t){const e=Xk(t);return h0.encodeByteArray(e,!0)},Sp=function(t){return Jk(t).replace(/\./g,"")},Cp=function(t){try{return h0.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L3(t){return eh(void 0,t)}function eh(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const n=e;return new Date(n.getTime());case Object:t===void 0&&(t={});break;case Array:t=[];break;default:return e}for(const n in e)!e.hasOwnProperty(n)||!M3(n)||(t[n]=eh(t[n],e[n]));return t}function M3(t){return t!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function V3(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F3=()=>V3().__FIREBASE_DEFAULTS__,U3=()=>{if(typeof process>"u"||typeof process.env>"u")return;const t={}.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},$3=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&Cp(t[1]);return e&&JSON.parse(e)},d0=()=>{try{return F3()||U3()||$3()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},Zk=()=>{var t;return(t=d0())===null||t===void 0?void 0:t.config},B3=t=>{var e;return(e=d0())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rn{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function f0(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t),a="";return[Sp(JSON.stringify(n)),Sp(JSON.stringify(o)),a].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ze(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function p0(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ze())}function $m(){var t;const e=(t=d0())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function z3(){return typeof self=="object"&&self.self===self}function ex(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function Bm(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function tx(){const t=Ze();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function nx(){return Yk.NODE_ADMIN===!0}function j3(){return!$m()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function th(){try{return typeof indexedDB=="object"}catch{return!1}}function q3(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W3="FirebaseError";class en extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=W3,Object.setPrototypeOf(this,en.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ha.prototype.create)}}class ha{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?H3(s,r):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new en(i,a,r)}}function H3(t,e){return t.replace(G3,(n,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const G3=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nh(t){return JSON.parse(t)}function Et(t){return JSON.stringify(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rx=function(t){let e={},n={},r={},i="";try{const s=t.split(".");e=nh(Cp(s[0])||""),n=nh(Cp(s[1])||""),i=s[2],r=n.d||{},delete n.d}catch{}return{header:e,claims:n,data:r,signature:i}},K3=function(t){const e=rx(t),n=e.claims;return!!n&&typeof n=="object"&&n.hasOwnProperty("iat")},Q3=function(t){const e=rx(t).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Ho(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]}function Rp(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Ap(t,e,n){const r={};for(const i in t)Object.prototype.hasOwnProperty.call(t,i)&&(r[i]=e.call(n,t[i],i,t));return r}function $v(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const s=t[i],o=e[i];if(X1(s)&&X1(o)){if(!$v(s,o))return!1}else if(s!==o)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function X1(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function da(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Ya(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function nc(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y3{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,n){n||(n=0);const r=this.W_;if(typeof e=="string")for(let h=0;h<16;h++)r[h]=e.charCodeAt(n)<<24|e.charCodeAt(n+1)<<16|e.charCodeAt(n+2)<<8|e.charCodeAt(n+3),n+=4;else for(let h=0;h<16;h++)r[h]=e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3],n+=4;for(let h=16;h<80;h++){const f=r[h-3]^r[h-8]^r[h-14]^r[h-16];r[h]=(f<<1|f>>>31)&4294967295}let i=this.chain_[0],s=this.chain_[1],o=this.chain_[2],a=this.chain_[3],l=this.chain_[4],u,c;for(let h=0;h<80;h++){h<40?h<20?(u=a^s&(o^a),c=1518500249):(u=s^o^a,c=1859775393):h<60?(u=s&o|a&(s|o),c=2400959708):(u=s^o^a,c=3395469782);const f=(i<<5|i>>>27)+u+l+c+r[h]&4294967295;l=a,a=o,o=(s<<30|s>>>2)&4294967295,s=i,i=f}this.chain_[0]=this.chain_[0]+i&4294967295,this.chain_[1]=this.chain_[1]+s&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+a&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295}update(e,n){if(e==null)return;n===void 0&&(n=e.length);const r=n-this.blockSize;let i=0;const s=this.buf_;let o=this.inbuf_;for(;i<n;){if(o===0)for(;i<=r;)this.compress_(e,i),i+=this.blockSize;if(typeof e=="string"){for(;i<n;)if(s[o]=e.charCodeAt(i),++o,++i,o===this.blockSize){this.compress_(s),o=0;break}}else for(;i<n;)if(s[o]=e[i],++o,++i,o===this.blockSize){this.compress_(s),o=0;break}}this.inbuf_=o,this.total_+=n}digest(){const e=[];let n=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let i=this.blockSize-1;i>=56;i--)this.buf_[i]=n&255,n/=256;this.compress_(this.buf_);let r=0;for(let i=0;i<5;i++)for(let s=24;s>=0;s-=8)e[r]=this.chain_[i]>>s&255,++r;return e}}function ix(t,e){const n=new X3(t,e);return n.subscribe.bind(n)}class X3{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let i;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");J3(e,["next","error","complete"])?i=e:i={next:e,error:n,complete:r},i.next===void 0&&(i.next=ey),i.error===void 0&&(i.error=ey),i.complete===void 0&&(i.complete=ey);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function J3(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function ey(){}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const te=function(t,e,n,r){let i;if(r<e?i="at least "+e:r>n&&(i=n===0?"none":"no more than "+n),i){const s=t+" failed: Was called with "+r+(r===1?" argument.":" arguments.")+" Expects "+i+".";throw new Error(s)}};function Mn(t,e){return`${t} failed: ${e} argument `}function Pt(t,e,n,r){if(!(r&&!n)&&typeof n!="function")throw new Error(Mn(t,e)+"must be a valid function.")}function J1(t,e,n,r){if(!(r&&!n)&&(typeof n!="object"||n===null))throw new Error(Mn(t,e)+"must be a valid context object.")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z3=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);if(i>=55296&&i<=56319){const s=i-55296;r++,V(r<t.length,"Surrogate pair missing trail surrogate.");const o=t.charCodeAt(r)-56320;i=65536+(s<<10)+o}i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):i<65536?(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},zm=function(t){let e=0;for(let n=0;n<t.length;n++){const r=t.charCodeAt(n);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,n++):e+=3}return e};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function j(t){return t&&t._delegate?t._delegate:t}class on{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fo="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bv{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new Rn;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(t5(e))try{this.getOrInitializeService({instanceIdentifier:fo})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=fo){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=fo){return this.instances.has(e)}getOptions(e=fo){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[s,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(s);r===a&&o.resolve(i)}return i}onInit(e,n){var r;const i=this.normalizeInstanceIdentifier(n),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);const o=this.instances.get(i);return o&&e(o,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const i of r)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:e5(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=fo){return this.component?this.component.multipleInstances?e:fo:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function e5(t){return t===fo?void 0:t}function t5(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sx{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new Bv(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m0=[];var pe;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(pe||(pe={}));const ox={debug:pe.DEBUG,verbose:pe.VERBOSE,info:pe.INFO,warn:pe.WARN,error:pe.ERROR,silent:pe.SILENT},n5=pe.INFO,r5={[pe.DEBUG]:"log",[pe.VERBOSE]:"log",[pe.INFO]:"info",[pe.WARN]:"warn",[pe.ERROR]:"error"},i5=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),i=r5[e];if(i)console[i](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class nu{constructor(e){this.name=e,this._logLevel=n5,this._logHandler=i5,this._userLogHandler=null,m0.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in pe))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?ox[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,pe.DEBUG,...e),this._logHandler(this,pe.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,pe.VERBOSE,...e),this._logHandler(this,pe.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,pe.INFO,...e),this._logHandler(this,pe.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,pe.WARN,...e),this._logHandler(this,pe.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,pe.ERROR,...e),this._logHandler(this,pe.ERROR,...e)}}function s5(t){m0.forEach(e=>{e.setLogLevel(t)})}function o5(t,e){for(const n of m0){let r=null;e&&e.level&&(r=ox[e.level]),t===null?n.userLogHandler=null:n.userLogHandler=(i,s,...o)=>{const a=o.map(l=>{if(l==null)return null;if(typeof l=="string")return l;if(typeof l=="number"||typeof l=="boolean")return l.toString();if(l instanceof Error)return l.message;try{return JSON.stringify(l)}catch{return null}}).filter(l=>l).join(" ");s>=(r??i.logLevel)&&t({level:pe[s].toLowerCase(),message:a,args:o,type:i.name})}}}const a5=(t,e)=>e.some(n=>t instanceof n);let Z1,eC;function l5(){return Z1||(Z1=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function u5(){return eC||(eC=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const ax=new WeakMap,zv=new WeakMap,lx=new WeakMap,ty=new WeakMap,g0=new WeakMap;function c5(t){const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",o)},s=()=>{n(Is(t.result)),i()},o=()=>{r(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&ax.set(n,t)}).catch(()=>{}),g0.set(e,t),e}function h5(t){if(zv.has(t))return;const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",o),t.removeEventListener("abort",o)},s=()=>{n(),i()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",o),t.addEventListener("abort",o)});zv.set(t,e)}let jv={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return zv.get(t);if(e==="objectStoreNames")return t.objectStoreNames||lx.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Is(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function d5(t){jv=t(jv)}function f5(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(ny(this),e,...n);return lx.set(r,e.sort?e.sort():[e]),Is(r)}:u5().includes(t)?function(...e){return t.apply(ny(this),e),Is(ax.get(this))}:function(...e){return Is(t.apply(ny(this),e))}}function p5(t){return typeof t=="function"?f5(t):(t instanceof IDBTransaction&&h5(t),a5(t,l5())?new Proxy(t,jv):t)}function Is(t){if(t instanceof IDBRequest)return c5(t);if(ty.has(t))return ty.get(t);const e=p5(t);return e!==t&&(ty.set(t,e),g0.set(e,t)),e}const ny=t=>g0.get(t);function m5(t,e,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(t,e),a=Is(o);return r&&o.addEventListener("upgradeneeded",l=>{r(Is(o.result),l.oldVersion,l.newVersion,Is(o.transaction),l)}),n&&o.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",u=>i(u.oldVersion,u.newVersion,u))}).catch(()=>{}),a}const g5=["get","getKey","getAll","getAllKeys","count"],_5=["put","add","delete","clear"],ry=new Map;function tC(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(ry.get(e))return ry.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=_5.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||g5.includes(n)))return;const s=async function(o,...a){const l=this.transaction(o,i?"readwrite":"readonly");let u=l.store;return r&&(u=u.index(a.shift())),(await Promise.all([u[n](...a),i&&l.done]))[0]};return ry.set(e,s),s}d5(t=>({...t,get:(e,n,r)=>tC(e,n)||t.get(e,n,r),has:(e,n)=>!!tC(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y5{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(v5(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function v5(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const qv="@firebase/app",nC="0.9.17";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Go=new nu("@firebase/app"),w5="@firebase/app-compat",E5="@firebase/analytics-compat",I5="@firebase/analytics",T5="@firebase/app-check-compat",S5="@firebase/app-check",C5="@firebase/auth",R5="@firebase/auth-compat",A5="@firebase/database",P5="@firebase/database-compat",b5="@firebase/functions",k5="@firebase/functions-compat",x5="@firebase/installations",N5="@firebase/installations-compat",D5="@firebase/messaging",O5="@firebase/messaging-compat",L5="@firebase/performance",M5="@firebase/performance-compat",V5="@firebase/remote-config",F5="@firebase/remote-config-compat",U5="@firebase/storage",$5="@firebase/storage-compat",B5="@firebase/firestore",z5="@firebase/firestore-compat",j5="firebase",q5="10.3.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ks="[DEFAULT]",W5={[qv]:"fire-core",[w5]:"fire-core-compat",[I5]:"fire-analytics",[E5]:"fire-analytics-compat",[S5]:"fire-app-check",[T5]:"fire-app-check-compat",[C5]:"fire-auth",[R5]:"fire-auth-compat",[A5]:"fire-rtdb",[P5]:"fire-rtdb-compat",[b5]:"fire-fn",[k5]:"fire-fn-compat",[x5]:"fire-iid",[N5]:"fire-iid-compat",[D5]:"fire-fcm",[O5]:"fire-fcm-compat",[L5]:"fire-perf",[M5]:"fire-perf-compat",[V5]:"fire-rc",[F5]:"fire-rc-compat",[U5]:"fire-gcs",[$5]:"fire-gcs-compat",[B5]:"fire-fst",[z5]:"fire-fst-compat","fire-js":"fire-js",[j5]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xs=new Map,rh=new Map;function Pp(t,e){try{t.container.addComponent(e)}catch(n){Go.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function ux(t,e){t.container.addOrOverwriteComponent(e)}function ii(t){const e=t.name;if(rh.has(e))return Go.debug(`There were multiple attempts to register component ${e}.`),!1;rh.set(e,t);for(const n of xs.values())Pp(n,t);return!0}function cx(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function H5(t,e,n=ks){cx(t,e).clearInstance(n)}function G5(){rh.clear()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K5={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."},bi=new ha("app","Firebase",K5);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Q5=class{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new on("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw bi.create("app-deleted",{appName:this._name})}};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hi=q5;function _0(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:ks,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw bi.create("bad-app-name",{appName:String(i)});if(n||(n=Zk()),!n)throw bi.create("no-options");const s=xs.get(i);if(s){if($v(n,s.options)&&$v(r,s.config))return s;throw bi.create("duplicate-app",{appName:i})}const o=new sx(i);for(const l of rh.values())o.addComponent(l);const a=new Q5(n,r,o);return xs.set(i,a),a}function Y5(t=ks){const e=xs.get(t);if(!e&&t===ks&&Zk())return _0();if(!e)throw bi.create("no-app",{appName:t});return e}function X5(){return Array.from(xs.values())}async function hx(t){const e=t.name;xs.has(e)&&(xs.delete(e),await Promise.all(t.container.getProviders().map(n=>n.delete())),t.isDeleted=!0)}function Vn(t,e,n){var r;let i=(r=W5[t])!==null&&r!==void 0?r:t;n&&(i+=`-${n}`);const s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const a=[`Unable to register library "${i}" with version "${e}":`];s&&a.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Go.warn(a.join(" "));return}ii(new on(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}function dx(t,e){if(t!==null&&typeof t!="function")throw bi.create("invalid-log-argument");o5(t,e)}function fx(t){s5(t)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J5="firebase-heartbeat-database",Z5=1,ih="firebase-heartbeat-store";let iy=null;function px(){return iy||(iy=m5(J5,Z5,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(ih)}}}).catch(t=>{throw bi.create("idb-open",{originalErrorMessage:t.message})})),iy}async function e6(t){try{return await(await px()).transaction(ih).objectStore(ih).get(mx(t))}catch(e){if(e instanceof en)Go.warn(e.message);else{const n=bi.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Go.warn(n.message)}}}async function rC(t,e){try{const r=(await px()).transaction(ih,"readwrite");await r.objectStore(ih).put(e,mx(t)),await r.done}catch(n){if(n instanceof en)Go.warn(n.message);else{const r=bi.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Go.warn(r.message)}}}function mx(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t6=1024,n6=30*24*60*60*1e3;class r6{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new s6(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=iC();if(this._heartbeatsCache===null&&(this._heartbeatsCache=await this._heartbeatsCachePromise),!(this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(i=>i.date===r)))return this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(i=>{const s=new Date(i.date).valueOf();return Date.now()-s<=n6}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache===null||this._heartbeatsCache.heartbeats.length===0)return"";const e=iC(),{heartbeatsToSend:n,unsentEntries:r}=i6(this._heartbeatsCache.heartbeats),i=Sp(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}}function iC(){return new Date().toISOString().substring(0,10)}function i6(t,e=t6){const n=[];let r=t.slice();for(const i of t){const s=n.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),sC(n)>e){s.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),sC(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class s6{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return th()?q3().then(()=>!0).catch(()=>!1):!1}async read(){return await this._canUseIndexedDBPromise?await e6(this.app)||{heartbeats:[]}:{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return rC(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return rC(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function sC(t){return Sp(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function o6(t){ii(new on("platform-logger",e=>new y5(e),"PRIVATE")),ii(new on("heartbeat",e=>new r6(e),"PRIVATE")),Vn(qv,nC,t),Vn(qv,nC,"esm2017"),Vn("fire-js","")}o6("");const a6=Object.freeze(Object.defineProperty({__proto__:null,FirebaseError:en,SDK_VERSION:hi,_DEFAULT_ENTRY_NAME:ks,_addComponent:Pp,_addOrOverwriteComponent:ux,_apps:xs,_clearComponents:G5,_components:rh,_getProvider:cx,_registerComponent:ii,_removeServiceInstance:H5,deleteApp:hx,getApp:Y5,getApps:X5,initializeApp:_0,onLog:dx,registerVersion:Vn,setLogLevel:fx},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l6{constructor(e,n){this._delegate=e,this.firebase=n,Pp(e,new on("app-compat",()=>this,"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(e=>{this._delegate.checkDestroyed(),e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),hx(this._delegate)))}_getService(e,n=ks){var r;this._delegate.checkDestroyed();const i=this._delegate.container.getProvider(e);return!i.isInitialized()&&((r=i.getComponent())===null||r===void 0?void 0:r.instantiationMode)==="EXPLICIT"&&i.initialize(),i.getImmediate({identifier:n})}_removeServiceInstance(e,n=ks){this._delegate.container.getProvider(e).clearInstance(n)}_addComponent(e){Pp(this._delegate,e)}_addOrOverwriteComponent(e){ux(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u6={"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."},oC=new ha("app-compat","Firebase",u6);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c6(t){const e={},n={__esModule:!0,initializeApp:s,app:i,registerVersion:Vn,setLogLevel:fx,onLog:dx,apps:null,SDK_VERSION:hi,INTERNAL:{registerComponent:a,removeApp:r,useAsService:l,modularAPIs:a6}};n.default=n,Object.defineProperty(n,"apps",{get:o});function r(u){delete e[u]}function i(u){if(u=u||ks,!Qn(e,u))throw oC.create("no-app",{appName:u});return e[u]}i.App=t;function s(u,c={}){const h=_0(u,c);if(Qn(e,h.name))return e[h.name];const f=new t(h,n);return e[h.name]=f,f}function o(){return Object.keys(e).map(u=>e[u])}function a(u){const c=u.name,h=c.replace("-compat","");if(ii(u)&&u.type==="PUBLIC"){const f=(g=i())=>{if(typeof g[h]!="function")throw oC.create("invalid-app-argument",{appName:c});return g[h]()};u.serviceProps!==void 0&&eh(f,u.serviceProps),n[h]=f,t.prototype[h]=function(...g){return this._getService.bind(this,c).apply(this,u.multipleInstances?g:[])}}return u.type==="PUBLIC"?n[h]:null}function l(u,c){return c==="serverAuth"?null:c}return n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gx(){const t=c6(l6);t.INTERNAL=Object.assign(Object.assign({},t.INTERNAL),{createFirebaseNamespace:gx,extendNamespace:e,createSubscribe:ix,ErrorFactory:ha,deepExtend:eh});function e(n){eh(t,n)}return t}const h6=gx();/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aC=new nu("@firebase/app-compat"),d6="@firebase/app-compat",f6="0.2.17";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p6(t){Vn(d6,f6,t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */if(z3()&&self.firebase!==void 0){aC.warn(`
    Warning: Firebase is already defined in the global scope. Please make sure
    Firebase library is only loaded once.
  `);const t=self.firebase.SDK_VERSION;t&&t.indexOf("LITE")>=0&&aC.warn(`
    Warning: You are trying to load Firebase while using Firebase Performance standalone script.
    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
    `)}const di=h6;p6();var m6="firebase",g6="10.3.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */di.registerVersion(m6,g6,"app-compat");const Lu={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"},Pa={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lC(t){return t!==void 0&&t.getResponse!==void 0}function uC(t){return t!==void 0&&t.enterprise!==void 0}class _6{constructor(e){if(this.siteKey="",this.emailPasswordEnabled=!1,e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.emailPasswordEnabled=e.recaptchaEnforcementState.some(n=>n.provider==="EMAIL_PASSWORD_PROVIDER"&&n.enforcementState!=="OFF")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y6(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend.","unsupported-password-policy-schema-version":"The password policy received from the backend uses a schema version that is not supported by this version of the Firebase SDK.","password-does-not-meet-requirements":"The password does not meet the requirements."}}function _x(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const v6=y6,w6=_x,yx=new ha("auth","Firebase",_x());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bp=new nu("@firebase/auth");function E6(t,...e){bp.logLevel<=pe.WARN&&bp.warn(`Auth (${hi}): ${t}`,...e)}function Ff(t,...e){bp.logLevel<=pe.ERROR&&bp.error(`Auth (${hi}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kt(t,...e){throw y0(t,...e)}function Wt(t,...e){return y0(t,...e)}function vx(t,e,n){const r=Object.assign(Object.assign({},w6()),{[e]:n});return new ha("auth","Firebase",r).create(e,{appName:t.name})}function ru(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&Kt(t,"argument-error"),vx(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function y0(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return yx.create(t,...e)}function M(t,e,...n){if(!t)throw y0(e,...n)}function Kr(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Ff(e),new Error(e)}function Dr(t,e){t||Kr(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sh(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function v0(){return cC()==="http:"||cC()==="https:"}function cC(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I6(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(v0()||ex()||"connection"in navigator)?navigator.onLine:!0}function T6(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qh{constructor(e,n){this.shortDelay=e,this.longDelay=n,Dr(n>e,"Short delay should be less than long delay!"),this.isMobile=p0()||Bm()}get(){return I6()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function w0(t,e){Dr(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wx{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;Kr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;Kr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;Kr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S6={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C6=new Qh(3e4,6e4);function ht(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function vt(t,e,n,r,i={}){return Ex(t,i,async()=>{let s={},o={};r&&(e==="GET"?o=r:s={body:JSON.stringify(r)});const a=da(Object.assign({key:t.config.apiKey},o)).slice(1),l=await t._getAdditionalHeaders();return l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode),wx.fetch()(Ix(t,t.config.apiHost,n,a),Object.assign({method:e,headers:l,referrerPolicy:"no-referrer"},s))})}async function Ex(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},S6),e);try{const i=new R6(t),s=await Promise.race([n(),i.promise]);i.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw rc(t,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const a=s.ok?o.errorMessage:o.error.message,[l,u]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw rc(t,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw rc(t,"email-already-in-use",o);if(l==="USER_DISABLED")throw rc(t,"user-disabled",o);const c=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw vx(t,c,u);Kt(t,c)}}catch(i){if(i instanceof en)throw i;Kt(t,"network-request-failed",{message:String(i)})}}async function zi(t,e,n,r,i={}){const s=await vt(t,e,n,r,i);return"mfaPendingCredential"in s&&Kt(t,"multi-factor-auth-required",{_serverResponse:s}),s}function Ix(t,e,n,r){const i=`${e}${n}?${r}`;return t.config.emulator?w0(t.config,i):`${t.config.apiScheme}://${i}`}class R6{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Wt(this.auth,"network-request-failed")),C6.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function rc(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=Wt(t,e,r);return i.customData._tokenResponse=n,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function A6(t){return(await vt(t,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}async function P6(t,e){return vt(t,"GET","/v2/recaptchaConfig",ht(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function b6(t,e){return vt(t,"POST","/v1/accounts:delete",e)}async function k6(t,e){return vt(t,"POST","/v1/accounts:update",e)}async function x6(t,e){return vt(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wc(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function N6(t,e=!1){const n=j(t),r=await n.getIdToken(e),i=jm(r);M(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,o=s==null?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:wc(sy(i.auth_time)),issuedAtTime:wc(sy(i.iat)),expirationTime:wc(sy(i.exp)),signInProvider:o||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function sy(t){return Number(t)*1e3}function jm(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Ff("JWT malformed, contained fewer than 3 sections"),null;try{const i=Cp(n);return i?JSON.parse(i):(Ff("Failed to decode base64 JWT payload"),null)}catch(i){return Ff("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function D6(t){const e=jm(t);return M(e,"internal-error"),M(typeof e.exp<"u","internal-error"),M(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Vi(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof en&&O6(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function O6({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L6{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const i=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tx{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=wc(this.lastLoginAt),this.creationTime=wc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oh(t){var e;const n=t.auth,r=await t.getIdToken(),i=await Vi(t,x6(n,{idToken:r}));M(i==null?void 0:i.users.length,n,"internal-error");const s=i.users[0];t._notifyReloadListener(s);const o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?F6(s.providerUserInfo):[],a=V6(t.providerData,o),l=t.isAnonymous,u=!(t.email&&s.passwordHash)&&!(a!=null&&a.length),c=l?u:!1,h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new Tx(s.createdAt,s.lastLoginAt),isAnonymous:c};Object.assign(t,h)}async function M6(t){const e=j(t);await oh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function V6(t,e){return[...t.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function F6(t){return t.map(e=>{var{providerId:n}=e,r=ZE(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function U6(t,e){const n=await Ex(t,{},async()=>{const r=da({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,o=Ix(t,i,"/v1/token",`key=${s}`),a=await t._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",wx.fetch()(o,{method:"POST",headers:a,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ah{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){M(e.idToken,"internal-error"),M(typeof e.idToken<"u","internal-error"),M(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):D6(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}async getToken(e,n=!1){return M(!this.accessToken||this.refreshToken,e,"user-token-expired"),!n&&this.accessToken&&!this.isExpired?this.accessToken:this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:i,expiresIn:s}=await U6(e,n);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:i,expirationTime:s}=n,o=new ah;return r&&(M(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(M(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(M(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new ah,this.toJSON())}_performRefresh(){return Kr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yi(t,e){M(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Lo{constructor(e){var{uid:n,auth:r,stsTokenManager:i}=e,s=ZE(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new L6(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Tx(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const n=await Vi(this,this.stsTokenManager.getToken(this.auth,e));return M(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return N6(this,e)}reload(){return M6(this)}_assign(e){this!==e&&(M(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Lo(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){M(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await oh(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){const e=await this.getIdToken();return await Vi(this,b6(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,i,s,o,a,l,u,c;const h=(r=n.displayName)!==null&&r!==void 0?r:void 0,f=(i=n.email)!==null&&i!==void 0?i:void 0,g=(s=n.phoneNumber)!==null&&s!==void 0?s:void 0,_=(o=n.photoURL)!==null&&o!==void 0?o:void 0,w=(a=n.tenantId)!==null&&a!==void 0?a:void 0,T=(l=n._redirectEventId)!==null&&l!==void 0?l:void 0,v=(u=n.createdAt)!==null&&u!==void 0?u:void 0,y=(c=n.lastLoginAt)!==null&&c!==void 0?c:void 0,{uid:I,emailVerified:C,isAnonymous:P,providerData:b,stsTokenManager:k}=n;M(I&&k,e,"internal-error");const F=ah.fromJSON(this.name,k);M(typeof I=="string",e,"internal-error"),Yi(h,e.name),Yi(f,e.name),M(typeof C=="boolean",e,"internal-error"),M(typeof P=="boolean",e,"internal-error"),Yi(g,e.name),Yi(_,e.name),Yi(w,e.name),Yi(T,e.name),Yi(v,e.name),Yi(y,e.name);const re=new Lo({uid:I,auth:e,email:f,emailVerified:C,displayName:h,isAnonymous:P,photoURL:_,phoneNumber:g,tenantId:w,stsTokenManager:F,createdAt:v,lastLoginAt:y});return b&&Array.isArray(b)&&(re.providerData=b.map(X=>Object.assign({},X))),T&&(re._redirectEventId=T),re}static async _fromIdTokenResponse(e,n,r=!1){const i=new ah;i.updateFromServerResponse(n);const s=new Lo({uid:n.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await oh(s),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hC=new Map;function Wn(t){Dr(t instanceof Function,"Expected a class definition");let e=hC.get(t);return e?(Dr(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,hC.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sx{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}Sx.type="NONE";const bl=Sx;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mo(t,e,n){return`firebase:${t}:${e}:${n}`}class il{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=Mo(this.userKey,i.apiKey,s),this.fullPersistenceKey=Mo("persistence",i.apiKey,s),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Lo._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new il(Wn(bl),e,r);const i=(await Promise.all(n.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let s=i[0]||Wn(bl);const o=Mo(r,e.config.apiKey,e.name);let a=null;for(const u of n)try{const c=await u._get(o);if(c){const h=Lo._fromJSON(e,c);u!==s&&(a=h),s=u;break}}catch{}const l=i.filter(u=>u._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new il(s,e,r):(s=l[0],a&&await s._set(o,a.toJSON()),await Promise.all(n.map(async u=>{if(u!==s)try{await u._remove(o)}catch{}})),new il(s,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dC(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Ax(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Cx(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Px(e))return"Blackberry";if(bx(e))return"Webos";if(E0(e))return"Safari";if((e.includes("chrome/")||Rx(e))&&!e.includes("edge/"))return"Chrome";if(Yh(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function Cx(t=Ze()){return/firefox\//i.test(t)}function E0(t=Ze()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Rx(t=Ze()){return/crios\//i.test(t)}function Ax(t=Ze()){return/iemobile/i.test(t)}function Yh(t=Ze()){return/android/i.test(t)}function Px(t=Ze()){return/blackberry/i.test(t)}function bx(t=Ze()){return/webos/i.test(t)}function iu(t=Ze()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function $6(t=Ze()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(t)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(t)}function B6(t=Ze()){var e;return iu(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function z6(){return tx()&&document.documentMode===10}function kx(t=Ze()){return iu(t)||Yh(t)||bx(t)||Px(t)||/windows phone/i.test(t)||Ax(t)}function j6(){try{return!!(window&&window!==window.top)}catch{return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xx(t,e=[]){let n;switch(t){case"Browser":n=dC(Ze());break;case"Worker":n=`${dC(Ze())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${hi}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q6{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=s=>new Promise((o,a)=>{try{const l=e(s);o(l)}catch(l){a(l)}});r.onAbort=n,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const i of n)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function W6(t,e={}){return vt(t,"GET","/v2/passwordPolicy",ht(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H6=6;class G6{constructor(e){var n,r,i,s;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=o.minPasswordLength)!==null&&n!==void 0?n:H6,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,i,s,o,a;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(n=l.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),l.isValid&&(l.isValid=(r=l.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(i=l.containsLowercaseLetter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(s=l.containsUppercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(o=l.containsNumericCharacter)!==null&&o!==void 0?o:!0),l.isValid&&(l.isValid=(a=l.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),l}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),i&&(n.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K6{constructor(e,n,r,i){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new fC(this),this.idTokenSubscription=new fC(this),this.beforeStateQueue=new q6(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=yx,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Wn(n)),this._initializationPromise=this.queue(async()=>{var r,i;if(!this._deleted&&(this.persistenceManager=await il.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUser(e){var n;const r=await this.assertedPersistence.getCurrentUser();let i=r,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,a=i==null?void 0:i._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&(l!=null&&l.user)&&(i=l.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(o){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return M(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await oh(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=T6()}async _delete(){this._deleted=!0}async updateCurrentUser(e){const n=e?j(e):null;return n&&M(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&M(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0)}setPersistence(e){return this.queue(async()=>{await this.assertedPersistence.setPersistence(Wn(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await W6(this),n=new G6(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new ha("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Wn(e)||this._popupRedirectResolver;M(n,this,"argument-error"),this.redirectPersistenceManager=await il.create(this,[Wn(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,i){if(this._deleted)return()=>{};const s=typeof n=="function"?n:n.next.bind(n);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(M(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof n=="function"){const l=e.addObserver(n,r,i);return()=>{o=!0,l()}}else{const l=e.addObserver(n);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return M(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=xx(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const i=await this._getAppCheckToken();return i&&(n["X-Firebase-AppCheck"]=i),n}async _getAppCheckToken(){var e;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&E6(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function it(t){return j(t)}class fC{constructor(e){this.auth=e,this.observer=null,this.addObserver=ix(n=>this.observer=n)}get next(){return M(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q6(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}function I0(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=i=>{const s=Wt("internal-error");s.customData=i,n(s)},r.type="text/javascript",r.charset="UTF-8",Q6().appendChild(r)})}function Nx(t){return`__${t}${Math.floor(Math.random()*1e6)}`}const Y6="https://www.google.com/recaptcha/enterprise.js?render=",X6="recaptcha-enterprise",J6="NO_RECAPTCHA";class Z6{constructor(e){this.type=X6,this.auth=it(e)}async verify(e="verify",n=!1){async function r(s){if(!n){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(o,a)=>{P6(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const u=new _6(l);return s.tenantId==null?s._agentRecaptchaConfig=u:s._tenantRecaptchaConfigs[s.tenantId]=u,o(u.siteKey)}}).catch(l=>{a(l)})})}function i(s,o,a){const l=window.grecaptcha;uC(l)?l.enterprise.ready(()=>{l.enterprise.execute(s,{action:e}).then(u=>{o(u)}).catch(()=>{o(J6)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((s,o)=>{r(this.auth).then(a=>{if(!n&&uC(window.grecaptcha))i(a,s,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}I0(Y6+a).then(()=>{i(a,s,o)}).catch(l=>{o(l)})}}).catch(a=>{o(a)})})}}async function Ns(t,e,n,r=!1){const i=new Z6(t);let s;try{s=await i.verify(n)}catch{s=await i.verify(n,!0)}const o=Object.assign({},e);return r?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}function ez(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Wn);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function tz(t,e,n){const r=it(t);M(r._canInitEmulator,r,"emulator-config-failed"),M(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!!(n!=null&&n.disableWarnings),s=Dx(e),{host:o,port:a}=nz(e),l=a===null?"":`:${a}`;r.config.emulator={url:`${s}//${o}${l}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||rz()}function Dx(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function nz(t){const e=Dx(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:pC(r.substr(s.length+1))}}else{const[s,o]=r.split(":");return{host:s,port:pC(o)}}}function pC(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function rz(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class su{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Kr("not implemented")}_getIdTokenResponse(e){return Kr("not implemented")}_linkToIdToken(e,n){return Kr("not implemented")}_getReauthenticationResolver(e){return Kr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ox(t,e){return vt(t,"POST","/v1/accounts:resetPassword",ht(t,e))}async function Lx(t,e){return vt(t,"POST","/v1/accounts:update",e)}async function iz(t,e){return vt(t,"POST","/v1/accounts:update",ht(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oy(t,e){return zi(t,"POST","/v1/accounts:signInWithPassword",ht(t,e))}async function qm(t,e){return vt(t,"POST","/v1/accounts:sendOobCode",ht(t,e))}async function sz(t,e){return qm(t,e)}async function ay(t,e){return qm(t,e)}async function ly(t,e){return qm(t,e)}async function oz(t,e){return qm(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function az(t,e){return zi(t,"POST","/v1/accounts:signInWithEmailLink",ht(t,e))}async function lz(t,e){return zi(t,"POST","/v1/accounts:signInWithEmailLink",ht(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lh extends su{constructor(e,n,r,i=null){super("password",r),this._email=e,this._password=n,this._tenantId=i}static _fromEmailAndPassword(e,n){return new lh(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new lh(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){var n;switch(this.signInMethod){case"password":const r={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};if(!((n=e._getRecaptchaConfig())===null||n===void 0)&&n.emailPasswordEnabled){const i=await Ns(e,r,"signInWithPassword");return oy(e,i)}else return oy(e,r).catch(async i=>{if(i.code==="auth/missing-recaptcha-token"){console.log("Sign-in with email address and password is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-in flow.");const s=await Ns(e,r,"signInWithPassword");return oy(e,s)}else return Promise.reject(i)});case"emailLink":return az(e,{email:this._email,oobCode:this._password});default:Kt(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":return Lx(e,{idToken:n,returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return lz(e,{idToken:n,email:this._email,oobCode:this._password});default:Kt(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ki(t,e){return zi(t,"POST","/v1/accounts:signInWithIdp",ht(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uz="http://localhost";class si extends su{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new si(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Kt("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i}=n,s=ZE(n,["providerId","signInMethod"]);if(!r||!i)return null;const o=new si(r,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return ki(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,ki(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,ki(e,n)}buildRequest(){const e={requestUri:uz,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=da(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cz(t,e){return vt(t,"POST","/v1/accounts:sendVerificationCode",ht(t,e))}async function hz(t,e){return zi(t,"POST","/v1/accounts:signInWithPhoneNumber",ht(t,e))}async function dz(t,e){const n=await zi(t,"POST","/v1/accounts:signInWithPhoneNumber",ht(t,e));if(n.temporaryProof)throw rc(t,"account-exists-with-different-credential",n);return n}const fz={USER_NOT_FOUND:"user-not-found"};async function pz(t,e){const n=Object.assign(Object.assign({},e),{operation:"REAUTH"});return zi(t,"POST","/v1/accounts:signInWithPhoneNumber",ht(t,n),fz)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vo extends su{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,n){return new Vo({verificationId:e,verificationCode:n})}static _fromTokenResponse(e,n){return new Vo({phoneNumber:e,temporaryProof:n})}_getIdTokenResponse(e){return hz(e,this._makeVerificationRequest())}_linkToIdToken(e,n){return dz(e,Object.assign({idToken:n},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return pz(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:n,verificationId:r,verificationCode:i}=this.params;return e&&n?{temporaryProof:e,phoneNumber:n}:{sessionInfo:r,code:i}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){typeof e=="string"&&(e=JSON.parse(e));const{verificationId:n,verificationCode:r,phoneNumber:i,temporaryProof:s}=e;return!r&&!n&&!i&&!s?null:new Vo({verificationId:n,verificationCode:r,phoneNumber:i,temporaryProof:s})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mz(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function gz(t){const e=Ya(nc(t)).link,n=e?Ya(nc(e)).deep_link_id:null,r=Ya(nc(t)).deep_link_id;return(r?Ya(nc(r)).link:null)||r||n||e||t}class Wm{constructor(e){var n,r,i,s,o,a;const l=Ya(nc(e)),u=(n=l.apiKey)!==null&&n!==void 0?n:null,c=(r=l.oobCode)!==null&&r!==void 0?r:null,h=mz((i=l.mode)!==null&&i!==void 0?i:null);M(u&&c&&h,"argument-error"),this.apiKey=u,this.operation=h,this.code=c,this.continueUrl=(s=l.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(o=l.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(a=l.tenantId)!==null&&a!==void 0?a:null}static parseLink(e){const n=gz(e);try{return new Wm(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xs{constructor(){this.providerId=Xs.PROVIDER_ID}static credential(e,n){return lh._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=Wm.parseLink(n);return M(r,"argument-error"),lh._fromEmailAndCode(e,r.code,r.tenantId)}}Xs.PROVIDER_ID="password";Xs.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Xs.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ji{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ou extends ji{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class sl extends ou{static credentialFromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;return M("providerId"in n&&"signInMethod"in n,"argument-error"),si._fromParams(n)}credential(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}_credential(e){return M(e.idToken||e.accessToken,"argument-error"),si._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(e){return sl.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return sl.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r,oauthTokenSecret:i,pendingToken:s,nonce:o,providerId:a}=e;if(!r&&!i&&!n&&!s||!a)return null;try{return new sl(a)._credential({idToken:n,accessToken:r,nonce:o,pendingToken:s})}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zr extends ou{constructor(){super("facebook.com")}static credential(e){return si._fromParams({providerId:zr.PROVIDER_ID,signInMethod:zr.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return zr.credentialFromTaggedObject(e)}static credentialFromError(e){return zr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return zr.credential(e.oauthAccessToken)}catch{return null}}}zr.FACEBOOK_SIGN_IN_METHOD="facebook.com";zr.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jr extends ou{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return si._fromParams({providerId:jr.PROVIDER_ID,signInMethod:jr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return jr.credentialFromTaggedObject(e)}static credentialFromError(e){return jr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return jr.credential(n,r)}catch{return null}}}jr.GOOGLE_SIGN_IN_METHOD="google.com";jr.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qr extends ou{constructor(){super("github.com")}static credential(e){return si._fromParams({providerId:qr.PROVIDER_ID,signInMethod:qr.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return qr.credentialFromTaggedObject(e)}static credentialFromError(e){return qr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return qr.credential(e.oauthAccessToken)}catch{return null}}}qr.GITHUB_SIGN_IN_METHOD="github.com";qr.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _z="http://localhost";class kl extends su{constructor(e,n){super(e,e),this.pendingToken=n}_getIdTokenResponse(e){const n=this.buildRequest();return ki(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,ki(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,ki(e,n)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,pendingToken:s}=n;return!r||!i||!s||r!==i?null:new kl(r,s)}static _create(e,n){return new kl(e,n)}buildRequest(){return{requestUri:_z,returnSecureToken:!0,pendingToken:this.pendingToken}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yz="saml.";class kp extends ji{constructor(e){M(e.startsWith(yz),"argument-error"),super(e)}static credentialFromResult(e){return kp.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return kp.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){const n=kl.fromJSON(e);return M(n,"argument-error"),n}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{pendingToken:n,providerId:r}=e;if(!n||!r)return null;try{return kl._create(r,n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wr extends ou{constructor(){super("twitter.com")}static credential(e,n){return si._fromParams({providerId:Wr.PROVIDER_ID,signInMethod:Wr.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Wr.credentialFromTaggedObject(e)}static credentialFromError(e){return Wr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return Wr.credential(n,r)}catch{return null}}}Wr.TWITTER_SIGN_IN_METHOD="twitter.com";Wr.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Uf(t,e){return zi(t,"POST","/v1/accounts:signUp",ht(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gr{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,i=!1){const s=await Lo._fromIdTokenResponse(e,r,i),o=mC(r);return new gr({user:s,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const i=mC(r);return new gr({user:e,providerId:i,_tokenResponse:r,operationType:n})}}function mC(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vz(t){var e;const n=it(t);if(await n._initializationPromise,!((e=n.currentUser)===null||e===void 0)&&e.isAnonymous)return new gr({user:n.currentUser,providerId:null,operationType:"signIn"});const r=await Uf(n,{returnSecureToken:!0}),i=await gr._fromIdTokenResponse(n,"signIn",r,!0);return await n._updateCurrentUser(i.user),i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xp extends en{constructor(e,n,r,i){var s;super(n.code,n.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,xp.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,i){return new xp(e,n,r,i)}}function Mx(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?xp._fromErrorAndOperation(t,s,e,r):s})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vx(t){return new Set(t.map(({providerId:e})=>e).filter(e=>!!e))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wz(t,e){const n=j(t);await Hm(!0,n,e);const{providerUserInfo:r}=await k6(n.auth,{idToken:await n.getIdToken(),deleteProvider:[e]}),i=Vx(r||[]);return n.providerData=n.providerData.filter(s=>i.has(s.providerId)),i.has("phone")||(n.phoneNumber=null),await n.auth._persistUserIfCurrent(n),n}async function T0(t,e,n=!1){const r=await Vi(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return gr._forOperation(t,"link",r)}async function Hm(t,e,n){await oh(e);const r=Vx(e.providerData),i=t===!1?"provider-already-linked":"no-such-provider";M(r.has(n)===t,e.auth,i)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Fx(t,e,n=!1){const{auth:r}=t,i="reauthenticate";try{const s=await Vi(t,Mx(r,i,e,t),n);M(s.idToken,r,"internal-error");const o=jm(s.idToken);M(o,r,"internal-error");const{sub:a}=o;return M(t.uid===a,r,"user-mismatch"),gr._forOperation(t,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&Kt(r,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ux(t,e,n=!1){const r="signIn",i=await Mx(t,r,e),s=await gr._fromIdTokenResponse(t,r,i);return n||await t._updateCurrentUser(s.user),s}async function Gm(t,e){return Ux(it(t),e)}async function $x(t,e){const n=j(t);return await Hm(!1,n,e.providerId),T0(n,e)}async function Bx(t,e){return Fx(j(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ez(t,e){return zi(t,"POST","/v1/accounts:signInWithCustomToken",ht(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Iz(t,e){const n=it(t),r=await Ez(n,{token:e,returnSecureToken:!0}),i=await gr._fromIdTokenResponse(n,"signIn",r);return await n._updateCurrentUser(i.user),i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xh{constructor(e,n){this.factorId=e,this.uid=n.mfaEnrollmentId,this.enrollmentTime=new Date(n.enrolledAt).toUTCString(),this.displayName=n.displayName}static _fromServerResponse(e,n){return"phoneInfo"in n?S0._fromServerResponse(e,n):"totpInfo"in n?C0._fromServerResponse(e,n):Kt(e,"internal-error")}}class S0 extends Xh{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,n){return new S0(n)}}class C0 extends Xh{constructor(e){super("totp",e)}static _fromServerResponse(e,n){return new C0(n)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ol(t,e,n){var r;M(((r=n.url)===null||r===void 0?void 0:r.length)>0,t,"invalid-continue-uri"),M(typeof n.dynamicLinkDomain>"u"||n.dynamicLinkDomain.length>0,t,"invalid-dynamic-link-domain"),e.continueUrl=n.url,e.dynamicLinkDomain=n.dynamicLinkDomain,e.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(M(n.iOS.bundleId.length>0,t,"missing-ios-bundle-id"),e.iOSBundleId=n.iOS.bundleId),n.android&&(M(n.android.packageName.length>0,t,"missing-android-pkg-name"),e.androidInstallApp=n.android.installApp,e.androidMinimumVersionCode=n.android.minimumVersion,e.androidPackageName=n.android.packageName)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function R0(t){const e=it(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function Tz(t,e,n){var r;const i=it(t),s={requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"};if(!((r=i._getRecaptchaConfig())===null||r===void 0)&&r.emailPasswordEnabled){const o=await Ns(i,s,"getOobCode",!0);n&&ol(i,o,n),await ay(i,o)}else n&&ol(i,s,n),await ay(i,s).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log("Password resets are protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the password reset flow.");const a=await Ns(i,s,"getOobCode",!0);n&&ol(i,a,n),await ay(i,a)}else return Promise.reject(o)})}async function Sz(t,e,n){await Ox(j(t),{oobCode:e,newPassword:n}).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&R0(t),r})}async function Cz(t,e){await iz(j(t),{oobCode:e})}async function zx(t,e){const n=j(t),r=await Ox(n,{oobCode:e}),i=r.requestType;switch(M(i,n,"internal-error"),i){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":M(r.newEmail,n,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":M(r.mfaInfo,n,"internal-error");default:M(r.email,n,"internal-error")}let s=null;return r.mfaInfo&&(s=Xh._fromServerResponse(it(n),r.mfaInfo)),{data:{email:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.newEmail:r.email)||null,previousEmail:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.email:r.newEmail)||null,multiFactorInfo:s},operation:i}}async function Rz(t,e){const{data:n}=await zx(j(t),e);return n.email}async function Az(t,e,n){var r;const i=it(t),s={returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"};let o;if(!((r=i._getRecaptchaConfig())===null||r===void 0)&&r.emailPasswordEnabled){const u=await Ns(i,s,"signUpPassword");o=Uf(i,u)}else o=Uf(i,s).catch(async u=>{if(u.code==="auth/missing-recaptcha-token"){console.log("Sign-up is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-up flow.");const c=await Ns(i,s,"signUpPassword");return Uf(i,c)}throw u});const a=await o.catch(u=>{throw u.code==="auth/password-does-not-meet-requirements"&&R0(t),u}),l=await gr._fromIdTokenResponse(i,"signIn",a);return await i._updateCurrentUser(l.user),l}function Pz(t,e,n){return Gm(j(t),Xs.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&R0(t),r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bz(t,e,n){var r;const i=it(t),s={requestType:"EMAIL_SIGNIN",email:e,clientType:"CLIENT_TYPE_WEB"};function o(a,l){M(l.handleCodeInApp,i,"argument-error"),l&&ol(i,a,l)}if(!((r=i._getRecaptchaConfig())===null||r===void 0)&&r.emailPasswordEnabled){const a=await Ns(i,s,"getOobCode",!0);o(a,n),await ly(i,a)}else o(s,n),await ly(i,s).catch(async a=>{if(a.code==="auth/missing-recaptcha-token"){console.log("Email link sign-in is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-in flow.");const l=await Ns(i,s,"getOobCode",!0);o(l,n),await ly(i,l)}else return Promise.reject(a)})}function kz(t,e){const n=Wm.parseLink(e);return(n==null?void 0:n.operation)==="EMAIL_SIGNIN"}async function xz(t,e,n){const r=j(t),i=Xs.credentialWithLink(e,n||sh());return M(i._tenantId===(r.tenantId||null),r,"tenant-id-mismatch"),Gm(r,i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Nz(t,e){return vt(t,"POST","/v1/accounts:createAuthUri",ht(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Dz(t,e){const n=v0()?sh():"http://localhost",r={identifier:e,continueUri:n},{signinMethods:i}=await Nz(j(t),r);return i||[]}async function Oz(t,e){const n=j(t),i={requestType:"VERIFY_EMAIL",idToken:await t.getIdToken()};e&&ol(n.auth,i,e);const{email:s}=await sz(n.auth,i);s!==t.email&&await t.reload()}async function Lz(t,e,n){const r=j(t),s={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:await t.getIdToken(),newEmail:e};n&&ol(r.auth,s,n);const{email:o}=await oz(r.auth,s);o!==t.email&&await t.reload()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Mz(t,e){return vt(t,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Vz(t,{displayName:e,photoURL:n}){if(e===void 0&&n===void 0)return;const r=j(t),s={idToken:await r.getIdToken(),displayName:e,photoUrl:n,returnSecureToken:!0},o=await Vi(r,Mz(r.auth,s));r.displayName=o.displayName||null,r.photoURL=o.photoUrl||null;const a=r.providerData.find(({providerId:l})=>l==="password");a&&(a.displayName=r.displayName,a.photoURL=r.photoURL),await r._updateTokensIfNecessary(o)}function Fz(t,e){return jx(j(t),e,null)}function Uz(t,e){return jx(j(t),null,e)}async function jx(t,e,n){const{auth:r}=t,s={idToken:await t.getIdToken(),returnSecureToken:!0};e&&(s.email=e),n&&(s.password=n);const o=await Vi(t,Lx(r,s));await t._updateTokensIfNecessary(o,!0)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $z(t){var e,n;if(!t)return null;const{providerId:r}=t,i=t.rawUserInfo?JSON.parse(t.rawUserInfo):{},s=t.isNewUser||t.kind==="identitytoolkit#SignupNewUserResponse";if(!r&&(t!=null&&t.idToken)){const o=(n=(e=jm(t.idToken))===null||e===void 0?void 0:e.firebase)===null||n===void 0?void 0:n.sign_in_provider;if(o){const a=o!=="anonymous"&&o!=="custom"?o:null;return new al(s,a)}}if(!r)return null;switch(r){case"facebook.com":return new Bz(s,i);case"github.com":return new zz(s,i);case"google.com":return new jz(s,i);case"twitter.com":return new qz(s,i,t.screenName||null);case"custom":case"anonymous":return new al(s,null);default:return new al(s,r,i)}}class al{constructor(e,n,r={}){this.isNewUser=e,this.providerId=n,this.profile=r}}class qx extends al{constructor(e,n,r,i){super(e,n,r),this.username=i}}class Bz extends al{constructor(e,n){super(e,"facebook.com",n)}}class zz extends qx{constructor(e,n){super(e,"github.com",n,typeof(n==null?void 0:n.login)=="string"?n==null?void 0:n.login:null)}}class jz extends al{constructor(e,n){super(e,"google.com",n)}}class qz extends qx{constructor(e,n,r){super(e,"twitter.com",n,r)}}function Wz(t){const{user:e,_tokenResponse:n}=t;return e.isAnonymous&&!n?{providerId:null,isNewUser:!1,profile:null}:$z(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Co{constructor(e,n,r){this.type=e,this.credential=n,this.user=r}static _fromIdtoken(e,n){return new Co("enroll",e,n)}static _fromMfaPendingCredential(e){return new Co("signin",e)}toJSON(){return{multiFactorSession:{[this.type==="enroll"?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){var n,r;if(e!=null&&e.multiFactorSession){if(!((n=e.multiFactorSession)===null||n===void 0)&&n.pendingCredential)return Co._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if(!((r=e.multiFactorSession)===null||r===void 0)&&r.idToken)return Co._fromIdtoken(e.multiFactorSession.idToken)}return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A0{constructor(e,n,r){this.session=e,this.hints=n,this.signInResolver=r}static _fromError(e,n){const r=it(e),i=n.customData._serverResponse,s=(i.mfaInfo||[]).map(a=>Xh._fromServerResponse(r,a));M(i.mfaPendingCredential,r,"internal-error");const o=Co._fromMfaPendingCredential(i.mfaPendingCredential);return new A0(o,s,async a=>{const l=await a._process(r,o);delete i.mfaInfo,delete i.mfaPendingCredential;const u=Object.assign(Object.assign({},i),{idToken:l.idToken,refreshToken:l.refreshToken});switch(n.operationType){case"signIn":const c=await gr._fromIdTokenResponse(r,n.operationType,u);return await r._updateCurrentUser(c.user),c;case"reauthenticate":return M(n.user,r,"internal-error"),gr._forOperation(n.user,n.operationType,u);default:Kt(r,"internal-error")}})}async resolveSignIn(e){const n=e;return this.signInResolver(n)}}function Hz(t,e){var n;const r=j(t),i=e;return M(e.customData.operationType,r,"argument-error"),M((n=i.customData._serverResponse)===null||n===void 0?void 0:n.mfaPendingCredential,r,"argument-error"),A0._fromError(r,i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gz(t,e){return vt(t,"POST","/v2/accounts/mfaEnrollment:start",ht(t,e))}function Kz(t,e){return vt(t,"POST","/v2/accounts/mfaEnrollment:finalize",ht(t,e))}function Qz(t,e){return vt(t,"POST","/v2/accounts/mfaEnrollment:withdraw",ht(t,e))}class P0{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload(n=>{n.mfaInfo&&(this.enrolledFactors=n.mfaInfo.map(r=>Xh._fromServerResponse(e.auth,r)))})}static _fromUser(e){return new P0(e)}async getSession(){return Co._fromIdtoken(await this.user.getIdToken(),this.user)}async enroll(e,n){const r=e,i=await this.getSession(),s=await Vi(this.user,r._process(this.user.auth,i,n));return await this.user._updateTokensIfNecessary(s),this.user.reload()}async unenroll(e){const n=typeof e=="string"?e:e.uid,r=await this.user.getIdToken();try{const i=await Vi(this.user,Qz(this.user.auth,{idToken:r,mfaEnrollmentId:n}));this.enrolledFactors=this.enrolledFactors.filter(({uid:s})=>s!==n),await this.user._updateTokensIfNecessary(i),await this.user.reload()}catch(i){throw i}}}const uy=new WeakMap;function Yz(t){const e=j(t);return uy.has(e)||uy.set(e,P0._fromUser(e)),uy.get(e)}const Np="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wx{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Np,"1"),this.storage.removeItem(Np),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xz(){const t=Ze();return E0(t)||iu(t)}const Jz=1e3,Zz=10;class Hx extends Wx{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=Xz()&&j6(),this.fallbackToPolling=kx(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),i=this.localCache[n];r!==i&&e(n,i,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const r=e.key;if(n?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const o=this.storage.getItem(r);if(e.newValue!==o)e.newValue!==null?this.storage.setItem(r,e.newValue):this.storage.removeItem(r);else if(this.localCache[r]===e.newValue&&!n)return}const i=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},s=this.storage.getItem(r);z6()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,Zz):i()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},Jz)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}Hx.type="LOCAL";const b0=Hx;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gx extends Wx{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}Gx.type="SESSION";const Ko=Gx;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ej(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Km{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(i=>i.isListeningto(e));if(n)return n;const r=new Km(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:i,data:s}=n.data,o=this.handlersMap[i];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const a=Array.from(o).map(async u=>u(n.origin,s)),l=await ej(a);n.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:l})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Km.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jh(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tj{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((a,l)=>{const u=Jh("",20);i.port1.start();const c=setTimeout(()=>{l(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(h){const f=h;if(f.data.eventId===u)switch(f.data.status){case"ack":clearTimeout(c),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(f.data.response);break;default:clearTimeout(c),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:u,data:n},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pt(){return window}function nj(t){pt().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function k0(){return typeof pt().WorkerGlobalScope<"u"&&typeof pt().importScripts=="function"}async function rj(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function ij(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function sj(){return k0()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kx="firebaseLocalStorageDb",oj=1,Dp="firebaseLocalStorage",Qx="fbase_key";class Zh{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Qm(t,e){return t.transaction([Dp],e?"readwrite":"readonly").objectStore(Dp)}function aj(){const t=indexedDB.deleteDatabase(Kx);return new Zh(t).toPromise()}function Wv(){const t=indexedDB.open(Kx,oj);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(Dp,{keyPath:Qx})}catch(i){n(i)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(Dp)?e(r):(r.close(),await aj(),e(await Wv()))})})}async function gC(t,e,n){const r=Qm(t,!0).put({[Qx]:e,value:n});return new Zh(r).toPromise()}async function lj(t,e){const n=Qm(t,!1).get(e),r=await new Zh(n).toPromise();return r===void 0?null:r.value}function _C(t,e){const n=Qm(t,!0).delete(e);return new Zh(n).toPromise()}const uj=800,cj=3;class Yx{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Wv(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>cj)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return k0()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Km._getInstance(sj()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await rj(),!this.activeServiceWorker)return;this.sender=new tj(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||ij()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Wv();return await gC(e,Np,"1"),await _C(e,Np),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>gC(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>lj(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>_C(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=Qm(i,!1).getAll();return new Zh(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),n.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),n.push(i));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),uj)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Yx.type="LOCAL";const uh=Yx;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hj(t,e){return vt(t,"POST","/v2/accounts/mfaSignIn:start",ht(t,e))}function dj(t,e){return vt(t,"POST","/v2/accounts/mfaSignIn:finalize",ht(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fj=500,pj=6e4,ef=1e12;class mj{constructor(e){this.auth=e,this.counter=ef,this._widgets=new Map}render(e,n){const r=this.counter;return this._widgets.set(r,new gj(e,this.auth.name,n||{})),this.counter++,r}reset(e){var n;const r=e||ef;(n=this._widgets.get(r))===null||n===void 0||n.delete(),this._widgets.delete(r)}getResponse(e){var n;const r=e||ef;return((n=this._widgets.get(r))===null||n===void 0?void 0:n.getResponse())||""}async execute(e){var n;const r=e||ef;return(n=this._widgets.get(r))===null||n===void 0||n.execute(),""}}class gj{constructor(e,n,r){this.params=r,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const i=typeof e=="string"?document.getElementById(e):e;M(i,"argument-error",{appName:n}),this.container=i,this.isVisible=this.params.size!=="invisible",this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=_j(50);const{callback:e,"expired-callback":n}=this.params;if(e)try{e(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,n)try{n()}catch{}this.isVisible&&this.execute()},pj)},fj))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}function _j(t){const e=[],n="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let r=0;r<t;r++)e.push(n.charAt(Math.floor(Math.random()*n.length)));return e.join("")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cy=Nx("rcb"),yj=new Qh(3e4,6e4),vj="https://www.google.com/recaptcha/api.js?";class wj{constructor(){var e;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!(!((e=pt().grecaptcha)===null||e===void 0)&&e.render)}load(e,n=""){return M(Ej(n),e,"argument-error"),this.shouldResolveImmediately(n)&&lC(pt().grecaptcha)?Promise.resolve(pt().grecaptcha):new Promise((r,i)=>{const s=pt().setTimeout(()=>{i(Wt(e,"network-request-failed"))},yj.get());pt()[cy]=()=>{pt().clearTimeout(s),delete pt()[cy];const a=pt().grecaptcha;if(!a||!lC(a)){i(Wt(e,"internal-error"));return}const l=a.render;a.render=(u,c)=>{const h=l(u,c);return this.counter++,h},this.hostLanguage=n,r(a)};const o=`${vj}?${da({onload:cy,render:"explicit",hl:n})}`;I0(o).catch(()=>{clearTimeout(s),i(Wt(e,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){var n;return!!(!((n=pt().grecaptcha)===null||n===void 0)&&n.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}function Ej(t){return t.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(t)}class Ij{async load(e){return new mj(e)}clearedOneInstance(){}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xx="recaptcha",Tj={theme:"light",type:"image"};let Sj=class{constructor(e,n,r=Object.assign({},Tj)){this.parameters=r,this.type=Xx,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=it(e),this.isInvisible=this.parameters.size==="invisible",M(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const i=typeof n=="string"?document.getElementById(n):n;M(i,this.auth,"argument-error"),this.container=i,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new Ij:new wj,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),n=this.getAssertedRecaptcha(),r=n.getResponse(e);return r||new Promise(i=>{const s=o=>{o&&(this.tokenChangeListeners.delete(s),i(o))};this.tokenChangeListeners.add(s),this.isInvisible&&n.execute(e)})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e}),this.renderPromise)}_reset(){this.assertNotDestroyed(),this.widgetId!==null&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){M(!this.parameters.sitekey,this.auth,"argument-error"),M(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),M(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return n=>{if(this.tokenChangeListeners.forEach(r=>r(n)),typeof e=="function")e(n);else if(typeof e=="string"){const r=pt()[e];typeof r=="function"&&r(n)}}}assertNotDestroyed(){M(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const n=document.createElement("div");e.appendChild(n),e=n}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){M(v0()&&!k0(),this.auth,"internal-error"),await Cj(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await A6(this.auth);M(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return M(this.recaptcha,this.auth,"internal-error"),this.recaptcha}};function Cj(){let t=null;return new Promise(e=>{if(document.readyState==="complete"){e();return}t=()=>e(),window.addEventListener("load",t)}).catch(e=>{throw t&&window.removeEventListener("load",t),e})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x0{constructor(e,n){this.verificationId=e,this.onConfirmation=n}confirm(e){const n=Vo._fromVerification(this.verificationId,e);return this.onConfirmation(n)}}async function Rj(t,e,n){const r=it(t),i=await Ym(r,e,j(n));return new x0(i,s=>Gm(r,s))}async function Aj(t,e,n){const r=j(t);await Hm(!1,r,"phone");const i=await Ym(r.auth,e,j(n));return new x0(i,s=>$x(r,s))}async function Pj(t,e,n){const r=j(t),i=await Ym(r.auth,e,j(n));return new x0(i,s=>Bx(r,s))}async function Ym(t,e,n){var r;const i=await n.verify();try{M(typeof i=="string",t,"argument-error"),M(n.type===Xx,t,"argument-error");let s;if(typeof e=="string"?s={phoneNumber:e}:s=e,"session"in s){const o=s.session;if("phoneNumber"in s)return M(o.type==="enroll",t,"internal-error"),(await Gz(t,{idToken:o.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:i}})).phoneSessionInfo.sessionInfo;{M(o.type==="signin",t,"internal-error");const a=((r=s.multiFactorHint)===null||r===void 0?void 0:r.uid)||s.multiFactorUid;return M(a,t,"missing-multi-factor-info"),(await hj(t,{mfaPendingCredential:o.credential,mfaEnrollmentId:a,phoneSignInInfo:{recaptchaToken:i}})).phoneResponseInfo.sessionInfo}}else{const{sessionInfo:o}=await cz(t,{phoneNumber:s.phoneNumber,recaptchaToken:i});return o}}finally{n._reset()}}async function bj(t,e){await T0(j(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Qo=class $f{constructor(e){this.providerId=$f.PROVIDER_ID,this.auth=it(e)}verifyPhoneNumber(e,n){return Ym(this.auth,e,j(n))}static credential(e,n){return Vo._fromVerification(e,n)}static credentialFromResult(e){const n=e;return $f.credentialFromTaggedObject(n)}static credentialFromError(e){return $f.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:n,temporaryProof:r}=e;return n&&r?Vo._fromTokenResponse(n,r):null}};Qo.PROVIDER_ID="phone";Qo.PHONE_SIGN_IN_METHOD="phone";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fa(t,e){return e?Wn(e):(M(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N0 extends su{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ki(e,this._buildIdpRequest())}_linkToIdToken(e,n){return ki(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return ki(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function kj(t){return Ux(t.auth,new N0(t),t.bypassAuthState)}function xj(t){const{auth:e,user:n}=t;return M(n,e,"internal-error"),Fx(n,new N0(t),t.bypassAuthState)}async function Nj(t){const{auth:e,user:n}=t;return M(n,e,"internal-error"),T0(n,new N0(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jx{constructor(e,n,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:i,tenantId:s,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:n,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return kj;case"linkViaPopup":case"linkViaRedirect":return Nj;case"reauthViaPopup":case"reauthViaRedirect":return xj;default:Kt(this.auth,"internal-error")}}resolve(e){Dr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Dr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dj=new Qh(2e3,1e4);async function Oj(t,e,n){const r=it(t);ru(t,e,ji);const i=fa(r,n);return new Ti(r,"signInViaPopup",e,i).executeNotNull()}async function Lj(t,e,n){const r=j(t);ru(r.auth,e,ji);const i=fa(r.auth,n);return new Ti(r.auth,"reauthViaPopup",e,i,r).executeNotNull()}async function Mj(t,e,n){const r=j(t);ru(r.auth,e,ji);const i=fa(r.auth,n);return new Ti(r.auth,"linkViaPopup",e,i,r).executeNotNull()}class Ti extends Jx{constructor(e,n,r,i,s){super(e,n,i,s),this.provider=r,this.authWindow=null,this.pollId=null,Ti.currentPopupAction&&Ti.currentPopupAction.cancel(),Ti.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return M(e,this.auth,"internal-error"),e}async onExecution(){Dr(this.filter.length===1,"Popup operations only handle one event");const e=Jh();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Wt(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Wt(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Ti.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Wt(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,Dj.get())};e()}}Ti.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vj="pendingRedirect",Ec=new Map;class Fj extends Jx{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Ec.get(this.auth._key());if(!e){try{const r=await Uj(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Ec.set(this.auth._key(),e)}return this.bypassAuthState||Ec.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function Uj(t,e){const n=eN(e),r=Zx(t);if(!await r._isAvailable())return!1;const i=await r._get(n)==="true";return await r._remove(n),i}async function D0(t,e){return Zx(t)._set(eN(e),"true")}function $j(){Ec.clear()}function O0(t,e){Ec.set(t._key(),e)}function Zx(t){return Wn(t._redirectPersistence)}function eN(t){return Mo(Vj,t.config.apiKey,t.name)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bj(t,e,n){return zj(t,e,n)}async function zj(t,e,n){const r=it(t);ru(t,e,ji),await r._initializationPromise;const i=fa(r,n);return await D0(i,r),i._openRedirect(r,e,"signInViaRedirect")}function jj(t,e,n){return qj(t,e,n)}async function qj(t,e,n){const r=j(t);ru(r.auth,e,ji),await r.auth._initializationPromise;const i=fa(r.auth,n);await D0(i,r.auth);const s=await tN(r);return i._openRedirect(r.auth,e,"reauthViaRedirect",s)}function Wj(t,e,n){return Hj(t,e,n)}async function Hj(t,e,n){const r=j(t);ru(r.auth,e,ji),await r.auth._initializationPromise;const i=fa(r.auth,n);await Hm(!1,r,e.providerId),await D0(i,r.auth);const s=await tN(r);return i._openRedirect(r.auth,e,"linkViaRedirect",s)}async function Gj(t,e){return await it(t)._initializationPromise,Xm(t,e,!1)}async function Xm(t,e,n=!1){const r=it(t),i=fa(r,e),o=await new Fj(r,i,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}async function tN(t){const e=Jh(`${t.uid}:::`);return t._redirectEventId=e,await t.auth._setRedirectUser(t),await t.auth._persistUserIfCurrent(t),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kj=10*60*1e3;class nN{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!Qj(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!rN(e)){const i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(Wt(this.auth,i))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=Kj&&this.cachedEventUids.clear(),this.cachedEventUids.has(yC(e))}saveEventToCache(e){this.cachedEventUids.add(yC(e)),this.lastProcessedEventTime=Date.now()}}function yC(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function rN({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function Qj(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return rN(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function iN(t,e={}){return vt(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yj=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Xj=/^https?/;async function Jj(t){if(t.config.emulator)return;const{authorizedDomains:e}=await iN(t);for(const n of e)try{if(Zj(n))return}catch{}Kt(t,"unauthorized-domain")}function Zj(t){const e=sh(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!Xj.test(n))return!1;if(Yj.test(t))return r===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e9=new Qh(3e4,6e4);function vC(){const t=pt().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function t9(t){return new Promise((e,n)=>{var r,i,s;function o(){vC(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{vC(),n(Wt(t,"network-request-failed"))},timeout:e9.get()})}if(!((i=(r=pt().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=pt().gapi)===null||s===void 0)&&s.load)o();else{const a=Nx("iframefcb");return pt()[a]=()=>{gapi.load?o():n(Wt(t,"network-request-failed"))},I0(`https://apis.google.com/js/api.js?onload=${a}`).catch(l=>n(l))}}).catch(e=>{throw Bf=null,e})}let Bf=null;function n9(t){return Bf=Bf||t9(t),Bf}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r9=new Qh(5e3,15e3),i9="__/auth/iframe",s9="emulator/auth/iframe",o9={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},a9=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function l9(t){const e=t.config;M(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?w0(e,s9):`https://${t.config.authDomain}/${i9}`,r={apiKey:e.apiKey,appName:t.name,v:hi},i=a9.get(t.config.apiHost);i&&(r.eid=i);const s=t._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${da(r).slice(1)}`}async function u9(t){const e=await n9(t),n=pt().gapi;return M(n,t,"internal-error"),e.open({where:document.body,url:l9(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:o9,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const o=Wt(t,"network-request-failed"),a=pt().setTimeout(()=>{s(o)},r9.get());function l(){pt().clearTimeout(a),i(r)}r.ping(l).then(l,()=>{s(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c9={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},h9=500,d9=600,f9="_blank",p9="http://localhost";class wC{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function m9(t,e,n,r=h9,i=d9){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l=Object.assign(Object.assign({},c9),{width:r.toString(),height:i.toString(),top:s,left:o}),u=Ze().toLowerCase();n&&(a=Rx(u)?f9:n),Cx(u)&&(e=e||p9,l.scrollbars="yes");const c=Object.entries(l).reduce((f,[g,_])=>`${f}${g}=${_},`,"");if(B6(u)&&a!=="_self")return g9(e||"",a),new wC(null);const h=window.open(e||"",a,c);M(h,t,"popup-blocked");try{h.focus()}catch{}return new wC(h)}function g9(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _9="__/auth/handler",y9="emulator/auth/handler",v9=encodeURIComponent("fac");async function Hv(t,e,n,r,i,s){M(t.config.authDomain,t,"auth-domain-config-required"),M(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:hi,eventId:i};if(e instanceof ji){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",Rp(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[c,h]of Object.entries(s||{}))o[c]=h}if(e instanceof ou){const c=e.getScopes().filter(h=>h!=="");c.length>0&&(o.scopes=c.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const c of Object.keys(a))a[c]===void 0&&delete a[c];const l=await t._getAppCheckToken(),u=l?`#${v9}=${encodeURIComponent(l)}`:"";return`${w9(t)}?${da(a).slice(1)}${u}`}function w9({config:t}){return t.emulator?w0(t,y9):`https://${t.authDomain}/${_9}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hy="webStorageSupport";class E9{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Ko,this._completeRedirectFn=Xm,this._overrideRedirectResult=O0}async _openPopup(e,n,r,i){var s;Dr((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const o=await Hv(e,n,r,sh(),i);return m9(e,o,Jh())}async _openRedirect(e,n,r,i){await this._originValidation(e);const s=await Hv(e,n,r,sh(),i);return nj(s),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:i,promise:s}=this.eventManagers[n];return i?Promise.resolve(i):(Dr(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await u9(e),r=new nN(e);return n.register("authEvent",i=>(M(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(hy,{type:hy},i=>{var s;const o=(s=i==null?void 0:i[0])===null||s===void 0?void 0:s[hy];o!==void 0&&n(!!o),Kt(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=Jj(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return kx()||E0()||iu()}}const I9=E9;class T9{constructor(e){this.factorId=e}_process(e,n,r){switch(n.type){case"enroll":return this._finalizeEnroll(e,n.credential,r);case"signin":return this._finalizeSignIn(e,n.credential);default:return Kr("unexpected MultiFactorSessionType")}}}class L0 extends T9{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new L0(e)}_finalizeEnroll(e,n,r){return Kz(e,{idToken:n,displayName:r,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,n){return dj(e,{mfaPendingCredential:n,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}class sN{constructor(){}static assertion(e){return L0._fromCredential(e)}}sN.FACTOR_ID="phone";var EC="@firebase/auth",IC="1.3.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S9{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){M(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function C9(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}function R9(t){ii(new on("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;M(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:xx(t)},u=new K6(r,i,s,l);return ez(u,n),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),ii(new on("auth-internal",e=>{const n=it(e.getProvider("auth").getImmediate());return(r=>new S9(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Vn(EC,IC,C9(t)),Vn(EC,IC,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A9=5*60;B3("authIdTokenMaxAge");R9("Browser");/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yo(){return window}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P9=2e3;async function b9(t,e,n){var r;const{BuildInfo:i}=Yo();Dr(e.sessionId,"AuthEvent did not contain a session ID");const s=await O9(e.sessionId),o={};return iu()?o.ibi=i.packageName:Yh()?o.apn=i.packageName:Kt(t,"operation-not-supported-in-this-environment"),i.displayName&&(o.appDisplayName=i.displayName),o.sessionId=s,Hv(t,n,e.type,void 0,(r=e.eventId)!==null&&r!==void 0?r:void 0,o)}async function k9(t){const{BuildInfo:e}=Yo(),n={};iu()?n.iosBundleId=e.packageName:Yh()?n.androidPackageName=e.packageName:Kt(t,"operation-not-supported-in-this-environment"),await iN(t,n)}function x9(t){const{cordova:e}=Yo();return new Promise(n=>{e.plugins.browsertab.isAvailable(r=>{let i=null;r?e.plugins.browsertab.openUrl(t):i=e.InAppBrowser.open(t,$6()?"_blank":"_system","location=yes"),n(i)})})}async function N9(t,e,n){const{cordova:r}=Yo();let i=()=>{};try{await new Promise((s,o)=>{let a=null;function l(){var h;s();const f=(h=r.plugins.browsertab)===null||h===void 0?void 0:h.close;typeof f=="function"&&f(),typeof(n==null?void 0:n.close)=="function"&&n.close()}function u(){a||(a=window.setTimeout(()=>{o(Wt(t,"redirect-cancelled-by-user"))},P9))}function c(){(document==null?void 0:document.visibilityState)==="visible"&&u()}e.addPassiveListener(l),document.addEventListener("resume",u,!1),Yh()&&document.addEventListener("visibilitychange",c,!1),i=()=>{e.removePassiveListener(l),document.removeEventListener("resume",u,!1),document.removeEventListener("visibilitychange",c,!1),a&&window.clearTimeout(a)}})}finally{i()}}function D9(t){var e,n,r,i,s,o,a,l,u,c;const h=Yo();M(typeof((e=h==null?void 0:h.universalLinks)===null||e===void 0?void 0:e.subscribe)=="function",t,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),M(typeof((n=h==null?void 0:h.BuildInfo)===null||n===void 0?void 0:n.packageName)<"u",t,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),M(typeof((s=(i=(r=h==null?void 0:h.cordova)===null||r===void 0?void 0:r.plugins)===null||i===void 0?void 0:i.browsertab)===null||s===void 0?void 0:s.openUrl)=="function",t,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),M(typeof((l=(a=(o=h==null?void 0:h.cordova)===null||o===void 0?void 0:o.plugins)===null||a===void 0?void 0:a.browsertab)===null||l===void 0?void 0:l.isAvailable)=="function",t,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),M(typeof((c=(u=h==null?void 0:h.cordova)===null||u===void 0?void 0:u.InAppBrowser)===null||c===void 0?void 0:c.open)=="function",t,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}async function O9(t){const e=L9(t),n=await crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(n)).map(i=>i.toString(16).padStart(2,"0")).join("")}function L9(t){if(Dr(/[0-9a-zA-Z]+/.test(t),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return new TextEncoder().encode(t);const e=new ArrayBuffer(t.length),n=new Uint8Array(e);for(let r=0;r<t.length;r++)n[r]=t.charCodeAt(r);return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M9=20;class V9 extends nN{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(e=>{this.resolveInialized=e})}addPassiveListener(e){this.passiveListeners.add(e)}removePassiveListener(e){this.passiveListeners.delete(e)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(e){return this.resolveInialized(),this.passiveListeners.forEach(n=>n(e)),super.onEvent(e)}async initialized(){await this.initPromise}}function F9(t,e,n=null){return{type:e,eventId:n,urlResponse:null,sessionId:B9(),postBody:null,tenantId:t.tenantId,error:Wt(t,"no-auth-event")}}function U9(t,e){return Gv()._set(Kv(t),e)}async function TC(t){const e=await Gv()._get(Kv(t));return e&&await Gv()._remove(Kv(t)),e}function $9(t,e){var n,r;const i=j9(e);if(i.includes("/__/auth/callback")){const s=zf(i),o=s.firebaseError?z9(decodeURIComponent(s.firebaseError)):null,a=(r=(n=o==null?void 0:o.code)===null||n===void 0?void 0:n.split("auth/"))===null||r===void 0?void 0:r[1],l=a?Wt(a):null;return l?{type:t.type,eventId:t.eventId,tenantId:t.tenantId,error:l,urlResponse:null,sessionId:null,postBody:null}:{type:t.type,eventId:t.eventId,tenantId:t.tenantId,sessionId:t.sessionId,urlResponse:i,postBody:null}}return null}function B9(){const t=[],e="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let n=0;n<M9;n++){const r=Math.floor(Math.random()*e.length);t.push(e.charAt(r))}return t.join("")}function Gv(){return Wn(b0)}function Kv(t){return Mo("authEvent",t.config.apiKey,t.name)}function z9(t){try{return JSON.parse(t)}catch{return null}}function j9(t){const e=zf(t),n=e.link?decodeURIComponent(e.link):void 0,r=zf(n).link,i=e.deep_link_id?decodeURIComponent(e.deep_link_id):void 0;return zf(i).link||i||r||n||t}function zf(t){if(!(t!=null&&t.includes("?")))return{};const[e,...n]=t.split("?");return Ya(n.join("?"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q9=500;class W9{constructor(){this._redirectPersistence=Ko,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=Xm,this._overrideRedirectResult=O0}async _initialize(e){const n=e._key();let r=this.eventManagers.get(n);return r||(r=new V9(e),this.eventManagers.set(n,r),this.attachCallbackListeners(e,r)),r}_openPopup(e){Kt(e,"operation-not-supported-in-this-environment")}async _openRedirect(e,n,r,i){D9(e);const s=await this._initialize(e);await s.initialized(),s.resetRedirect(),$j(),await this._originValidation(e);const o=F9(e,r,i);await U9(e,o);const a=await b9(e,o,n),l=await x9(a);return N9(e,s,l)}_isIframeWebStorageSupported(e,n){throw new Error("Method not implemented.")}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=k9(e)),this.originValidationPromises[n]}attachCallbackListeners(e,n){const{universalLinks:r,handleOpenURL:i,BuildInfo:s}=Yo(),o=setTimeout(async()=>{await TC(e),n.onEvent(SC())},q9),a=async c=>{clearTimeout(o);const h=await TC(e);let f=null;h&&(c!=null&&c.url)&&(f=$9(h,c.url)),n.onEvent(f||SC())};typeof r<"u"&&typeof r.subscribe=="function"&&r.subscribe(null,a);const l=i,u=`${s.packageName.toLowerCase()}://`;Yo().handleOpenURL=async c=>{if(c.toLowerCase().startsWith(u)&&a({url:c}),typeof l=="function")try{l(c)}catch(h){console.error(h)}}}}const H9=W9;function SC(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:Wt("no-auth-event")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function G9(t,e){it(t)._logFramework(e)}var K9="@firebase/auth-compat",Q9="0.4.6";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y9=1e3;function Ic(){var t;return((t=self==null?void 0:self.location)===null||t===void 0?void 0:t.protocol)||null}function X9(){return Ic()==="http:"||Ic()==="https:"}function oN(t=Ze()){return!!((Ic()==="file:"||Ic()==="ionic:"||Ic()==="capacitor:")&&t.toLowerCase().match(/iphone|ipad|ipod|android/))}function J9(){return Bm()||$m()}function Z9(){return tx()&&(document==null?void 0:document.documentMode)===11}function eq(t=Ze()){return/Edge\/\d+/.test(t)}function tq(t=Ze()){return Z9()||eq(t)}function aN(){try{const t=self.localStorage,e=Jh();if(t)return t.setItem(e,"1"),t.removeItem(e),tq()?th():!0}catch{return M0()&&th()}return!1}function M0(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function dy(){return(X9()||ex()||oN())&&!J9()&&aN()&&!M0()}function lN(){return oN()&&typeof document<"u"}async function nq(){return lN()?new Promise(t=>{const e=setTimeout(()=>{t(!1)},Y9);document.addEventListener("deviceready",()=>{clearTimeout(e),t(!0)})}):!1}function rq(){return typeof window<"u"?window:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zn={LOCAL:"local",NONE:"none",SESSION:"session"},Mu=M,uN="persistence";function iq(t,e){if(Mu(Object.values(zn).includes(e),t,"invalid-persistence-type"),Bm()){Mu(e!==zn.SESSION,t,"unsupported-persistence-type");return}if($m()){Mu(e===zn.NONE,t,"unsupported-persistence-type");return}if(M0()){Mu(e===zn.NONE||e===zn.LOCAL&&th(),t,"unsupported-persistence-type");return}Mu(e===zn.NONE||aN(),t,"unsupported-persistence-type")}async function Qv(t){await t._initializationPromise;const e=cN(),n=Mo(uN,t.config.apiKey,t.name);e&&e.setItem(n,t._getPersistence())}function sq(t,e){const n=cN();if(!n)return[];const r=Mo(uN,t,e);switch(n.getItem(r)){case zn.NONE:return[bl];case zn.LOCAL:return[uh,Ko];case zn.SESSION:return[Ko];default:return[]}}function cN(){var t;try{return((t=rq())===null||t===void 0?void 0:t.sessionStorage)||null}catch{return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oq=M;class us{constructor(){this.browserResolver=Wn(I9),this.cordovaResolver=Wn(H9),this.underlyingResolver=null,this._redirectPersistence=Ko,this._completeRedirectFn=Xm,this._overrideRedirectResult=O0}async _initialize(e){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._initialize(e)}async _openPopup(e,n,r,i){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openPopup(e,n,r,i)}async _openRedirect(e,n,r,i){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openRedirect(e,n,r,i)}_isIframeWebStorageSupported(e,n){this.assertedUnderlyingResolver._isIframeWebStorageSupported(e,n)}_originValidation(e){return this.assertedUnderlyingResolver._originValidation(e)}get _shouldInitProactively(){return lN()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return oq(this.underlyingResolver,"internal-error"),this.underlyingResolver}async selectUnderlyingResolver(){if(this.underlyingResolver)return;const e=await nq();this.underlyingResolver=e?this.cordovaResolver:this.browserResolver}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hN(t){return t.unwrap()}function aq(t){return t.wrapped()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lq(t){return dN(t)}function uq(t,e){var n;const r=(n=e.customData)===null||n===void 0?void 0:n._tokenResponse;if((e==null?void 0:e.code)==="auth/multi-factor-auth-required"){const i=e;i.resolver=new cq(t,Hz(t,e))}else if(r){const i=dN(e),s=e;i&&(s.credential=i,s.tenantId=r.tenantId||void 0,s.email=r.email||void 0,s.phoneNumber=r.phoneNumber||void 0)}}function dN(t){const{_tokenResponse:e}=t instanceof en?t.customData:t;if(!e)return null;if(!(t instanceof en)&&"temporaryProof"in e&&"phoneNumber"in e)return Qo.credentialFromResult(t);const n=e.providerId;if(!n||n===Lu.PASSWORD)return null;let r;switch(n){case Lu.GOOGLE:r=jr;break;case Lu.FACEBOOK:r=zr;break;case Lu.GITHUB:r=qr;break;case Lu.TWITTER:r=Wr;break;default:const{oauthIdToken:i,oauthAccessToken:s,oauthTokenSecret:o,pendingToken:a,nonce:l}=e;return!s&&!o&&!i&&!a?null:a?n.startsWith("saml.")?kl._create(n,a):si._fromParams({providerId:n,signInMethod:n,pendingToken:a,idToken:i,accessToken:s}):new sl(n).credential({idToken:i,accessToken:s,rawNonce:l})}return t instanceof en?r.credentialFromError(t):r.credentialFromResult(t)}function Tn(t,e){return e.catch(n=>{throw n instanceof en&&uq(t,n),n}).then(n=>{const r=n.operationType,i=n.user;return{operationType:r,credential:lq(n),additionalUserInfo:Wz(n),user:Jm.getOrCreate(i)}})}async function Yv(t,e){const n=await e;return{verificationId:n.verificationId,confirm:r=>Tn(t,n.confirm(r))}}class cq{constructor(e,n){this.resolver=n,this.auth=aq(e)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(e){return Tn(hN(this.auth),this.resolver.resolveSignIn(e))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Jm=class ic{constructor(e){this._delegate=e,this.multiFactor=Yz(e)}static getOrCreate(e){return ic.USER_MAP.has(e)||ic.USER_MAP.set(e,new ic(e)),ic.USER_MAP.get(e)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(e){return this._delegate.getIdTokenResult(e)}getIdToken(e){return this._delegate.getIdToken(e)}linkAndRetrieveDataWithCredential(e){return this.linkWithCredential(e)}async linkWithCredential(e){return Tn(this.auth,$x(this._delegate,e))}async linkWithPhoneNumber(e,n){return Yv(this.auth,Aj(this._delegate,e,n))}async linkWithPopup(e){return Tn(this.auth,Mj(this._delegate,e,us))}async linkWithRedirect(e){return await Qv(it(this.auth)),Wj(this._delegate,e,us)}reauthenticateAndRetrieveDataWithCredential(e){return this.reauthenticateWithCredential(e)}async reauthenticateWithCredential(e){return Tn(this.auth,Bx(this._delegate,e))}reauthenticateWithPhoneNumber(e,n){return Yv(this.auth,Pj(this._delegate,e,n))}reauthenticateWithPopup(e){return Tn(this.auth,Lj(this._delegate,e,us))}async reauthenticateWithRedirect(e){return await Qv(it(this.auth)),jj(this._delegate,e,us)}sendEmailVerification(e){return Oz(this._delegate,e)}async unlink(e){return await wz(this._delegate,e),this}updateEmail(e){return Fz(this._delegate,e)}updatePassword(e){return Uz(this._delegate,e)}updatePhoneNumber(e){return bj(this._delegate,e)}updateProfile(e){return Vz(this._delegate,e)}verifyBeforeUpdateEmail(e,n){return Lz(this._delegate,e,n)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}};Jm.USER_MAP=new WeakMap;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vu=M;class Xv{constructor(e,n){if(this.app=e,n.isInitialized()){this._delegate=n.getImmediate(),this.linkUnderlyingAuth();return}const{apiKey:r}=e.options;Vu(r,"invalid-api-key",{appName:e.name}),Vu(r,"invalid-api-key",{appName:e.name});const i=typeof window<"u"?us:void 0;this._delegate=n.initialize({options:{persistence:hq(r,e.name),popupRedirectResolver:i}}),this._delegate._updateErrorMap(v6),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?Jm.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(e){this._delegate.languageCode=e}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(e){this._delegate.tenantId=e}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(e,n){tz(this._delegate,e,n)}applyActionCode(e){return Cz(this._delegate,e)}checkActionCode(e){return zx(this._delegate,e)}confirmPasswordReset(e,n){return Sz(this._delegate,e,n)}async createUserWithEmailAndPassword(e,n){return Tn(this._delegate,Az(this._delegate,e,n))}fetchProvidersForEmail(e){return this.fetchSignInMethodsForEmail(e)}fetchSignInMethodsForEmail(e){return Dz(this._delegate,e)}isSignInWithEmailLink(e){return kz(this._delegate,e)}async getRedirectResult(){Vu(dy(),this._delegate,"operation-not-supported-in-this-environment");const e=await Gj(this._delegate,us);return e?Tn(this._delegate,Promise.resolve(e)):{credential:null,user:null}}addFrameworkForLogging(e){G9(this._delegate,e)}onAuthStateChanged(e,n,r){const{next:i,error:s,complete:o}=CC(e,n,r);return this._delegate.onAuthStateChanged(i,s,o)}onIdTokenChanged(e,n,r){const{next:i,error:s,complete:o}=CC(e,n,r);return this._delegate.onIdTokenChanged(i,s,o)}sendSignInLinkToEmail(e,n){return bz(this._delegate,e,n)}sendPasswordResetEmail(e,n){return Tz(this._delegate,e,n||void 0)}async setPersistence(e){iq(this._delegate,e);let n;switch(e){case zn.SESSION:n=Ko;break;case zn.LOCAL:n=await Wn(uh)._isAvailable()?uh:b0;break;case zn.NONE:n=bl;break;default:return Kt("argument-error",{appName:this._delegate.name})}return this._delegate.setPersistence(n)}signInAndRetrieveDataWithCredential(e){return this.signInWithCredential(e)}signInAnonymously(){return Tn(this._delegate,vz(this._delegate))}signInWithCredential(e){return Tn(this._delegate,Gm(this._delegate,e))}signInWithCustomToken(e){return Tn(this._delegate,Iz(this._delegate,e))}signInWithEmailAndPassword(e,n){return Tn(this._delegate,Pz(this._delegate,e,n))}signInWithEmailLink(e,n){return Tn(this._delegate,xz(this._delegate,e,n))}signInWithPhoneNumber(e,n){return Yv(this._delegate,Rj(this._delegate,e,n))}async signInWithPopup(e){return Vu(dy(),this._delegate,"operation-not-supported-in-this-environment"),Tn(this._delegate,Oj(this._delegate,e,us))}async signInWithRedirect(e){return Vu(dy(),this._delegate,"operation-not-supported-in-this-environment"),await Qv(this._delegate),Bj(this._delegate,e,us)}updateCurrentUser(e){return this._delegate.updateCurrentUser(e)}verifyPasswordResetCode(e){return Rz(this._delegate,e)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}Xv.Persistence=zn;function CC(t,e,n){let r=t;typeof t!="function"&&({next:r,error:e,complete:n}=t);const i=r;return{next:o=>i(o&&Jm.getOrCreate(o)),error:e,complete:n}}function hq(t,e){const n=sq(t,e);if(typeof self<"u"&&!n.includes(uh)&&n.push(uh),typeof window<"u")for(const r of[b0,Ko])n.includes(r)||n.push(r);return n.includes(bl)||n.push(bl),n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V0{constructor(){this.providerId="phone",this._delegate=new Qo(hN(di.auth()))}static credential(e,n){return Qo.credential(e,n)}verifyPhoneNumber(e,n){return this._delegate.verifyPhoneNumber(e,n)}unwrap(){return this._delegate}}V0.PHONE_SIGN_IN_METHOD=Qo.PHONE_SIGN_IN_METHOD;V0.PROVIDER_ID=Qo.PROVIDER_ID;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dq=M;class fq{constructor(e,n,r=di.app()){var i;dq((i=r.options)===null||i===void 0?void 0:i.apiKey,"invalid-api-key",{appName:r.name}),this._delegate=new Sj(r.auth(),e,n),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pq="auth-compat";function mq(t){t.INTERNAL.registerComponent(new on(pq,e=>{const n=e.getProvider("app-compat").getImmediate(),r=e.getProvider("auth");return new Xv(n,r)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:Pa.EMAIL_SIGNIN,PASSWORD_RESET:Pa.PASSWORD_RESET,RECOVER_EMAIL:Pa.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:Pa.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:Pa.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:Pa.VERIFY_EMAIL}},EmailAuthProvider:Xs,FacebookAuthProvider:zr,GithubAuthProvider:qr,GoogleAuthProvider:jr,OAuthProvider:sl,SAMLAuthProvider:kp,PhoneAuthProvider:V0,PhoneMultiFactorGenerator:sN,RecaptchaVerifier:fq,TwitterAuthProvider:Wr,Auth:Xv,AuthCredential:su,Error:en}).setInstantiationMode("LAZY").setMultipleInstances(!1)),t.registerVersion(K9,Q9)}mq(di);var gq=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},z,F0=F0||{},ne=gq||self;function Zm(t){var e=typeof t;return e=e!="object"?e:t?Array.isArray(t)?"array":e:"null",e=="array"||e=="object"&&typeof t.length=="number"}function ed(t){var e=typeof t;return e=="object"&&t!=null||e=="function"}function _q(t){return Object.prototype.hasOwnProperty.call(t,fy)&&t[fy]||(t[fy]=++yq)}var fy="closure_uid_"+(1e9*Math.random()>>>0),yq=0;function vq(t,e,n){return t.call.apply(t.bind,arguments)}function wq(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,r),t.apply(e,i)}}return function(){return t.apply(e,arguments)}}function tn(t,e,n){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?tn=vq:tn=wq,tn.apply(null,arguments)}function tf(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var r=n.slice();return r.push.apply(r,arguments),t.apply(this,r)}}function Mt(t,e){function n(){}n.prototype=e.prototype,t.$=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.ac=function(r,i,s){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return e.prototype[i].apply(r,o)}}function Js(){this.s=this.s,this.o=this.o}var Eq=0;Js.prototype.s=!1;Js.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),Eq!=0)&&_q(this)};Js.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const fN=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(typeof t=="string")return typeof e!="string"||e.length!=1?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1};function U0(t){const e=t.length;if(0<e){const n=Array(e);for(let r=0;r<e;r++)n[r]=t[r];return n}return[]}function RC(t,e){for(let n=1;n<arguments.length;n++){const r=arguments[n];if(Zm(r)){const i=t.length||0,s=r.length||0;t.length=i+s;for(let o=0;o<s;o++)t[i+o]=r[o]}else t.push(r)}}function nn(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}nn.prototype.h=function(){this.defaultPrevented=!0};var Iq=function(){if(!ne.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{ne.addEventListener("test",()=>{},e),ne.removeEventListener("test",()=>{},e)}catch{}return t}();function ch(t){return/^[\s\xa0]*$/.test(t)}function eg(){var t=ne.navigator;return t&&(t=t.userAgent)?t:""}function Hr(t){return eg().indexOf(t)!=-1}function $0(t){return $0[" "](t),t}$0[" "]=function(){};function Tq(t,e){var n=mW;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}var Sq=Hr("Opera"),xl=Hr("Trident")||Hr("MSIE"),pN=Hr("Edge"),Jv=pN||xl,mN=Hr("Gecko")&&!(eg().toLowerCase().indexOf("webkit")!=-1&&!Hr("Edge"))&&!(Hr("Trident")||Hr("MSIE"))&&!Hr("Edge"),Cq=eg().toLowerCase().indexOf("webkit")!=-1&&!Hr("Edge");function gN(){var t=ne.document;return t?t.documentMode:void 0}var Zv;e:{var py="",my=function(){var t=eg();if(mN)return/rv:([^\);]+)(\)|;)/.exec(t);if(pN)return/Edge\/([\d\.]+)/.exec(t);if(xl)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t);if(Cq)return/WebKit\/(\S+)/.exec(t);if(Sq)return/(?:Version)[ \/]?(\S+)/.exec(t)}();if(my&&(py=my?my[1]:""),xl){var gy=gN();if(gy!=null&&gy>parseFloat(py)){Zv=String(gy);break e}}Zv=py}var ew;if(ne.document&&xl){var AC=gN();ew=AC||parseInt(Zv,10)||void 0}else ew=void 0;var Rq=ew;function hh(t,e){if(nn.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(mN){e:{try{$0(e.nodeName);var i=!0;break e}catch{}i=!1}i||(e=null)}}else n=="mouseover"?e=t.fromElement:n=="mouseout"&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=r.clientX!==void 0?r.clientX:r.pageX,this.clientY=r.clientY!==void 0?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=t.clientX!==void 0?t.clientX:t.pageX,this.clientY=t.clientY!==void 0?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=typeof t.pointerType=="string"?t.pointerType:Aq[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&hh.$.h.call(this)}}Mt(hh,nn);var Aq={2:"touch",3:"pen",4:"mouse"};hh.prototype.h=function(){hh.$.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var td="closure_listenable_"+(1e6*Math.random()|0),Pq=0;function bq(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.la=i,this.key=++Pq,this.fa=this.ia=!1}function tg(t){t.fa=!0,t.listener=null,t.proxy=null,t.src=null,t.la=null}function B0(t,e,n){for(const r in t)e.call(n,t[r],r,t)}function kq(t,e){for(const n in t)e.call(void 0,t[n],n,t)}function _N(t){const e={};for(const n in t)e[n]=t[n];return e}const PC="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function yN(t,e){let n,r;for(let i=1;i<arguments.length;i++){r=arguments[i];for(n in r)t[n]=r[n];for(let s=0;s<PC.length;s++)n=PC[s],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function ng(t){this.src=t,this.g={},this.h=0}ng.prototype.add=function(t,e,n,r,i){var s=t.toString();t=this.g[s],t||(t=this.g[s]=[],this.h++);var o=nw(t,e,r,i);return-1<o?(e=t[o],n||(e.ia=!1)):(e=new bq(e,this.src,s,!!r,i),e.ia=n,t.push(e)),e};function tw(t,e){var n=e.type;if(n in t.g){var r=t.g[n],i=fN(r,e),s;(s=0<=i)&&Array.prototype.splice.call(r,i,1),s&&(tg(e),t.g[n].length==0&&(delete t.g[n],t.h--))}}function nw(t,e,n,r){for(var i=0;i<t.length;++i){var s=t[i];if(!s.fa&&s.listener==e&&s.capture==!!n&&s.la==r)return i}return-1}var z0="closure_lm_"+(1e6*Math.random()|0),_y={};function vN(t,e,n,r,i){if(r&&r.once)return EN(t,e,n,r,i);if(Array.isArray(e)){for(var s=0;s<e.length;s++)vN(t,e[s],n,r,i);return null}return n=W0(n),t&&t[td]?t.O(e,n,ed(r)?!!r.capture:!!r,i):wN(t,e,n,!1,r,i)}function wN(t,e,n,r,i,s){if(!e)throw Error("Invalid event type");var o=ed(i)?!!i.capture:!!i,a=q0(t);if(a||(t[z0]=a=new ng(t)),n=a.add(e,n,r,o,s),n.proxy)return n;if(r=xq(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)Iq||(i=o),i===void 0&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(TN(e.toString()),r);else if(t.addListener&&t.removeListener)t.addListener(r);else throw Error("addEventListener and attachEvent are unavailable.");return n}function xq(){function t(n){return e.call(t.src,t.listener,n)}const e=Nq;return t}function EN(t,e,n,r,i){if(Array.isArray(e)){for(var s=0;s<e.length;s++)EN(t,e[s],n,r,i);return null}return n=W0(n),t&&t[td]?t.P(e,n,ed(r)?!!r.capture:!!r,i):wN(t,e,n,!0,r,i)}function IN(t,e,n,r,i){if(Array.isArray(e))for(var s=0;s<e.length;s++)IN(t,e[s],n,r,i);else r=ed(r)?!!r.capture:!!r,n=W0(n),t&&t[td]?(t=t.i,e=String(e).toString(),e in t.g&&(s=t.g[e],n=nw(s,n,r,i),-1<n&&(tg(s[n]),Array.prototype.splice.call(s,n,1),s.length==0&&(delete t.g[e],t.h--)))):t&&(t=q0(t))&&(e=t.g[e.toString()],t=-1,e&&(t=nw(e,n,r,i)),(n=-1<t?e[t]:null)&&j0(n))}function j0(t){if(typeof t!="number"&&t&&!t.fa){var e=t.src;if(e&&e[td])tw(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(TN(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=q0(e))?(tw(n,t),n.h==0&&(n.src=null,e[z0]=null)):tg(t)}}}function TN(t){return t in _y?_y[t]:_y[t]="on"+t}function Nq(t,e){if(t.fa)t=!0;else{e=new hh(e,this);var n=t.listener,r=t.la||t.src;t.ia&&j0(t),t=n.call(r,e)}return t}function q0(t){return t=t[z0],t instanceof ng?t:null}var yy="__closure_events_fn_"+(1e9*Math.random()>>>0);function W0(t){return typeof t=="function"?t:(t[yy]||(t[yy]=function(e){return t.handleEvent(e)}),t[yy])}function Ot(){Js.call(this),this.i=new ng(this),this.S=this,this.J=null}Mt(Ot,Js);Ot.prototype[td]=!0;Ot.prototype.removeEventListener=function(t,e,n,r){IN(this,t,e,n,r)};function Ht(t,e){var n,r=t.J;if(r)for(n=[];r;r=r.J)n.push(r);if(t=t.S,r=e.type||e,typeof e=="string")e=new nn(e,t);else if(e instanceof nn)e.target=e.target||t;else{var i=e;e=new nn(r,t),yN(e,i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var o=e.g=n[s];i=nf(o,r,!0,e)&&i}if(o=e.g=t,i=nf(o,r,!0,e)&&i,i=nf(o,r,!1,e)&&i,n)for(s=0;s<n.length;s++)o=e.g=n[s],i=nf(o,r,!1,e)&&i}Ot.prototype.N=function(){if(Ot.$.N.call(this),this.i){var t=this.i,e;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)tg(n[r]);delete t.g[e],t.h--}}this.J=null};Ot.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)};Ot.prototype.P=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};function nf(t,e,n,r){if(e=t.i.g[String(e)],!e)return!0;e=e.concat();for(var i=!0,s=0;s<e.length;++s){var o=e[s];if(o&&!o.fa&&o.capture==n){var a=o.listener,l=o.la||o.src;o.ia&&tw(t.i,o),i=a.call(l,r)!==!1&&i}}return i&&!r.defaultPrevented}var H0=ne.JSON.stringify;class Dq{constructor(e,n){this.i=e,this.j=n,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}function Oq(){var t=G0;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}class Lq{constructor(){this.h=this.g=null}add(e,n){const r=SN.get();r.set(e,n),this.h?this.h.next=r:this.g=r,this.h=r}}var SN=new Dq(()=>new Mq,t=>t.reset());class Mq{constructor(){this.next=this.g=this.h=null}set(e,n){this.h=e,this.g=n,this.next=null}reset(){this.next=this.g=this.h=null}}function Vq(t){var e=1;t=t.split(":");const n=[];for(;0<e&&t.length;)n.push(t.shift()),e--;return t.length&&n.push(t.join(":")),n}function Fq(t){ne.setTimeout(()=>{throw t},0)}let dh,fh=!1,G0=new Lq,CN=()=>{const t=ne.Promise.resolve(void 0);dh=()=>{t.then(Uq)}};var Uq=()=>{for(var t;t=Oq();){try{t.h.call(t.g)}catch(n){Fq(n)}var e=SN;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}fh=!1};function rg(t,e){Ot.call(this),this.h=t||1,this.g=e||ne,this.j=tn(this.qb,this),this.l=Date.now()}Mt(rg,Ot);z=rg.prototype;z.ga=!1;z.T=null;z.qb=function(){if(this.ga){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-t):(this.T&&(this.g.clearTimeout(this.T),this.T=null),Ht(this,"tick"),this.ga&&(K0(this),this.start()))}};z.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function K0(t){t.ga=!1,t.T&&(t.g.clearTimeout(t.T),t.T=null)}z.N=function(){rg.$.N.call(this),K0(this),delete this.g};function Q0(t,e,n){if(typeof t=="function")n&&(t=tn(t,n));else if(t&&typeof t.handleEvent=="function")t=tn(t.handleEvent,t);else throw Error("Invalid listener argument");return 2147483647<Number(e)?-1:ne.setTimeout(t,e||0)}function RN(t){t.g=Q0(()=>{t.g=null,t.i&&(t.i=!1,RN(t))},t.j);const e=t.h;t.h=null,t.m.apply(null,e)}class $q extends Js{constructor(e,n){super(),this.m=e,this.j=n,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:RN(this)}N(){super.N(),this.g&&(ne.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ph(t){Js.call(this),this.h=t,this.g={}}Mt(ph,Js);var bC=[];function AN(t,e,n,r){Array.isArray(n)||(n&&(bC[0]=n.toString()),n=bC);for(var i=0;i<n.length;i++){var s=vN(e,n[i],r||t.handleEvent,!1,t.h||t);if(!s)break;t.g[s.key]=s}}function PN(t){B0(t.g,function(e,n){this.g.hasOwnProperty(n)&&j0(e)},t),t.g={}}ph.prototype.N=function(){ph.$.N.call(this),PN(this)};ph.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function ig(){this.g=!0}ig.prototype.Ea=function(){this.g=!1};function Bq(t,e,n,r,i,s){t.info(function(){if(t.g)if(s)for(var o="",a=s.split("&"),l=0;l<a.length;l++){var u=a[l].split("=");if(1<u.length){var c=u[0];u=u[1];var h=c.split("_");o=2<=h.length&&h[1]=="type"?o+(c+"="+u+"&"):o+(c+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+`
`+n+`
`+o})}function zq(t,e,n,r,i,s,o){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+`
`+n+`
`+s+" "+o})}function Xa(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+qq(t,n)+(r?" "+r:"")})}function jq(t,e){t.info(function(){return"TIMEOUT: "+e})}ig.prototype.info=function(){};function qq(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n){for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if(s!="noop"&&s!="stop"&&s!="close")for(var o=1;o<i.length;o++)i[o]=""}}}}return H0(n)}catch{return e}}var pa={},kC=null;function sg(){return kC=kC||new Ot}pa.Ta="serverreachability";function bN(t){nn.call(this,pa.Ta,t)}Mt(bN,nn);function mh(t){const e=sg();Ht(e,new bN(e))}pa.STAT_EVENT="statevent";function kN(t,e){nn.call(this,pa.STAT_EVENT,t),this.stat=e}Mt(kN,nn);function fn(t){const e=sg();Ht(e,new kN(e,t))}pa.Ua="timingevent";function xN(t,e){nn.call(this,pa.Ua,t),this.size=e}Mt(xN,nn);function nd(t,e){if(typeof t!="function")throw Error("Fn must not be null and must be a function");return ne.setTimeout(function(){t()},e)}var og={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},NN={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function Y0(){}Y0.prototype.h=null;function xC(t){return t.h||(t.h=t.i())}function DN(){}var rd={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function X0(){nn.call(this,"d")}Mt(X0,nn);function J0(){nn.call(this,"c")}Mt(J0,nn);var rw;function ag(){}Mt(ag,Y0);ag.prototype.g=function(){return new XMLHttpRequest};ag.prototype.i=function(){return{}};rw=new ag;function id(t,e,n,r){this.l=t,this.j=e,this.m=n,this.W=r||1,this.U=new ph(this),this.P=Wq,t=Jv?125:void 0,this.V=new rg(t),this.I=null,this.i=!1,this.s=this.A=this.v=this.L=this.G=this.Y=this.B=null,this.F=[],this.g=null,this.C=0,this.o=this.u=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new ON}function ON(){this.i=null,this.g="",this.h=!1}var Wq=45e3,iw={},Op={};z=id.prototype;z.setTimeout=function(t){this.P=t};function sw(t,e,n){t.L=1,t.v=ug(Fi(e)),t.s=n,t.S=!0,LN(t,null)}function LN(t,e){t.G=Date.now(),sd(t),t.A=Fi(t.v);var n=t.A,r=t.W;Array.isArray(r)||(r=[String(r)]),jN(n.i,"t",r),t.C=0,n=t.l.J,t.h=new ON,t.g=cD(t.l,n?e:null,!t.s),0<t.O&&(t.M=new $q(tn(t.Pa,t,t.g),t.O)),AN(t.U,t.g,"readystatechange",t.nb),e=t.I?_N(t.I):{},t.s?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ha(t.A,t.u,t.s,e)):(t.u="GET",t.g.ha(t.A,t.u,null,e)),mh(),Bq(t.j,t.u,t.A,t.m,t.W,t.s)}z.nb=function(t){t=t.target;const e=this.M;e&&Qr(t)==3?e.l():this.Pa(t)};z.Pa=function(t){try{if(t==this.g)e:{const c=Qr(this.g);var e=this.g.Ia();const h=this.g.da();if(!(3>c)&&(c!=3||Jv||this.g&&(this.h.h||this.g.ja()||LC(this.g)))){this.J||c!=4||e==7||(e==8||0>=h?mh(3):mh(2)),lg(this);var n=this.g.da();this.ca=n;t:if(MN(this)){var r=LC(this.g);t="";var i=r.length,s=Qr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Ro(this),Tc(this);var o="";break t}this.h.i=new ne.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,t+=this.h.i.decode(r[e],{stream:s&&e==i-1});r.splice(0,i),this.h.g+=t,this.C=0,o=this.h.g}else o=this.g.ja();if(this.i=n==200,zq(this.j,this.u,this.A,this.m,this.W,c,n),this.i){if(this.aa&&!this.K){t:{if(this.g){var a,l=this.g;if((a=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!ch(a)){var u=a;break t}}u=null}if(n=u)Xa(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,ow(this,n);else{this.i=!1,this.o=3,fn(12),Ro(this),Tc(this);break e}}this.S?(VN(this,c,o),Jv&&this.i&&c==3&&(AN(this.U,this.V,"tick",this.mb),this.V.start())):(Xa(this.j,this.m,o,null),ow(this,o)),c==4&&Ro(this),this.i&&!this.J&&(c==4?oD(this.l,this):(this.i=!1,sd(this)))}else dW(this.g),n==400&&0<o.indexOf("Unknown SID")?(this.o=3,fn(12)):(this.o=0,fn(13)),Ro(this),Tc(this)}}}catch{}finally{}};function MN(t){return t.g?t.u=="GET"&&t.L!=2&&t.l.Ha:!1}function VN(t,e,n){let r=!0,i;for(;!t.J&&t.C<n.length;)if(i=Hq(t,n),i==Op){e==4&&(t.o=4,fn(14),r=!1),Xa(t.j,t.m,null,"[Incomplete Response]");break}else if(i==iw){t.o=4,fn(15),Xa(t.j,t.m,n,"[Invalid Chunk]"),r=!1;break}else Xa(t.j,t.m,i,null),ow(t,i);MN(t)&&i!=Op&&i!=iw&&(t.h.g="",t.C=0),e!=4||n.length!=0||t.h.h||(t.o=1,fn(16),r=!1),t.i=t.i&&r,r?0<n.length&&!t.ba&&(t.ba=!0,e=t.l,e.g==t&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),iI(e),e.M=!0,fn(11))):(Xa(t.j,t.m,n,"[Invalid Chunked Response]"),Ro(t),Tc(t))}z.mb=function(){if(this.g){var t=Qr(this.g),e=this.g.ja();this.C<e.length&&(lg(this),VN(this,t,e),this.i&&t!=4&&sd(this))}};function Hq(t,e){var n=t.C,r=e.indexOf(`
`,n);return r==-1?Op:(n=Number(e.substring(n,r)),isNaN(n)?iw:(r+=1,r+n>e.length?Op:(e=e.slice(r,r+n),t.C=r+n,e)))}z.cancel=function(){this.J=!0,Ro(this)};function sd(t){t.Y=Date.now()+t.P,FN(t,t.P)}function FN(t,e){if(t.B!=null)throw Error("WatchDog timer not null");t.B=nd(tn(t.lb,t),e)}function lg(t){t.B&&(ne.clearTimeout(t.B),t.B=null)}z.lb=function(){this.B=null;const t=Date.now();0<=t-this.Y?(jq(this.j,this.A),this.L!=2&&(mh(),fn(17)),Ro(this),this.o=2,Tc(this)):FN(this,this.Y-t)};function Tc(t){t.l.H==0||t.J||oD(t.l,t)}function Ro(t){lg(t);var e=t.M;e&&typeof e.sa=="function"&&e.sa(),t.M=null,K0(t.V),PN(t.U),t.g&&(e=t.g,t.g=null,e.abort(),e.sa())}function ow(t,e){try{var n=t.l;if(n.H!=0&&(n.g==t||aw(n.i,t))){if(!t.K&&aw(n.i,t)&&n.H==3){try{var r=n.Ja.g.parse(e)}catch{r=null}if(Array.isArray(r)&&r.length==3){var i=r;if(i[0]==0){e:if(!n.u){if(n.g)if(n.g.G+3e3<t.G)Vp(n),fg(n);else break e;rI(n),fn(18)}}else n.Fa=i[1],0<n.Fa-n.V&&37500>i[2]&&n.G&&n.A==0&&!n.v&&(n.v=nd(tn(n.ib,n),6e3));if(1>=HN(n.i)&&n.oa){try{n.oa()}catch{}n.oa=void 0}}else Ao(n,11)}else if((t.K||n.g==t)&&Vp(n),!ch(e))for(i=n.Ja.g.parse(e),e=0;e<i.length;e++){let u=i[e];if(n.V=u[0],u=u[1],n.H==2)if(u[0]=="c"){n.K=u[1],n.pa=u[2];const c=u[3];c!=null&&(n.ra=c,n.l.info("VER="+n.ra));const h=u[4];h!=null&&(n.Ga=h,n.l.info("SVER="+n.Ga));const f=u[5];f!=null&&typeof f=="number"&&0<f&&(r=1.5*f,n.L=r,n.l.info("backChannelRequestTimeoutMs_="+r)),r=n;const g=t.g;if(g){const _=g.g?g.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(_){var s=r.i;s.g||_.indexOf("spdy")==-1&&_.indexOf("quic")==-1&&_.indexOf("h2")==-1||(s.j=s.l,s.g=new Set,s.h&&(Z0(s,s.h),s.h=null))}if(r.F){const w=g.g?g.g.getResponseHeader("X-HTTP-Session-Id"):null;w&&(r.Da=w,Fe(r.I,r.F,w))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-t.G,n.l.info("Handshake RTT: "+n.S+"ms")),r=n;var o=t;if(r.wa=uD(r,r.J?r.pa:null,r.Y),o.K){GN(r.i,o);var a=o,l=r.L;l&&a.setTimeout(l),a.B&&(lg(a),sd(a)),r.g=o}else iD(r);0<n.j.length&&pg(n)}else u[0]!="stop"&&u[0]!="close"||Ao(n,7);else n.H==3&&(u[0]=="stop"||u[0]=="close"?u[0]=="stop"?Ao(n,7):nI(n):u[0]!="noop"&&n.h&&n.h.Aa(u),n.A=0)}}mh(4)}catch{}}function Gq(t){if(t.Z&&typeof t.Z=="function")return t.Z();if(typeof Map<"u"&&t instanceof Map||typeof Set<"u"&&t instanceof Set)return Array.from(t.values());if(typeof t=="string")return t.split("");if(Zm(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}e=[],n=0;for(r in t)e[n++]=t[r];return e}function Kq(t){if(t.ta&&typeof t.ta=="function")return t.ta();if(!t.Z||typeof t.Z!="function"){if(typeof Map<"u"&&t instanceof Map)return Array.from(t.keys());if(!(typeof Set<"u"&&t instanceof Set)){if(Zm(t)||typeof t=="string"){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}e=[],n=0;for(const r in t)e[n++]=r;return e}}}function UN(t,e){if(t.forEach&&typeof t.forEach=="function")t.forEach(e,void 0);else if(Zm(t)||typeof t=="string")Array.prototype.forEach.call(t,e,void 0);else for(var n=Kq(t),r=Gq(t),i=r.length,s=0;s<i;s++)e.call(void 0,r[s],n&&n[s],t)}var $N=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Qq(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var s=t[n].substring(0,r);i=t[n].substring(r+1)}else s=t[n];e(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}function Fo(t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,t instanceof Fo){this.h=t.h,Lp(this,t.j),this.s=t.s,this.g=t.g,Mp(this,t.m),this.l=t.l;var e=t.i,n=new gh;n.i=e.i,e.g&&(n.g=new Map(e.g),n.h=e.h),NC(this,n),this.o=t.o}else t&&(e=String(t).match($N))?(this.h=!1,Lp(this,e[1]||"",!0),this.s=sc(e[2]||""),this.g=sc(e[3]||"",!0),Mp(this,e[4]),this.l=sc(e[5]||"",!0),NC(this,e[6]||"",!0),this.o=sc(e[7]||"")):(this.h=!1,this.i=new gh(null,this.h))}Fo.prototype.toString=function(){var t=[],e=this.j;e&&t.push(oc(e,DC,!0),":");var n=this.g;return(n||e=="file")&&(t.push("//"),(e=this.s)&&t.push(oc(e,DC,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n=this.m,n!=null&&t.push(":",String(n))),(n=this.l)&&(this.g&&n.charAt(0)!="/"&&t.push("/"),t.push(oc(n,n.charAt(0)=="/"?Jq:Xq,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.o)&&t.push("#",oc(n,eW)),t.join("")};function Fi(t){return new Fo(t)}function Lp(t,e,n){t.j=n?sc(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function Mp(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function NC(t,e,n){e instanceof gh?(t.i=e,tW(t.i,t.h)):(n||(e=oc(e,Zq)),t.i=new gh(e,t.h))}function Fe(t,e,n){t.i.set(e,n)}function ug(t){return Fe(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function sc(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function oc(t,e,n){return typeof t=="string"?(t=encodeURI(t).replace(e,Yq),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Yq(t){return t=t.charCodeAt(0),"%"+(t>>4&15).toString(16)+(t&15).toString(16)}var DC=/[#\/\?@]/g,Xq=/[#\?:]/g,Jq=/[#\?]/g,Zq=/[#\?@]/g,eW=/#/g;function gh(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function Zs(t){t.g||(t.g=new Map,t.h=0,t.i&&Qq(t.i,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}z=gh.prototype;z.add=function(t,e){Zs(this),this.i=null,t=au(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this};function BN(t,e){Zs(t),e=au(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function zN(t,e){return Zs(t),e=au(t,e),t.g.has(e)}z.forEach=function(t,e){Zs(this),this.g.forEach(function(n,r){n.forEach(function(i){t.call(e,i,r,this)},this)},this)};z.ta=function(){Zs(this);const t=Array.from(this.g.values()),e=Array.from(this.g.keys()),n=[];for(let r=0;r<e.length;r++){const i=t[r];for(let s=0;s<i.length;s++)n.push(e[r])}return n};z.Z=function(t){Zs(this);let e=[];if(typeof t=="string")zN(this,t)&&(e=e.concat(this.g.get(au(this,t))));else{t=Array.from(this.g.values());for(let n=0;n<t.length;n++)e=e.concat(t[n])}return e};z.set=function(t,e){return Zs(this),this.i=null,t=au(this,t),zN(this,t)&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this};z.get=function(t,e){return t?(t=this.Z(t),0<t.length?String(t[0]):e):e};function jN(t,e,n){BN(t,e),0<n.length&&(t.i=null,t.g.set(au(t,e),U0(n)),t.h+=n.length)}z.toString=function(){if(this.i)return this.i;if(!this.g)return"";const t=[],e=Array.from(this.g.keys());for(var n=0;n<e.length;n++){var r=e[n];const s=encodeURIComponent(String(r)),o=this.Z(r);for(r=0;r<o.length;r++){var i=s;o[r]!==""&&(i+="="+encodeURIComponent(String(o[r]))),t.push(i)}}return this.i=t.join("&")};function au(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function tW(t,e){e&&!t.j&&(Zs(t),t.i=null,t.g.forEach(function(n,r){var i=r.toLowerCase();r!=i&&(BN(this,r),jN(this,i,n))},t)),t.j=e}var nW=class{constructor(t,e){this.g=t,this.map=e}};function qN(t){this.l=t||rW,ne.PerformanceNavigationTiming?(t=ne.performance.getEntriesByType("navigation"),t=0<t.length&&(t[0].nextHopProtocol=="hq"||t[0].nextHopProtocol=="h2")):t=!!(ne.g&&ne.g.Ka&&ne.g.Ka()&&ne.g.Ka().ec),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var rW=10;function WN(t){return t.h?!0:t.g?t.g.size>=t.j:!1}function HN(t){return t.h?1:t.g?t.g.size:0}function aw(t,e){return t.h?t.h==e:t.g?t.g.has(e):!1}function Z0(t,e){t.g?t.g.add(e):t.h=e}function GN(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}qN.prototype.cancel=function(){if(this.i=KN(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const t of this.g.values())t.cancel();this.g.clear()}};function KN(t){if(t.h!=null)return t.i.concat(t.h.F);if(t.g!=null&&t.g.size!==0){let e=t.i;for(const n of t.g.values())e=e.concat(n.F);return e}return U0(t.i)}var iW=class{stringify(t){return ne.JSON.stringify(t,void 0)}parse(t){return ne.JSON.parse(t,void 0)}};function sW(){this.g=new iW}function oW(t,e,n){const r=n||"";try{UN(t,function(i,s){let o=i;ed(i)&&(o=H0(i)),e.push(r+s+"="+encodeURIComponent(o))})}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function aW(t,e){const n=new ig;if(ne.Image){const r=new Image;r.onload=tf(rf,n,r,"TestLoadImage: loaded",!0,e),r.onerror=tf(rf,n,r,"TestLoadImage: error",!1,e),r.onabort=tf(rf,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=tf(rf,n,r,"TestLoadImage: timeout",!1,e),ne.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}function rf(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch{}}function cg(t){this.l=t.fc||null,this.j=t.ob||!1}Mt(cg,Y0);cg.prototype.g=function(){return new hg(this.l,this.j)};cg.prototype.i=function(t){return function(){return t}}({});function hg(t,e){Ot.call(this),this.F=t,this.u=e,this.m=void 0,this.readyState=eI,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Mt(hg,Ot);var eI=0;z=hg.prototype;z.open=function(t,e){if(this.readyState!=eI)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,_h(this)};z.send=function(t){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.F||ne).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))};z.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,od(this)),this.readyState=eI};z.$a=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,_h(this)),this.g&&(this.readyState=3,_h(this),this.g)))if(this.responseType==="arraybuffer")t.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof ne.ReadableStream<"u"&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;QN(this)}else t.text().then(this.Za.bind(this),this.ka.bind(this))};function QN(t){t.j.read().then(t.Xa.bind(t)).catch(t.ka.bind(t))}z.Xa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?od(this):_h(this),this.readyState==3&&QN(this)}};z.Za=function(t){this.g&&(this.response=this.responseText=t,od(this))};z.Ya=function(t){this.g&&(this.response=t,od(this))};z.ka=function(){this.g&&od(this)};function od(t){t.readyState=4,t.l=null,t.j=null,t.A=null,_h(t)}z.setRequestHeader=function(t,e){this.v.append(t,e)};z.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""};z.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join(`\r
`)};function _h(t){t.onreadystatechange&&t.onreadystatechange.call(t)}Object.defineProperty(hg.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(t){this.m=t?"include":"same-origin"}});var lW=ne.JSON.parse;function st(t){Ot.call(this),this.headers=new Map,this.u=t||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=YN,this.L=this.M=!1}Mt(st,Ot);var YN="",uW=/^https?$/i,cW=["POST","PUT"];z=st.prototype;z.Oa=function(t){this.M=t};z.ha=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+t);e=e?e.toUpperCase():"GET",this.I=t,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():rw.g(),this.C=this.u?xC(this.u):xC(rw),this.g.onreadystatechange=tn(this.La,this);try{this.G=!0,this.g.open(e,String(t),!0),this.G=!1}catch(s){OC(this,s);return}if(t=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else if(typeof r.keys=="function"&&typeof r.get=="function")for(const s of r.keys())n.set(s,r.get(s));else throw Error("Unknown input type for opt_headers: "+String(r));r=Array.from(n.keys()).find(s=>s.toLowerCase()=="content-type"),i=ne.FormData&&t instanceof ne.FormData,!(0<=fN(cW,e))||r||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[s,o]of n)this.g.setRequestHeader(s,o);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{ZN(this),0<this.B&&((this.L=hW(this.g))?(this.g.timeout=this.B,this.g.ontimeout=tn(this.ua,this)):this.A=Q0(this.ua,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(s){OC(this,s)}};function hW(t){return xl&&typeof t.timeout=="number"&&t.ontimeout!==void 0}z.ua=function(){typeof F0<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Ht(this,"timeout"),this.abort(8))};function OC(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,XN(t),dg(t)}function XN(t){t.F||(t.F=!0,Ht(t,"complete"),Ht(t,"error"))}z.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,Ht(this,"complete"),Ht(this,"abort"),dg(this))};z.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),dg(this,!0)),st.$.N.call(this)};z.La=function(){this.s||(this.G||this.v||this.l?JN(this):this.kb())};z.kb=function(){JN(this)};function JN(t){if(t.h&&typeof F0<"u"&&(!t.C[1]||Qr(t)!=4||t.da()!=2)){if(t.v&&Qr(t)==4)Q0(t.La,0,t);else if(Ht(t,"readystatechange"),Qr(t)==4){t.h=!1;try{const o=t.da();e:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var n;if(!(n=e)){var r;if(r=o===0){var i=String(t.I).match($N)[1]||null;!i&&ne.self&&ne.self.location&&(i=ne.self.location.protocol.slice(0,-1)),r=!uW.test(i?i.toLowerCase():"")}n=r}if(n)Ht(t,"complete"),Ht(t,"success");else{t.m=6;try{var s=2<Qr(t)?t.g.statusText:""}catch{s=""}t.j=s+" ["+t.da()+"]",XN(t)}}finally{dg(t)}}}}function dg(t,e){if(t.g){ZN(t);const n=t.g,r=t.C[0]?()=>{}:null;t.g=null,t.C=null,e||Ht(t,"ready");try{n.onreadystatechange=r}catch{}}}function ZN(t){t.g&&t.L&&(t.g.ontimeout=null),t.A&&(ne.clearTimeout(t.A),t.A=null)}z.isActive=function(){return!!this.g};function Qr(t){return t.g?t.g.readyState:0}z.da=function(){try{return 2<Qr(this)?this.g.status:-1}catch{return-1}};z.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}};z.Wa=function(t){if(this.g){var e=this.g.responseText;return t&&e.indexOf(t)==0&&(e=e.substring(t.length)),lW(e)}};function LC(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.K){case YN:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch{return null}}function dW(t){const e={};t=(t.g&&2<=Qr(t)&&t.g.getAllResponseHeaders()||"").split(`\r
`);for(let r=0;r<t.length;r++){if(ch(t[r]))continue;var n=Vq(t[r]);const i=n[0];if(n=n[1],typeof n!="string")continue;n=n.trim();const s=e[i]||[];e[i]=s,s.push(n)}kq(e,function(r){return r.join(", ")})}z.Ia=function(){return this.m};z.Sa=function(){return typeof this.j=="string"?this.j:String(this.j)};function eD(t){let e="";return B0(t,function(n,r){e+=r,e+=":",e+=n,e+=`\r
`}),e}function tI(t,e,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=eD(n),typeof t=="string"?n!=null&&encodeURIComponent(String(n)):Fe(t,e,n))}function Fu(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function tD(t){this.Ga=0,this.j=[],this.l=new ig,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=Fu("failFast",!1,t),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=Fu("baseRetryDelayMs",5e3,t),this.hb=Fu("retryDelaySeedMs",1e4,t),this.eb=Fu("forwardChannelMaxRetries",2,t),this.xa=Fu("forwardChannelRequestTimeoutMs",2e4,t),this.va=t&&t.xmlHttpFactory||void 0,this.Ha=t&&t.dc||!1,this.L=void 0,this.J=t&&t.supportsCrossDomainXhr||!1,this.K="",this.i=new qN(t&&t.concurrentRequestLimit),this.Ja=new sW,this.P=t&&t.fastHandshake||!1,this.O=t&&t.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=t&&t.bc||!1,t&&t.Ea&&this.l.Ea(),t&&t.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&t&&t.detectBufferingProxy||!1,this.qa=void 0,t&&t.longPollingTimeout&&0<t.longPollingTimeout&&(this.qa=t.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}z=tD.prototype;z.ra=8;z.H=1;function nI(t){if(nD(t),t.H==3){var e=t.W++,n=Fi(t.I);if(Fe(n,"SID",t.K),Fe(n,"RID",e),Fe(n,"TYPE","terminate"),ad(t,n),e=new id(t,t.l,e),e.L=2,e.v=ug(Fi(n)),n=!1,ne.navigator&&ne.navigator.sendBeacon)try{n=ne.navigator.sendBeacon(e.v.toString(),"")}catch{}!n&&ne.Image&&(new Image().src=e.v,n=!0),n||(e.g=cD(e.l,null),e.g.ha(e.v)),e.G=Date.now(),sd(e)}lD(t)}function fg(t){t.g&&(iI(t),t.g.cancel(),t.g=null)}function nD(t){fg(t),t.u&&(ne.clearTimeout(t.u),t.u=null),Vp(t),t.i.cancel(),t.m&&(typeof t.m=="number"&&ne.clearTimeout(t.m),t.m=null)}function pg(t){if(!WN(t.i)&&!t.m){t.m=!0;var e=t.Na;dh||CN(),fh||(dh(),fh=!0),G0.add(e,t),t.C=0}}function fW(t,e){return HN(t.i)>=t.i.j-(t.m?1:0)?!1:t.m?(t.j=e.F.concat(t.j),!0):t.H==1||t.H==2||t.C>=(t.cb?0:t.eb)?!1:(t.m=nd(tn(t.Na,t,e),aD(t,t.C)),t.C++,!0)}z.Na=function(t){if(this.m)if(this.m=null,this.H==1){if(!t){this.W=Math.floor(1e5*Math.random()),t=this.W++;const i=new id(this,this.l,t);let s=this.s;if(this.U&&(s?(s=_N(s),yN(s,this.U)):s=this.U),this.o!==null||this.O||(i.I=s,s=null),this.P)e:{for(var e=0,n=0;n<this.j.length;n++){t:{var r=this.j[n];if("__data__"in r.map&&(r=r.map.__data__,typeof r=="string")){r=r.length;break t}r=void 0}if(r===void 0)break;if(e+=r,4096<e){e=n;break e}if(e===4096||n===this.j.length-1){e=n+1;break e}}e=1e3}else e=1e3;e=rD(this,i,e),n=Fi(this.I),Fe(n,"RID",t),Fe(n,"CVER",22),this.F&&Fe(n,"X-HTTP-Session-Id",this.F),ad(this,n),s&&(this.O?e="headers="+encodeURIComponent(String(eD(s)))+"&"+e:this.o&&tI(n,this.o,s)),Z0(this.i,i),this.bb&&Fe(n,"TYPE","init"),this.P?(Fe(n,"$req",e),Fe(n,"SID","null"),i.aa=!0,sw(i,n,null)):sw(i,n,e),this.H=2}}else this.H==3&&(t?MC(this,t):this.j.length==0||WN(this.i)||MC(this))};function MC(t,e){var n;e?n=e.m:n=t.W++;const r=Fi(t.I);Fe(r,"SID",t.K),Fe(r,"RID",n),Fe(r,"AID",t.V),ad(t,r),t.o&&t.s&&tI(r,t.o,t.s),n=new id(t,t.l,n,t.C+1),t.o===null&&(n.I=t.s),e&&(t.j=e.F.concat(t.j)),e=rD(t,n,1e3),n.setTimeout(Math.round(.5*t.xa)+Math.round(.5*t.xa*Math.random())),Z0(t.i,n),sw(n,r,e)}function ad(t,e){t.na&&B0(t.na,function(n,r){Fe(e,r,n)}),t.h&&UN({},function(n,r){Fe(e,r,n)})}function rD(t,e,n){n=Math.min(t.j.length,n);var r=t.h?tn(t.h.Va,t.h,t):null;e:{var i=t.j;let s=-1;for(;;){const o=["count="+n];s==-1?0<n?(s=i[0].g,o.push("ofs="+s)):s=0:o.push("ofs="+s);let a=!0;for(let l=0;l<n;l++){let u=i[l].g;const c=i[l].map;if(u-=s,0>u)s=Math.max(0,i[l].g-100),a=!1;else try{oW(c,o,"req"+u+"_")}catch{r&&r(c)}}if(a){r=o.join("&");break e}}}return t=t.j.splice(0,n),e.F=t,r}function iD(t){if(!t.g&&!t.u){t.ba=1;var e=t.Ma;dh||CN(),fh||(dh(),fh=!0),G0.add(e,t),t.A=0}}function rI(t){return t.g||t.u||3<=t.A?!1:(t.ba++,t.u=nd(tn(t.Ma,t),aD(t,t.A)),t.A++,!0)}z.Ma=function(){if(this.u=null,sD(this),this.ca&&!(this.M||this.g==null||0>=this.S)){var t=2*this.S;this.l.info("BP detection timer enabled: "+t),this.B=nd(tn(this.jb,this),t)}};z.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,fn(10),fg(this),sD(this))};function iI(t){t.B!=null&&(ne.clearTimeout(t.B),t.B=null)}function sD(t){t.g=new id(t,t.l,"rpc",t.ba),t.o===null&&(t.g.I=t.s),t.g.O=0;var e=Fi(t.wa);Fe(e,"RID","rpc"),Fe(e,"SID",t.K),Fe(e,"AID",t.V),Fe(e,"CI",t.G?"0":"1"),!t.G&&t.qa&&Fe(e,"TO",t.qa),Fe(e,"TYPE","xmlhttp"),ad(t,e),t.o&&t.s&&tI(e,t.o,t.s),t.L&&t.g.setTimeout(t.L);var n=t.g;t=t.pa,n.L=1,n.v=ug(Fi(e)),n.s=null,n.S=!0,LN(n,t)}z.ib=function(){this.v!=null&&(this.v=null,fg(this),rI(this),fn(19))};function Vp(t){t.v!=null&&(ne.clearTimeout(t.v),t.v=null)}function oD(t,e){var n=null;if(t.g==e){Vp(t),iI(t),t.g=null;var r=2}else if(aw(t.i,e))n=e.F,GN(t.i,e),r=1;else return;if(t.H!=0){if(e.i)if(r==1){n=e.s?e.s.length:0,e=Date.now()-e.G;var i=t.C;r=sg(),Ht(r,new xN(r,n)),pg(t)}else iD(t);else if(i=e.o,i==3||i==0&&0<e.ca||!(r==1&&fW(t,e)||r==2&&rI(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),i){case 1:Ao(t,5);break;case 4:Ao(t,10);break;case 3:Ao(t,6);break;default:Ao(t,2)}}}function aD(t,e){let n=t.ab+Math.floor(Math.random()*t.hb);return t.isActive()||(n*=2),n*e}function Ao(t,e){if(t.l.info("Error code "+e),e==2){var n=null;t.h&&(n=null);var r=tn(t.pb,t);n||(n=new Fo("//www.google.com/images/cleardot.gif"),ne.location&&ne.location.protocol=="http"||Lp(n,"https"),ug(n)),aW(n.toString(),r)}else fn(2);t.H=0,t.h&&t.h.za(e),lD(t),nD(t)}z.pb=function(t){t?(this.l.info("Successfully pinged google.com"),fn(2)):(this.l.info("Failed to ping google.com"),fn(1))};function lD(t){if(t.H=0,t.ma=[],t.h){const e=KN(t.i);(e.length!=0||t.j.length!=0)&&(RC(t.ma,e),RC(t.ma,t.j),t.i.i.length=0,U0(t.j),t.j.length=0),t.h.ya()}}function uD(t,e,n){var r=n instanceof Fo?Fi(n):new Fo(n);if(r.g!="")e&&(r.g=e+"."+r.g),Mp(r,r.m);else{var i=ne.location;r=i.protocol,e=e?e+"."+i.hostname:i.hostname,i=+i.port;var s=new Fo(null);r&&Lp(s,r),e&&(s.g=e),i&&Mp(s,i),n&&(s.l=n),r=s}return n=t.F,e=t.Da,n&&e&&Fe(r,n,e),Fe(r,"VER",t.ra),ad(t,r),r}function cD(t,e,n){if(e&&!t.J)throw Error("Can't create secondary domain capable XhrIo object.");return e=n&&t.Ha&&!t.va?new st(new cg({ob:!0})):new st(t.va),e.Oa(t.J),e}z.isActive=function(){return!!this.h&&this.h.isActive(this)};function hD(){}z=hD.prototype;z.Ba=function(){};z.Aa=function(){};z.za=function(){};z.ya=function(){};z.isActive=function(){return!0};z.Va=function(){};function Fp(){if(xl&&!(10<=Number(Rq)))throw Error("Environmental error: no available transport.")}Fp.prototype.g=function(t,e){return new Yn(t,e)};function Yn(t,e){Ot.call(this),this.g=new tD(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(t?t["X-WebChannel-Client-Profile"]=e.Ca:t={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=t,(t=e&&e.cc)&&!ch(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!ch(e)&&(this.g.F=e,t=this.h,t!==null&&e in t&&(t=this.h,e in t&&delete t[e])),this.j=new lu(this)}Mt(Yn,Ot);Yn.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var t=this.g,e=this.l,n=this.h||void 0;fn(0),t.Y=e,t.na=n||{},t.G=t.aa,t.I=uD(t,null,t.Y),pg(t)};Yn.prototype.close=function(){nI(this.g)};Yn.prototype.u=function(t){var e=this.g;if(typeof t=="string"){var n={};n.__data__=t,t=n}else this.v&&(n={},n.__data__=H0(t),t=n);e.j.push(new nW(e.fb++,t)),e.H==3&&pg(e)};Yn.prototype.N=function(){this.g.h=null,delete this.j,nI(this.g),delete this.g,Yn.$.N.call(this)};function dD(t){X0.call(this),t.__headers__&&(this.headers=t.__headers__,this.statusCode=t.__status__,delete t.__headers__,delete t.__status__);var e=t.__sm__;if(e){e:{for(const n in e){t=n;break e}t=void 0}(this.i=t)&&(t=this.i,e=e!==null&&t in e?e[t]:void 0),this.data=e}else this.data=t}Mt(dD,X0);function fD(){J0.call(this),this.status=1}Mt(fD,J0);function lu(t){this.g=t}Mt(lu,hD);lu.prototype.Ba=function(){Ht(this.g,"a")};lu.prototype.Aa=function(t){Ht(this.g,new dD(t))};lu.prototype.za=function(t){Ht(this.g,new fD)};lu.prototype.ya=function(){Ht(this.g,"b")};function pW(){this.blockSize=-1}function Or(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}Mt(Or,pW);Or.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0};function vy(t,e,n){n||(n=0);var r=Array(16);if(typeof e=="string")for(var i=0;16>i;++i)r[i]=e.charCodeAt(n++)|e.charCodeAt(n++)<<8|e.charCodeAt(n++)<<16|e.charCodeAt(n++)<<24;else for(i=0;16>i;++i)r[i]=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24;e=t.g[0],n=t.g[1],i=t.g[2];var s=t.g[3],o=e+(s^n&(i^s))+r[0]+3614090360&4294967295;e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[1]+3905402710&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[2]+606105819&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[3]+3250441966&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[4]+4118548399&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[5]+1200080426&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[6]+2821735955&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[7]+4249261313&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[8]+1770035416&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[9]+2336552879&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[10]+4294925233&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[11]+2304563134&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[12]+1804603682&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[13]+4254626195&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[14]+2792965006&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[15]+1236535329&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(i^s&(n^i))+r[1]+4129170786&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[6]+3225465664&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[11]+643717713&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[0]+3921069994&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[5]+3593408605&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[10]+38016083&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[15]+3634488961&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[4]+3889429448&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[9]+568446438&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[14]+3275163606&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[3]+4107603335&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[8]+1163531501&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[13]+2850285829&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[2]+4243563512&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[7]+1735328473&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[12]+2368359562&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(n^i^s)+r[5]+4294588738&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[8]+2272392833&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[11]+1839030562&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[14]+4259657740&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[1]+2763975236&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[4]+1272893353&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[7]+4139469664&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[10]+3200236656&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[13]+681279174&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[0]+3936430074&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[3]+3572445317&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[6]+76029189&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[9]+3654602809&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[12]+3873151461&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[15]+530742520&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[2]+3299628645&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(i^(n|~s))+r[0]+4096336452&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[7]+1126891415&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[14]+2878612391&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[5]+4237533241&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[12]+1700485571&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[3]+2399980690&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[10]+4293915773&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[1]+2240044497&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[8]+1873313359&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[15]+4264355552&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[6]+2734768916&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[13]+1309151649&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[4]+4149444226&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[11]+3174756917&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[2]+718787259&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[9]+3951481745&4294967295,t.g[0]=t.g[0]+e&4294967295,t.g[1]=t.g[1]+(i+(o<<21&4294967295|o>>>11))&4294967295,t.g[2]=t.g[2]+i&4294967295,t.g[3]=t.g[3]+s&4294967295}Or.prototype.j=function(t,e){e===void 0&&(e=t.length);for(var n=e-this.blockSize,r=this.m,i=this.h,s=0;s<e;){if(i==0)for(;s<=n;)vy(this,t,s),s+=this.blockSize;if(typeof t=="string"){for(;s<e;)if(r[i++]=t.charCodeAt(s++),i==this.blockSize){vy(this,r),i=0;break}}else for(;s<e;)if(r[i++]=t[s++],i==this.blockSize){vy(this,r),i=0;break}}this.h=i,this.i+=e};Or.prototype.l=function(){var t=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);t[0]=128;for(var e=1;e<t.length-8;++e)t[e]=0;var n=8*this.i;for(e=t.length-8;e<t.length;++e)t[e]=n&255,n/=256;for(this.j(t),t=Array(16),e=n=0;4>e;++e)for(var r=0;32>r;r+=8)t[n++]=this.g[e]>>>r&255;return t};function Pe(t,e){this.h=e;for(var n=[],r=!0,i=t.length-1;0<=i;i--){var s=t[i]|0;r&&s==e||(n[i]=s,r=!1)}this.g=n}var mW={};function sI(t){return-128<=t&&128>t?Tq(t,function(e){return new Pe([e|0],0>e?-1:0)}):new Pe([t|0],0>t?-1:0)}function Yr(t){if(isNaN(t)||!isFinite(t))return ll;if(0>t)return zt(Yr(-t));for(var e=[],n=1,r=0;t>=n;r++)e[r]=t/n|0,n*=lw;return new Pe(e,0)}function pD(t,e){if(t.length==0)throw Error("number format error: empty string");if(e=e||10,2>e||36<e)throw Error("radix out of range: "+e);if(t.charAt(0)=="-")return zt(pD(t.substring(1),e));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var n=Yr(Math.pow(e,8)),r=ll,i=0;i<t.length;i+=8){var s=Math.min(8,t.length-i),o=parseInt(t.substring(i,i+s),e);8>s?(s=Yr(Math.pow(e,s)),r=r.R(s).add(Yr(o))):(r=r.R(n),r=r.add(Yr(o)))}return r}var lw=4294967296,ll=sI(0),uw=sI(1),VC=sI(16777216);z=Pe.prototype;z.ea=function(){if(ir(this))return-zt(this).ea();for(var t=0,e=1,n=0;n<this.g.length;n++){var r=this.D(n);t+=(0<=r?r:lw+r)*e,e*=lw}return t};z.toString=function(t){if(t=t||10,2>t||36<t)throw Error("radix out of range: "+t);if(Si(this))return"0";if(ir(this))return"-"+zt(this).toString(t);for(var e=Yr(Math.pow(t,6)),n=this,r="";;){var i=$p(n,e).g;n=Up(n,i.R(e));var s=((0<n.g.length?n.g[0]:n.h)>>>0).toString(t);if(n=i,Si(n))return s+r;for(;6>s.length;)s="0"+s;r=s+r}};z.D=function(t){return 0>t?0:t<this.g.length?this.g[t]:this.h};function Si(t){if(t.h!=0)return!1;for(var e=0;e<t.g.length;e++)if(t.g[e]!=0)return!1;return!0}function ir(t){return t.h==-1}z.X=function(t){return t=Up(this,t),ir(t)?-1:Si(t)?0:1};function zt(t){for(var e=t.g.length,n=[],r=0;r<e;r++)n[r]=~t.g[r];return new Pe(n,~t.h).add(uw)}z.abs=function(){return ir(this)?zt(this):this};z.add=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0,i=0;i<=e;i++){var s=r+(this.D(i)&65535)+(t.D(i)&65535),o=(s>>>16)+(this.D(i)>>>16)+(t.D(i)>>>16);r=o>>>16,s&=65535,o&=65535,n[i]=o<<16|s}return new Pe(n,n[n.length-1]&-2147483648?-1:0)};function Up(t,e){return t.add(zt(e))}z.R=function(t){if(Si(this)||Si(t))return ll;if(ir(this))return ir(t)?zt(this).R(zt(t)):zt(zt(this).R(t));if(ir(t))return zt(this.R(zt(t)));if(0>this.X(VC)&&0>t.X(VC))return Yr(this.ea()*t.ea());for(var e=this.g.length+t.g.length,n=[],r=0;r<2*e;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var i=0;i<t.g.length;i++){var s=this.D(r)>>>16,o=this.D(r)&65535,a=t.D(i)>>>16,l=t.D(i)&65535;n[2*r+2*i]+=o*l,sf(n,2*r+2*i),n[2*r+2*i+1]+=s*l,sf(n,2*r+2*i+1),n[2*r+2*i+1]+=o*a,sf(n,2*r+2*i+1),n[2*r+2*i+2]+=s*a,sf(n,2*r+2*i+2)}for(r=0;r<e;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=e;r<2*e;r++)n[r]=0;return new Pe(n,0)};function sf(t,e){for(;(t[e]&65535)!=t[e];)t[e+1]+=t[e]>>>16,t[e]&=65535,e++}function Uu(t,e){this.g=t,this.h=e}function $p(t,e){if(Si(e))throw Error("division by zero");if(Si(t))return new Uu(ll,ll);if(ir(t))return e=$p(zt(t),e),new Uu(zt(e.g),zt(e.h));if(ir(e))return e=$p(t,zt(e)),new Uu(zt(e.g),e.h);if(30<t.g.length){if(ir(t)||ir(e))throw Error("slowDivide_ only works with positive integers.");for(var n=uw,r=e;0>=r.X(t);)n=FC(n),r=FC(r);var i=ba(n,1),s=ba(r,1);for(r=ba(r,2),n=ba(n,2);!Si(r);){var o=s.add(r);0>=o.X(t)&&(i=i.add(n),s=o),r=ba(r,1),n=ba(n,1)}return e=Up(t,i.R(e)),new Uu(i,e)}for(i=ll;0<=t.X(e);){for(n=Math.max(1,Math.floor(t.ea()/e.ea())),r=Math.ceil(Math.log(n)/Math.LN2),r=48>=r?1:Math.pow(2,r-48),s=Yr(n),o=s.R(e);ir(o)||0<o.X(t);)n-=r,s=Yr(n),o=s.R(e);Si(s)&&(s=uw),i=i.add(s),t=Up(t,o)}return new Uu(i,t)}z.gb=function(t){return $p(this,t).h};z.and=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)&t.D(r);return new Pe(n,this.h&t.h)};z.or=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)|t.D(r);return new Pe(n,this.h|t.h)};z.xor=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)^t.D(r);return new Pe(n,this.h^t.h)};function FC(t){for(var e=t.g.length+1,n=[],r=0;r<e;r++)n[r]=t.D(r)<<1|t.D(r-1)>>>31;return new Pe(n,t.h)}function ba(t,e){var n=e>>5;e%=32;for(var r=t.g.length-n,i=[],s=0;s<r;s++)i[s]=0<e?t.D(s+n)>>>e|t.D(s+n+1)<<32-e:t.D(s+n);return new Pe(i,t.h)}Fp.prototype.createWebChannel=Fp.prototype.g;Yn.prototype.send=Yn.prototype.u;Yn.prototype.open=Yn.prototype.m;Yn.prototype.close=Yn.prototype.close;og.NO_ERROR=0;og.TIMEOUT=8;og.HTTP_ERROR=6;NN.COMPLETE="complete";DN.EventType=rd;rd.OPEN="a";rd.CLOSE="b";rd.ERROR="c";rd.MESSAGE="d";Ot.prototype.listen=Ot.prototype.O;st.prototype.listenOnce=st.prototype.P;st.prototype.getLastError=st.prototype.Sa;st.prototype.getLastErrorCode=st.prototype.Ia;st.prototype.getStatus=st.prototype.da;st.prototype.getResponseJson=st.prototype.Wa;st.prototype.getResponseText=st.prototype.ja;st.prototype.send=st.prototype.ha;st.prototype.setWithCredentials=st.prototype.Oa;Or.prototype.digest=Or.prototype.l;Or.prototype.reset=Or.prototype.reset;Or.prototype.update=Or.prototype.j;Pe.prototype.add=Pe.prototype.add;Pe.prototype.multiply=Pe.prototype.R;Pe.prototype.modulo=Pe.prototype.gb;Pe.prototype.compare=Pe.prototype.X;Pe.prototype.toNumber=Pe.prototype.ea;Pe.prototype.toString=Pe.prototype.toString;Pe.prototype.getBits=Pe.prototype.D;Pe.fromNumber=Yr;Pe.fromString=pD;var gW=function(){return new Fp},_W=function(){return sg()},wy=og,yW=NN,vW=pa,UC={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},of=DN,wW=st,EW=Or,ul=Pe;const $C="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}bt.UNAUTHENTICATED=new bt(null),bt.GOOGLE_CREDENTIALS=new bt("google-credentials-uid"),bt.FIRST_PARTY=new bt("first-party-uid"),bt.MOCK_USER=new bt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let uu="10.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ds=new nu("@firebase/firestore");function cw(){return Ds.logLevel}function IW(t){Ds.setLogLevel(t)}function O(t,...e){if(Ds.logLevel<=pe.DEBUG){const n=e.map(oI);Ds.debug(`Firestore (${uu}): ${t}`,...n)}}function lt(t,...e){if(Ds.logLevel<=pe.ERROR){const n=e.map(oI);Ds.error(`Firestore (${uu}): ${t}`,...n)}}function Lr(t,...e){if(Ds.logLevel<=pe.WARN){const n=e.map(oI);Ds.warn(`Firestore (${uu}): ${t}`,...n)}}function oI(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function W(t="Unexpected state"){const e=`FIRESTORE (${uu}) INTERNAL ASSERTION FAILED: `+t;throw lt(e),new Error(e)}function Y(t,e){t||W()}function TW(t,e){t||W()}function B(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class D extends en{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dt{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mD{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class SW{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(bt.UNAUTHENTICATED))}shutdown(){}}class CW{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class RW{constructor(e){this.t=e,this.currentUser=bt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){let r=this.i;const i=l=>this.i!==r?(r=this.i,n(l)):Promise.resolve();let s=new Dt;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Dt,e.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const l=s;e.enqueueRetryable(async()=>{await l.promise,await i(this.currentUser)})},a=l=>{O("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(O("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Dt)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(O("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Y(typeof r.accessToken=="string"),new mD(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return Y(e===null||typeof e=="string"),new bt(e)}}class AW{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=bt.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class PW{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new AW(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(bt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class bW{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class kW{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){const r=s=>{s.error!=null&&O("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.R;return this.R=s.token,O("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{O("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):O("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Y(typeof n.token=="string"),this.R=n.token,new bW(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xW(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gD{static V(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const i=xW(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%e.length))}return r}}function se(t,e){return t<e?-1:t>e?1:0}function Nl(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}function _D(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class He{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new D(A.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new D(A.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new D(A.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new D(A.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return He.fromMillis(Date.now())}static fromDate(e){return He.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new He(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?se(this.nanoseconds,e.nanoseconds):se(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Q(e)}static min(){return new Q(new He(0,0))}static max(){return new Q(new He(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yh{constructor(e,n,r){n===void 0?n=0:n>e.length&&W(),r===void 0?r=e.length-n:r>e.length-n&&W(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return yh.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof yh?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let i=0;i<r;i++){const s=e.get(i),o=n.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class ge extends yh{construct(e,n,r){return new ge(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new D(A.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new ge(n)}static emptyPath(){return new ge([])}}const NW=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ut extends yh{construct(e,n,r){return new ut(e,n,r)}static isValidIdentifier(e){return NW.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ut.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new ut(["__name__"])}static fromServerFormat(e){const n=[];let r="",i=0;const s=()=>{if(r.length===0)throw new D(A.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;i<e.length;){const a=e[i];if(a==="\\"){if(i+1===e.length)throw new D(A.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new D(A.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new D(A.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new ut(n)}static emptyPath(){return new ut([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ${constructor(e){this.path=e}static fromPath(e){return new $(ge.fromString(e))}static fromName(e){return new $(ge.fromString(e).popFirst(5))}static empty(){return new $(ge.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ge.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return ge.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new $(new ge(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yD{constructor(e,n,r,i){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=i}}function hw(t){return t.fields.find(e=>e.kind===2)}function po(t){return t.fields.filter(e=>e.kind!==2)}yD.UNKNOWN_ID=-1;class DW{constructor(e,n){this.fieldPath=e,this.kind=n}}class Bp{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new Bp(0,Xn.min())}}function vD(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=Q.fromTimestamp(r===1e9?new He(n+1,0):new He(n,r));return new Xn(i,$.empty(),e)}function wD(t){return new Xn(t.readTime,t.key,-1)}class Xn{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Xn(Q.min(),$.empty(),-1)}static max(){return new Xn(Q.max(),$.empty(),-1)}}function aI(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=$.comparator(t.documentKey,e.documentKey),n!==0?n:se(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ED="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class ID{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eo(t){if(t.code!==A.FAILED_PRECONDITION||t.message!==ED)throw t;O("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&W(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new R((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof R?n:R.resolve(n)}catch(n){return R.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):R.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):R.reject(n)}static resolve(e){return new R((n,r)=>{n(e)})}static reject(e){return new R((n,r)=>{r(e)})}static waitFor(e){return new R((n,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&n()},l=>r(l))}),o=!0,s===i&&n()})}static or(e){let n=R.resolve(!1);for(const r of e)n=n.next(i=>i?R.resolve(i):r());return n}static forEach(e,n){const r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new R((r,i)=>{const s=e.length,o=new Array(s);let a=0;for(let l=0;l<s;l++){const u=l;n(e[u]).next(c=>{o[u]=c,++a,a===s&&r(o)},c=>i(c))}})}static doWhile(e,n){return new R((r,i)=>{const s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mg{constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.m=new Dt,this.transaction.oncomplete=()=>{this.m.resolve()},this.transaction.onabort=()=>{n.error?this.m.reject(new Sc(e,n.error)):this.m.resolve()},this.transaction.onerror=r=>{const i=lI(r.target.error);this.m.reject(new Sc(e,i))}}static open(e,n,r,i){try{return new mg(n,e.transaction(i,r))}catch(s){throw new Sc(n,s)}}get g(){return this.m.promise}abort(e){e&&this.m.reject(e),this.aborted||(O("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}p(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new LW(n)}}class Rr{constructor(e,n,r){this.name=e,this.version=n,this.S=r,Rr.D(Ze())===12.2&&lt("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return O("SimpleDb","Removing database:",e),go(window.indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!th())return!1;if(Rr.C())return!0;const e=Ze(),n=Rr.D(e),r=0<n&&n<10,i=Rr.F(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static C(){var e;return typeof process<"u"&&((e=process.env)===null||e===void 0?void 0:e.M)==="YES"}static O(e,n){return e.store(n)}static D(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}static F(e){const n=e.match(/Android ([\d.]+)/i),r=n?n[1].split(".").slice(0,2).join("."):"-1";return Number(r)}async N(e){return this.db||(O("SimpleDb","Opening database:",this.name),this.db=await new Promise((n,r)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{const o=s.target.result;n(o)},i.onblocked=()=>{r(new Sc(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{const o=s.target.error;o.name==="VersionError"?r(new D(A.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new D(A.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new Sc(e,o))},i.onupgradeneeded=s=>{O("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const o=s.target.result;this.S.B(o,i.transaction,s.oldVersion,this.version).next(()=>{O("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.L&&(this.db.onversionchange=n=>this.L(n)),this.db}k(e){this.L=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,r,i){const s=n==="readonly";let o=0;for(;;){++o;try{this.db=await this.N(e);const a=mg.open(this.db,e,s?"readonly":"readwrite",r),l=i(a).next(u=>(a.p(),u)).catch(u=>(a.abort(u),R.reject(u))).toPromise();return l.catch(()=>{}),await a.g,l}catch(a){const l=a,u=l.name!=="FirebaseError"&&o<3;if(O("SimpleDb","Transaction failed with error:",l.message,"Retrying:",u),this.close(),!u)return Promise.reject(l)}}}close(){this.db&&this.db.close(),this.db=void 0}}class OW{constructor(e){this.q=e,this.K=!1,this.$=null}get isDone(){return this.K}get U(){return this.$}set cursor(e){this.q=e}done(){this.K=!0}W(e){this.$=e}delete(){return go(this.q.delete())}}class Sc extends D{constructor(e,n){super(A.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function to(t){return t.name==="IndexedDbTransactionError"}class LW{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(O("SimpleDb","PUT",this.store.name,e,n),r=this.store.put(n,e)):(O("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),go(r)}add(e){return O("SimpleDb","ADD",this.store.name,e,e),go(this.store.add(e))}get(e){return go(this.store.get(e)).next(n=>(n===void 0&&(n=null),O("SimpleDb","GET",this.store.name,e,n),n))}delete(e){return O("SimpleDb","DELETE",this.store.name,e),go(this.store.delete(e))}count(){return O("SimpleDb","COUNT",this.store.name),go(this.store.count())}G(e,n){const r=this.options(e,n);if(r.index||typeof this.store.getAll!="function"){const i=this.cursor(r),s=[];return this.j(i,(o,a)=>{s.push(a)}).next(()=>s)}{const i=this.store.getAll(r.range);return new R((s,o)=>{i.onerror=a=>{o(a.target.error)},i.onsuccess=a=>{s(a.target.result)}})}}H(e,n){const r=this.store.getAll(e,n===null?void 0:n);return new R((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}J(e,n){O("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,n);r.Y=!1;const i=this.cursor(r);return this.j(i,(s,o,a)=>a.delete())}Z(e,n){let r;n?r=e:(r={},n=e);const i=this.cursor(r);return this.j(i,n)}X(e){const n=this.cursor({});return new R((r,i)=>{n.onerror=s=>{const o=lI(s.target.error);i(o)},n.onsuccess=s=>{const o=s.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}j(e,n){const r=[];return new R((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void i();const l=new OW(a),u=n(a.primaryKey,a.value,l);if(u instanceof R){const c=u.catch(h=>(l.done(),R.reject(h)));r.push(c)}l.isDone?i():l.U===null?a.continue():a.continue(l.U)}}).next(()=>R.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.Y?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function go(t){return new R((e,n)=>{t.onsuccess=r=>{const i=r.target.result;e(i)},t.onerror=r=>{const i=lI(r.target.error);n(i)}})}let BC=!1;function lI(t){const e=Rr.D(Ze());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const r=new D("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return BC||(BC=!0,setTimeout(()=>{throw r},0)),r}}return t}class MW{constructor(e,n){this.asyncQueue=e,this.ee=n,this.task=null}start(){this.te(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}te(e){O("IndexBackiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{O("IndexBackiller",`Documents written: ${await this.ee.ne()}`)}catch(n){to(n)?O("IndexBackiller","Ignoring IndexedDB error during index backfill: ",n):await eo(n)}await this.te(6e4)})}}class VW{constructor(e,n){this.localStore=e,this.persistence=n}async ne(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.re(n,e))}re(e,n){const r=new Set;let i=n,s=!0;return R.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return O("IndexBackiller",`Processing collection: ${o}`),this.ie(e,o,i).next(a=>{i-=a,r.add(o)});s=!1})).next(()=>n-i)}ie(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(i=>this.localStore.localDocuments.getNextDocuments(e,n,i,r).next(s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.se(i,s)).next(a=>(O("IndexBackiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a))).next(()=>o.size)}))}se(e,n){let r=e;return n.changes.forEach((i,s)=>{const o=wD(s);aI(o,r)>0&&(r=o)}),new Xn(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bn{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.oe(r),this._e=r=>n.writeSequenceNumber(r))}oe(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this._e&&this._e(e),e}}bn.ae=-1;function ld(t){return t==null}function vh(t){return t===0&&1/t==-1/0}function TD(t){return typeof t=="number"&&Number.isInteger(t)&&!vh(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gn(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=zC(e)),e=FW(t.get(n),e);return zC(e)}function FW(t,e){let n=e;const r=t.length;for(let i=0;i<r;i++){const s=t.charAt(i);switch(s){case"\0":n+="";break;case"":n+="";break;default:n+=s}}return n}function zC(t){return t+""}function Xr(t){const e=t.length;if(Y(e>=2),e===2)return Y(t.charAt(0)===""&&t.charAt(1)===""),ge.emptyPath();const n=e-2,r=[];let i="";for(let s=0;s<e;){const o=t.indexOf("",s);switch((o<0||o>n)&&W(),t.charAt(o+1)){case"":const a=t.substring(s,o);let l;i.length===0?l=a:(i+=a,l=i,i=""),r.push(l);break;case"":i+=t.substring(s,o),i+="\0";break;case"":i+=t.substring(s,o+1);break;default:W()}s=o+2}return new ge(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jC=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jf(t,e){return[t,gn(e)]}function SD(t,e,n){return[t,gn(e),n]}const UW={},$W=["prefixPath","collectionGroup","readTime","documentId"],BW=["prefixPath","collectionGroup","documentId"],zW=["collectionGroup","readTime","prefixPath","documentId"],jW=["canonicalId","targetId"],qW=["targetId","path"],WW=["path","targetId"],HW=["collectionId","parent"],GW=["indexId","uid"],KW=["uid","sequenceNumber"],QW=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],YW=["indexId","uid","orderedDocumentKey"],XW=["userId","collectionPath","documentId"],JW=["userId","collectionPath","largestBatchId"],ZW=["userId","collectionGroup","largestBatchId"],CD=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],e8=[...CD,"documentOverlays"],RD=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],AD=RD,t8=[...AD,"indexConfiguration","indexState","indexEntries"];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dw extends ID{constructor(e,n){super(),this.ue=e,this.currentSequenceNumber=n}}function Vt(t,e){const n=B(t);return Rr.O(n.ue,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qC(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function ma(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function PD(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let et=class fw{constructor(e,n){this.comparator=e,this.root=n||Ts.EMPTY}insert(e,n){return new fw(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Ts.BLACK,null,null))}remove(e){return new fw(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ts.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new af(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new af(this.root,e,this.comparator,!1)}getReverseIterator(){return new af(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new af(this.root,e,this.comparator,!0)}},af=class{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Ts=class gi{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??gi.RED,this.left=i??gi.EMPTY,this.right=s??gi.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new gi(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return gi.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return gi.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,gi.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,gi.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw W();const e=this.left.check();if(e!==this.right.check())throw W();return e+(this.isRed()?0:1)}};Ts.EMPTY=null,Ts.RED=!0,Ts.BLACK=!1;Ts.EMPTY=new class{constructor(){this.size=0}get key(){throw W()}get value(){throw W()}get color(){throw W()}get left(){throw W()}get right(){throw W()}copy(e,n,r,i,s){return this}insert(e,n,r){return new Ts(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Be{constructor(e){this.comparator=e,this.data=new et(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new WC(this.data.getIterator())}getIteratorFrom(e){return new WC(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Be)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Be(this.comparator);return n.data=e,n}}class WC{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function ka(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kn{constructor(e){this.fields=e,e.sort(ut.comparator)}static empty(){return new kn([])}unionWith(e){let n=new Be(ut.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new kn(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Nl(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bD extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n8(){return typeof atob<"u"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tt{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new bD("Invalid base64 string: "+s):s}}(e);return new Tt(n)}static fromUint8Array(e){const n=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new Tt(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return se(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Tt.EMPTY_BYTE_STRING=new Tt("");const r8=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Os(t){if(Y(!!t),typeof t=="string"){let e=0;const n=r8.exec(t);if(Y(!!n),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:rt(t.seconds),nanos:rt(t.nanos)}}function rt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Ls(t){return typeof t=="string"?Tt.fromBase64String(t):Tt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gg(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function uI(t){const e=t.mapValue.fields.__previous_value__;return gg(e)?uI(e):e}function wh(t){const e=Os(t.mapValue.fields.__local_write_time__.timestampValue);return new He(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i8{constructor(e,n,r,i,s,o,a,l,u){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=u}}class Ms{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new Ms("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Ms&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cs={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},qf={nullValue:"NULL_VALUE"};function Xo(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?gg(t)?4:kD(t)?9007199254740991:10:W()}function oi(t,e){if(t===e)return!0;const n=Xo(t);if(n!==Xo(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return wh(t).isEqual(wh(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=Os(i.timestampValue),a=Os(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return Ls(i.bytesValue).isEqual(Ls(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return rt(i.geoPointValue.latitude)===rt(s.geoPointValue.latitude)&&rt(i.geoPointValue.longitude)===rt(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return rt(i.integerValue)===rt(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=rt(i.doubleValue),a=rt(s.doubleValue);return o===a?vh(o)===vh(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return Nl(t.arrayValue.values||[],e.arrayValue.values||[],oi);case 10:return function(i,s){const o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(qC(o)!==qC(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!oi(o[l],a[l])))return!1;return!0}(t,e);default:return W()}}function Eh(t,e){return(t.values||[]).find(n=>oi(n,e))!==void 0}function Vs(t,e){if(t===e)return 0;const n=Xo(t),r=Xo(e);if(n!==r)return se(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return se(t.booleanValue,e.booleanValue);case 2:return function(s,o){const a=rt(s.integerValue||s.doubleValue),l=rt(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(t,e);case 3:return HC(t.timestampValue,e.timestampValue);case 4:return HC(wh(t),wh(e));case 5:return se(t.stringValue,e.stringValue);case 6:return function(s,o){const a=Ls(s),l=Ls(o);return a.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(s,o){const a=s.split("/"),l=o.split("/");for(let u=0;u<a.length&&u<l.length;u++){const c=se(a[u],l[u]);if(c!==0)return c}return se(a.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,o){const a=se(rt(s.latitude),rt(o.latitude));return a!==0?a:se(rt(s.longitude),rt(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(s,o){const a=s.values||[],l=o.values||[];for(let u=0;u<a.length&&u<l.length;++u){const c=Vs(a[u],l[u]);if(c)return c}return se(a.length,l.length)}(t.arrayValue,e.arrayValue);case 10:return function(s,o){if(s===cs.mapValue&&o===cs.mapValue)return 0;if(s===cs.mapValue)return 1;if(o===cs.mapValue)return-1;const a=s.fields||{},l=Object.keys(a),u=o.fields||{},c=Object.keys(u);l.sort(),c.sort();for(let h=0;h<l.length&&h<c.length;++h){const f=se(l[h],c[h]);if(f!==0)return f;const g=Vs(a[l[h]],u[c[h]]);if(g!==0)return g}return se(l.length,c.length)}(t.mapValue,e.mapValue);default:throw W()}}function HC(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return se(t,e);const n=Os(t),r=Os(e),i=se(n.seconds,r.seconds);return i!==0?i:se(n.nanos,r.nanos)}function Dl(t){return pw(t)}function pw(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Os(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Ls(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return $.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(const s of n.values||[])i?i=!1:r+=",",r+=pw(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let i="{",s=!0;for(const o of r)s?s=!1:i+=",",i+=`${o}:${pw(n.fields[o])}`;return i+"}"}(t.mapValue):W()}function Jo(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function mw(t){return!!t&&"integerValue"in t}function Ih(t){return!!t&&"arrayValue"in t}function GC(t){return!!t&&"nullValue"in t}function KC(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Wf(t){return!!t&&"mapValue"in t}function Cc(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return ma(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Cc(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Cc(t.arrayValue.values[n]);return e}return Object.assign({},t)}function kD(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}function s8(t){return"nullValue"in t?qf:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?Jo(Ms.empty(),$.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?{mapValue:{}}:W()}function o8(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?Jo(Ms.empty(),$.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?{mapValue:{}}:"mapValue"in t?cs:W()}function QC(t,e){const n=Vs(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function YC(t,e){const n=Vs(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jt{constructor(e){this.value=e}static empty(){return new jt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Wf(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Cc(n)}setAll(e){let n=ut.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const l=this.getFieldsMap(n);this.applyChanges(l,r,i),r={},i=[],n=a.popLast()}o?r[a.lastSegment()]=Cc(o):i.push(a.lastSegment())});const s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){const n=this.field(e.popLast());Wf(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return oi(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];Wf(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){ma(n,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new jt(Cc(this.value))}}function xD(t){const e=[];return ma(t.fields,(n,r)=>{const i=new ut([n]);if(Wf(r)){const s=xD(r.mapValue).fields;if(s.length===0)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)}),new kn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ue{constructor(e,n,r,i,s,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new Ue(e,0,Q.min(),Q.min(),Q.min(),jt.empty(),0)}static newFoundDocument(e,n,r,i){return new Ue(e,1,n,Q.min(),r,i,0)}static newNoDocument(e,n){return new Ue(e,2,n,Q.min(),Q.min(),jt.empty(),0)}static newUnknownDocument(e,n){return new Ue(e,3,n,Q.min(),Q.min(),jt.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(Q.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=jt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=jt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Q.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Ue&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Ue(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fs{constructor(e,n){this.position=e,this.inclusive=n}}function XC(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const s=e[i],o=t.position[i];if(s.field.isKeyField()?r=$.comparator($.fromName(o.referenceValue),n.key):r=Vs(o,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function JC(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!oi(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cl{constructor(e,n="asc"){this.field=e,this.dir=n}}function a8(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ND{}class de extends ND{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new l8(e,n,r):n==="array-contains"?new h8(e,r):n==="in"?new FD(e,r):n==="not-in"?new d8(e,r):n==="array-contains-any"?new f8(e,r):new de(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new u8(e,r):new c8(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(Vs(n,this.value)):n!==null&&Xo(this.value)===Xo(n)&&this.matchesComparison(Vs(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return W()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}getFirstInequalityField(){return this.isInequality()?this.field:null}}class Re extends ND{constructor(e,n){super(),this.filters=e,this.op=n,this.ce=null}static create(e,n){return new Re(e,n)}matches(e){return Ol(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ce!==null||(this.ce=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ce}getFilters(){return Object.assign([],this.filters)}getFirstInequalityField(){const e=this.le(n=>n.isInequality());return e!==null?e.field:null}le(e){for(const n of this.getFlattenedFilters())if(e(n))return n;return null}}function Ol(t){return t.op==="and"}function gw(t){return t.op==="or"}function cI(t){return DD(t)&&Ol(t)}function DD(t){for(const e of t.filters)if(e instanceof Re)return!1;return!0}function _w(t){if(t instanceof de)return t.field.canonicalString()+t.op.toString()+Dl(t.value);if(cI(t))return t.filters.map(e=>_w(e)).join(",");{const e=t.filters.map(n=>_w(n)).join(",");return`${t.op}(${e})`}}function OD(t,e){return t instanceof de?function(r,i){return i instanceof de&&r.op===i.op&&r.field.isEqual(i.field)&&oi(r.value,i.value)}(t,e):t instanceof Re?function(r,i){return i instanceof Re&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&OD(o,i.filters[a]),!0):!1}(t,e):void W()}function LD(t,e){const n=t.filters.concat(e);return Re.create(n,t.op)}function MD(t){return t instanceof de?function(n){return`${n.field.canonicalString()} ${n.op} ${Dl(n.value)}`}(t):t instanceof Re?function(n){return n.op.toString()+" {"+n.getFilters().map(MD).join(" ,")+"}"}(t):"Filter"}class l8 extends de{constructor(e,n,r){super(e,n,r),this.key=$.fromName(r.referenceValue)}matches(e){const n=$.comparator(e.key,this.key);return this.matchesComparison(n)}}class u8 extends de{constructor(e,n){super(e,"in",n),this.keys=VD("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class c8 extends de{constructor(e,n){super(e,"not-in",n),this.keys=VD("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function VD(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>$.fromName(r.referenceValue))}class h8 extends de{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Ih(n)&&Eh(n.arrayValue,this.value)}}class FD extends de{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Eh(this.value.arrayValue,n)}}class d8 extends de{constructor(e,n){super(e,"not-in",n)}matches(e){if(Eh(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!Eh(this.value.arrayValue,n)}}class f8 extends de{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Ih(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Eh(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p8{constructor(e,n=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.he=null}}function yw(t,e=null,n=[],r=[],i=null,s=null,o=null){return new p8(t,e,n,r,i,s,o)}function Zo(t){const e=B(t);if(e.he===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>_w(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),ld(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Dl(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Dl(r)).join(",")),e.he=n}return e.he}function ud(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!a8(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!OD(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!JC(t.startAt,e.startAt)&&JC(t.endAt,e.endAt)}function zp(t){return $.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function jp(t,e){return t.filters.filter(n=>n instanceof de&&n.field.isEqual(e))}function ZC(t,e,n){let r=qf,i=!0;for(const s of jp(t,e)){let o=qf,a=!0;switch(s.op){case"<":case"<=":o=s8(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=qf}QC({value:r,inclusive:i},{value:o,inclusive:a})<0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=n.position[s];QC({value:r,inclusive:i},{value:o,inclusive:n.inclusive})<0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}function eR(t,e,n){let r=cs,i=!0;for(const s of jp(t,e)){let o=cs,a=!0;switch(s.op){case">=":case">":o=o8(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=cs}YC({value:r,inclusive:i},{value:o,inclusive:a})>0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=n.position[s];YC({value:r,inclusive:i},{value:o,inclusive:n.inclusive})>0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qi{constructor(e,n=null,r=[],i=[],s=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=l,this.Pe=null,this.Ie=null,this.Te=null,this.startAt,this.endAt}}function UD(t,e,n,r,i,s,o,a){return new qi(t,e,n,r,i,s,o,a)}function cu(t){return new qi(t)}function tR(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function hI(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}function _g(t){for(const e of t.filters){const n=e.getFirstInequalityField();if(n!==null)return n}return null}function dI(t){return t.collectionGroup!==null}function hl(t){const e=B(t);if(e.Pe===null){e.Pe=[];const n=_g(e),r=hI(e);if(n!==null&&r===null)n.isKeyField()||e.Pe.push(new cl(n)),e.Pe.push(new cl(ut.keyField(),"asc"));else{let i=!1;for(const s of e.explicitOrderBy)e.Pe.push(s),s.field.isKeyField()&&(i=!0);if(!i){const s=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.Pe.push(new cl(ut.keyField(),s))}}}return e.Pe}function Fn(t){const e=B(t);return e.Ie||(e.Ie=m8(e,hl(t))),e.Ie}function m8(t,e){if(t.limitType==="F")return yw(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new cl(i.field,s)});const n=t.endAt?new Fs(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Fs(t.startAt.position,t.startAt.inclusive):null;return yw(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function vw(t,e){e.getFirstInequalityField(),_g(t);const n=t.filters.concat([e]);return new qi(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function qp(t,e,n){return new qi(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function cd(t,e){return ud(Fn(t),Fn(e))&&t.limitType===e.limitType}function $D(t){return`${Zo(Fn(t))}|lt:${t.limitType}`}function ww(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>MD(i)).join(", ")}]`),ld(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>Dl(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>Dl(i)).join(",")),`Target(${r})`}(Fn(t))}; limitType=${t.limitType})`}function hd(t,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):$.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(const s of hl(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(o,a,l){const u=XC(o,a,l);return o.inclusive?u<=0:u<0}(r.startAt,hl(r),i)||r.endAt&&!function(o,a,l){const u=XC(o,a,l);return o.inclusive?u>=0:u>0}(r.endAt,hl(r),i))}(t,e)}function BD(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function zD(t){return(e,n)=>{let r=!1;for(const i of hl(t)){const s=g8(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function g8(t,e,n){const r=t.field.isKeyField()?$.comparator(e.key,n.key):function(s,o,a){const l=o.data.field(s),u=a.data.field(s);return l!==null&&u!==null?Vs(l,u):W()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return W()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class no{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){ma(this.inner,(n,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return PD(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _8=new et($.comparator);function xn(){return _8}const jD=new et($.comparator);function ac(...t){let e=jD;for(const n of t)e=e.insert(n.key,n);return e}function qD(t){let e=jD;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function Jr(){return Rc()}function WD(){return Rc()}function Rc(){return new no(t=>t.toString(),(t,e)=>t.isEqual(e))}const y8=new et($.comparator),v8=new Be($.comparator);function ae(...t){let e=v8;for(const n of t)e=e.add(n);return e}const w8=new Be(se);function fI(){return w8}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HD(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:vh(e)?"-0":e}}function GD(t){return{integerValue:""+t}}function KD(t,e){return TD(e)?GD(e):HD(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yg{constructor(){this._=void 0}}function E8(t,e,n){return t instanceof Ll?function(i,s){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&gg(s)&&(s=uI(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(n,e):t instanceof ea?YD(t,e):t instanceof ta?XD(t,e):function(i,s){const o=QD(i,s),a=nR(o)+nR(i.Ee);return mw(o)&&mw(i.Ee)?GD(a):HD(i.serializer,a)}(t,e)}function I8(t,e,n){return t instanceof ea?YD(t,e):t instanceof ta?XD(t,e):n}function QD(t,e){return t instanceof Ml?function(r){return mw(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}class Ll extends yg{}class ea extends yg{constructor(e){super(),this.elements=e}}function YD(t,e){const n=JD(e);for(const r of t.elements)n.some(i=>oi(i,r))||n.push(r);return{arrayValue:{values:n}}}class ta extends yg{constructor(e){super(),this.elements=e}}function XD(t,e){let n=JD(e);for(const r of t.elements)n=n.filter(i=>!oi(i,r));return{arrayValue:{values:n}}}class Ml extends yg{constructor(e,n){super(),this.serializer=e,this.Ee=n}}function nR(t){return rt(t.integerValue||t.doubleValue)}function JD(t){return Ih(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dd{constructor(e,n){this.field=e,this.transform=n}}function T8(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof ea&&i instanceof ea||r instanceof ta&&i instanceof ta?Nl(r.elements,i.elements,oi):r instanceof Ml&&i instanceof Ml?oi(r.Ee,i.Ee):r instanceof Ll&&i instanceof Ll}(t.transform,e.transform)}class S8{constructor(e,n){this.version=e,this.transformResults=n}}class qe{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new qe}static exists(e){return new qe(void 0,e)}static updateTime(e){return new qe(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Hf(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class vg{}function ZD(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new du(t.key,qe.none()):new hu(t.key,t.data,qe.none());{const n=t.data,r=jt.empty();let i=new Be(ut.comparator);for(let s of e.fields)if(!i.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new Wi(t.key,r,new kn(i.toArray()),qe.none())}}function C8(t,e,n){t instanceof hu?function(i,s,o){const a=i.value.clone(),l=iR(i.fieldTransforms,s,o.transformResults);a.setAll(l),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof Wi?function(i,s,o){if(!Hf(i.precondition,s))return void s.convertToUnknownDocument(o.version);const a=iR(i.fieldTransforms,s,o.transformResults),l=s.data;l.setAll(eO(i)),l.setAll(a),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function Ac(t,e,n,r){return t instanceof hu?function(s,o,a,l){if(!Hf(s.precondition,o))return a;const u=s.value.clone(),c=sR(s.fieldTransforms,l,o);return u.setAll(c),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(t,e,n,r):t instanceof Wi?function(s,o,a,l){if(!Hf(s.precondition,o))return a;const u=sR(s.fieldTransforms,l,o),c=o.data;return c.setAll(eO(s)),c.setAll(u),o.convertToFoundDocument(o.version,c).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(h=>h.field))}(t,e,n,r):function(s,o,a){return Hf(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function R8(t,e){let n=null;for(const r of t.fieldTransforms){const i=e.data.field(r.field),s=QD(r.transform,i||null);s!=null&&(n===null&&(n=jt.empty()),n.set(r.field,s))}return n||null}function rR(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Nl(r,i,(s,o)=>T8(s,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class hu extends vg{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Wi extends vg{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function eO(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function iR(t,e,n){const r=new Map;Y(t.length===n.length);for(let i=0;i<n.length;i++){const s=t[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,I8(o,a,n[i]))}return r}function sR(t,e,n){const r=new Map;for(const i of t){const s=i.transform,o=n.data.field(i.field);r.set(i.field,E8(s,o,e))}return r}class du extends vg{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class pI extends vg{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mI{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&C8(s,e,r[i])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=Ac(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=Ac(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=WD();return this.mutations.forEach(i=>{const s=e.get(i.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=n.has(i.key)?null:a;const l=ZD(o,a);l!==null&&r.set(i.key,l),o.isValidDocument()||o.convertToNoDocument(Q.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),ae())}isEqual(e){return this.batchId===e.batchId&&Nl(this.mutations,e.mutations,(n,r)=>rR(n,r))&&Nl(this.baseMutations,e.baseMutations,(n,r)=>rR(n,r))}}class gI{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){Y(e.mutations.length===r.length);let i=function(){return y8}();const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new gI(e,n,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _I{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A8{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ft,me;function tO(t){switch(t){default:return W();case A.CANCELLED:case A.UNKNOWN:case A.DEADLINE_EXCEEDED:case A.RESOURCE_EXHAUSTED:case A.INTERNAL:case A.UNAVAILABLE:case A.UNAUTHENTICATED:return!1;case A.INVALID_ARGUMENT:case A.NOT_FOUND:case A.ALREADY_EXISTS:case A.PERMISSION_DENIED:case A.FAILED_PRECONDITION:case A.ABORTED:case A.OUT_OF_RANGE:case A.UNIMPLEMENTED:case A.DATA_LOSS:return!0}}function nO(t){if(t===void 0)return lt("GRPC error has no .code"),A.UNKNOWN;switch(t){case ft.OK:return A.OK;case ft.CANCELLED:return A.CANCELLED;case ft.UNKNOWN:return A.UNKNOWN;case ft.DEADLINE_EXCEEDED:return A.DEADLINE_EXCEEDED;case ft.RESOURCE_EXHAUSTED:return A.RESOURCE_EXHAUSTED;case ft.INTERNAL:return A.INTERNAL;case ft.UNAVAILABLE:return A.UNAVAILABLE;case ft.UNAUTHENTICATED:return A.UNAUTHENTICATED;case ft.INVALID_ARGUMENT:return A.INVALID_ARGUMENT;case ft.NOT_FOUND:return A.NOT_FOUND;case ft.ALREADY_EXISTS:return A.ALREADY_EXISTS;case ft.PERMISSION_DENIED:return A.PERMISSION_DENIED;case ft.FAILED_PRECONDITION:return A.FAILED_PRECONDITION;case ft.ABORTED:return A.ABORTED;case ft.OUT_OF_RANGE:return A.OUT_OF_RANGE;case ft.UNIMPLEMENTED:return A.UNIMPLEMENTED;case ft.DATA_LOSS:return A.DATA_LOSS;default:return W()}}(me=ft||(ft={}))[me.OK=0]="OK",me[me.CANCELLED=1]="CANCELLED",me[me.UNKNOWN=2]="UNKNOWN",me[me.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",me[me.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",me[me.NOT_FOUND=5]="NOT_FOUND",me[me.ALREADY_EXISTS=6]="ALREADY_EXISTS",me[me.PERMISSION_DENIED=7]="PERMISSION_DENIED",me[me.UNAUTHENTICATED=16]="UNAUTHENTICATED",me[me.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",me[me.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",me[me.ABORTED=10]="ABORTED",me[me.OUT_OF_RANGE=11]="OUT_OF_RANGE",me[me.UNIMPLEMENTED=12]="UNIMPLEMENTED",me[me.INTERNAL=13]="INTERNAL",me[me.UNAVAILABLE=14]="UNAVAILABLE",me[me.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rO(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P8=new ul([4294967295,4294967295],0);function oR(t){const e=rO().encode(t),n=new EW;return n.update(e),new Uint8Array(n.digest())}function aR(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new ul([n,r],0),new ul([i,s],0)]}class yI{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new lc(`Invalid padding: ${n}`);if(r<0)throw new lc(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new lc(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new lc(`Invalid padding when bitmap length is 0: ${n}`);this.Ae=8*e.length-n,this.Re=ul.fromNumber(this.Ae)}Ve(e,n,r){let i=e.add(n.multiply(ul.fromNumber(r)));return i.compare(P8)===1&&(i=new ul([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Re).toNumber()}me(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ae===0)return!1;const n=oR(e),[r,i]=aR(n);for(let s=0;s<this.hashCount;s++){const o=this.Ve(r,i,s);if(!this.me(o))return!1}return!0}static create(e,n,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new yI(s,i,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.Ae===0)return;const n=oR(e),[r,i]=aR(n);for(let s=0;s<this.hashCount;s++){const o=this.Ve(r,i,s);this.fe(o)}}fe(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class lc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fd{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const i=new Map;return i.set(e,pd.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new fd(Q.min(),i,new et(se),xn(),ae())}}class pd{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new pd(r,n,ae(),ae(),ae())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gf{constructor(e,n,r,i){this.ge=e,this.removedTargetIds=n,this.key=r,this.pe=i}}class iO{constructor(e,n){this.targetId=e,this.ye=n}}class sO{constructor(e,n,r=Tt.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}}class lR{constructor(){this.we=0,this.Se=cR(),this.be=Tt.EMPTY_BYTE_STRING,this.De=!1,this.ve=!0}get current(){return this.De}get resumeToken(){return this.be}get Ce(){return this.we!==0}get Fe(){return this.ve}Me(e){e.approximateByteSize()>0&&(this.ve=!0,this.be=e)}xe(){let e=ae(),n=ae(),r=ae();return this.Se.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:W()}}),new pd(this.be,this.De,e,n,r)}Oe(){this.ve=!1,this.Se=cR()}Ne(e,n){this.ve=!0,this.Se=this.Se.insert(e,n)}Be(e){this.ve=!0,this.Se=this.Se.remove(e)}Le(){this.we+=1}ke(){this.we-=1}qe(){this.ve=!0,this.De=!0}}class b8{constructor(e){this.Qe=e,this.Ke=new Map,this.$e=xn(),this.Ue=uR(),this.We=new et(se)}Ge(e){for(const n of e.ge)e.pe&&e.pe.isFoundDocument()?this.ze(n,e.pe):this.je(n,e.key,e.pe);for(const n of e.removedTargetIds)this.je(n,e.key,e.pe)}He(e){this.forEachTarget(e,n=>{const r=this.Je(n);switch(e.state){case 0:this.Ye(n)&&r.Me(e.resumeToken);break;case 1:r.ke(),r.Ce||r.Oe(),r.Me(e.resumeToken);break;case 2:r.ke(),r.Ce||this.removeTarget(n);break;case 3:this.Ye(n)&&(r.qe(),r.Me(e.resumeToken));break;case 4:this.Ye(n)&&(this.Ze(n),r.Me(e.resumeToken));break;default:W()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Ke.forEach((r,i)=>{this.Ye(i)&&n(i)})}Xe(e){const n=e.targetId,r=e.ye.count,i=this.et(n);if(i){const s=i.target;if(zp(s))if(r===0){const o=new $(s.path);this.je(n,o,Ue.newNoDocument(o,Q.min()))}else Y(r===1);else{const o=this.tt(n);if(o!==r){const a=this.nt(e),l=a?this.rt(a,e,o):1;if(l!==0){this.Ze(n);const u=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.We=this.We.insert(n,u)}}}}}nt(e){const n=e.ye.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n;let o,a;try{o=Ls(r).toUint8Array()}catch(l){if(l instanceof bD)return Lr("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new yI(o,i,s)}catch(l){return Lr(l instanceof lc?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.Ae===0?null:a}rt(e,n,r){return n.ye.count===r-this.ot(e,n.targetId)?0:2}ot(e,n){const r=this.Qe.getRemoteKeysForTarget(n);let i=0;return r.forEach(s=>{const o=this.Qe.st(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.je(n,s,null),i++)}),i}_t(e){const n=new Map;this.Ke.forEach((s,o)=>{const a=this.et(o);if(a){if(s.current&&zp(a.target)){const l=new $(a.target.path);this.$e.get(l)!==null||this.ut(o,l)||this.je(o,l,Ue.newNoDocument(l,e))}s.Fe&&(n.set(o,s.xe()),s.Oe())}});let r=ae();this.Ue.forEach((s,o)=>{let a=!0;o.forEachWhile(l=>{const u=this.et(l);return!u||u.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.$e.forEach((s,o)=>o.setReadTime(e));const i=new fd(e,n,this.We,this.$e,r);return this.$e=xn(),this.Ue=uR(),this.We=new et(se),i}ze(e,n){if(!this.Ye(e))return;const r=this.ut(e,n.key)?2:0;this.Je(e).Ne(n.key,r),this.$e=this.$e.insert(n.key,n),this.Ue=this.Ue.insert(n.key,this.ct(n.key).add(e))}je(e,n,r){if(!this.Ye(e))return;const i=this.Je(e);this.ut(e,n)?i.Ne(n,1):i.Be(n),this.Ue=this.Ue.insert(n,this.ct(n).delete(e)),r&&(this.$e=this.$e.insert(n,r))}removeTarget(e){this.Ke.delete(e)}tt(e){const n=this.Je(e).xe();return this.Qe.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Le(e){this.Je(e).Le()}Je(e){let n=this.Ke.get(e);return n||(n=new lR,this.Ke.set(e,n)),n}ct(e){let n=this.Ue.get(e);return n||(n=new Be(se),this.Ue=this.Ue.insert(e,n)),n}Ye(e){const n=this.et(e)!==null;return n||O("WatchChangeAggregator","Detected inactive target",e),n}et(e){const n=this.Ke.get(e);return n&&n.Ce?null:this.Qe.lt(e)}Ze(e){this.Ke.set(e,new lR),this.Qe.getRemoteKeysForTarget(e).forEach(n=>{this.je(e,n,null)})}ut(e,n){return this.Qe.getRemoteKeysForTarget(e).has(n)}}function uR(){return new et($.comparator)}function cR(){return new et($.comparator)}const k8=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),x8=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),N8=(()=>({and:"AND",or:"OR"}))();class D8{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Ew(t,e){return t.useProto3Json||ld(e)?e:{value:e}}function Vl(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function oO(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function O8(t,e){return Vl(t,e.toTimestamp())}function ct(t){return Y(!!t),Q.fromTimestamp(function(n){const r=Os(n);return new He(r.seconds,r.nanos)}(t))}function vI(t,e){return function(r){return new ge(["projects",r.projectId,"databases",r.database])}(t).child("documents").child(e).canonicalString()}function aO(t){const e=ge.fromString(t);return Y(gO(e)),e}function Th(t,e){return vI(t.databaseId,e.path)}function ti(t,e){const n=aO(e);if(n.get(1)!==t.databaseId.projectId)throw new D(A.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new D(A.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new $(uO(n))}function Iw(t,e){return vI(t.databaseId,e)}function lO(t){const e=aO(t);return e.length===4?ge.emptyPath():uO(e)}function Sh(t){return new ge(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function uO(t){return Y(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function hR(t,e,n){return{name:Th(t,e),fields:n.value.mapValue.fields}}function cO(t,e,n){const r=ti(t,e.name),i=ct(e.updateTime),s=e.createTime?ct(e.createTime):Q.min(),o=new jt({mapValue:{fields:e.fields}}),a=Ue.newFoundDocument(r,i,s,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function L8(t,e){return"found"in e?function(r,i){Y(!!i.found),i.found.name,i.found.updateTime;const s=ti(r,i.found.name),o=ct(i.found.updateTime),a=i.found.createTime?ct(i.found.createTime):Q.min(),l=new jt({mapValue:{fields:i.found.fields}});return Ue.newFoundDocument(s,o,a,l)}(t,e):"missing"in e?function(r,i){Y(!!i.missing),Y(!!i.readTime);const s=ti(r,i.missing),o=ct(i.readTime);return Ue.newNoDocument(s,o)}(t,e):W()}function M8(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:W()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(u,c){return u.useProto3Json?(Y(c===void 0||typeof c=="string"),Tt.fromBase64String(c||"")):(Y(c===void 0||c instanceof Uint8Array),Tt.fromUint8Array(c||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(u){const c=u.code===void 0?A.UNKNOWN:nO(u.code);return new D(c,u.message||"")}(o);n=new sO(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=ti(t,r.document.name),s=ct(r.document.updateTime),o=r.document.createTime?ct(r.document.createTime):Q.min(),a=new jt({mapValue:{fields:r.document.fields}}),l=Ue.newFoundDocument(i,s,o,a),u=r.targetIds||[],c=r.removedTargetIds||[];n=new Gf(u,c,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=ti(t,r.document),s=r.readTime?ct(r.readTime):Q.min(),o=Ue.newNoDocument(i,s),a=r.removedTargetIds||[];n=new Gf([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=ti(t,r.document),s=r.removedTargetIds||[];n=new Gf([],s,i,null)}else{if(!("filter"in e))return W();{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,o=new A8(i,s),a=r.targetId;n=new iO(a,o)}}return n}function Ch(t,e){let n;if(e instanceof hu)n={update:hR(t,e.key,e.value)};else if(e instanceof du)n={delete:Th(t,e.key)};else if(e instanceof Wi)n={update:hR(t,e.key,e.data),updateMask:z8(e.fieldMask)};else{if(!(e instanceof pI))return W();n={verify:Th(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,o){const a=o.transform;if(a instanceof Ll)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof ea)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof ta)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Ml)return{fieldPath:o.field.canonicalString(),increment:a.Ee};throw W()}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:O8(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:W()}(t,e.precondition)),n}function Tw(t,e){const n=e.currentDocument?function(s){return s.updateTime!==void 0?qe.updateTime(ct(s.updateTime)):s.exists!==void 0?qe.exists(s.exists):qe.none()}(e.currentDocument):qe.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(o,a){let l=null;if("setToServerValue"in a)Y(a.setToServerValue==="REQUEST_TIME"),l=new Ll;else if("appendMissingElements"in a){const c=a.appendMissingElements.values||[];l=new ea(c)}else if("removeAllFromArray"in a){const c=a.removeAllFromArray.values||[];l=new ta(c)}else"increment"in a?l=new Ml(o,a.increment):W();const u=ut.fromServerFormat(a.fieldPath);return new dd(u,l)}(t,i)):[];if(e.update){e.update.name;const i=ti(t,e.update.name),s=new jt({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(l){const u=l.fieldPaths||[];return new kn(u.map(c=>ut.fromServerFormat(c)))}(e.updateMask);return new Wi(i,s,o,n,r)}return new hu(i,s,n,r)}if(e.delete){const i=ti(t,e.delete);return new du(i,n)}if(e.verify){const i=ti(t,e.verify);return new pI(i,n)}return W()}function V8(t,e){return t&&t.length>0?(Y(e!==void 0),t.map(n=>function(i,s){let o=i.updateTime?ct(i.updateTime):ct(s);return o.isEqual(Q.min())&&(o=ct(s)),new S8(o,i.transformResults||[])}(n,e))):[]}function hO(t,e){return{documents:[Iw(t,e.path)]}}function dO(t,e){const n={structuredQuery:{}},r=e.path;e.collectionGroup!==null?(n.parent=Iw(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Iw(t,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);const i=function(l){if(l.length!==0)return mO(Re.create(l,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const s=function(l){if(l.length!==0)return l.map(u=>function(h){return{field:Oa(h.field),direction:U8(h.dir)}}(u))}(e.orderBy);s&&(n.structuredQuery.orderBy=s);const o=Ew(t,e.limit);return o!==null&&(n.structuredQuery.limit=o),e.startAt&&(n.structuredQuery.startAt=function(l){return{before:l.inclusive,values:l.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(l){return{before:!l.inclusive,values:l.position}}(e.endAt)),n}function fO(t){let e=lO(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){Y(r===1);const c=n.from[0];c.allDescendants?i=c.collectionId:e=e.child(c.collectionId)}let s=[];n.where&&(s=function(h){const f=pO(h);return f instanceof Re&&cI(f)?f.getFilters():[f]}(n.where));let o=[];n.orderBy&&(o=function(h){return h.map(f=>function(_){return new cl(La(_.field),function(T){switch(T){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(_.direction))}(f))}(n.orderBy));let a=null;n.limit&&(a=function(h){let f;return f=typeof h=="object"?h.value:h,ld(f)?null:f}(n.limit));let l=null;n.startAt&&(l=function(h){const f=!!h.before,g=h.values||[];return new Fs(g,f)}(n.startAt));let u=null;return n.endAt&&(u=function(h){const f=!h.before,g=h.values||[];return new Fs(g,f)}(n.endAt)),UD(e,i,o,s,a,"F",l,u)}function F8(t,e){const n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return W()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function pO(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=La(n.unaryFilter.field);return de.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=La(n.unaryFilter.field);return de.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=La(n.unaryFilter.field);return de.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=La(n.unaryFilter.field);return de.create(o,"!=",{nullValue:"NULL_VALUE"});default:return W()}}(t):t.fieldFilter!==void 0?function(n){return de.create(La(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return W()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Re.create(n.compositeFilter.filters.map(r=>pO(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return W()}}(n.compositeFilter.op))}(t):W()}function U8(t){return k8[t]}function $8(t){return x8[t]}function B8(t){return N8[t]}function Oa(t){return{fieldPath:t.canonicalString()}}function La(t){return ut.fromServerFormat(t.fieldPath)}function mO(t){return t instanceof de?function(n){if(n.op==="=="){if(KC(n.value))return{unaryFilter:{field:Oa(n.field),op:"IS_NAN"}};if(GC(n.value))return{unaryFilter:{field:Oa(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(KC(n.value))return{unaryFilter:{field:Oa(n.field),op:"IS_NOT_NAN"}};if(GC(n.value))return{unaryFilter:{field:Oa(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Oa(n.field),op:$8(n.op),value:n.value}}}(t):t instanceof Re?function(n){const r=n.getFilters().map(i=>mO(i));return r.length===1?r[0]:{compositeFilter:{op:B8(n.op),filters:r}}}(t):W()}function z8(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function gO(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ci{constructor(e,n,r,i,s=Q.min(),o=Q.min(),a=Tt.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new Ci(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Ci(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ci(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ci(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _O{constructor(e){this.ht=e}}function j8(t,e){let n;if(e.document)n=cO(t.ht,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=$.fromSegments(e.noDocument.path),i=ra(e.noDocument.readTime);n=Ue.newNoDocument(r,i),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return W();{const r=$.fromSegments(e.unknownDocument.path),i=ra(e.unknownDocument.version);n=Ue.newUnknownDocument(r,i)}}return e.readTime&&n.setReadTime(function(i){const s=new He(i[0],i[1]);return Q.fromTimestamp(s)}(e.readTime)),n}function dR(t,e){const n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:Wp(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(s,o){return{name:Th(s,o.key),fields:o.data.value.mapValue.fields,updateTime:Vl(s,o.version.toTimestamp()),createTime:Vl(s,o.createTime.toTimestamp())}}(t.ht,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:na(e.version)};else{if(!e.isUnknownDocument())return W();r.unknownDocument={path:n.path.toArray(),version:na(e.version)}}return r}function Wp(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function na(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function ra(t){const e=new He(t.seconds,t.nanoseconds);return Q.fromTimestamp(e)}function _o(t,e){const n=(e.baseMutations||[]).map(s=>Tw(t.ht,s));for(let s=0;s<e.mutations.length-1;++s){const o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const a=e.mutations[s+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const r=e.mutations.map(s=>Tw(t.ht,s)),i=He.fromMillis(e.localWriteTimeMs);return new mI(e.batchId,i,n,r)}function uc(t){const e=ra(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?ra(t.lastLimboFreeSnapshotVersion):Q.min();let r;return r=function(s){return s.documents!==void 0}(t.query)?function(s){return Y(s.documents.length===1),Fn(cu(lO(s.documents[0])))}(t.query):function(s){return Fn(fO(s))}(t.query),new Ci(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,Tt.fromBase64String(t.resumeToken))}function yO(t,e){const n=na(e.snapshotVersion),r=na(e.lastLimboFreeSnapshotVersion);let i;i=zp(e.target)?hO(t.ht,e.target):dO(t.ht,e.target);const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Zo(e.target),readTime:n,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function wI(t){const e=fO({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?qp(e,e.limit,"L"):e}function Ey(t,e){return new _I(e.largestBatchId,Tw(t.ht,e.overlayMutation))}function fR(t,e){const n=e.path.lastSegment();return[t,gn(e.path.popLast()),n]}function pR(t,e,n,r){return{indexId:t,uid:e.uid||"",sequenceNumber:n,readTime:na(r.readTime),documentKey:gn(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q8{getBundleMetadata(e,n){return mR(e).get(n).next(r=>{if(r)return function(s){return{id:s.bundleId,createTime:ra(s.createTime),version:s.version}}(r)})}saveBundleMetadata(e,n){return mR(e).put(function(i){return{bundleId:i.id,createTime:na(ct(i.createTime)),version:i.version}}(n))}getNamedQuery(e,n){return gR(e).get(n).next(r=>{if(r)return function(s){return{name:s.name,query:wI(s.bundledQuery),readTime:ra(s.readTime)}}(r)})}saveNamedQuery(e,n){return gR(e).put(function(i){return{name:i.name,readTime:na(ct(i.readTime)),bundledQuery:i.bundledQuery}}(n))}}function mR(t){return Vt(t,"bundles")}function gR(t){return Vt(t,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wg{constructor(e,n){this.serializer=e,this.userId=n}static Pt(e,n){const r=n.uid||"";return new wg(e,r)}getOverlay(e,n){return $u(e).get(fR(this.userId,n)).next(r=>r?Ey(this.serializer,r):null)}getOverlays(e,n){const r=Jr();return R.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){const i=[];return r.forEach((s,o)=>{const a=new _I(n,o);i.push(this.It(e,a))}),R.waitFor(i)}removeOverlaysForBatchId(e,n,r){const i=new Set;n.forEach(o=>i.add(gn(o.getCollectionPath())));const s=[];return i.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push($u(e).J("collectionPathOverlayIndex",a))}),R.waitFor(s)}getOverlaysForCollection(e,n,r){const i=Jr(),s=gn(n),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return $u(e).G("collectionPathOverlayIndex",o).next(a=>{for(const l of a){const u=Ey(this.serializer,l);i.set(u.getKey(),u)}return i})}getOverlaysForCollectionGroup(e,n,r,i){const s=Jr();let o;const a=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return $u(e).Z({index:"collectionGroupOverlayIndex",range:a},(l,u,c)=>{const h=Ey(this.serializer,u);s.size()<i||h.largestBatchId===o?(s.set(h.getKey(),h),o=h.largestBatchId):c.done()}).next(()=>s)}It(e,n){return $u(e).put(function(i,s,o){const[a,l,u]=fR(s,o.mutation.key);return{userId:s,collectionPath:l,documentId:u,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:Ch(i.ht,o.mutation)}}(this.serializer,this.userId,n))}}function $u(t){return Vt(t,"documentOverlays")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yo{constructor(){}Tt(e,n){this.Et(e,n),n.dt()}Et(e,n){if("nullValue"in e)this.At(n,5);else if("booleanValue"in e)this.At(n,10),n.Rt(e.booleanValue?1:0);else if("integerValue"in e)this.At(n,15),n.Rt(rt(e.integerValue));else if("doubleValue"in e){const r=rt(e.doubleValue);isNaN(r)?this.At(n,13):(this.At(n,15),vh(r)?n.Rt(0):n.Rt(r))}else if("timestampValue"in e){const r=e.timestampValue;this.At(n,20),typeof r=="string"?n.Vt(r):(n.Vt(`${r.seconds||""}`),n.Rt(r.nanos||0))}else if("stringValue"in e)this.ft(e.stringValue,n),this.gt(n);else if("bytesValue"in e)this.At(n,30),n.yt(Ls(e.bytesValue)),this.gt(n);else if("referenceValue"in e)this.wt(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.At(n,45),n.Rt(r.latitude||0),n.Rt(r.longitude||0)}else"mapValue"in e?kD(e)?this.At(n,Number.MAX_SAFE_INTEGER):(this.St(e.mapValue,n),this.gt(n)):"arrayValue"in e?(this.bt(e.arrayValue,n),this.gt(n)):W()}ft(e,n){this.At(n,25),this.Dt(e,n)}Dt(e,n){n.Vt(e)}St(e,n){const r=e.fields||{};this.At(n,55);for(const i of Object.keys(r))this.ft(i,n),this.Et(r[i],n)}bt(e,n){const r=e.values||[];this.At(n,50);for(const i of r)this.Et(i,n)}wt(e,n){this.At(n,37),$.fromName(e).path.forEach(r=>{this.At(n,60),this.Dt(r,n)})}At(e,n){e.Rt(n)}gt(e){e.Rt(2)}}yo.vt=new yo;function W8(t){if(t===0)return 8;let e=0;return!(t>>4)&&(e+=4,t<<=4),!(t>>6)&&(e+=2,t<<=2),!(t>>7)&&(e+=1),e}function _R(t){const e=64-function(r){let i=0;for(let s=0;s<8;++s){const o=W8(255&r[s]);if(i+=o,o!==8)break}return i}(t);return Math.ceil(e/8)}class H8{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ct(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Ft(r.value),r=n.next();this.Mt()}xt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Ot(r.value),r=n.next();this.Nt()}Bt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Ft(r);else if(r<2048)this.Ft(960|r>>>6),this.Ft(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Ft(480|r>>>12),this.Ft(128|63&r>>>6),this.Ft(128|63&r);else{const i=n.codePointAt(0);this.Ft(240|i>>>18),this.Ft(128|63&i>>>12),this.Ft(128|63&i>>>6),this.Ft(128|63&i)}}this.Mt()}Lt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Ot(r);else if(r<2048)this.Ot(960|r>>>6),this.Ot(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Ot(480|r>>>12),this.Ot(128|63&r>>>6),this.Ot(128|63&r);else{const i=n.codePointAt(0);this.Ot(240|i>>>18),this.Ot(128|63&i>>>12),this.Ot(128|63&i>>>6),this.Ot(128|63&i)}}this.Nt()}kt(e){const n=this.qt(e),r=_R(n);this.Qt(1+r),this.buffer[this.position++]=255&r;for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=255&n[i]}Kt(e){const n=this.qt(e),r=_R(n);this.Qt(1+r),this.buffer[this.position++]=~(255&r);for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=~(255&n[i])}$t(){this.Ut(255),this.Ut(255)}Wt(){this.Gt(255),this.Gt(255)}reset(){this.position=0}seed(e){this.Qt(e.length),this.buffer.set(e,this.position),this.position+=e.length}zt(){return this.buffer.slice(0,this.position)}qt(e){const n=function(s){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),r=(128&n[0])!=0;n[0]^=r?255:128;for(let i=1;i<n.length;++i)n[i]^=r?255:0;return n}Ft(e){const n=255&e;n===0?(this.Ut(0),this.Ut(255)):n===255?(this.Ut(255),this.Ut(0)):this.Ut(n)}Ot(e){const n=255&e;n===0?(this.Gt(0),this.Gt(255)):n===255?(this.Gt(255),this.Gt(0)):this.Gt(e)}Mt(){this.Ut(0),this.Ut(1)}Nt(){this.Gt(0),this.Gt(1)}Ut(e){this.Qt(1),this.buffer[this.position++]=e}Gt(e){this.Qt(1),this.buffer[this.position++]=~e}Qt(e){const n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class G8{constructor(e){this.jt=e}yt(e){this.jt.Ct(e)}Vt(e){this.jt.Bt(e)}Rt(e){this.jt.kt(e)}dt(){this.jt.$t()}}class K8{constructor(e){this.jt=e}yt(e){this.jt.xt(e)}Vt(e){this.jt.Lt(e)}Rt(e){this.jt.Kt(e)}dt(){this.jt.Wt()}}class Bu{constructor(){this.jt=new H8,this.Ht=new G8(this.jt),this.Jt=new K8(this.jt)}seed(e){this.jt.seed(e)}Yt(e){return e===0?this.Ht:this.Jt}zt(){return this.jt.zt()}reset(){this.jt.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vo{constructor(e,n,r,i){this.indexId=e,this.documentKey=n,this.arrayValue=r,this.directionalValue=i}Zt(){const e=this.directionalValue.length,n=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.directionalValue,0),n!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new vo(this.indexId,this.documentKey,this.arrayValue,r)}}function Xi(t,e){let n=t.indexId-e.indexId;return n!==0?n:(n=yR(t.arrayValue,e.arrayValue),n!==0?n:(n=yR(t.directionalValue,e.directionalValue),n!==0?n:$.comparator(t.documentKey,e.documentKey)))}function yR(t,e){for(let n=0;n<t.length&&n<e.length;++n){const r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q8{constructor(e){this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.Xt=e.orderBy,this.en=[];for(const n of e.filters){const r=n;r.isInequality()?this.tn=r:this.en.push(r)}}nn(e){Y(e.collectionGroup===this.collectionId);const n=hw(e);if(n!==void 0&&!this.rn(n))return!1;const r=po(e);let i=new Set,s=0,o=0;for(;s<r.length&&this.rn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.tn!==void 0){if(!i.has(this.tn.field.canonicalString())){const a=r[s];if(!this.sn(this.tn,a)||!this.on(this.Xt[o++],a))return!1}++s}for(;s<r.length;++s){const a=r[s];if(o>=this.Xt.length||!this.on(this.Xt[o++],a))return!1}return!0}rn(e){for(const n of this.en)if(this.sn(n,e))return!0;return!1}sn(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}on(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vO(t){var e,n;if(Y(t instanceof de||t instanceof Re),t instanceof de){if(t instanceof FD){const i=((n=(e=t.value.arrayValue)===null||e===void 0?void 0:e.values)===null||n===void 0?void 0:n.map(s=>de.create(t.field,"==",s)))||[];return Re.create(i,"or")}return t}const r=t.filters.map(i=>vO(i));return Re.create(r,t.op)}function Y8(t){if(t.getFilters().length===0)return[];const e=Rw(vO(t));return Y(wO(e)),Sw(e)||Cw(e)?[e]:e.getFilters()}function Sw(t){return t instanceof de}function Cw(t){return t instanceof Re&&cI(t)}function wO(t){return Sw(t)||Cw(t)||function(n){if(n instanceof Re&&gw(n)){for(const r of n.getFilters())if(!Sw(r)&&!Cw(r))return!1;return!0}return!1}(t)}function Rw(t){if(Y(t instanceof de||t instanceof Re),t instanceof de)return t;if(t.filters.length===1)return Rw(t.filters[0]);const e=t.filters.map(r=>Rw(r));let n=Re.create(e,t.op);return n=Hp(n),wO(n)?n:(Y(n instanceof Re),Y(Ol(n)),Y(n.filters.length>1),n.filters.reduce((r,i)=>EI(r,i)))}function EI(t,e){let n;return Y(t instanceof de||t instanceof Re),Y(e instanceof de||e instanceof Re),n=t instanceof de?e instanceof de?function(i,s){return Re.create([i,s],"and")}(t,e):vR(t,e):e instanceof de?vR(e,t):function(i,s){if(Y(i.filters.length>0&&s.filters.length>0),Ol(i)&&Ol(s))return LD(i,s.getFilters());const o=gw(i)?i:s,a=gw(i)?s:i,l=o.filters.map(u=>EI(u,a));return Re.create(l,"or")}(t,e),Hp(n)}function vR(t,e){if(Ol(e))return LD(e,t.getFilters());{const n=e.filters.map(r=>EI(t,r));return Re.create(n,"or")}}function Hp(t){if(Y(t instanceof de||t instanceof Re),t instanceof de)return t;const e=t.getFilters();if(e.length===1)return Hp(e[0]);if(DD(t))return t;const n=e.map(i=>Hp(i)),r=[];return n.forEach(i=>{i instanceof de?r.push(i):i instanceof Re&&(i.op===t.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:Re.create(r,t.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X8{constructor(){this._n=new II}addToCollectionParentIndex(e,n){return this._n.add(n),R.resolve()}getCollectionParents(e,n){return R.resolve(this._n.getEntries(n))}addFieldIndex(e,n){return R.resolve()}deleteFieldIndex(e,n){return R.resolve()}getDocumentsMatchingTarget(e,n){return R.resolve(null)}getIndexType(e,n){return R.resolve(0)}getFieldIndexes(e,n){return R.resolve([])}getNextCollectionGroupToUpdate(e){return R.resolve(null)}getMinOffset(e,n){return R.resolve(Xn.min())}getMinOffsetFromCollectionGroup(e,n){return R.resolve(Xn.min())}updateCollectionGroup(e,n,r){return R.resolve()}updateIndexEntries(e,n){return R.resolve()}}class II{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new Be(ge.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Be(ge.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lf=new Uint8Array(0);class J8{constructor(e,n){this.user=e,this.databaseId=n,this.an=new II,this.un=new no(r=>Zo(r),(r,i)=>ud(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.an.has(n)){const r=n.lastSegment(),i=n.popLast();e.addOnCommittedListener(()=>{this.an.add(n)});const s={collectionId:r,parent:gn(i)};return wR(e).put(s)}return R.resolve()}getCollectionParents(e,n){const r=[],i=IDBKeyRange.bound([n,""],[_D(n),""],!1,!0);return wR(e).G(i).next(s=>{for(const o of s){if(o.collectionId!==n)break;r.push(Xr(o.parent))}return r})}addFieldIndex(e,n){const r=uf(e),i=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(l=>[l.fieldPath.canonicalString(),l.kind])}}(n);delete i.indexId;const s=r.add(i);if(n.indexState){const o=ju(e);return s.next(a=>{o.put(pR(a,this.user,n.indexState.sequenceNumber,n.indexState.offset))})}return s.next()}deleteFieldIndex(e,n){const r=uf(e),i=ju(e),s=zu(e);return r.delete(n.indexId).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}getDocumentsMatchingTarget(e,n){const r=zu(e);let i=!0;const s=new Map;return R.forEach(this.cn(n),o=>this.ln(e,o).next(a=>{i&&(i=!!a),s.set(o,a)})).next(()=>{if(i){let o=ae();const a=[];return R.forEach(s,(l,u)=>{O("IndexedDbIndexManager",`Using index ${function(I){return`id=${I.indexId}|cg=${I.collectionGroup}|f=${I.fields.map(C=>`${C.fieldPath}:${C.kind}`).join(",")}`}(l)} to execute ${Zo(n)}`);const c=function(I,C){const P=hw(C);if(P===void 0)return null;for(const b of jp(I,P.fieldPath))switch(b.op){case"array-contains-any":return b.value.arrayValue.values||[];case"array-contains":return[b.value]}return null}(u,l),h=function(I,C){const P=new Map;for(const b of po(C))for(const k of jp(I,b.fieldPath))switch(k.op){case"==":case"in":P.set(b.fieldPath.canonicalString(),k.value);break;case"not-in":case"!=":return P.set(b.fieldPath.canonicalString(),k.value),Array.from(P.values())}return null}(u,l),f=function(I,C){const P=[];let b=!0;for(const k of po(C)){const F=k.kind===0?ZC(I,k.fieldPath,I.startAt):eR(I,k.fieldPath,I.startAt);P.push(F.value),b&&(b=F.inclusive)}return new Fs(P,b)}(u,l),g=function(I,C){const P=[];let b=!0;for(const k of po(C)){const F=k.kind===0?eR(I,k.fieldPath,I.endAt):ZC(I,k.fieldPath,I.endAt);P.push(F.value),b&&(b=F.inclusive)}return new Fs(P,b)}(u,l),_=this.hn(l,u,f),w=this.hn(l,u,g),T=this.Pn(l,u,h),v=this.In(l.indexId,c,_,f.inclusive,w,g.inclusive,T);return R.forEach(v,y=>r.H(y,n.limit).next(I=>{I.forEach(C=>{const P=$.fromSegments(C.documentKey);o.has(P)||(o=o.add(P),a.push(P))})}))}).next(()=>a)}return R.resolve(null)})}cn(e){let n=this.un.get(e);return n||(e.filters.length===0?n=[e]:n=Y8(Re.create(e.filters,"and")).map(r=>yw(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.un.set(e,n),n)}In(e,n,r,i,s,o,a){const l=(n!=null?n.length:1)*Math.max(r.length,s.length),u=l/(n!=null?n.length:1),c=[];for(let h=0;h<l;++h){const f=n?this.Tn(n[h/u]):lf,g=this.En(e,f,r[h%u],i),_=this.dn(e,f,s[h%u],o),w=a.map(T=>this.En(e,f,T,!0));c.push(...this.createRange(g,_,w))}return c}En(e,n,r,i){const s=new vo(e,$.empty(),n,r);return i?s:s.Zt()}dn(e,n,r,i){const s=new vo(e,$.empty(),n,r);return i?s.Zt():s}ln(e,n){const r=new Q8(n),i=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(const a of s)r.nn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,n){let r=2;const i=this.cn(n);return R.forEach(i,s=>this.ln(e,s).next(o=>{o?r!==0&&o.fields.length<function(l){let u=new Be(ut.comparator),c=!1;for(const h of l.filters)for(const f of h.getFlattenedFilters())f.field.isKeyField()||(f.op==="array-contains"||f.op==="array-contains-any"?c=!0:u=u.add(f.field));for(const h of l.orderBy)h.field.isKeyField()||(u=u.add(h.field));return u.size+(c?1:0)}(s)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(n)&&i.length>1&&r===2?1:r)}An(e,n){const r=new Bu;for(const i of po(e)){const s=n.data.field(i.fieldPath);if(s==null)return null;const o=r.Yt(i.kind);yo.vt.Tt(s,o)}return r.zt()}Tn(e){const n=new Bu;return yo.vt.Tt(e,n.Yt(0)),n.zt()}Rn(e,n){const r=new Bu;return yo.vt.Tt(Jo(this.databaseId,n),r.Yt(function(s){const o=po(s);return o.length===0?0:o[o.length-1].kind}(e))),r.zt()}Pn(e,n,r){if(r===null)return[];let i=[];i.push(new Bu);let s=0;for(const o of po(e)){const a=r[s++];for(const l of i)if(this.Vn(n,o.fieldPath)&&Ih(a))i=this.mn(i,o,a);else{const u=l.Yt(o.kind);yo.vt.Tt(a,u)}}return this.fn(i)}hn(e,n,r){return this.Pn(e,n,r.position)}fn(e){const n=[];for(let r=0;r<e.length;++r)n[r]=e[r].zt();return n}mn(e,n,r){const i=[...e],s=[];for(const o of r.arrayValue.values||[])for(const a of i){const l=new Bu;l.seed(a.zt()),yo.vt.Tt(o,l.Yt(n.kind)),s.push(l)}return s}Vn(e,n){return!!e.filters.find(r=>r instanceof de&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){const r=uf(e),i=ju(e);return(n?r.G("collectionGroupIndex",IDBKeyRange.bound(n,n)):r.G()).next(s=>{const o=[];return R.forEach(s,a=>i.get([a.indexId,this.uid]).next(l=>{o.push(function(c,h){const f=h?new Bp(h.sequenceNumber,new Xn(ra(h.readTime),new $(Xr(h.documentKey)),h.largestBatchId)):Bp.empty(),g=c.fields.map(([_,w])=>new DW(ut.fromServerFormat(_),w));return new yD(c.indexId,c.collectionGroup,g,f)}(a,l))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,i)=>{const s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:se(r.collectionGroup,i.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){const i=uf(e),s=ju(e);return this.gn(e).next(o=>i.G("collectionGroupIndex",IDBKeyRange.bound(n,n)).next(a=>R.forEach(a,l=>s.put(pR(l.indexId,this.user,o,r)))))}updateIndexEntries(e,n){const r=new Map;return R.forEach(n,(i,s)=>{const o=r.get(i.collectionGroup);return(o?R.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),R.forEach(a,l=>this.pn(e,i,l).next(u=>{const c=this.yn(s,l);return u.isEqual(c)?R.resolve():this.wn(e,s,l,u,c)}))))})}Sn(e,n,r,i){return zu(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.Rn(r,n.key),documentKey:n.key.path.toArray()})}bn(e,n,r,i){return zu(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.Rn(r,n.key),n.key.path.toArray()])}pn(e,n,r){const i=zu(e);let s=new Be(Xi);return i.Z({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.Rn(r,n)])},(o,a)=>{s=s.add(new vo(r.indexId,n,a.arrayValue,a.directionalValue))}).next(()=>s)}yn(e,n){let r=new Be(Xi);const i=this.An(n,e);if(i==null)return r;const s=hw(n);if(s!=null){const o=e.data.field(s.fieldPath);if(Ih(o))for(const a of o.arrayValue.values||[])r=r.add(new vo(n.indexId,e.key,this.Tn(a),i))}else r=r.add(new vo(n.indexId,e.key,lf,i));return r}wn(e,n,r,i,s){O("IndexedDbIndexManager","Updating index entries for document '%s'",n.key);const o=[];return function(l,u,c,h,f){const g=l.getIterator(),_=u.getIterator();let w=ka(g),T=ka(_);for(;w||T;){let v=!1,y=!1;if(w&&T){const I=c(w,T);I<0?y=!0:I>0&&(v=!0)}else w!=null?y=!0:v=!0;v?(h(T),T=ka(_)):y?(f(w),w=ka(g)):(w=ka(g),T=ka(_))}}(i,s,Xi,a=>{o.push(this.Sn(e,n,r,a))},a=>{o.push(this.bn(e,n,r,a))}),R.waitFor(o)}gn(e){let n=1;return ju(e).Z({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),n=i.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,a)=>Xi(o,a)).filter((o,a,l)=>!a||Xi(o,l[a-1])!==0);const i=[];i.push(e);for(const o of r){const a=Xi(o,e),l=Xi(o,n);if(a===0)i[0]=e.Zt();else if(a>0&&l<0)i.push(o),i.push(o.Zt());else if(l>0)break}i.push(n);const s=[];for(let o=0;o<i.length;o+=2){if(this.Dn(i[o],i[o+1]))return[];const a=[i[o].indexId,this.uid,i[o].arrayValue,i[o].directionalValue,lf,[]],l=[i[o+1].indexId,this.uid,i[o+1].arrayValue,i[o+1].directionalValue,lf,[]];s.push(IDBKeyRange.bound(a,l))}return s}Dn(e,n){return Xi(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(ER)}getMinOffset(e,n){return R.mapArray(this.cn(n),r=>this.ln(e,r).next(i=>i||W())).next(ER)}}function wR(t){return Vt(t,"collectionParents")}function zu(t){return Vt(t,"indexEntries")}function uf(t){return Vt(t,"indexConfiguration")}function ju(t){return Vt(t,"indexState")}function ER(t){Y(t.length!==0);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){const i=t[r].indexState.offset;aI(i,e)<0&&(e=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new Xn(e.readTime,e.documentKey,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IR={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class Sn{constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new Sn(e,Sn.DEFAULT_COLLECTION_PERCENTILE,Sn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EO(t,e,n){const r=t.store("mutations"),i=t.store("documentMutations"),s=[],o=IDBKeyRange.only(n.batchId);let a=0;const l=r.Z({range:o},(c,h,f)=>(a++,f.delete()));s.push(l.next(()=>{Y(a===1)}));const u=[];for(const c of n.mutations){const h=SD(e,c.key.path,n.batchId);s.push(i.delete(h)),u.push(c.key)}return R.waitFor(s).next(()=>u)}function Gp(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw W();e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Sn.DEFAULT_COLLECTION_PERCENTILE=10,Sn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Sn.DEFAULT=new Sn(41943040,Sn.DEFAULT_COLLECTION_PERCENTILE,Sn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Sn.DISABLED=new Sn(-1,0,0);class Eg{constructor(e,n,r,i){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=i,this.vn={}}static Pt(e,n,r,i){Y(e.uid!=="");const s=e.isAuthenticated()?e.uid:"";return new Eg(s,n,r,i)}checkEmpty(e){let n=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Ji(e).Z({index:"userMutationsIndex",range:r},(i,s,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,i){const s=Ma(e),o=Ji(e);return o.add({}).next(a=>{Y(typeof a=="number");const l=new mI(a,n,r,i),u=function(g,_,w){const T=w.baseMutations.map(y=>Ch(g.ht,y)),v=w.mutations.map(y=>Ch(g.ht,y));return{userId:_,batchId:w.batchId,localWriteTimeMs:w.localWriteTime.toMillis(),baseMutations:T,mutations:v}}(this.serializer,this.userId,l),c=[];let h=new Be((f,g)=>se(f.canonicalString(),g.canonicalString()));for(const f of i){const g=SD(this.userId,f.key.path,a);h=h.add(f.key.path.popLast()),c.push(o.put(u)),c.push(s.put(g,UW))}return h.forEach(f=>{c.push(this.indexManager.addToCollectionParentIndex(e,f))}),e.addOnCommittedListener(()=>{this.vn[a]=l.keys()}),R.waitFor(c).next(()=>l)})}lookupMutationBatch(e,n){return Ji(e).get(n).next(r=>r?(Y(r.userId===this.userId),_o(this.serializer,r)):null)}Cn(e,n){return this.vn[n]?R.resolve(this.vn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){const i=r.keys();return this.vn[n]=i,i}return null})}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=IDBKeyRange.lowerBound([this.userId,r]);let s=null;return Ji(e).Z({index:"userMutationsIndex",range:i},(o,a,l)=>{a.userId===this.userId&&(Y(a.batchId>=r),s=_o(this.serializer,a)),l.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return Ji(e).Z({index:"userMutationsIndex",range:n,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Ji(e).G("userMutationsIndex",n).next(r=>r.map(i=>_o(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,n){const r=jf(this.userId,n.path),i=IDBKeyRange.lowerBound(r),s=[];return Ma(e).Z({range:i},(o,a,l)=>{const[u,c,h]=o,f=Xr(c);if(u===this.userId&&n.path.isEqual(f))return Ji(e).get(h).next(g=>{if(!g)throw W();Y(g.userId===this.userId),s.push(_o(this.serializer,g))});l.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Be(se);const i=[];return n.forEach(s=>{const o=jf(this.userId,s.path),a=IDBKeyRange.lowerBound(o),l=Ma(e).Z({range:a},(u,c,h)=>{const[f,g,_]=u,w=Xr(g);f===this.userId&&s.path.isEqual(w)?r=r.add(_):h.done()});i.push(l)}),R.waitFor(i).next(()=>this.Fn(e,r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1,s=jf(this.userId,r),o=IDBKeyRange.lowerBound(s);let a=new Be(se);return Ma(e).Z({range:o},(l,u,c)=>{const[h,f,g]=l,_=Xr(f);h===this.userId&&r.isPrefixOf(_)?_.length===i&&(a=a.add(g)):c.done()}).next(()=>this.Fn(e,a))}Fn(e,n){const r=[],i=[];return n.forEach(s=>{i.push(Ji(e).get(s).next(o=>{if(o===null)throw W();Y(o.userId===this.userId),r.push(_o(this.serializer,o))}))}),R.waitFor(i).next(()=>r)}removeMutationBatch(e,n){return EO(e.ue,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.Mn(n.batchId)}),R.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}Mn(e){delete this.vn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return R.resolve();const r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),i=[];return Ma(e).Z({range:r},(s,o,a)=>{if(s[0]===this.userId){const l=Xr(s[1]);i.push(l)}else a.done()}).next(()=>{Y(i.length===0)})})}containsKey(e,n){return IO(e,this.userId,n)}xn(e){return TO(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function IO(t,e,n){const r=jf(e,n.path),i=r[1],s=IDBKeyRange.lowerBound(r);let o=!1;return Ma(t).Z({range:s,Y:!0},(a,l,u)=>{const[c,h,f]=a;c===e&&h===i&&(o=!0),u.done()}).next(()=>o)}function Ji(t){return Vt(t,"mutations")}function Ma(t){return Vt(t,"documentMutations")}function TO(t){return Vt(t,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ia{constructor(e){this.On=e}next(){return this.On+=2,this.On}static Nn(){return new ia(0)}static Bn(){return new ia(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z8{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.Ln(e).next(n=>{const r=new ia(n.highestTargetId);return n.highestTargetId=r.next(),this.kn(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Ln(e).next(n=>Q.fromTimestamp(new He(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Ln(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.Ln(e).next(i=>(i.highestListenSequenceNumber=n,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),n>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=n),this.kn(e,i)))}addTargetData(e,n){return this.qn(e,n).next(()=>this.Ln(e).next(r=>(r.targetCount+=1,this.Qn(n,r),this.kn(e,r))))}updateTargetData(e,n){return this.qn(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>xa(e).delete(n.targetId)).next(()=>this.Ln(e)).next(r=>(Y(r.targetCount>0),r.targetCount-=1,this.kn(e,r)))}removeTargets(e,n,r){let i=0;const s=[];return xa(e).Z((o,a)=>{const l=uc(a);l.sequenceNumber<=n&&r.get(l.targetId)===null&&(i++,s.push(this.removeTargetData(e,l)))}).next(()=>R.waitFor(s)).next(()=>i)}forEachTarget(e,n){return xa(e).Z((r,i)=>{const s=uc(i);n(s)})}Ln(e){return TR(e).get("targetGlobalKey").next(n=>(Y(n!==null),n))}kn(e,n){return TR(e).put("targetGlobalKey",n)}qn(e,n){return xa(e).put(yO(this.serializer,n))}Qn(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.Ln(e).next(n=>n.targetCount)}getTargetData(e,n){const r=Zo(n),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let s=null;return xa(e).Z({range:i,index:"queryTargetsIndex"},(o,a,l)=>{const u=uc(a);ud(n,u.target)&&(s=u,l.done())}).next(()=>s)}addMatchingKeys(e,n,r){const i=[],s=ss(e);return n.forEach(o=>{const a=gn(o.path);i.push(s.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,o))}),R.waitFor(i)}removeMatchingKeys(e,n,r){const i=ss(e);return R.forEach(n,s=>{const o=gn(s.path);return R.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,n){const r=ss(e),i=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,n){const r=IDBKeyRange.bound([n],[n+1],!1,!0),i=ss(e);let s=ae();return i.Z({range:r,Y:!0},(o,a,l)=>{const u=Xr(o[1]),c=new $(u);s=s.add(c)}).next(()=>s)}containsKey(e,n){const r=gn(n.path),i=IDBKeyRange.bound([r],[_D(r)],!1,!0);let s=0;return ss(e).Z({index:"documentTargetsIndex",Y:!0,range:i},([o,a],l,u)=>{o!==0&&(s++,u.done())}).next(()=>s>0)}lt(e,n){return xa(e).get(n).next(r=>r?uc(r):null)}}function xa(t){return Vt(t,"targets")}function TR(t){return Vt(t,"targetGlobal")}function ss(t){return Vt(t,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SR([t,e],[n,r]){const i=se(t,n);return i===0?se(e,r):i}class eH{constructor(e){this.Kn=e,this.buffer=new Be(SR),this.$n=0}Un(){return++this.$n}Wn(e){const n=[e,this.Un()];if(this.buffer.size<this.Kn)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();SR(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class tH{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Gn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.zn(6e4)}stop(){this.Gn&&(this.Gn.cancel(),this.Gn=null)}get started(){return this.Gn!==null}zn(e){O("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Gn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Gn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){to(n)?O("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",n):await eo(n)}await this.zn(3e5)})}}class nH{constructor(e,n){this.jn=e,this.params=n}calculateTargetCount(e,n){return this.jn.Hn(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return R.resolve(bn.ae);const r=new eH(n);return this.jn.forEachTarget(e,i=>r.Wn(i.sequenceNumber)).next(()=>this.jn.Jn(e,i=>r.Wn(i))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.jn.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.jn.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(O("LruGarbageCollector","Garbage collection skipped; disabled"),R.resolve(IR)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(O("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),IR):this.Yn(e,n))}getCacheSize(e){return this.jn.getCacheSize(e)}Yn(e,n){let r,i,s,o,a,l,u;const c=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(O("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),i=this.params.maximumSequenceNumbersToCollect):i=h,o=Date.now(),this.nthSequenceNumber(e,i))).next(h=>(r=h,a=Date.now(),this.removeTargets(e,r,n))).next(h=>(s=h,l=Date.now(),this.removeOrphanedDocuments(e,r))).next(h=>(u=Date.now(),cw()<=pe.DEBUG&&O("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-c}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(l-a)+`ms
	Removed ${h} documents in `+(u-l)+`ms
Total Duration: ${u-c}ms`),R.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:h})))}}function rH(t,e){return new nH(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iH{constructor(e,n){this.db=e,this.garbageCollector=rH(this,n)}Hn(e){const n=this.Zn(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}Zn(e){let n=0;return this.Jn(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}Jn(e,n){return this.Xn(e,(r,i)=>n(i))}addReference(e,n,r){return cf(e,r)}removeReference(e,n,r){return cf(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return cf(e,n)}er(e,n){return function(i,s){let o=!1;return TO(i).X(a=>IO(i,a,s).next(l=>(l&&(o=!0),R.resolve(!l)))).next(()=>o)}(e,n)}removeOrphanedDocuments(e,n){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let s=0;return this.Xn(e,(o,a)=>{if(a<=n){const l=this.er(e,o).next(u=>{if(!u)return s++,r.getEntry(e,o).next(()=>(r.removeEntry(o,Q.min()),ss(e).delete(function(h){return[0,gn(h.path)]}(o))))});i.push(l)}}).next(()=>R.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return cf(e,n)}Xn(e,n){const r=ss(e);let i,s=bn.ae;return r.Z({index:"documentTargetsIndex"},([o,a],{path:l,sequenceNumber:u})=>{o===0?(s!==bn.ae&&n(new $(Xr(i)),s),s=u,i=l):s=bn.ae}).next(()=>{s!==bn.ae&&n(new $(Xr(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function cf(t,e){return ss(t).put(function(r,i){return{targetId:0,path:gn(r.path),sequenceNumber:i}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SO{constructor(){this.changes=new no(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Ue.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?R.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sH{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return uo(e).put(r)}removeEntry(e,n,r){return uo(e).delete(function(s,o){const a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],Wp(o),a[a.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.tr(e,r)))}getEntry(e,n){let r=Ue.newInvalidDocument(n);return uo(e).Z({index:"documentKeyIndex",range:IDBKeyRange.only(qu(n))},(i,s)=>{r=this.nr(n,s)}).next(()=>r)}rr(e,n){let r={size:0,document:Ue.newInvalidDocument(n)};return uo(e).Z({index:"documentKeyIndex",range:IDBKeyRange.only(qu(n))},(i,s)=>{r={document:this.nr(n,s),size:Gp(s)}}).next(()=>r)}getEntries(e,n){let r=xn();return this.ir(e,n,(i,s)=>{const o=this.nr(i,s);r=r.insert(i,o)}).next(()=>r)}sr(e,n){let r=xn(),i=new et($.comparator);return this.ir(e,n,(s,o)=>{const a=this.nr(s,o);r=r.insert(s,a),i=i.insert(s,Gp(o))}).next(()=>({documents:r,_r:i}))}ir(e,n,r){if(n.isEmpty())return R.resolve();let i=new Be(AR);n.forEach(l=>i=i.add(l));const s=IDBKeyRange.bound(qu(i.first()),qu(i.last())),o=i.getIterator();let a=o.getNext();return uo(e).Z({index:"documentKeyIndex",range:s},(l,u,c)=>{const h=$.fromSegments([...u.prefixPath,u.collectionGroup,u.documentId]);for(;a&&AR(a,h)<0;)r(a,null),a=o.getNext();a&&a.isEqual(h)&&(r(a,u),a=o.hasNext()?o.getNext():null),a?c.W(qu(a)):c.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,n,r,i){const s=n.path,o=[s.popLast().toArray(),s.lastSegment(),Wp(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],a=[s.popLast().toArray(),s.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return uo(e).G(IDBKeyRange.bound(o,a,!0)).next(l=>{let u=xn();for(const c of l){const h=this.nr($.fromSegments(c.prefixPath.concat(c.collectionGroup,c.documentId)),c);h.isFoundDocument()&&(hd(n,h)||i.has(h.key))&&(u=u.insert(h.key,h))}return u})}getAllFromCollectionGroup(e,n,r,i){let s=xn();const o=RR(n,r),a=RR(n,Xn.max());return uo(e).Z({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(l,u,c)=>{const h=this.nr($.fromSegments(u.prefixPath.concat(u.collectionGroup,u.documentId)),u);s=s.insert(h.key,h),s.size===i&&c.done()}).next(()=>s)}newChangeBuffer(e){return new oH(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return CR(e).get("remoteDocumentGlobalKey").next(n=>(Y(!!n),n))}tr(e,n){return CR(e).put("remoteDocumentGlobalKey",n)}nr(e,n){if(n){const r=j8(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(Q.min())))return r}return Ue.newInvalidDocument(e)}}function CO(t){return new sH(t)}class oH extends SO{constructor(e,n){super(),this.ar=e,this.trackRemovals=n,this.ur=new no(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){const n=[];let r=0,i=new Be((s,o)=>se(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{const a=this.ur.get(s);if(n.push(this.ar.removeEntry(e,s,a.readTime)),o.isValidDocument()){const l=dR(this.ar.serializer,o);i=i.add(s.path.popLast());const u=Gp(l);r+=u-a.size,n.push(this.ar.addEntry(e,s,l))}else if(r-=a.size,this.trackRemovals){const l=dR(this.ar.serializer,o.convertToNoDocument(Q.min()));n.push(this.ar.addEntry(e,s,l))}}),i.forEach(s=>{n.push(this.ar.indexManager.addToCollectionParentIndex(e,s))}),n.push(this.ar.updateMetadata(e,r)),R.waitFor(n)}getFromCache(e,n){return this.ar.rr(e,n).next(r=>(this.ur.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.ar.sr(e,n).next(({documents:r,_r:i})=>(i.forEach((s,o)=>{this.ur.set(s,{size:o,readTime:r.get(s).readTime})}),r))}}function CR(t){return Vt(t,"remoteDocumentGlobal")}function uo(t){return Vt(t,"remoteDocumentsV14")}function qu(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function RR(t,e){const n=e.documentKey.path.toArray();return[t,Wp(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function AR(t,e){const n=t.path.toArray(),r=e.path.toArray();let i=0;for(let s=0;s<n.length-2&&s<r.length-2;++s)if(i=se(n[s],r[s]),i)return i;return i=se(n.length,r.length),i||(i=se(n[n.length-2],r[r.length-2]),i||se(n[n.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aH{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RO{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&Ac(r.mutation,i,kn.empty(),He.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,ae()).next(()=>r))}getLocalViewOfDocuments(e,n,r=ae()){const i=Jr();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let o=ac();return s.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=Jr();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,ae()))}populateOverlays(e,n,r){const i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,i){let s=xn();const o=Rc(),a=function(){return Rc()}();return n.forEach((l,u)=>{const c=r.get(u.key);i.has(u.key)&&(c===void 0||c.mutation instanceof Wi)?s=s.insert(u.key,u):c!==void 0?(o.set(u.key,c.mutation.getFieldMask()),Ac(c.mutation,u,c.mutation.getFieldMask(),He.now())):o.set(u.key,kn.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((u,c)=>o.set(u,c)),n.forEach((u,c)=>{var h;return a.set(u,new aH(c,(h=o.get(u))!==null&&h!==void 0?h:null))}),a))}recalculateAndSaveOverlays(e,n){const r=Rc();let i=new et((o,a)=>o-a),s=ae();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(l=>{const u=n.get(l);if(u===null)return;let c=r.get(l)||kn.empty();c=a.applyToLocalView(u,c),r.set(l,c);const h=(i.get(a.batchId)||ae()).add(l);i=i.insert(a.batchId,h)})}).next(()=>{const o=[],a=i.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),u=l.key,c=l.value,h=WD();c.forEach(f=>{if(!s.has(f)){const g=ZD(n.get(f),r.get(f));g!==null&&h.set(f,g),s=s.add(f)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,h))}return R.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r){return function(s){return $.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):dI(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r):this.getDocumentsMatchingCollectionQuery(e,n,r)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):R.resolve(Jr());let a=-1,l=s;return o.next(u=>R.forEach(u,(c,h)=>(a<h.largestBatchId&&(a=h.largestBatchId),s.get(c)?R.resolve():this.remoteDocumentCache.getEntry(e,c).next(f=>{l=l.insert(c,f)}))).next(()=>this.populateOverlays(e,u,s)).next(()=>this.computeViews(e,l,u,ae())).next(c=>({batchId:a,changes:qD(c)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new $(n)).next(r=>{let i=ac();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r){const i=n.collectionGroup;let s=ac();return this.indexManager.getCollectionParents(e,i).next(o=>R.forEach(o,a=>{const l=function(c,h){return new qi(h,null,c.explicitOrderBy.slice(),c.filters.slice(),c.limit,c.limitType,c.startAt,c.endAt)}(n,a.child(i));return this.getDocumentsMatchingCollectionQuery(e,l,r).next(u=>{u.forEach((c,h)=>{s=s.insert(c,h)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,n,r){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(s=>(i=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i))).next(s=>{i.forEach((a,l)=>{const u=l.getKey();s.get(u)===null&&(s=s.insert(u,Ue.newInvalidDocument(u)))});let o=ac();return s.forEach((a,l)=>{const u=i.get(a);u!==void 0&&Ac(u.mutation,l,kn.empty(),He.now()),hd(n,l)&&(o=o.insert(a,l))}),o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lH{constructor(e){this.serializer=e,this.cr=new Map,this.lr=new Map}getBundleMetadata(e,n){return R.resolve(this.cr.get(n))}saveBundleMetadata(e,n){return this.cr.set(n.id,function(i){return{id:i.id,version:i.version,createTime:ct(i.createTime)}}(n)),R.resolve()}getNamedQuery(e,n){return R.resolve(this.lr.get(n))}saveNamedQuery(e,n){return this.lr.set(n.name,function(i){return{name:i.name,query:wI(i.bundledQuery),readTime:ct(i.readTime)}}(n)),R.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uH{constructor(){this.overlays=new et($.comparator),this.hr=new Map}getOverlay(e,n){return R.resolve(this.overlays.get(n))}getOverlays(e,n){const r=Jr();return R.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.It(e,n,s)}),R.resolve()}removeOverlaysForBatchId(e,n,r){const i=this.hr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.hr.delete(r)),R.resolve()}getOverlaysForCollection(e,n,r){const i=Jr(),s=n.length+1,o=new $(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,u=l.getKey();if(!n.isPrefixOf(u.path))break;u.path.length===s&&l.largestBatchId>r&&i.set(l.getKey(),l)}return R.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new et((u,c)=>u-c);const o=this.overlays.getIterator();for(;o.hasNext();){const u=o.getNext().value;if(u.getKey().getCollectionGroup()===n&&u.largestBatchId>r){let c=s.get(u.largestBatchId);c===null&&(c=Jr(),s=s.insert(u.largestBatchId,c)),c.set(u.getKey(),u)}}const a=Jr(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((u,c)=>a.set(u,c)),!(a.size()>=i)););return R.resolve(a)}It(e,n,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.hr.get(i.largestBatchId).delete(r.key);this.hr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new _I(n,r));let s=this.hr.get(n);s===void 0&&(s=ae(),this.hr.set(n,s)),this.hr.set(n,s.add(r.key))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TI{constructor(){this.Pr=new Be(Ct.Ir),this.Tr=new Be(Ct.Er)}isEmpty(){return this.Pr.isEmpty()}addReference(e,n){const r=new Ct(e,n);this.Pr=this.Pr.add(r),this.Tr=this.Tr.add(r)}dr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Ar(new Ct(e,n))}Rr(e,n){e.forEach(r=>this.removeReference(r,n))}Vr(e){const n=new $(new ge([])),r=new Ct(n,e),i=new Ct(n,e+1),s=[];return this.Tr.forEachInRange([r,i],o=>{this.Ar(o),s.push(o.key)}),s}mr(){this.Pr.forEach(e=>this.Ar(e))}Ar(e){this.Pr=this.Pr.delete(e),this.Tr=this.Tr.delete(e)}gr(e){const n=new $(new ge([])),r=new Ct(n,e),i=new Ct(n,e+1);let s=ae();return this.Tr.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){const n=new Ct(e,0),r=this.Pr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class Ct{constructor(e,n){this.key=e,this.pr=n}static Ir(e,n){return $.comparator(e.key,n.key)||se(e.pr,n.pr)}static Er(e,n){return se(e.pr,n.pr)||$.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cH{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.yr=1,this.wr=new Be(Ct.Ir)}checkEmpty(e){return R.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){const s=this.yr;this.yr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new mI(s,n,r,i);this.mutationQueue.push(o);for(const a of i)this.wr=this.wr.add(new Ct(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return R.resolve(o)}lookupMutationBatch(e,n){return R.resolve(this.Sr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=this.br(r),s=i<0?0:i;return R.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return R.resolve(this.mutationQueue.length===0?-1:this.yr-1)}getAllMutationBatches(e){return R.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Ct(n,0),i=new Ct(n,Number.POSITIVE_INFINITY),s=[];return this.wr.forEachInRange([r,i],o=>{const a=this.Sr(o.pr);s.push(a)}),R.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Be(se);return n.forEach(i=>{const s=new Ct(i,0),o=new Ct(i,Number.POSITIVE_INFINITY);this.wr.forEachInRange([s,o],a=>{r=r.add(a.pr)})}),R.resolve(this.Dr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1;let s=r;$.isDocumentKey(s)||(s=s.child(""));const o=new Ct(new $(s),0);let a=new Be(se);return this.wr.forEachWhile(l=>{const u=l.key.path;return!!r.isPrefixOf(u)&&(u.length===i&&(a=a.add(l.pr)),!0)},o),R.resolve(this.Dr(a))}Dr(e){const n=[];return e.forEach(r=>{const i=this.Sr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){Y(this.vr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.wr;return R.forEach(n.mutations,i=>{const s=new Ct(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.wr=r})}Mn(e){}containsKey(e,n){const r=new Ct(n,0),i=this.wr.firstAfterOrEqual(r);return R.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,R.resolve()}vr(e,n){return this.br(e)}br(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Sr(e){const n=this.br(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hH{constructor(e){this.Cr=e,this.docs=function(){return new et($.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.Cr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return R.resolve(r?r.document.mutableCopy():Ue.newInvalidDocument(n))}getEntries(e,n){let r=xn();return n.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():Ue.newInvalidDocument(i))}),R.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=xn();const o=n.path,a=new $(o.child("")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:u,value:{document:c}}=l.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||aI(wD(c),r)<=0||(i.has(c.key)||hd(n,c))&&(s=s.insert(c.key,c.mutableCopy()))}return R.resolve(s)}getAllFromCollectionGroup(e,n,r,i){W()}Fr(e,n){return R.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new dH(this)}getSize(e){return R.resolve(this.size)}}class dH extends SO{constructor(e){super(),this.ar=e}applyChanges(e){const n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.ar.addEntry(e,i)):this.ar.removeEntry(r)}),R.waitFor(n)}getFromCache(e,n){return this.ar.getEntry(e,n)}getAllFromCache(e,n){return this.ar.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fH{constructor(e){this.persistence=e,this.Mr=new no(n=>Zo(n),ud),this.lastRemoteSnapshotVersion=Q.min(),this.highestTargetId=0,this.Or=0,this.Nr=new TI,this.targetCount=0,this.Br=ia.Nn()}forEachTarget(e,n){return this.Mr.forEach((r,i)=>n(i)),R.resolve()}getLastRemoteSnapshotVersion(e){return R.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return R.resolve(this.Or)}allocateTargetId(e){return this.highestTargetId=this.Br.next(),R.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Or&&(this.Or=n),R.resolve()}qn(e){this.Mr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.Br=new ia(n),this.highestTargetId=n),e.sequenceNumber>this.Or&&(this.Or=e.sequenceNumber)}addTargetData(e,n){return this.qn(n),this.targetCount+=1,R.resolve()}updateTargetData(e,n){return this.qn(n),R.resolve()}removeTargetData(e,n){return this.Mr.delete(n.target),this.Nr.Vr(n.targetId),this.targetCount-=1,R.resolve()}removeTargets(e,n,r){let i=0;const s=[];return this.Mr.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.Mr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),R.waitFor(s).next(()=>i)}getTargetCount(e){return R.resolve(this.targetCount)}getTargetData(e,n){const r=this.Mr.get(n)||null;return R.resolve(r)}addMatchingKeys(e,n,r){return this.Nr.dr(n,r),R.resolve()}removeMatchingKeys(e,n,r){this.Nr.Rr(n,r);const i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),R.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this.Nr.Vr(n),R.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Nr.gr(n);return R.resolve(r)}containsKey(e,n){return R.resolve(this.Nr.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AO{constructor(e,n){this.Lr={},this.overlays={},this.kr=new bn(0),this.qr=!1,this.qr=!0,this.referenceDelegate=e(this),this.Qr=new fH(this),this.indexManager=new X8,this.remoteDocumentCache=function(i){return new hH(i)}(r=>this.referenceDelegate.Kr(r)),this.serializer=new _O(n),this.$r=new lH(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.qr=!1,Promise.resolve()}get started(){return this.qr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new uH,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.Lr[e.toKey()];return r||(r=new cH(n,this.referenceDelegate),this.Lr[e.toKey()]=r),r}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.$r}runTransaction(e,n,r){O("MemoryPersistence","Starting transaction:",e);const i=new pH(this.kr.next());return this.referenceDelegate.Ur(),r(i).next(s=>this.referenceDelegate.Wr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Gr(e,n){return R.or(Object.values(this.Lr).map(r=>()=>r.containsKey(e,n)))}}class pH extends ID{constructor(e){super(),this.currentSequenceNumber=e}}class Ig{constructor(e){this.persistence=e,this.zr=new TI,this.jr=null}static Hr(e){return new Ig(e)}get Jr(){if(this.jr)return this.jr;throw W()}addReference(e,n,r){return this.zr.addReference(r,n),this.Jr.delete(r.toString()),R.resolve()}removeReference(e,n,r){return this.zr.removeReference(r,n),this.Jr.add(r.toString()),R.resolve()}markPotentiallyOrphaned(e,n){return this.Jr.add(n.toString()),R.resolve()}removeTarget(e,n){this.zr.Vr(n.targetId).forEach(i=>this.Jr.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.Jr.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}Ur(){this.jr=new Set}Wr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return R.forEach(this.Jr,r=>{const i=$.fromPath(r);return this.Yr(e,i).next(s=>{s||n.removeEntry(i,Q.min())})}).next(()=>(this.jr=null,n.apply(e)))}updateLimboDocument(e,n){return this.Yr(e,n).next(r=>{r?this.Jr.delete(n.toString()):this.Jr.add(n.toString())})}Kr(e){return 0}Yr(e,n){return R.or([()=>R.resolve(this.zr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Gr(e,n)])}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mH{constructor(e){this.serializer=e}B(e,n,r,i){const s=new mg("createOrUpgrade",n);r<1&&i>=1&&(function(l){l.createObjectStore("owner")}(e),function(l){l.createObjectStore("mutationQueues",{keyPath:"userId"}),l.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",jC,{unique:!0}),l.createObjectStore("documentMutations")}(e),PR(e),function(l){l.createObjectStore("remoteDocuments")}(e));let o=R.resolve();return r<3&&i>=3&&(r!==0&&(function(l){l.deleteObjectStore("targetDocuments"),l.deleteObjectStore("targets"),l.deleteObjectStore("targetGlobal")}(e),PR(e)),o=o.next(()=>function(l){const u=l.store("targetGlobal"),c={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Q.min().toTimestamp(),targetCount:0};return u.put("targetGlobalKey",c)}(s))),r<4&&i>=4&&(r!==0&&(o=o.next(()=>function(l,u){return u.store("mutations").G().next(c=>{l.deleteObjectStore("mutations"),l.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",jC,{unique:!0});const h=u.store("mutations"),f=c.map(g=>h.put(g));return R.waitFor(f)})}(e,s))),o=o.next(()=>{(function(l){l.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&i>=5&&(o=o.next(()=>this.Xr(s))),r<6&&i>=6&&(o=o.next(()=>(function(l){l.createObjectStore("remoteDocumentGlobal")}(e),this.ei(s)))),r<7&&i>=7&&(o=o.next(()=>this.ti(s))),r<8&&i>=8&&(o=o.next(()=>this.ni(e,s))),r<9&&i>=9&&(o=o.next(()=>{(function(l){l.objectStoreNames.contains("remoteDocumentChanges")&&l.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(o=o.next(()=>this.ri(s))),r<11&&i>=11&&(o=o.next(()=>{(function(l){l.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(l){l.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(o=o.next(()=>{(function(l){const u=l.createObjectStore("documentOverlays",{keyPath:XW});u.createIndex("collectionPathOverlayIndex",JW,{unique:!1}),u.createIndex("collectionGroupOverlayIndex",ZW,{unique:!1})})(e)})),r<13&&i>=13&&(o=o.next(()=>function(l){const u=l.createObjectStore("remoteDocumentsV14",{keyPath:$W});u.createIndex("documentKeyIndex",BW),u.createIndex("collectionGroupIndex",zW)}(e)).next(()=>this.ii(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(o=o.next(()=>this.si(e,s))),r<15&&i>=15&&(o=o.next(()=>function(l){l.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),l.createObjectStore("indexState",{keyPath:GW}).createIndex("sequenceNumberIndex",KW,{unique:!1}),l.createObjectStore("indexEntries",{keyPath:QW}).createIndex("documentKeyIndex",YW,{unique:!1})}(e))),o}ei(e){let n=0;return e.store("remoteDocuments").Z((r,i)=>{n+=Gp(i)}).next(()=>{const r={byteSize:n};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}Xr(e){const n=e.store("mutationQueues"),r=e.store("mutations");return n.G().next(i=>R.forEach(i,s=>{const o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return r.G("userMutationsIndex",o).next(a=>R.forEach(a,l=>{Y(l.userId===s.userId);const u=_o(this.serializer,l);return EO(e,s.userId,u).next(()=>{})}))}))}ti(e){const n=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{const s=[];return r.Z((o,a)=>{const l=new ge(o),u=function(h){return[0,gn(h)]}(l);s.push(n.get(u).next(c=>c?R.resolve():(h=>n.put({targetId:0,path:gn(h),sequenceNumber:i.highestListenSequenceNumber}))(l)))}).next(()=>R.waitFor(s))})}ni(e,n){e.createObjectStore("collectionParents",{keyPath:HW});const r=n.store("collectionParents"),i=new II,s=o=>{if(i.add(o)){const a=o.lastSegment(),l=o.popLast();return r.put({collectionId:a,parent:gn(l)})}};return n.store("remoteDocuments").Z({Y:!0},(o,a)=>{const l=new ge(o);return s(l.popLast())}).next(()=>n.store("documentMutations").Z({Y:!0},([o,a,l],u)=>{const c=Xr(a);return s(c.popLast())}))}ri(e){const n=e.store("targets");return n.Z((r,i)=>{const s=uc(i),o=yO(this.serializer,s);return n.put(o)})}ii(e,n){const r=n.store("remoteDocuments"),i=[];return r.Z((s,o)=>{const a=n.store("remoteDocumentsV14"),l=function(h){return h.document?new $(ge.fromString(h.document.name).popFirst(5)):h.noDocument?$.fromSegments(h.noDocument.path):h.unknownDocument?$.fromSegments(h.unknownDocument.path):W()}(o).path.toArray(),u={prefixPath:l.slice(0,l.length-2),collectionGroup:l[l.length-2],documentId:l[l.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(a.put(u))}).next(()=>R.waitFor(i))}si(e,n){const r=n.store("mutations"),i=CO(this.serializer),s=new AO(Ig.Hr,this.serializer.ht);return r.G().next(o=>{const a=new Map;return o.forEach(l=>{var u;let c=(u=a.get(l.userId))!==null&&u!==void 0?u:ae();_o(this.serializer,l).keys().forEach(h=>c=c.add(h)),a.set(l.userId,c)}),R.forEach(a,(l,u)=>{const c=new bt(u),h=wg.Pt(this.serializer,c),f=s.getIndexManager(c),g=Eg.Pt(c,this.serializer,f,s.referenceDelegate);return new RO(i,g,h,f).recalculateAndSaveOverlaysForDocumentKeys(new dw(n,bn.ae),l).next()})})}}function PR(t){t.createObjectStore("targetDocuments",{keyPath:qW}).createIndex("documentTargetsIndex",WW,{unique:!0}),t.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",jW,{unique:!0}),t.createObjectStore("targetGlobal")}const Iy="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class SI{constructor(e,n,r,i,s,o,a,l,u,c,h=15){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.oi=s,this.window=o,this.document=a,this._i=u,this.ai=c,this.ui=h,this.kr=null,this.qr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ci=null,this.inForeground=!1,this.li=null,this.hi=null,this.Pi=Number.NEGATIVE_INFINITY,this.Ii=f=>Promise.resolve(),!SI.v())throw new D(A.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new iH(this,i),this.Ti=n+"main",this.serializer=new _O(l),this.Ei=new Rr(this.Ti,this.ui,new mH(this.serializer)),this.Qr=new Z8(this.referenceDelegate,this.serializer),this.remoteDocumentCache=CO(this.serializer),this.$r=new q8,this.window&&this.window.localStorage?this.di=this.window.localStorage:(this.di=null,c===!1&&lt("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Ai().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new D(A.FAILED_PRECONDITION,Iy);return this.Ri(),this.Vi(),this.mi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Qr.getHighestSequenceNumber(e))}).then(e=>{this.kr=new bn(e,this._i)}).then(()=>{this.qr=!0}).catch(e=>(this.Ei&&this.Ei.close(),Promise.reject(e)))}fi(e){return this.Ii=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ei.k(async n=>{n.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.oi.enqueueAndForget(async()=>{this.started&&await this.Ai()}))}Ai(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>hf(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.gi(e).next(n=>{n||(this.isPrimary=!1,this.oi.enqueueRetryable(()=>this.Ii(!1)))})}).next(()=>this.pi(e)).next(n=>this.isPrimary&&!n?this.yi(e).next(()=>!1):!!n&&this.wi(e).next(()=>!0))).catch(e=>{if(to(e))return O("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return O("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.oi.enqueueRetryable(()=>this.Ii(e)),this.isPrimary=e})}gi(e){return Wu(e).get("owner").next(n=>R.resolve(this.Si(n)))}bi(e){return hf(e).delete(this.clientId)}async Di(){if(this.isPrimary&&!this.vi(this.Pi,18e5)){this.Pi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const r=Vt(n,"clientMetadata");return r.G().next(i=>{const s=this.Ci(i,18e5),o=i.filter(a=>s.indexOf(a)===-1);return R.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.di)for(const n of e)this.di.removeItem(this.Fi(n.clientId))}}mi(){this.hi=this.oi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Ai().then(()=>this.Di()).then(()=>this.mi()))}Si(e){return!!e&&e.ownerId===this.clientId}pi(e){return this.ai?R.resolve(!0):Wu(e).get("owner").next(n=>{if(n!==null&&this.vi(n.leaseTimestampMs,5e3)&&!this.Mi(n.ownerId)){if(this.Si(n)&&this.networkEnabled)return!0;if(!this.Si(n)){if(!n.allowTabSynchronization)throw new D(A.FAILED_PRECONDITION,Iy);return!1}}return!(!this.networkEnabled||!this.inForeground)||hf(e).G().next(r=>this.Ci(r,5e3).find(i=>{if(this.clientId!==i.clientId){const s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(s||o&&a)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&O("IndexedDbPersistence",`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}async shutdown(){this.qr=!1,this.xi(),this.hi&&(this.hi.cancel(),this.hi=null),this.Oi(),this.Ni(),await this.Ei.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const n=new dw(e,bn.ae);return this.yi(n).next(()=>this.bi(n))}),this.Ei.close(),this.Bi()}Ci(e,n){return e.filter(r=>this.vi(r.updateTimeMs,n)&&!this.Mi(r.clientId))}Li(){return this.runTransaction("getActiveClients","readonly",e=>hf(e).G().next(n=>this.Ci(n,18e5).map(r=>r.clientId)))}get started(){return this.qr}getMutationQueue(e,n){return Eg.Pt(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new J8(e,this.serializer.ht.databaseId)}getDocumentOverlayCache(e){return wg.Pt(this.serializer,e)}getBundleCache(){return this.$r}runTransaction(e,n,r){O("IndexedDbPersistence","Starting transaction:",e);const i=n==="readonly"?"readonly":"readwrite",s=function(l){return l===15?t8:l===14?AD:l===13?RD:l===12?e8:l===11?CD:void W()}(this.ui);let o;return this.Ei.runTransaction(e,i,s,a=>(o=new dw(a,this.kr?this.kr.next():bn.ae),n==="readwrite-primary"?this.gi(o).next(l=>!!l||this.pi(o)).next(l=>{if(!l)throw lt(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.oi.enqueueRetryable(()=>this.Ii(!1)),new D(A.FAILED_PRECONDITION,ED);return r(o)}).next(l=>this.wi(o).next(()=>l)):this.ki(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}ki(e){return Wu(e).get("owner").next(n=>{if(n!==null&&this.vi(n.leaseTimestampMs,5e3)&&!this.Mi(n.ownerId)&&!this.Si(n)&&!(this.ai||this.allowTabSynchronization&&n.allowTabSynchronization))throw new D(A.FAILED_PRECONDITION,Iy)})}wi(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Wu(e).put("owner",n)}static v(){return Rr.v()}yi(e){const n=Wu(e);return n.get("owner").next(r=>this.Si(r)?(O("IndexedDbPersistence","Releasing primary lease."),n.delete("owner")):R.resolve())}vi(e,n){const r=Date.now();return!(e<r-n)&&(!(e>r)||(lt(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Ri(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.li=()=>{this.oi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Ai()))},this.document.addEventListener("visibilitychange",this.li),this.inForeground=this.document.visibilityState==="visible")}Oi(){this.li&&(this.document.removeEventListener("visibilitychange",this.li),this.li=null)}Vi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.ci=()=>{this.xi();const n=/(?:Version|Mobile)\/1[456]/;j3()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.oi.enterRestrictedMode(!0),this.oi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.ci))}Ni(){this.ci&&(this.window.removeEventListener("pagehide",this.ci),this.ci=null)}Mi(e){var n;try{const r=((n=this.di)===null||n===void 0?void 0:n.getItem(this.Fi(e)))!==null;return O("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return lt("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}xi(){if(this.di)try{this.di.setItem(this.Fi(this.clientId),String(Date.now()))}catch(e){lt("Failed to set zombie client id.",e)}}Bi(){if(this.di)try{this.di.removeItem(this.Fi(this.clientId))}catch{}}Fi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Wu(t){return Vt(t,"owner")}function hf(t){return Vt(t,"clientMetadata")}function CI(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RI{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.qi=r,this.Qi=i}static Ki(e,n){let r=ae(),i=ae();for(const s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new RI(e,n.fromCache,r,i)}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PO{constructor(){this.$i=!1}initialize(e,n){this.Ui=e,this.indexManager=n,this.$i=!0}getDocumentsMatchingQuery(e,n,r,i){return this.Wi(e,n).next(s=>s||this.Gi(e,n,i,r)).next(s=>s||this.zi(e,n))}Wi(e,n){if(tR(n))return R.resolve(null);let r=Fn(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=qp(n,null,"F"),r=Fn(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const o=ae(...s);return this.Ui.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(l=>{const u=this.ji(n,a);return this.Hi(n,u,o,l.readTime)?this.Wi(e,qp(n,null,"F")):this.Ji(e,u,n,l)}))})))}Gi(e,n,r,i){return tR(n)||i.isEqual(Q.min())?this.zi(e,n):this.Ui.getDocuments(e,r).next(s=>{const o=this.ji(n,s);return this.Hi(n,o,r,i)?this.zi(e,n):(cw()<=pe.DEBUG&&O("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),ww(n)),this.Ji(e,o,n,vD(i,-1)))})}ji(e,n){let r=new Be(zD(e));return n.forEach((i,s)=>{hd(e,s)&&(r=r.add(s))}),r}Hi(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}zi(e,n){return cw()<=pe.DEBUG&&O("QueryEngine","Using full collection scan to execute query:",ww(n)),this.Ui.getDocumentsMatchingQuery(e,n,Xn.min())}Ji(e,n,r,i){return this.Ui.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gH{constructor(e,n,r,i){this.persistence=e,this.Yi=n,this.serializer=i,this.Zi=new et(se),this.Xi=new no(s=>Zo(s),ud),this.es=new Map,this.ts=e.getRemoteDocumentCache(),this.Qr=e.getTargetCache(),this.$r=e.getBundleCache(),this.ns(r)}ns(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new RO(this.ts,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.ts.setIndexManager(this.indexManager),this.Yi.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Zi))}}function bO(t,e,n,r){return new gH(t,e,n,r)}async function kO(t,e){const n=B(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n.ns(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{const o=[],a=[];let l=ae();for(const u of i){o.push(u.batchId);for(const c of u.mutations)l=l.add(c.key)}for(const u of s){a.push(u.batchId);for(const c of u.mutations)l=l.add(c.key)}return n.localDocuments.getDocuments(r,l).next(u=>({rs:u,removedBatchIds:o,addedBatchIds:a}))})})}function _H(t,e){const n=B(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=n.ts.newChangeBuffer({trackRemovals:!0});return function(a,l,u,c){const h=u.batch,f=h.keys();let g=R.resolve();return f.forEach(_=>{g=g.next(()=>c.getEntry(l,_)).next(w=>{const T=u.docVersions.get(_);Y(T!==null),w.version.compareTo(T)<0&&(h.applyToRemoteDocument(w,u),w.isValidDocument()&&(w.setReadTime(u.commitVersion),c.addEntry(w)))})}),g.next(()=>a.mutationQueue.removeMutationBatch(l,h))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let l=ae();for(let u=0;u<a.mutationResults.length;++u)a.mutationResults[u].transformResults.length>0&&(l=l.add(a.batch.mutations[u].key));return l}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function xO(t){const e=B(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Qr.getLastRemoteSnapshotVersion(n))}function yH(t,e){const n=B(t),r=e.snapshotVersion;let i=n.Zi;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=n.ts.newChangeBuffer({trackRemovals:!0});i=n.Zi;const a=[];e.targetChanges.forEach((c,h)=>{const f=i.get(h);if(!f)return;a.push(n.Qr.removeMatchingKeys(s,c.removedDocuments,h).next(()=>n.Qr.addMatchingKeys(s,c.addedDocuments,h)));let g=f.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(h)!==null?g=g.withResumeToken(Tt.EMPTY_BYTE_STRING,Q.min()).withLastLimboFreeSnapshotVersion(Q.min()):c.resumeToken.approximateByteSize()>0&&(g=g.withResumeToken(c.resumeToken,r)),i=i.insert(h,g),function(w,T,v){return w.resumeToken.approximateByteSize()===0||T.snapshotVersion.toMicroseconds()-w.snapshotVersion.toMicroseconds()>=3e8?!0:v.addedDocuments.size+v.modifiedDocuments.size+v.removedDocuments.size>0}(f,g,c)&&a.push(n.Qr.updateTargetData(s,g))});let l=xn(),u=ae();if(e.documentUpdates.forEach(c=>{e.resolvedLimboDocuments.has(c)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(s,c))}),a.push(NO(s,o,e.documentUpdates).next(c=>{l=c.ss,u=c.os})),!r.isEqual(Q.min())){const c=n.Qr.getLastRemoteSnapshotVersion(s).next(h=>n.Qr.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(c)}return R.waitFor(a).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,l,u)).next(()=>l)}).then(s=>(n.Zi=i,s))}function NO(t,e,n){let r=ae(),i=ae();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let o=xn();return n.forEach((a,l)=>{const u=s.get(a);l.isFoundDocument()!==u.isFoundDocument()&&(i=i.add(a)),l.isNoDocument()&&l.version.isEqual(Q.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!u.isValidDocument()||l.version.compareTo(u.version)>0||l.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):O("LocalStore","Ignoring outdated watch update for ",a,". Current version:",u.version," Watch version:",l.version)}),{ss:o,os:i}})}function vH(t,e){const n=B(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function Fl(t,e){const n=B(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.Qr.getTargetData(r,e).next(s=>s?(i=s,R.resolve(i)):n.Qr.allocateTargetId(r).next(o=>(i=new Ci(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Qr.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=n.Zi.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.Zi=n.Zi.insert(r.targetId,r),n.Xi.set(e,r.targetId)),r})}async function Ul(t,e,n){const r=B(t),i=r.Zi.get(e),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!to(o))throw o;O("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.Zi=r.Zi.remove(e),r.Xi.delete(i.target)}function Kp(t,e,n){const r=B(t);let i=Q.min(),s=ae();return r.persistence.runTransaction("Execute query","readonly",o=>function(l,u,c){const h=B(l),f=h.Xi.get(c);return f!==void 0?R.resolve(h.Zi.get(f)):h.Qr.getTargetData(u,c)}(r,o,Fn(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Qr.getMatchingKeysForTargetId(o,a.targetId).next(l=>{s=l})}).next(()=>r.Yi.getDocumentsMatchingQuery(o,e,n?i:Q.min(),n?s:ae())).next(a=>(LO(r,BD(e),a),{documents:a,_s:s})))}function DO(t,e){const n=B(t),r=B(n.Qr),i=n.Zi.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",s=>r.lt(s,e).next(o=>o?o.target:null))}function OO(t,e){const n=B(t),r=n.es.get(e)||Q.min();return n.persistence.runTransaction("Get new document changes","readonly",i=>n.ts.getAllFromCollectionGroup(i,e,vD(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(LO(n,e,i),i))}function LO(t,e,n){let r=t.es.get(e)||Q.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.es.set(e,r)}async function wH(t,e,n,r){const i=B(t);let s=ae(),o=xn();for(const u of n){const c=e.us(u.metadata.name);u.document&&(s=s.add(c));const h=e.cs(u);h.setReadTime(e.ls(u.metadata.readTime)),o=o.insert(c,h)}const a=i.ts.newChangeBuffer({trackRemovals:!0}),l=await Fl(i,function(c){return Fn(cu(ge.fromString(`__bundle__/docs/${c}`)))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",u=>NO(u,a,o).next(c=>(a.apply(u),c)).next(c=>i.Qr.removeMatchingKeysForTargetId(u,l.targetId).next(()=>i.Qr.addMatchingKeys(u,s,l.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(u,c.ss,c.os)).next(()=>c.ss)))}async function EH(t,e,n=ae()){const r=await Fl(t,Fn(wI(e.bundledQuery))),i=B(t);return i.persistence.runTransaction("Save named query","readwrite",s=>{const o=ct(e.readTime);if(r.snapshotVersion.compareTo(o)>=0)return i.$r.saveNamedQuery(s,e);const a=r.withResumeToken(Tt.EMPTY_BYTE_STRING,o);return i.Zi=i.Zi.insert(a.targetId,a),i.Qr.updateTargetData(s,a).next(()=>i.Qr.removeMatchingKeysForTargetId(s,r.targetId)).next(()=>i.Qr.addMatchingKeys(s,n,r.targetId)).next(()=>i.$r.saveNamedQuery(s,e))})}function bR(t,e){return`firestore_clients_${t}_${e}`}function kR(t,e,n){let r=`firestore_mutations_${t}_${n}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function Ty(t,e){return`firestore_targets_${t}_${e}`}class Qp{constructor(e,n,r,i){this.user=e,this.batchId=n,this.state=r,this.error=i}static hs(e,n,r){const i=JSON.parse(r);let s,o=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return o&&i.error&&(o=typeof i.error.message=="string"&&typeof i.error.code=="string",o&&(s=new D(i.error.code,i.error.message))),o?new Qp(e,n,i.state,s):(lt("SharedClientState",`Failed to parse mutation state for ID '${n}': ${r}`),null)}Ps(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Pc{constructor(e,n,r){this.targetId=e,this.state=n,this.error=r}static hs(e,n){const r=JSON.parse(n);let i,s=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return s&&r.error&&(s=typeof r.error.message=="string"&&typeof r.error.code=="string",s&&(i=new D(r.error.code,r.error.message))),s?new Pc(e,r.state,i):(lt("SharedClientState",`Failed to parse target state for ID '${e}': ${n}`),null)}Ps(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Yp{constructor(e,n){this.clientId=e,this.activeTargetIds=n}static hs(e,n){const r=JSON.parse(n);let i=typeof r=="object"&&r.activeTargetIds instanceof Array,s=fI();for(let o=0;i&&o<r.activeTargetIds.length;++o)i=TD(r.activeTargetIds[o]),s=s.add(r.activeTargetIds[o]);return i?new Yp(e,s):(lt("SharedClientState",`Failed to parse client data for instance '${e}': ${n}`),null)}}class AI{constructor(e,n){this.clientId=e,this.onlineState=n}static hs(e){const n=JSON.parse(e);return typeof n=="object"&&["Unknown","Online","Offline"].indexOf(n.onlineState)!==-1&&typeof n.clientId=="string"?new AI(n.clientId,n.onlineState):(lt("SharedClientState",`Failed to parse online state: ${e}`),null)}}class Aw{constructor(){this.activeTargetIds=fI()}Is(e){this.activeTargetIds=this.activeTargetIds.add(e)}Ts(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ps(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Sy{constructor(e,n,r,i,s){this.window=e,this.oi=n,this.persistenceKey=r,this.Es=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.ds=this.As.bind(this),this.Rs=new et(se),this.started=!1,this.Vs=[];const o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.fs=bR(this.persistenceKey,this.Es),this.gs=function(l){return`firestore_sequence_number_${l}`}(this.persistenceKey),this.Rs=this.Rs.insert(this.Es,new Aw),this.ps=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.ys=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.ws=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.Ss=function(l){return`firestore_online_state_${l}`}(this.persistenceKey),this.bs=function(l){return`firestore_bundle_loaded_v2_${l}`}(this.persistenceKey),this.window.addEventListener("storage",this.ds)}static v(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Li();for(const r of e){if(r===this.Es)continue;const i=this.getItem(bR(this.persistenceKey,r));if(i){const s=Yp.hs(r,i);s&&(this.Rs=this.Rs.insert(s.clientId,s))}}this.Ds();const n=this.storage.getItem(this.Ss);if(n){const r=this.vs(n);r&&this.Cs(r)}for(const r of this.Vs)this.As(r);this.Vs=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.gs,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Fs(this.Rs)}isActiveQueryTarget(e){let n=!1;return this.Rs.forEach((r,i)=>{i.activeTargetIds.has(e)&&(n=!0)}),n}addPendingMutation(e){this.Ms(e,"pending")}updateMutationState(e,n,r){this.Ms(e,n,r),this.xs(e)}addLocalQueryTarget(e){let n="not-current";if(this.isActiveQueryTarget(e)){const r=this.storage.getItem(Ty(this.persistenceKey,e));if(r){const i=Pc.hs(e,r);i&&(n=i.state)}}return this.Os.Is(e),this.Ds(),n}removeLocalQueryTarget(e){this.Os.Ts(e),this.Ds()}isLocalQueryTarget(e){return this.Os.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Ty(this.persistenceKey,e))}updateQueryState(e,n,r){this.Ns(e,n,r)}handleUserChange(e,n,r){n.forEach(i=>{this.xs(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Bs(e)}notifyBundleLoaded(e){this.Ls(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.ds),this.removeItem(this.fs),this.started=!1)}getItem(e){const n=this.storage.getItem(e);return O("SharedClientState","READ",e,n),n}setItem(e,n){O("SharedClientState","SET",e,n),this.storage.setItem(e,n)}removeItem(e){O("SharedClientState","REMOVE",e),this.storage.removeItem(e)}As(e){const n=e;if(n.storageArea===this.storage){if(O("SharedClientState","EVENT",n.key,n.newValue),n.key===this.fs)return void lt("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.oi.enqueueRetryable(async()=>{if(this.started){if(n.key!==null){if(this.ps.test(n.key)){if(n.newValue==null){const r=this.ks(n.key);return this.qs(r,null)}{const r=this.Qs(n.key,n.newValue);if(r)return this.qs(r.clientId,r)}}else if(this.ys.test(n.key)){if(n.newValue!==null){const r=this.Ks(n.key,n.newValue);if(r)return this.$s(r)}}else if(this.ws.test(n.key)){if(n.newValue!==null){const r=this.Us(n.key,n.newValue);if(r)return this.Ws(r)}}else if(n.key===this.Ss){if(n.newValue!==null){const r=this.vs(n.newValue);if(r)return this.Cs(r)}}else if(n.key===this.gs){const r=function(s){let o=bn.ae;if(s!=null)try{const a=JSON.parse(s);Y(typeof a=="number"),o=a}catch(a){lt("SharedClientState","Failed to read sequence number from WebStorage",a)}return o}(n.newValue);r!==bn.ae&&this.sequenceNumberHandler(r)}else if(n.key===this.bs){const r=this.Gs(n.newValue);await Promise.all(r.map(i=>this.syncEngine.zs(i)))}}}else this.Vs.push(n)})}}get Os(){return this.Rs.get(this.Es)}Ds(){this.setItem(this.fs,this.Os.Ps())}Ms(e,n,r){const i=new Qp(this.currentUser,e,n,r),s=kR(this.persistenceKey,this.currentUser,e);this.setItem(s,i.Ps())}xs(e){const n=kR(this.persistenceKey,this.currentUser,e);this.removeItem(n)}Bs(e){const n={clientId:this.Es,onlineState:e};this.storage.setItem(this.Ss,JSON.stringify(n))}Ns(e,n,r){const i=Ty(this.persistenceKey,e),s=new Pc(e,n,r);this.setItem(i,s.Ps())}Ls(e){const n=JSON.stringify(Array.from(e));this.setItem(this.bs,n)}ks(e){const n=this.ps.exec(e);return n?n[1]:null}Qs(e,n){const r=this.ks(e);return Yp.hs(r,n)}Ks(e,n){const r=this.ys.exec(e),i=Number(r[1]),s=r[2]!==void 0?r[2]:null;return Qp.hs(new bt(s),i,n)}Us(e,n){const r=this.ws.exec(e),i=Number(r[1]);return Pc.hs(i,n)}vs(e){return AI.hs(e)}Gs(e){return JSON.parse(e)}async $s(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.js(e.batchId,e.state,e.error);O("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)}Ws(e){return this.syncEngine.Hs(e.targetId,e.state,e.error)}qs(e,n){const r=n?this.Rs.insert(e,n):this.Rs.remove(e),i=this.Fs(this.Rs),s=this.Fs(r),o=[],a=[];return s.forEach(l=>{i.has(l)||o.push(l)}),i.forEach(l=>{s.has(l)||a.push(l)}),this.syncEngine.Js(o,a).then(()=>{this.Rs=r})}Cs(e){this.Rs.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Fs(e){let n=fI();return e.forEach((r,i)=>{n=n.unionWith(i.activeTargetIds)}),n}}class MO{constructor(){this.Ys=new Aw,this.Zs={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e){return this.Ys.Is(e),this.Zs[e]||"not-current"}updateQueryState(e,n,r){this.Zs[e]=n}removeLocalQueryTarget(e){this.Ys.Ts(e)}isLocalQueryTarget(e){return this.Ys.activeTargetIds.has(e)}clearQueryState(e){delete this.Zs[e]}getAllActiveQueryTargets(){return this.Ys.activeTargetIds}isActiveQueryTarget(e){return this.Ys.activeTargetIds.has(e)}start(){return this.Ys=new Aw,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IH{Xs(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xR{constructor(){this.eo=()=>this.no(),this.ro=()=>this.io(),this.so=[],this.oo()}Xs(e){this.so.push(e)}shutdown(){window.removeEventListener("online",this.eo),window.removeEventListener("offline",this.ro)}oo(){window.addEventListener("online",this.eo),window.addEventListener("offline",this.ro)}no(){O("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.so)e(0)}io(){O("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.so)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let df=null;function Cy(){return df===null?df=function(){return 268435456+Math.round(2147483648*Math.random())}():df++,"0x"+df.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TH={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SH{constructor(e){this._o=e._o,this.ao=e.ao}uo(e){this.co=e}lo(e){this.ho=e}onMessage(e){this.Po=e}close(){this.ao()}send(e){this._o(e)}Io(){this.co()}To(e){this.ho(e)}Eo(e){this.Po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xt="WebChannelConnection";class CH extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Ao=r+"://"+n.host,this.Ro=`projects/${i}/databases/${s}`,this.Vo=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get mo(){return!1}fo(n,r,i,s,o){const a=Cy(),l=this.po(n,r);O("RestConnection",`Sending RPC '${n}' ${a}:`,l,i);const u={"google-cloud-resource-prefix":this.Ro,"x-goog-request-params":this.Vo};return this.yo(u,s,o),this.wo(n,l,u,i).then(c=>(O("RestConnection",`Received RPC '${n}' ${a}: `,c),c),c=>{throw Lr("RestConnection",`RPC '${n}' ${a} failed with error: `,c,"url: ",l,"request:",i),c})}So(n,r,i,s,o,a){return this.fo(n,r,i,s,o)}yo(n,r,i){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+uu}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>n[o]=s),i&&i.headers.forEach((s,o)=>n[o]=s)}po(n,r){const i=TH[n];return`${this.Ao}/v1/${r}:${i}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}wo(e,n,r,i){const s=Cy();return new Promise((o,a)=>{const l=new wW;l.setWithCredentials(!0),l.listenOnce(yW.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case wy.NO_ERROR:const c=l.getResponseJson();O(Xt,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(c)),o(c);break;case wy.TIMEOUT:O(Xt,`RPC '${e}' ${s} timed out`),a(new D(A.DEADLINE_EXCEEDED,"Request time out"));break;case wy.HTTP_ERROR:const h=l.getStatus();if(O(Xt,`RPC '${e}' ${s} failed with status:`,h,"response text:",l.getResponseText()),h>0){let f=l.getResponseJson();Array.isArray(f)&&(f=f[0]);const g=f==null?void 0:f.error;if(g&&g.status&&g.message){const _=function(T){const v=T.toLowerCase().replace(/_/g,"-");return Object.values(A).indexOf(v)>=0?v:A.UNKNOWN}(g.status);a(new D(_,g.message))}else a(new D(A.UNKNOWN,"Server responded with status "+l.getStatus()))}else a(new D(A.UNAVAILABLE,"Connection failed."));break;default:W()}}finally{O(Xt,`RPC '${e}' ${s} completed.`)}});const u=JSON.stringify(i);O(Xt,`RPC '${e}' ${s} sending request:`,i),l.send(n,"POST",u,r,15)})}bo(e,n,r){const i=Cy(),s=[this.Ao,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=gW(),a=_W(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(l.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(l.useFetchStreams=!0),this.yo(l.initMessageHeaders,n,r),l.encodeInitMessageHeaders=!0;const c=s.join("");O(Xt,`Creating RPC '${e}' stream ${i}: ${c}`,l);const h=o.createWebChannel(c,l);let f=!1,g=!1;const _=new SH({_o:T=>{g?O(Xt,`Not sending because RPC '${e}' stream ${i} is closed:`,T):(f||(O(Xt,`Opening RPC '${e}' stream ${i} transport.`),h.open(),f=!0),O(Xt,`RPC '${e}' stream ${i} sending:`,T),h.send(T))},ao:()=>h.close()}),w=(T,v,y)=>{T.listen(v,I=>{try{y(I)}catch(C){setTimeout(()=>{throw C},0)}})};return w(h,of.EventType.OPEN,()=>{g||O(Xt,`RPC '${e}' stream ${i} transport opened.`)}),w(h,of.EventType.CLOSE,()=>{g||(g=!0,O(Xt,`RPC '${e}' stream ${i} transport closed`),_.To())}),w(h,of.EventType.ERROR,T=>{g||(g=!0,Lr(Xt,`RPC '${e}' stream ${i} transport errored:`,T),_.To(new D(A.UNAVAILABLE,"The operation could not be completed")))}),w(h,of.EventType.MESSAGE,T=>{var v;if(!g){const y=T.data[0];Y(!!y);const I=y,C=I.error||((v=I[0])===null||v===void 0?void 0:v.error);if(C){O(Xt,`RPC '${e}' stream ${i} received error:`,C);const P=C.status;let b=function(re){const X=ft[re];if(X!==void 0)return nO(X)}(P),k=C.message;b===void 0&&(b=A.INTERNAL,k="Unknown error status: "+P+" with message "+C.message),g=!0,_.To(new D(b,k)),h.close()}else O(Xt,`RPC '${e}' stream ${i} received:`,y),_.Eo(y)}}),w(a,vW.STAT_EVENT,T=>{T.stat===UC.PROXY?O(Xt,`RPC '${e}' stream ${i} detected buffering proxy`):T.stat===UC.NOPROXY&&O(Xt,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{_.Io()},0),_}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VO(){return typeof window<"u"?window:null}function Kf(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function md(t){return new D8(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PI{constructor(e,n,r=1e3,i=1.5,s=6e4){this.oi=e,this.timerId=n,this.Do=r,this.vo=i,this.Co=s,this.Fo=0,this.Mo=null,this.xo=Date.now(),this.reset()}reset(){this.Fo=0}Oo(){this.Fo=this.Co}No(e){this.cancel();const n=Math.floor(this.Fo+this.Bo()),r=Math.max(0,Date.now()-this.xo),i=Math.max(0,n-r);i>0&&O("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Fo} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.Mo=this.oi.enqueueAfterDelay(this.timerId,i,()=>(this.xo=Date.now(),e())),this.Fo*=this.vo,this.Fo<this.Do&&(this.Fo=this.Do),this.Fo>this.Co&&(this.Fo=this.Co)}Lo(){this.Mo!==null&&(this.Mo.skipDelay(),this.Mo=null)}cancel(){this.Mo!==null&&(this.Mo.cancel(),this.Mo=null)}Bo(){return(Math.random()-.5)*this.Fo}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FO{constructor(e,n,r,i,s,o,a,l){this.oi=e,this.ko=r,this.qo=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.Qo=0,this.Ko=null,this.$o=null,this.stream=null,this.Uo=new PI(e,n)}Wo(){return this.state===1||this.state===5||this.Go()}Go(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.zo()}async stop(){this.Wo()&&await this.close(0)}jo(){this.state=0,this.Uo.reset()}Ho(){this.Go()&&this.Ko===null&&(this.Ko=this.oi.enqueueAfterDelay(this.ko,6e4,()=>this.Jo()))}Yo(e){this.Zo(),this.stream.send(e)}async Jo(){if(this.Go())return this.close(0)}Zo(){this.Ko&&(this.Ko.cancel(),this.Ko=null)}Xo(){this.$o&&(this.$o.cancel(),this.$o=null)}async close(e,n){this.Zo(),this.Xo(),this.Uo.cancel(),this.Qo++,e!==4?this.Uo.reset():n&&n.code===A.RESOURCE_EXHAUSTED?(lt(n.toString()),lt("Using maximum backoff delay to prevent overloading the backend."),this.Uo.Oo()):n&&n.code===A.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.e_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.lo(n)}e_(){}auth(){this.state=1;const e=this.t_(this.Qo),n=this.Qo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Qo===n&&this.n_(r,i)},r=>{e(()=>{const i=new D(A.UNKNOWN,"Fetching auth token failed: "+r.message);return this.r_(i)})})}n_(e,n){const r=this.t_(this.Qo);this.stream=this.i_(e,n),this.stream.uo(()=>{r(()=>(this.state=2,this.$o=this.oi.enqueueAfterDelay(this.qo,1e4,()=>(this.Go()&&(this.state=3),Promise.resolve())),this.listener.uo()))}),this.stream.lo(i=>{r(()=>this.r_(i))}),this.stream.onMessage(i=>{r(()=>this.onMessage(i))})}zo(){this.state=5,this.Uo.No(async()=>{this.state=0,this.start()})}r_(e){return O("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}t_(e){return n=>{this.oi.enqueueAndForget(()=>this.Qo===e?n():(O("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class RH extends FO{constructor(e,n,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}i_(e,n){return this.connection.bo("Listen",e,n)}onMessage(e){this.Uo.reset();const n=M8(this.serializer,e),r=function(s){if(!("targetChange"in s))return Q.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?Q.min():o.readTime?ct(o.readTime):Q.min()}(e);return this.listener.s_(n,r)}o_(e){const n={};n.database=Sh(this.serializer),n.addTarget=function(s,o){let a;const l=o.target;if(a=zp(l)?{documents:hO(s,l)}:{query:dO(s,l)},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=oO(s,o.resumeToken);const u=Ew(s,o.expectedCount);u!==null&&(a.expectedCount=u)}else if(o.snapshotVersion.compareTo(Q.min())>0){a.readTime=Vl(s,o.snapshotVersion.toTimestamp());const u=Ew(s,o.expectedCount);u!==null&&(a.expectedCount=u)}return a}(this.serializer,e);const r=F8(this.serializer,e);r&&(n.labels=r),this.Yo(n)}__(e){const n={};n.database=Sh(this.serializer),n.removeTarget=e,this.Yo(n)}}class AH extends FO{constructor(e,n,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s,this.a_=!1}get u_(){return this.a_}start(){this.a_=!1,this.lastStreamToken=void 0,super.start()}e_(){this.a_&&this.c_([])}i_(e,n){return this.connection.bo("Write",e,n)}onMessage(e){if(Y(!!e.streamToken),this.lastStreamToken=e.streamToken,this.a_){this.Uo.reset();const n=V8(e.writeResults,e.commitTime),r=ct(e.commitTime);return this.listener.l_(r,n)}return Y(!e.writeResults||e.writeResults.length===0),this.a_=!0,this.listener.h_()}P_(){const e={};e.database=Sh(this.serializer),this.Yo(e)}c_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>Ch(this.serializer,r))};this.Yo(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PH extends class{}{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.I_=!1}T_(){if(this.I_)throw new D(A.FAILED_PRECONDITION,"The client has already been terminated.")}fo(e,n,r){return this.T_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,s])=>this.connection.fo(e,n,r,i,s)).catch(i=>{throw i.name==="FirebaseError"?(i.code===A.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new D(A.UNKNOWN,i.toString())})}So(e,n,r,i){return this.T_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.So(e,n,r,s,o,i)).catch(s=>{throw s.name==="FirebaseError"?(s.code===A.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new D(A.UNKNOWN,s.toString())})}terminate(){this.I_=!0}}class bH{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.d_=0,this.A_=null,this.R_=!0}V_(){this.d_===0&&(this.m_("Unknown"),this.A_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.A_=null,this.f_("Backend didn't respond within 10 seconds."),this.m_("Offline"),Promise.resolve())))}g_(e){this.state==="Online"?this.m_("Unknown"):(this.d_++,this.d_>=1&&(this.p_(),this.f_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.m_("Offline")))}set(e){this.p_(),this.d_=0,e==="Online"&&(this.R_=!1),this.m_(e)}m_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}f_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.R_?(lt(n),this.R_=!1):O("OnlineStateTracker",n)}p_(){this.A_!==null&&(this.A_.cancel(),this.A_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kH{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.y_=[],this.w_=new Map,this.S_=new Set,this.b_=[],this.D_=s,this.D_.Xs(o=>{r.enqueueAndForget(async()=>{ro(this)&&(O("RemoteStore","Restarting streams for network reachability change."),await async function(l){const u=B(l);u.S_.add(4),await fu(u),u.v_.set("Unknown"),u.S_.delete(4),await gd(u)}(this))})}),this.v_=new bH(r,i)}}async function gd(t){if(ro(t))for(const e of t.b_)await e(!0)}async function fu(t){for(const e of t.b_)await e(!1)}function Tg(t,e){const n=B(t);n.w_.has(e.targetId)||(n.w_.set(e.targetId,e),xI(n)?kI(n):mu(n).Go()&&bI(n,e))}function Rh(t,e){const n=B(t),r=mu(n);n.w_.delete(e),r.Go()&&UO(n,e),n.w_.size===0&&(r.Go()?r.Ho():ro(n)&&n.v_.set("Unknown"))}function bI(t,e){if(t.C_.Le(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Q.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}mu(t).o_(e)}function UO(t,e){t.C_.Le(e),mu(t).__(e)}function kI(t){t.C_=new b8({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),lt:e=>t.w_.get(e)||null,st:()=>t.datastore.serializer.databaseId}),mu(t).start(),t.v_.V_()}function xI(t){return ro(t)&&!mu(t).Wo()&&t.w_.size>0}function ro(t){return B(t).S_.size===0}function $O(t){t.C_=void 0}async function xH(t){t.w_.forEach((e,n)=>{bI(t,e)})}async function NH(t,e){$O(t),xI(t)?(t.v_.g_(e),kI(t)):t.v_.set("Unknown")}async function DH(t,e,n){if(t.v_.set("Online"),e instanceof sO&&e.state===2&&e.cause)try{await async function(i,s){const o=s.cause;for(const a of s.targetIds)i.w_.has(a)&&(await i.remoteSyncer.rejectListen(a,o),i.w_.delete(a),i.C_.removeTarget(a))}(t,e)}catch(r){O("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Xp(t,r)}else if(e instanceof Gf?t.C_.Ge(e):e instanceof iO?t.C_.Xe(e):t.C_.He(e),!n.isEqual(Q.min()))try{const r=await xO(t.localStore);n.compareTo(r)>=0&&await function(s,o){const a=s.C_._t(o);return a.targetChanges.forEach((l,u)=>{if(l.resumeToken.approximateByteSize()>0){const c=s.w_.get(u);c&&s.w_.set(u,c.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,u)=>{const c=s.w_.get(l);if(!c)return;s.w_.set(l,c.withResumeToken(Tt.EMPTY_BYTE_STRING,c.snapshotVersion)),UO(s,l);const h=new Ci(c.target,l,u,c.sequenceNumber);bI(s,h)}),s.remoteSyncer.applyRemoteEvent(a)}(t,n)}catch(r){O("RemoteStore","Failed to raise snapshot:",r),await Xp(t,r)}}async function Xp(t,e,n){if(!to(e))throw e;t.S_.add(1),await fu(t),t.v_.set("Offline"),n||(n=()=>xO(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{O("RemoteStore","Retrying IndexedDB access"),await n(),t.S_.delete(1),await gd(t)})}function BO(t,e){return e().catch(n=>Xp(t,n,e))}async function pu(t){const e=B(t),n=Us(e);let r=e.y_.length>0?e.y_[e.y_.length-1].batchId:-1;for(;OH(e);)try{const i=await vH(e.localStore,r);if(i===null){e.y_.length===0&&n.Ho();break}r=i.batchId,LH(e,i)}catch(i){await Xp(e,i)}zO(e)&&jO(e)}function OH(t){return ro(t)&&t.y_.length<10}function LH(t,e){t.y_.push(e);const n=Us(t);n.Go()&&n.u_&&n.c_(e.mutations)}function zO(t){return ro(t)&&!Us(t).Wo()&&t.y_.length>0}function jO(t){Us(t).start()}async function MH(t){Us(t).P_()}async function VH(t){const e=Us(t);for(const n of t.y_)e.c_(n.mutations)}async function FH(t,e,n){const r=t.y_.shift(),i=gI.from(r,e,n);await BO(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await pu(t)}async function UH(t,e){e&&Us(t).u_&&await async function(r,i){if(function(o){return tO(o)&&o!==A.ABORTED}(i.code)){const s=r.y_.shift();Us(r).jo(),await BO(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await pu(r)}}(t,e),zO(t)&&jO(t)}async function NR(t,e){const n=B(t);n.asyncQueue.verifyOperationInProgress(),O("RemoteStore","RemoteStore received new credentials");const r=ro(n);n.S_.add(3),await fu(n),r&&n.v_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.S_.delete(3),await gd(n)}async function Pw(t,e){const n=B(t);e?(n.S_.delete(2),await gd(n)):e||(n.S_.add(2),await fu(n),n.v_.set("Unknown"))}function mu(t){return t.F_||(t.F_=function(n,r,i){const s=B(n);return s.T_(),new RH(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{uo:xH.bind(null,t),lo:NH.bind(null,t),s_:DH.bind(null,t)}),t.b_.push(async e=>{e?(t.F_.jo(),xI(t)?kI(t):t.v_.set("Unknown")):(await t.F_.stop(),$O(t))})),t.F_}function Us(t){return t.M_||(t.M_=function(n,r,i){const s=B(n);return s.T_(),new AH(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{uo:MH.bind(null,t),lo:UH.bind(null,t),h_:VH.bind(null,t),l_:FH.bind(null,t)}),t.b_.push(async e=>{e?(t.M_.jo(),await pu(t)):(await t.M_.stop(),t.y_.length>0&&(O("RemoteStore",`Stopping write stream with ${t.y_.length} pending writes`),t.y_=[]))})),t.M_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NI{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new Dt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}static createAndSchedule(e,n,r,i,s){const o=Date.now()+r,a=new NI(e,n,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new D(A.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function gu(t,e){if(lt("AsyncQueue",`${e}: ${t}`),to(t))return new D(A.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dl{constructor(e){this.comparator=e?(n,r)=>e(n,r)||$.comparator(n.key,r.key):(n,r)=>$.comparator(n.key,r.key),this.keyedMap=ac(),this.sortedSet=new et(this.comparator)}static emptySet(e){return new dl(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof dl)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new dl;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DR{constructor(){this.x_=new et($.comparator)}track(e){const n=e.doc.key,r=this.x_.get(n);r?e.type!==0&&r.type===3?this.x_=this.x_.insert(n,e):e.type===3&&r.type!==1?this.x_=this.x_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.x_=this.x_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.x_=this.x_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.x_=this.x_.remove(n):e.type===1&&r.type===2?this.x_=this.x_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.x_=this.x_.insert(n,{type:2,doc:e.doc}):W():this.x_=this.x_.insert(n,e)}O_(){const e=[];return this.x_.inorderTraversal((n,r)=>{e.push(r)}),e}}class $l{constructor(e,n,r,i,s,o,a,l,u){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=u}static fromInitialDocuments(e,n,r,i,s){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new $l(e,n,dl.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&cd(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $H{constructor(){this.N_=void 0,this.listeners=[]}}class BH{constructor(){this.queries=new no(e=>$D(e),cd),this.onlineState="Unknown",this.B_=new Set}}async function DI(t,e){const n=B(t),r=e.query;let i=!1,s=n.queries.get(r);if(s||(i=!0,s=new $H),i)try{s.N_=await n.onListen(r)}catch(o){const a=gu(o,`Initialization of query '${ww(e.query)}' failed`);return void e.onError(a)}n.queries.set(r,s),s.listeners.push(e),e.L_(n.onlineState),s.N_&&e.k_(s.N_)&&LI(n)}async function OI(t,e){const n=B(t),r=e.query;let i=!1;const s=n.queries.get(r);if(s){const o=s.listeners.indexOf(e);o>=0&&(s.listeners.splice(o,1),i=s.listeners.length===0)}if(i)return n.queries.delete(r),n.onUnlisten(r)}function zH(t,e){const n=B(t);let r=!1;for(const i of e){const s=i.query,o=n.queries.get(s);if(o){for(const a of o.listeners)a.k_(i)&&(r=!0);o.N_=i}}r&&LI(n)}function jH(t,e,n){const r=B(t),i=r.queries.get(e);if(i)for(const s of i.listeners)s.onError(n);r.queries.delete(e)}function LI(t){t.B_.forEach(e=>{e.next()})}class MI{constructor(e,n,r){this.query=e,this.q_=n,this.Q_=!1,this.K_=null,this.onlineState="Unknown",this.options=r||{}}k_(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new $l(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Q_?this.U_(e)&&(this.q_.next(e),n=!0):this.W_(e,this.onlineState)&&(this.G_(e),n=!0),this.K_=e,n}onError(e){this.q_.error(e)}L_(e){this.onlineState=e;let n=!1;return this.K_&&!this.Q_&&this.W_(this.K_,e)&&(this.G_(this.K_),n=!0),n}W_(e,n){if(!e.fromCache)return!0;const r=n!=="Offline";return(!this.options.z_||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}U_(e){if(e.docChanges.length>0)return!0;const n=this.K_&&this.K_.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}G_(e){e=$l.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Q_=!0,this.q_.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qH{constructor(e,n){this.j_=e,this.byteLength=n}H_(){return"metadata"in this.j_}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OR{constructor(e){this.serializer=e}us(e){return ti(this.serializer,e)}cs(e){return e.metadata.exists?cO(this.serializer,e.document,!1):Ue.newNoDocument(this.us(e.metadata.name),this.ls(e.metadata.readTime))}ls(e){return ct(e)}}class WH{constructor(e,n,r){this.J_=e,this.localStore=n,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=qO(e)}Y_(e){this.progress.bytesLoaded+=e.byteLength;let n=this.progress.documentsLoaded;if(e.j_.namedQuery)this.queries.push(e.j_.namedQuery);else if(e.j_.documentMetadata){this.documents.push({metadata:e.j_.documentMetadata}),e.j_.documentMetadata.exists||++n;const r=ge.fromString(e.j_.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.j_.document&&(this.documents[this.documents.length-1].document=e.j_.document,++n);return n!==this.progress.documentsLoaded?(this.progress.documentsLoaded=n,Object.assign({},this.progress)):null}Z_(e){const n=new Map,r=new OR(this.serializer);for(const i of e)if(i.metadata.queries){const s=r.us(i.metadata.name);for(const o of i.metadata.queries){const a=(n.get(o)||ae()).add(s);n.set(o,a)}}return n}async complete(){const e=await wH(this.localStore,new OR(this.serializer),this.documents,this.J_.id),n=this.Z_(this.documents);for(const r of this.queries)await EH(this.localStore,r,n.get(r.name));return this.progress.taskState="Success",{progress:this.progress,X_:this.collectionGroups,ea:e}}}function qO(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WO{constructor(e){this.key=e}}class HO{constructor(e){this.key=e}}class GO{constructor(e,n){this.query=e,this.ta=n,this.na=null,this.hasCachedResults=!1,this.current=!1,this.ra=ae(),this.mutatedKeys=ae(),this.ia=zD(e),this.sa=new dl(this.ia)}get oa(){return this.ta}_a(e,n){const r=n?n.aa:new DR,i=n?n.sa:this.sa;let s=n?n.mutatedKeys:this.mutatedKeys,o=i,a=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,u=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((c,h)=>{const f=i.get(c),g=hd(this.query,h)?h:null,_=!!f&&this.mutatedKeys.has(f.key),w=!!g&&(g.hasLocalMutations||this.mutatedKeys.has(g.key)&&g.hasCommittedMutations);let T=!1;f&&g?f.data.isEqual(g.data)?_!==w&&(r.track({type:3,doc:g}),T=!0):this.ua(f,g)||(r.track({type:2,doc:g}),T=!0,(l&&this.ia(g,l)>0||u&&this.ia(g,u)<0)&&(a=!0)):!f&&g?(r.track({type:0,doc:g}),T=!0):f&&!g&&(r.track({type:1,doc:f}),T=!0,(l||u)&&(a=!0)),T&&(g?(o=o.add(g),s=w?s.add(c):s.delete(c)):(o=o.delete(c),s=s.delete(c)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const c=this.query.limitType==="F"?o.last():o.first();o=o.delete(c.key),s=s.delete(c.key),r.track({type:1,doc:c})}return{sa:o,aa:r,Hi:a,mutatedKeys:s}}ua(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r){const i=this.sa;this.sa=e.sa,this.mutatedKeys=e.mutatedKeys;const s=e.aa.O_();s.sort((u,c)=>function(f,g){const _=w=>{switch(w){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return W()}};return _(f)-_(g)}(u.type,c.type)||this.ia(u.doc,c.doc)),this.ca(r);const o=n?this.la():[],a=this.ra.size===0&&this.current?1:0,l=a!==this.na;return this.na=a,s.length!==0||l?{snapshot:new $l(this.query,e.sa,i,s,e.mutatedKeys,a===0,l,!1,!!r&&r.resumeToken.approximateByteSize()>0),ha:o}:{ha:o}}L_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({sa:this.sa,aa:new DR,mutatedKeys:this.mutatedKeys,Hi:!1},!1)):{ha:[]}}Pa(e){return!this.ta.has(e)&&!!this.sa.has(e)&&!this.sa.get(e).hasLocalMutations}ca(e){e&&(e.addedDocuments.forEach(n=>this.ta=this.ta.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.ta=this.ta.delete(n)),this.current=e.current)}la(){if(!this.current)return[];const e=this.ra;this.ra=ae(),this.sa.forEach(r=>{this.Pa(r.key)&&(this.ra=this.ra.add(r.key))});const n=[];return e.forEach(r=>{this.ra.has(r)||n.push(new HO(r))}),this.ra.forEach(r=>{e.has(r)||n.push(new WO(r))}),n}Ia(e){this.ta=e._s,this.ra=ae();const n=this._a(e.documents);return this.applyChanges(n,!0)}Ta(){return $l.fromInitialDocuments(this.query,this.sa,this.mutatedKeys,this.na===0,this.hasCachedResults)}}class HH{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class GH{constructor(e){this.key=e,this.Ea=!1}}class KH{constructor(e,n,r,i,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.da={},this.Aa=new no(a=>$D(a),cd),this.Ra=new Map,this.Va=new Set,this.ma=new et($.comparator),this.fa=new Map,this.ga=new TI,this.pa={},this.ya=new Map,this.wa=ia.Bn(),this.onlineState="Unknown",this.Sa=void 0}get isPrimaryClient(){return this.Sa===!0}}async function QH(t,e){const n=BI(t);let r,i;const s=n.Aa.get(e);if(s)r=s.targetId,n.sharedClientState.addLocalQueryTarget(r),i=s.view.Ta();else{const o=await Fl(n.localStore,Fn(e)),a=n.sharedClientState.addLocalQueryTarget(o.targetId);r=o.targetId,i=await VI(n,e,r,a==="current",o.resumeToken),n.isPrimaryClient&&Tg(n.remoteStore,o)}return i}async function VI(t,e,n,r,i){t.ba=(h,f,g)=>async function(w,T,v,y){let I=T.view._a(v);I.Hi&&(I=await Kp(w.localStore,T.query,!1).then(({documents:b})=>T.view._a(b,I)));const C=y&&y.targetChanges.get(T.targetId),P=T.view.applyChanges(I,w.isPrimaryClient,C);return bw(w,T.targetId,P.ha),P.snapshot}(t,h,f,g);const s=await Kp(t.localStore,e,!0),o=new GO(e,s._s),a=o._a(s.documents),l=pd.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),u=o.applyChanges(a,t.isPrimaryClient,l);bw(t,n,u.ha);const c=new HH(e,n,o);return t.Aa.set(e,c),t.Ra.has(n)?t.Ra.get(n).push(e):t.Ra.set(n,[e]),u.snapshot}async function YH(t,e){const n=B(t),r=n.Aa.get(e),i=n.Ra.get(r.targetId);if(i.length>1)return n.Ra.set(r.targetId,i.filter(s=>!cd(s,e))),void n.Aa.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)||await Ul(n.localStore,r.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(r.targetId),Rh(n.remoteStore,r.targetId),Bl(n,r.targetId)}).catch(eo)):(Bl(n,r.targetId),await Ul(n.localStore,r.targetId,!0))}async function XH(t,e,n){const r=zI(t);try{const i=await function(o,a){const l=B(o),u=He.now(),c=a.reduce((g,_)=>g.add(_.key),ae());let h,f;return l.persistence.runTransaction("Locally write mutations","readwrite",g=>{let _=xn(),w=ae();return l.ts.getEntries(g,c).next(T=>{_=T,_.forEach((v,y)=>{y.isValidDocument()||(w=w.add(v))})}).next(()=>l.localDocuments.getOverlayedDocuments(g,_)).next(T=>{h=T;const v=[];for(const y of a){const I=R8(y,h.get(y.key).overlayedDocument);I!=null&&v.push(new Wi(y.key,I,xD(I.value.mapValue),qe.exists(!0)))}return l.mutationQueue.addMutationBatch(g,u,v,a)}).next(T=>{f=T;const v=T.applyToLocalDocumentSet(h,w);return l.documentOverlayCache.saveOverlays(g,T.batchId,v)})}).then(()=>({batchId:f.batchId,changes:qD(h)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,l){let u=o.pa[o.currentUser.toKey()];u||(u=new et(se)),u=u.insert(a,l),o.pa[o.currentUser.toKey()]=u}(r,i.batchId,n),await Hi(r,i.changes),await pu(r.remoteStore)}catch(i){const s=gu(i,"Failed to persist write");n.reject(s)}}async function KO(t,e){const n=B(t);try{const r=await yH(n.localStore,e);e.targetChanges.forEach((i,s)=>{const o=n.fa.get(s);o&&(Y(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.Ea=!0:i.modifiedDocuments.size>0?Y(o.Ea):i.removedDocuments.size>0&&(Y(o.Ea),o.Ea=!1))}),await Hi(n,r,e)}catch(r){await eo(r)}}function LR(t,e,n){const r=B(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const i=[];r.Aa.forEach((s,o)=>{const a=o.view.L_(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){const l=B(o);l.onlineState=a;let u=!1;l.queries.forEach((c,h)=>{for(const f of h.listeners)f.L_(a)&&(u=!0)}),u&&LI(l)}(r.eventManager,e),i.length&&r.da.s_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function JH(t,e,n){const r=B(t);r.sharedClientState.updateQueryState(e,"rejected",n);const i=r.fa.get(e),s=i&&i.key;if(s){let o=new et($.comparator);o=o.insert(s,Ue.newNoDocument(s,Q.min()));const a=ae().add(s),l=new fd(Q.min(),new Map,new et(se),o,a);await KO(r,l),r.ma=r.ma.remove(s),r.fa.delete(e),$I(r)}else await Ul(r.localStore,e,!1).then(()=>Bl(r,e,n)).catch(eo)}async function ZH(t,e){const n=B(t),r=e.batch.batchId;try{const i=await _H(n.localStore,e);UI(n,r,null),FI(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Hi(n,i)}catch(i){await eo(i)}}async function eG(t,e,n){const r=B(t);try{const i=await function(o,a){const l=B(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let c;return l.mutationQueue.lookupMutationBatch(u,a).next(h=>(Y(h!==null),c=h.keys(),l.mutationQueue.removeMutationBatch(u,h))).next(()=>l.mutationQueue.performConsistencyCheck(u)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(u,c,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,c)).next(()=>l.localDocuments.getDocuments(u,c))})}(r.localStore,e);UI(r,e,n),FI(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await Hi(r,i)}catch(i){await eo(i)}}async function tG(t,e){const n=B(t);ro(n.remoteStore)||O("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=await function(o){const a=B(o);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",l=>a.mutationQueue.getHighestUnacknowledgedBatchId(l))}(n.localStore);if(r===-1)return void e.resolve();const i=n.ya.get(r)||[];i.push(e),n.ya.set(r,i)}catch(r){const i=gu(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}}function FI(t,e){(t.ya.get(e)||[]).forEach(n=>{n.resolve()}),t.ya.delete(e)}function UI(t,e,n){const r=B(t);let i=r.pa[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.pa[r.currentUser.toKey()]=i}}function Bl(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Ra.get(e))t.Aa.delete(r),n&&t.da.Da(r,n);t.Ra.delete(e),t.isPrimaryClient&&t.ga.Vr(e).forEach(r=>{t.ga.containsKey(r)||QO(t,r)})}function QO(t,e){t.Va.delete(e.path.canonicalString());const n=t.ma.get(e);n!==null&&(Rh(t.remoteStore,n),t.ma=t.ma.remove(e),t.fa.delete(n),$I(t))}function bw(t,e,n){for(const r of n)r instanceof WO?(t.ga.addReference(r.key,e),nG(t,r)):r instanceof HO?(O("SyncEngine","Document no longer in limbo: "+r.key),t.ga.removeReference(r.key,e),t.ga.containsKey(r.key)||QO(t,r.key)):W()}function nG(t,e){const n=e.key,r=n.path.canonicalString();t.ma.get(n)||t.Va.has(r)||(O("SyncEngine","New document in limbo: "+n),t.Va.add(r),$I(t))}function $I(t){for(;t.Va.size>0&&t.ma.size<t.maxConcurrentLimboResolutions;){const e=t.Va.values().next().value;t.Va.delete(e);const n=new $(ge.fromString(e)),r=t.wa.next();t.fa.set(r,new GH(n)),t.ma=t.ma.insert(n,r),Tg(t.remoteStore,new Ci(Fn(cu(n.path)),r,"TargetPurposeLimboResolution",bn.ae))}}async function Hi(t,e,n){const r=B(t),i=[],s=[],o=[];r.Aa.isEmpty()||(r.Aa.forEach((a,l)=>{o.push(r.ba(l,e,n).then(u=>{if((u||n)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(l.targetId,u!=null&&u.fromCache?"not-current":"current"),u){i.push(u);const c=RI.Ki(l.targetId,u);s.push(c)}}))}),await Promise.all(o),r.da.s_(i),await async function(l,u){const c=B(l);try{await c.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>R.forEach(u,f=>R.forEach(f.qi,g=>c.persistence.referenceDelegate.addReference(h,f.targetId,g)).next(()=>R.forEach(f.Qi,g=>c.persistence.referenceDelegate.removeReference(h,f.targetId,g)))))}catch(h){if(!to(h))throw h;O("LocalStore","Failed to update sequence numbers: "+h)}for(const h of u){const f=h.targetId;if(!h.fromCache){const g=c.Zi.get(f),_=g.snapshotVersion,w=g.withLastLimboFreeSnapshotVersion(_);c.Zi=c.Zi.insert(f,w)}}}(r.localStore,s))}async function rG(t,e){const n=B(t);if(!n.currentUser.isEqual(e)){O("SyncEngine","User change. New user:",e.toKey());const r=await kO(n.localStore,e);n.currentUser=e,function(s,o){s.ya.forEach(a=>{a.forEach(l=>{l.reject(new D(A.CANCELLED,o))})}),s.ya.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Hi(n,r.rs)}}function iG(t,e){const n=B(t),r=n.fa.get(e);if(r&&r.Ea)return ae().add(r.key);{let i=ae();const s=n.Ra.get(e);if(!s)return i;for(const o of s){const a=n.Aa.get(o);i=i.unionWith(a.view.oa)}return i}}async function sG(t,e){const n=B(t),r=await Kp(n.localStore,e.query,!0),i=e.view.Ia(r);return n.isPrimaryClient&&bw(n,e.targetId,i.ha),i}async function oG(t,e){const n=B(t);return OO(n.localStore,e).then(r=>Hi(n,r))}async function aG(t,e,n,r){const i=B(t),s=await function(a,l){const u=B(a),c=B(u.mutationQueue);return u.persistence.runTransaction("Lookup mutation documents","readonly",h=>c.Cn(h,l).next(f=>f?u.localDocuments.getDocuments(h,f):R.resolve(null)))}(i.localStore,e);s!==null?(n==="pending"?await pu(i.remoteStore):n==="acknowledged"||n==="rejected"?(UI(i,e,r||null),FI(i,e),function(a,l){B(B(a).mutationQueue).Mn(l)}(i.localStore,e)):W(),await Hi(i,s)):O("SyncEngine","Cannot apply mutation batch with id: "+e)}async function lG(t,e){const n=B(t);if(BI(n),zI(n),e===!0&&n.Sa!==!0){const r=n.sharedClientState.getAllActiveQueryTargets(),i=await MR(n,r.toArray());n.Sa=!0,await Pw(n.remoteStore,!0);for(const s of i)Tg(n.remoteStore,s)}else if(e===!1&&n.Sa!==!1){const r=[];let i=Promise.resolve();n.Ra.forEach((s,o)=>{n.sharedClientState.isLocalQueryTarget(o)?r.push(o):i=i.then(()=>(Bl(n,o),Ul(n.localStore,o,!0))),Rh(n.remoteStore,o)}),await i,await MR(n,r),function(o){const a=B(o);a.fa.forEach((l,u)=>{Rh(a.remoteStore,u)}),a.ga.mr(),a.fa=new Map,a.ma=new et($.comparator)}(n),n.Sa=!1,await Pw(n.remoteStore,!1)}}async function MR(t,e,n){const r=B(t),i=[],s=[];for(const o of e){let a;const l=r.Ra.get(o);if(l&&l.length!==0){a=await Fl(r.localStore,Fn(l[0]));for(const u of l){const c=r.Aa.get(u),h=await sG(r,c);h.snapshot&&s.push(h.snapshot)}}else{const u=await DO(r.localStore,o);a=await Fl(r.localStore,u),await VI(r,YO(u),o,!1,a.resumeToken)}i.push(a)}return r.da.s_(s),i}function YO(t){return UD(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function uG(t){return function(n){return B(B(n).persistence).Li()}(B(t).localStore)}async function cG(t,e,n,r){const i=B(t);if(i.Sa)return void O("SyncEngine","Ignoring unexpected query state notification.");const s=i.Ra.get(e);if(s&&s.length>0)switch(n){case"current":case"not-current":{const o=await OO(i.localStore,BD(s[0])),a=fd.createSynthesizedRemoteEventForCurrentChange(e,n==="current",Tt.EMPTY_BYTE_STRING);await Hi(i,o,a);break}case"rejected":await Ul(i.localStore,e,!0),Bl(i,e,r);break;default:W()}}async function hG(t,e,n){const r=BI(t);if(r.Sa){for(const i of e){if(r.Ra.has(i)){O("SyncEngine","Adding an already active target "+i);continue}const s=await DO(r.localStore,i),o=await Fl(r.localStore,s);await VI(r,YO(s),o.targetId,!1,o.resumeToken),Tg(r.remoteStore,o)}for(const i of n)r.Ra.has(i)&&await Ul(r.localStore,i,!1).then(()=>{Rh(r.remoteStore,i),Bl(r,i)}).catch(eo)}}function BI(t){const e=B(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=KO.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=iG.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=JH.bind(null,e),e.da.s_=zH.bind(null,e.eventManager),e.da.Da=jH.bind(null,e.eventManager),e}function zI(t){const e=B(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=ZH.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=eG.bind(null,e),e}function dG(t,e,n){const r=B(t);(async function(s,o,a){try{const l=await o.getMetadata();if(await function(g,_){const w=B(g),T=ct(_.createTime);return w.persistence.runTransaction("hasNewerBundle","readonly",v=>w.$r.getBundleMetadata(v,_.id)).then(v=>!!v&&v.createTime.compareTo(T)>=0)}(s.localStore,l))return await o.close(),a._completeWith(function(g){return{taskState:"Success",documentsLoaded:g.totalDocuments,bytesLoaded:g.totalBytes,totalDocuments:g.totalDocuments,totalBytes:g.totalBytes}}(l)),Promise.resolve(new Set);a._updateProgress(qO(l));const u=new WH(l,s.localStore,o.serializer);let c=await o.va();for(;c;){const f=await u.Y_(c);f&&a._updateProgress(f),c=await o.va()}const h=await u.complete();return await Hi(s,h.ea,void 0),await function(g,_){const w=B(g);return w.persistence.runTransaction("Save bundle","readwrite",T=>w.$r.saveBundleMetadata(T,_))}(s.localStore,l),a._completeWith(h.progress),Promise.resolve(h.X_)}catch(l){return Lr("SyncEngine",`Loading bundle failed with ${l}`),a._failWith(l),Promise.resolve(new Set)}})(r,e,n).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}class kw{constructor(){this.synchronizeTabs=!1}async initialize(e){this.serializer=md(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),await this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)}createGarbageCollectionScheduler(e,n){return null}createIndexBackfillerScheduler(e,n){return null}createLocalStore(e){return bO(this.persistence,new PO,e.initialUser,this.serializer)}createPersistence(e){return new AO(Ig.Hr,this.serializer)}createSharedClientState(e){return new MO}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class XO extends kw{constructor(e,n,r){super(),this.Ca=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Ca.initialize(this,e),await zI(this.Ca.syncEngine),await pu(this.Ca.remoteStore),await this.persistence.fi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}createLocalStore(e){return bO(this.persistence,new PO,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,n){const r=this.persistence.referenceDelegate.garbageCollector;return new tH(r,e.asyncQueue,n)}createIndexBackfillerScheduler(e,n){const r=new VW(n,this.persistence);return new MW(e.asyncQueue,r)}createPersistence(e){const n=CI(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Sn.withCacheSize(this.cacheSizeBytes):Sn.DEFAULT;return new SI(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,VO(),Kf(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new MO}}class fG extends XO{constructor(e,n){super(e,n,!1),this.Ca=e,this.cacheSizeBytes=n,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const n=this.Ca.syncEngine;this.sharedClientState instanceof Sy&&(this.sharedClientState.syncEngine={js:aG.bind(null,n),Hs:cG.bind(null,n),Js:hG.bind(null,n),Li:uG.bind(null,n),zs:oG.bind(null,n)},await this.sharedClientState.start()),await this.persistence.fi(async r=>{await lG(this.Ca.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())})}createSharedClientState(e){const n=VO();if(!Sy.v(n))throw new D(A.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=CI(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Sy(n,e.asyncQueue,r,e.clientId,e.initialUser)}}class jI{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>LR(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=rG.bind(null,this.syncEngine),await Pw(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new BH}()}createDatastore(e){const n=md(e.databaseInfo.databaseId),r=function(s){return new CH(s)}(e.databaseInfo);return function(s,o,a,l){return new PH(s,o,a,l)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,s,o,a){return new kH(r,i,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>LR(this.syncEngine,n,0),function(){return xR.v()?new xR:new IH}())}createSyncEngine(e,n){return function(i,s,o,a,l,u,c){const h=new KH(i,s,o,a,l,u);return c&&(h.Sa=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}terminate(){return async function(n){const r=B(n);O("RemoteStore","RemoteStore shutting down."),r.S_.add(5),await fu(r),r.D_.shutdown(),r.v_.set("Unknown")}(this.remoteStore)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VR(t,e=10240){let n=0;return{async read(){if(n<t.byteLength){const r={value:t.slice(n,n+e),done:!1};return n+=e,r}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sg{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Fa(this.observer.next,e)}error(e){this.observer.error?this.Fa(this.observer.error,e):lt("Uncaught Error in snapshot listener:",e.toString())}Ma(){this.muted=!0}Fa(e,n){this.muted||setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pG{constructor(e,n){this.xa=e,this.serializer=n,this.metadata=new Dt,this.buffer=new Uint8Array,this.Oa=function(){return new TextDecoder("utf-8")}(),this.Na().then(r=>{r&&r.H_()?this.metadata.resolve(r.j_.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r==null?void 0:r.j_)}`))},r=>this.metadata.reject(r))}close(){return this.xa.cancel()}async getMetadata(){return this.metadata.promise}async va(){return await this.getMetadata(),this.Na()}async Na(){const e=await this.Ba();if(e===null)return null;const n=this.Oa.decode(e),r=Number(n);isNaN(r)&&this.La(`length string (${n}) is not valid number`);const i=await this.ka(r);return new qH(JSON.parse(i),e.length+r)}qa(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}async Ba(){for(;this.qa()<0&&!await this.Qa(););if(this.buffer.length===0)return null;const e=this.qa();e<0&&this.La("Reached the end of bundle when a length string is expected.");const n=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),n}async ka(e){for(;this.buffer.length<e;)await this.Qa()&&this.La("Reached the end of bundle when more is expected.");const n=this.Oa.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),n}La(e){throw this.xa.cancel(),new Error(`Invalid bundle format: ${e}`)}async Qa(){const e=await this.xa.read();if(!e.done){const n=new Uint8Array(this.buffer.length+e.value.length);n.set(this.buffer),n.set(e.value,this.buffer.length),this.buffer=n}return e.done}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mG{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new D(A.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const n=await async function(i,s){const o=B(i),a=Sh(o.serializer)+"/documents",l={documents:s.map(f=>Th(o.serializer,f))},u=await o.So("BatchGetDocuments",a,l,s.length),c=new Map;u.forEach(f=>{const g=L8(o.serializer,f);c.set(g.key.toString(),g)});const h=[];return s.forEach(f=>{const g=c.get(f.toString());Y(!!g),h.push(g)}),h}(this.datastore,e);return n.forEach(r=>this.recordVersion(r)),n}set(e,n){this.write(n.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,n){try{this.write(n.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastWriteError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new du(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;const e=this.readVersions;this.mutations.forEach(n=>{e.delete(n.key.toString())}),e.forEach((n,r)=>{const i=$.fromPath(r);this.mutations.push(new pI(i,this.precondition(i)))}),await async function(r,i){const s=B(r),o=Sh(s.serializer)+"/documents",a={writes:i.map(l=>Ch(s.serializer,l))};await s.fo("Commit",o,a)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let n;if(e.isFoundDocument())n=e.version;else{if(!e.isNoDocument())throw W();n=Q.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!n.isEqual(r))throw new D(A.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),n)}precondition(e){const n=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&n?n.isEqual(Q.min())?qe.exists(!1):qe.updateTime(n):qe.none()}preconditionForUpdate(e){const n=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&n){if(n.isEqual(Q.min()))throw new D(A.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return qe.updateTime(n)}return qe.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gG{constructor(e,n,r,i,s){this.asyncQueue=e,this.datastore=n,this.options=r,this.updateFunction=i,this.deferred=s,this.Ka=r.maxAttempts,this.Uo=new PI(this.asyncQueue,"transaction_retry")}run(){this.Ka-=1,this.$a()}$a(){this.Uo.No(async()=>{const e=new mG(this.datastore),n=this.Ua(e);n&&n.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(i=>{this.Wa(i)}))}).catch(r=>{this.Wa(r)})})}Ua(e){try{const n=this.updateFunction(e);return!ld(n)&&n.catch&&n.then?n:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(n){return this.deferred.reject(n),null}}Wa(e){this.Ka>0&&this.Ga(e)?(this.Ka-=1,this.asyncQueue.enqueueAndForget(()=>(this.$a(),Promise.resolve()))):this.deferred.reject(e)}Ga(e){if(e.name==="FirebaseError"){const n=e.code;return n==="aborted"||n==="failed-precondition"||n==="already-exists"||!tO(n)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _G{constructor(e,n,r,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=bt.UNAUTHENTICATED,this.clientId=gD.V(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,async s=>{O("FirestoreClient","Received user=",s.uid),await this.authCredentialListener(s),this.user=s}),this.appCheckCredentials.start(r,s=>(O("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new D(A.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Dt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=gu(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Qf(t,e){t.asyncQueue.verifyOperationInProgress(),O("FirestoreClient","Initializing OfflineComponentProvider");const n=await t.getConfiguration();await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async i=>{r.isEqual(i)||(await kO(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function xw(t,e){t.asyncQueue.verifyOperationInProgress();const n=await qI(t);O("FirestoreClient","Initializing OnlineComponentProvider");const r=await t.getConfiguration();await e.initialize(n,r),t.setCredentialChangeListener(i=>NR(e.remoteStore,i)),t.setAppCheckTokenChangeListener((i,s)=>NR(e.remoteStore,s)),t._onlineComponents=e}function JO(t){return t.name==="FirebaseError"?t.code===A.FAILED_PRECONDITION||t.code===A.UNIMPLEMENTED:!(typeof DOMException<"u"&&t instanceof DOMException)||t.code===22||t.code===20||t.code===11}async function qI(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){O("FirestoreClient","Using user provided OfflineComponentProvider");try{await Qf(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!JO(n))throw n;Lr("Error using user provided cache. Falling back to memory cache: "+n),await Qf(t,new kw)}}else O("FirestoreClient","Using default OfflineComponentProvider"),await Qf(t,new kw);return t._offlineComponents}async function Cg(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(O("FirestoreClient","Using user provided OnlineComponentProvider"),await xw(t,t._uninitializedComponentsProvider._online)):(O("FirestoreClient","Using default OnlineComponentProvider"),await xw(t,new jI))),t._onlineComponents}function ZO(t){return qI(t).then(e=>e.persistence)}function WI(t){return qI(t).then(e=>e.localStore)}function eL(t){return Cg(t).then(e=>e.remoteStore)}function HI(t){return Cg(t).then(e=>e.syncEngine)}function yG(t){return Cg(t).then(e=>e.datastore)}async function zl(t){const e=await Cg(t),n=e.eventManager;return n.onListen=QH.bind(null,e.syncEngine),n.onUnlisten=YH.bind(null,e.syncEngine),n}function vG(t){return t.asyncQueue.enqueue(async()=>{const e=await ZO(t),n=await eL(t);return e.setNetworkEnabled(!0),function(i){const s=B(i);return s.S_.delete(0),gd(s)}(n)})}function wG(t){return t.asyncQueue.enqueue(async()=>{const e=await ZO(t),n=await eL(t);return e.setNetworkEnabled(!1),async function(i){const s=B(i);s.S_.add(0),await fu(s),s.v_.set("Offline")}(n)})}function EG(t,e){const n=new Dt;return t.asyncQueue.enqueueAndForget(async()=>async function(i,s,o){try{const a=await function(u,c){const h=B(u);return h.persistence.runTransaction("read document","readonly",f=>h.localDocuments.getDocument(f,c))}(i,s);a.isFoundDocument()?o.resolve(a):a.isNoDocument()?o.resolve(null):o.reject(new D(A.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(a){const l=gu(a,`Failed to get document '${s} from cache`);o.reject(l)}}(await WI(t),e,n)),n.promise}function tL(t,e,n={}){const r=new Dt;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,a,l,u){const c=new Sg({next:f=>{o.enqueueAndForget(()=>OI(s,h));const g=f.docs.has(a);!g&&f.fromCache?u.reject(new D(A.UNAVAILABLE,"Failed to get document because the client is offline.")):g&&f.fromCache&&l&&l.source==="server"?u.reject(new D(A.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(f)},error:f=>u.reject(f)}),h=new MI(cu(a.path),c,{includeMetadataChanges:!0,z_:!0});return DI(s,h)}(await zl(t),t.asyncQueue,e,n,r)),r.promise}function IG(t,e){const n=new Dt;return t.asyncQueue.enqueueAndForget(async()=>async function(i,s,o){try{const a=await Kp(i,s,!0),l=new GO(s,a._s),u=l._a(a.documents),c=l.applyChanges(u,!1);o.resolve(c.snapshot)}catch(a){const l=gu(a,`Failed to execute query '${s} against cache`);o.reject(l)}}(await WI(t),e,n)),n.promise}function nL(t,e,n={}){const r=new Dt;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,a,l,u){const c=new Sg({next:f=>{o.enqueueAndForget(()=>OI(s,h)),f.fromCache&&l.source==="server"?u.reject(new D(A.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(f)},error:f=>u.reject(f)}),h=new MI(a,c,{includeMetadataChanges:!0,z_:!0});return DI(s,h)}(await zl(t),t.asyncQueue,e,n,r)),r.promise}function TG(t,e){const n=new Sg(e);return t.asyncQueue.enqueueAndForget(async()=>function(i,s){B(i).B_.add(s),s.next()}(await zl(t),n)),()=>{n.Ma(),t.asyncQueue.enqueueAndForget(async()=>function(i,s){B(i).B_.delete(s)}(await zl(t),n))}}function SG(t,e,n,r){const i=function(o,a){let l;return l=typeof o=="string"?rO().encode(o):o,function(c,h){return new pG(c,h)}(function(c,h){if(c instanceof Uint8Array)return VR(c,h);if(c instanceof ArrayBuffer)return VR(new Uint8Array(c),h);if(c instanceof ReadableStream)return c.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(l),a)}(n,md(e));t.asyncQueue.enqueueAndForget(async()=>{dG(await HI(t),i,r)})}function CG(t,e){return t.asyncQueue.enqueue(async()=>function(r,i){const s=B(r);return s.persistence.runTransaction("Get named query","readonly",o=>s.$r.getNamedQuery(o,i))}(await WI(t),e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rL(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FR=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GI(t,e,n){if(!n)throw new D(A.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function iL(t,e,n,r){if(e===!0&&r===!0)throw new D(A.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function UR(t){if(!$.isDocumentKey(t))throw new D(A.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function $R(t){if($.isDocumentKey(t))throw new D(A.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Rg(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":W()}function ve(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new D(A.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Rg(t);throw new D(A.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function sL(t,e){if(e<=0)throw new D(A.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BR{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new D(A.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new D(A.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}iL("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=rL((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new D(A.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new D(A.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new D(A.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class _d{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new BR({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new D(A.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new D(A.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new BR(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new SW;switch(r.type){case"firstParty":return new PW(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new D(A.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=FR.get(n);r&&(O("ComponentProvider","Removing Datastore"),FR.delete(n),r.terminate())}(this),Promise.resolve()}}function RG(t,e,n,r={}){var i;const s=(t=ve(t,_d))._getSettings(),o=`${e}:${n}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&Lr("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let a,l;if(typeof r.mockUserToken=="string")a=r.mockUserToken,l=bt.MOCK_USER;else{a=f0(r.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);const u=r.mockUserToken.sub||r.mockUserToken.user_id;if(!u)throw new D(A.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new bt(u)}t._authCredentials=new CW(new mD(a,l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let _n=class oL{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new oL(this.firestore,e,this._query)}},Xe=class aL{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ss(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new aL(this.firestore,e,this._key)}},Ss=class lL extends _n{constructor(e,n,r){super(e,n,cu(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Xe(this.firestore,null,new $(e))}withConverter(e){return new lL(this.firestore,e,this._path)}};function uL(t,e,...n){if(t=j(t),GI("collection","path",e),t instanceof _d){const r=ge.fromString(e,...n);return $R(r),new Ss(t,null,r)}{if(!(t instanceof Xe||t instanceof Ss))throw new D(A.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(ge.fromString(e,...n));return $R(r),new Ss(t.firestore,null,r)}}function AG(t,e){if(t=ve(t,_d),GI("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new D(A.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new _n(t,null,function(r){return new qi(ge.emptyPath(),r)}(e))}function Jp(t,e,...n){if(t=j(t),arguments.length===1&&(e=gD.V()),GI("doc","path",e),t instanceof _d){const r=ge.fromString(e,...n);return UR(r),new Xe(t,null,new $(r))}{if(!(t instanceof Xe||t instanceof Ss))throw new D(A.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(ge.fromString(e,...n));return UR(r),new Xe(t.firestore,t instanceof Ss?t.converter:null,new $(r))}}function cL(t,e){return t=j(t),e=j(e),(t instanceof Xe||t instanceof Ss)&&(e instanceof Xe||e instanceof Ss)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function hL(t,e){return t=j(t),e=j(e),t instanceof _n&&e instanceof _n&&t.firestore===e.firestore&&cd(t._query,e._query)&&t.converter===e.converter}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PG{constructor(){this.za=Promise.resolve(),this.ja=[],this.Ha=!1,this.Ja=[],this.Ya=null,this.Za=!1,this.Xa=!1,this.eu=[],this.Uo=new PI(this,"async_queue_retry"),this.tu=()=>{const n=Kf();n&&O("AsyncQueue","Visibility state changed to "+n.visibilityState),this.Uo.Lo()};const e=Kf();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.tu)}get isShuttingDown(){return this.Ha}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.nu(),this.ru(e)}enterRestrictedMode(e){if(!this.Ha){this.Ha=!0,this.Xa=e||!1;const n=Kf();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.tu)}}enqueue(e){if(this.nu(),this.Ha)return new Promise(()=>{});const n=new Dt;return this.ru(()=>this.Ha&&this.Xa?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.ja.push(e),this.iu()))}async iu(){if(this.ja.length!==0){try{await this.ja[0](),this.ja.shift(),this.Uo.reset()}catch(e){if(!to(e))throw e;O("AsyncQueue","Operation failed with retryable error: "+e)}this.ja.length>0&&this.Uo.No(()=>this.iu())}}ru(e){const n=this.za.then(()=>(this.Za=!0,e().catch(r=>{this.Ya=r,this.Za=!1;const i=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw lt("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.Za=!1,r))));return this.za=n,n}enqueueAfterDelay(e,n,r){this.nu(),this.eu.indexOf(e)>-1&&(n=0);const i=NI.createAndSchedule(this,e,n,r,s=>this.su(s));return this.Ja.push(i),i}nu(){this.Ya&&W()}verifyOperationInProgress(){}async ou(){let e;do e=this.za,await e;while(e!==this.za)}_u(e){for(const n of this.Ja)if(n.timerId===e)return!0;return!1}au(e){return this.ou().then(()=>{this.Ja.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Ja)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.ou()})}uu(e){this.eu.push(e)}su(e){const n=this.Ja.indexOf(e);this.Ja.splice(n,1)}}function Nw(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const i=n;for(const s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(t,["next","error","complete"])}class bG{constructor(){this._progressObserver={},this._taskCompletionResolver=new Dt,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,n,r){this._progressObserver={next:e,error:n,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,n){return this._taskCompletionResolver.promise.then(e,n)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kG=-1;let ot=class extends _d{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=function(){return new PG}(),this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||dL(this),this._firestoreClient.terminate()}};function Ft(t){return t._firestoreClient||dL(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function dL(t){var e,n,r;const i=t._freezeSettings(),s=function(a,l,u,c){return new i8(a,l,u,c.host,c.ssl,c.experimentalForceLongPolling,c.experimentalAutoDetectLongPolling,rL(c.experimentalLongPollingOptions),c.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._firestoreClient=new _G(t._authCredentials,t._appCheckCredentials,t._queue,s),!((n=i.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}function xG(t,e){pL(t=ve(t,ot));const n=Ft(t);if(n._uninitializedComponentsProvider)throw new D(A.FAILED_PRECONDITION,"SDK cache is already specified.");Lr("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const r=t._freezeSettings(),i=new jI;return fL(n,i,new XO(i,r.cacheSizeBytes,e==null?void 0:e.forceOwnership))}function NG(t){pL(t=ve(t,ot));const e=Ft(t);if(e._uninitializedComponentsProvider)throw new D(A.FAILED_PRECONDITION,"SDK cache is already specified.");Lr("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=t._freezeSettings(),r=new jI;return fL(e,r,new fG(r,n.cacheSizeBytes))}function fL(t,e,n){const r=new Dt;return t.asyncQueue.enqueue(async()=>{try{await Qf(t,n),await xw(t,e),r.resolve()}catch(i){const s=i;if(!JO(s))throw s;Lr("Error enabling indexeddb cache. Falling back to memory cache: "+s),r.reject(s)}}).then(()=>r.promise)}function DG(t){if(t._initialized&&!t._terminated)throw new D(A.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new Dt;return t._queue.enqueueAndForgetEvenWhileRestricted(async()=>{try{await async function(r){if(!Rr.v())return Promise.resolve();const i=r+"main";await Rr.delete(i)}(CI(t._databaseId,t._persistenceKey)),e.resolve()}catch(n){e.reject(n)}}),e.promise}function OG(t){return function(n){const r=new Dt;return n.asyncQueue.enqueueAndForget(async()=>tG(await HI(n),r)),r.promise}(Ft(t=ve(t,ot)))}function LG(t){return vG(Ft(t=ve(t,ot)))}function MG(t){return wG(Ft(t=ve(t,ot)))}function VG(t,e){const n=Ft(t=ve(t,ot)),r=new bG;return SG(n,t._databaseId,e,r),r}function FG(t,e){return CG(Ft(t=ve(t,ot)),e).then(n=>n?new _n(t,null,n.query):null)}function pL(t){if(t._initialized||t._terminated)throw new D(A.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ai{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ai(Tt.fromBase64String(e))}catch(n){throw new D(A.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new ai(Tt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let $s=class{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new D(A.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ut(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ga=class{constructor(e){this._methodName=e}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ag{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new D(A.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new D(A.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return se(this._lat,e._lat)||se(this._long,e._long)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UG=/^__.*__$/;class $G{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new Wi(e,this.data,this.fieldMask,n,this.fieldTransforms):new hu(e,this.data,n,this.fieldTransforms)}}class mL{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new Wi(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function gL(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw W()}}class Pg{constructor(e,n,r,i,s,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.cu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get lu(){return this.settings.lu}hu(e){return new Pg(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Pu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.hu({path:r,Iu:!1});return i.Tu(e),i}Eu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.hu({path:r,Iu:!1});return i.cu(),i}du(e){return this.hu({path:void 0,Iu:!0})}Au(e){return Zp(e,this.settings.methodName,this.settings.Ru||!1,this.path,this.settings.Vu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}cu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Tu(this.path.get(e))}Tu(e){if(e.length===0)throw this.Au("Document fields must not be empty");if(gL(this.lu)&&UG.test(e))throw this.Au('Document fields cannot begin and end with "__"')}}class BG{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||md(e)}mu(e,n,r,i=!1){return new Pg({lu:e,methodName:n,Vu:r,path:ut.emptyPath(),Iu:!1,Ru:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function _a(t){const e=t._freezeSettings(),n=md(t._databaseId);return new BG(t._databaseId,!!e.ignoreUndefinedProperties,n)}function bg(t,e,n,r,i,s={}){const o=t.mu(s.merge||s.mergeFields?2:0,e,n,i);XI("Data must be an object, but it was:",o,r);const a=vL(r,o);let l,u;if(s.merge)l=new kn(o.fieldMask),u=o.fieldTransforms;else if(s.mergeFields){const c=[];for(const h of s.mergeFields){const f=Dw(e,h,n);if(!o.contains(f))throw new D(A.INVALID_ARGUMENT,`Field '${f}' is specified in your field mask but missing from your input data.`);EL(c,f)||c.push(f)}l=new kn(c),u=o.fieldTransforms.filter(h=>l.covers(h.field))}else l=null,u=o.fieldTransforms;return new $G(new jt(a),l,u)}class yd extends ga{_toFieldTransform(e){if(e.lu!==2)throw e.lu===1?e.Au(`${this._methodName}() can only appear at the top level of your update data`):e.Au(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof yd}}function _L(t,e,n){return new Pg({lu:3,Vu:e.settings.Vu,methodName:t._methodName,Iu:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class KI extends ga{_toFieldTransform(e){return new dd(e.path,new Ll)}isEqual(e){return e instanceof KI}}class zG extends ga{constructor(e,n){super(e),this.fu=n}_toFieldTransform(e){const n=_L(this,e,!0),r=this.fu.map(s=>ya(s,n)),i=new ea(r);return new dd(e.path,i)}isEqual(e){return this===e}}class jG extends ga{constructor(e,n){super(e),this.fu=n}_toFieldTransform(e){const n=_L(this,e,!0),r=this.fu.map(s=>ya(s,n)),i=new ta(r);return new dd(e.path,i)}isEqual(e){return this===e}}class qG extends ga{constructor(e,n){super(e),this.gu=n}_toFieldTransform(e){const n=new Ml(e.serializer,KD(e.serializer,this.gu));return new dd(e.path,n)}isEqual(e){return this===e}}function QI(t,e,n,r){const i=t.mu(1,e,n);XI("Data must be an object, but it was:",i,r);const s=[],o=jt.empty();ma(r,(l,u)=>{const c=JI(e,l,n);u=j(u);const h=i.Eu(c);if(u instanceof yd)s.push(c);else{const f=ya(u,h);f!=null&&(s.push(c),o.set(c,f))}});const a=new kn(s);return new mL(o,a,i.fieldTransforms)}function YI(t,e,n,r,i,s){const o=t.mu(1,e,n),a=[Dw(e,r,n)],l=[i];if(s.length%2!=0)throw new D(A.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let f=0;f<s.length;f+=2)a.push(Dw(e,s[f])),l.push(s[f+1]);const u=[],c=jt.empty();for(let f=a.length-1;f>=0;--f)if(!EL(u,a[f])){const g=a[f];let _=l[f];_=j(_);const w=o.Eu(g);if(_ instanceof yd)u.push(g);else{const T=ya(_,w);T!=null&&(u.push(g),c.set(g,T))}}const h=new kn(u);return new mL(c,h,o.fieldTransforms)}function yL(t,e,n,r=!1){return ya(n,t.mu(r?4:3,e))}function ya(t,e){if(wL(t=j(t)))return XI("Unsupported field value:",e,t),vL(t,e);if(t instanceof ga)return function(r,i){if(!gL(i.lu))throw i.Au(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Au(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.Iu&&e.lu!==4)throw e.Au("Nested arrays are not supported");return function(r,i){const s=[];let o=0;for(const a of r){let l=ya(a,i.du(o));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),o++}return{arrayValue:{values:s}}}(t,e)}return function(r,i){if((r=j(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return KD(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=He.fromDate(r);return{timestampValue:Vl(i.serializer,s)}}if(r instanceof He){const s=new He(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Vl(i.serializer,s)}}if(r instanceof Ag)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof ai)return{bytesValue:oO(i.serializer,r._byteString)};if(r instanceof Xe){const s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Au(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:vI(r.firestore._databaseId||i.databaseId,r._key.path)}}throw i.Au(`Unsupported field value: ${Rg(r)}`)}(t,e)}function vL(t,e){const n={};return PD(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ma(t,(r,i)=>{const s=ya(i,e.Pu(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function wL(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof He||t instanceof Ag||t instanceof ai||t instanceof Xe||t instanceof ga)}function XI(t,e,n){if(!wL(n)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(n)){const r=Rg(n);throw r==="an object"?e.Au(t+" a custom object"):e.Au(t+" "+r)}}function Dw(t,e,n){if((e=j(e))instanceof $s)return e._internalPath;if(typeof e=="string")return JI(t,e);throw Zp("Field path arguments must be of type string or ",t,!1,void 0,n)}const WG=new RegExp("[~\\*/\\[\\]]");function JI(t,e,n){if(e.search(WG)>=0)throw Zp(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new $s(...e.split("."))._internalPath}catch{throw Zp(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Zp(t,e,n,r,i){const s=r&&!r.isEmpty(),o=i!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${r}`),o&&(l+=` in document ${i}`),l+=")"),new D(A.INVALID_ARGUMENT,a+t+l)}function EL(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ah{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Xe(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new HG(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(kg("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class HG extends Ah{data(){return super.data()}}function kg(t,e){return typeof e=="string"?JI(t,e):e instanceof $s?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IL(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new D(A.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class ZI{}let vd=class extends ZI{};function Zi(t,e,...n){let r=[];e instanceof ZI&&r.push(e),r=r.concat(n),function(s){const o=s.filter(l=>l instanceof eT).length,a=s.filter(l=>l instanceof xg).length;if(o>1||o>0&&a>0)throw new D(A.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)t=i._apply(t);return t}class xg extends vd{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new xg(e,n,r)}_apply(e){const n=this._parse(e);return PL(e._query,n),new _n(e.firestore,e.converter,vw(e._query,n))}_parse(e){const n=_a(e.firestore);return function(s,o,a,l,u,c,h){let f;if(u.isKeyField()){if(c==="array-contains"||c==="array-contains-any")throw new D(A.INVALID_ARGUMENT,`Invalid Query. You can't perform '${c}' queries on documentId().`);if(c==="in"||c==="not-in"){jR(h,c);const g=[];for(const _ of h)g.push(zR(l,s,_));f={arrayValue:{values:g}}}else f=zR(l,s,h)}else c!=="in"&&c!=="not-in"&&c!=="array-contains-any"||jR(h,c),f=yL(a,o,h,c==="in"||c==="not-in");return de.create(u,c,f)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function GG(t,e,n){const r=e,i=kg("where",t);return xg._create(i,r,n)}class eT extends ZI{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new eT(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:Re.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(i,s){let o=i;const a=s.getFlattenedFilters();for(const l of a)PL(o,l),o=vw(o,l)}(e._query,n),new _n(e.firestore,e.converter,vw(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class tT extends vd{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new tT(e,n)}_apply(e){const n=function(i,s,o){if(i.startAt!==null)throw new D(A.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new D(A.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const a=new cl(s,o);return function(u,c){if(hI(u)===null){const h=_g(u);h!==null&&bL(u,h,c.field)}}(i,a),a}(e._query,this._field,this._direction);return new _n(e.firestore,e.converter,function(i,s){const o=i.explicitOrderBy.concat([s]);return new qi(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,n))}}function KG(t,e="asc"){const n=e,r=kg("orderBy",t);return tT._create(r,n)}class Ng extends vd{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new Ng(e,n,r)}_apply(e){return new _n(e.firestore,e.converter,qp(e._query,this._limit,this._limitType))}}function QG(t){return sL("limit",t),Ng._create("limit",t,"F")}function YG(t){return sL("limitToLast",t),Ng._create("limitToLast",t,"L")}let TL=class SL extends vd{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new SL(e,n,r)}_apply(e){const n=AL(e,this.type,this._docOrFields,this._inclusive);return new _n(e.firestore,e.converter,function(i,s){return new qi(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,s,i.endAt)}(e._query,n))}};function XG(...t){return TL._create("startAt",t,!0)}function JG(...t){return TL._create("startAfter",t,!1)}let CL=class RL extends vd{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new RL(e,n,r)}_apply(e){const n=AL(e,this.type,this._docOrFields,this._inclusive);return new _n(e.firestore,e.converter,function(i,s){return new qi(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,s)}(e._query,n))}};function ZG(...t){return CL._create("endBefore",t,!1)}function eK(...t){return CL._create("endAt",t,!0)}function AL(t,e,n,r){if(n[0]=j(n[0]),n[0]instanceof Ah)return function(s,o,a,l,u){if(!l)throw new D(A.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);const c=[];for(const h of hl(s))if(h.field.isKeyField())c.push(Jo(o,l.key));else{const f=l.data.field(h.field);if(gg(f))throw new D(A.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+h.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(f===null){const g=h.field.canonicalString();throw new D(A.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${g}' (used as the orderBy) does not exist.`)}c.push(f)}return new Fs(c,u)}(t._query,t.firestore._databaseId,e,n[0]._document,r);{const i=_a(t.firestore);return function(o,a,l,u,c,h){const f=o.explicitOrderBy;if(c.length>f.length)throw new D(A.INVALID_ARGUMENT,`Too many arguments provided to ${u}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const g=[];for(let _=0;_<c.length;_++){const w=c[_];if(f[_].field.isKeyField()){if(typeof w!="string")throw new D(A.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${u}(), but got a ${typeof w}`);if(!dI(o)&&w.indexOf("/")!==-1)throw new D(A.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${u}() must be a plain document ID, but '${w}' contains a slash.`);const T=o.path.child(ge.fromString(w));if(!$.isDocumentKey(T))throw new D(A.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${u}() must result in a valid document path, but '${T}' is not because it contains an odd number of segments.`);const v=new $(T);g.push(Jo(a,v))}else{const T=yL(l,u,w);g.push(T)}}return new Fs(g,h)}(t._query,t.firestore._databaseId,i,e,n,r)}}function zR(t,e,n){if(typeof(n=j(n))=="string"){if(n==="")throw new D(A.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!dI(e)&&n.indexOf("/")!==-1)throw new D(A.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(ge.fromString(n));if(!$.isDocumentKey(r))throw new D(A.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Jo(t,new $(r))}if(n instanceof Xe)return Jo(t,n._key);throw new D(A.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Rg(n)}.`)}function jR(t,e){if(!Array.isArray(t)||t.length===0)throw new D(A.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function PL(t,e){if(e.isInequality()){const r=_g(t),i=e.field;if(r!==null&&!r.isEqual(i))throw new D(A.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${r.toString()}' and '${i.toString()}'`);const s=hI(t);s!==null&&bL(t,i,s)}const n=function(i,s){for(const o of i)for(const a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new D(A.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new D(A.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}function bL(t,e,n){if(!n.isEqual(e))throw new D(A.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${e.toString()}' and so you must also use '${e.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${n.toString()}' instead.`)}class nT{convertValue(e,n="none"){switch(Xo(e)){case 0:return null;case 1:return e.booleanValue;case 2:return rt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Ls(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 10:return this.convertObject(e.mapValue,n);default:throw W()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return ma(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertGeoPoint(e){return new Ag(rt(e.latitude),rt(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=uI(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(wh(e));default:return null}}convertTimestamp(e){const n=Os(e);return new He(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=ge.fromString(e);Y(gO(r));const i=new Ms(r.get(1),r.get(3)),s=new $(r.popFirst(5));return i.isEqual(n)||lt(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dg(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}class tK extends nT{constructor(e){super(),this.firestore=e}convertBytes(e){return new ai(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Xe(this.firestore,null,n)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Po{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}let Ui=class extends Ah{constructor(e,n,r,i,s,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new bc(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(kg("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}},bc=class extends Ui{data(e={}){return super.data(e)}},Bs=class{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new Po(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new bc(this._firestore,this._userDataWriter,r.key,r,new Po(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new D(A.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{const l=new bc(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Po(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{const l=new bc(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Po(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);let u=-1,c=-1;return a.type!==0&&(u=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),c=o.indexOf(a.doc.key)),{type:nK(a.type),doc:l,oldIndex:u,newIndex:c}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}};function nK(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return W()}}function kL(t,e){return t instanceof Ui&&e instanceof Ui?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(t._document===null?e._document===null:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof Bs&&e instanceof Bs&&t._firestore===e._firestore&&hL(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rK(t){t=ve(t,Xe);const e=ve(t.firestore,ot);return tL(Ft(e),t._key).then(n=>rT(e,t,n))}class va extends nT{constructor(e){super(),this.firestore=e}convertBytes(e){return new ai(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Xe(this.firestore,null,n)}}function iK(t){t=ve(t,Xe);const e=ve(t.firestore,ot),n=Ft(e),r=new va(e);return EG(n,t._key).then(i=>new Ui(e,r,t._key,i,new Po(i!==null&&i.hasLocalMutations,!0),t.converter))}function sK(t){t=ve(t,Xe);const e=ve(t.firestore,ot);return tL(Ft(e),t._key,{source:"server"}).then(n=>rT(e,t,n))}function oK(t){t=ve(t,_n);const e=ve(t.firestore,ot),n=Ft(e),r=new va(e);return IL(t._query),nL(n,t._query).then(i=>new Bs(e,r,t,i))}function aK(t){t=ve(t,_n);const e=ve(t.firestore,ot),n=Ft(e),r=new va(e);return IG(n,t._query).then(i=>new Bs(e,r,t,i))}function lK(t){t=ve(t,_n);const e=ve(t.firestore,ot),n=Ft(e),r=new va(e);return nL(n,t._query,{source:"server"}).then(i=>new Bs(e,r,t,i))}function qR(t,e,n){t=ve(t,Xe);const r=ve(t.firestore,ot),i=Dg(t.converter,e,n);return wd(r,[bg(_a(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,qe.none())])}function WR(t,e,n,...r){t=ve(t,Xe);const i=ve(t.firestore,ot),s=_a(i);let o;return o=typeof(e=j(e))=="string"||e instanceof $s?YI(s,"updateDoc",t._key,e,n,r):QI(s,"updateDoc",t._key,e),wd(i,[o.toMutation(t._key,qe.exists(!0))])}function uK(t){return wd(ve(t.firestore,ot),[new du(t._key,qe.none())])}function cK(t,e){const n=ve(t.firestore,ot),r=Jp(t),i=Dg(t.converter,e);return wd(n,[bg(_a(t.firestore),"addDoc",r._key,i,t.converter!==null,{}).toMutation(r._key,qe.exists(!1))]).then(()=>r)}function xL(t,...e){var n,r,i;t=j(t);let s={includeMetadataChanges:!1},o=0;typeof e[o]!="object"||Nw(e[o])||(s=e[o],o++);const a={includeMetadataChanges:s.includeMetadataChanges};if(Nw(e[o])){const h=e[o];e[o]=(n=h.next)===null||n===void 0?void 0:n.bind(h),e[o+1]=(r=h.error)===null||r===void 0?void 0:r.bind(h),e[o+2]=(i=h.complete)===null||i===void 0?void 0:i.bind(h)}let l,u,c;if(t instanceof Xe)u=ve(t.firestore,ot),c=cu(t._key.path),l={next:h=>{e[o]&&e[o](rT(u,t,h))},error:e[o+1],complete:e[o+2]};else{const h=ve(t,_n);u=ve(h.firestore,ot),c=h._query;const f=new va(u);l={next:g=>{e[o]&&e[o](new Bs(u,f,h,g))},error:e[o+1],complete:e[o+2]},IL(t._query)}return function(f,g,_,w){const T=new Sg(w),v=new MI(g,T,_);return f.asyncQueue.enqueueAndForget(async()=>DI(await zl(f),v)),()=>{T.Ma(),f.asyncQueue.enqueueAndForget(async()=>OI(await zl(f),v))}}(Ft(u),c,a,l)}function hK(t,e){return TG(Ft(t=ve(t,ot)),Nw(e)?e:{next:e})}function wd(t,e){return function(r,i){const s=new Dt;return r.asyncQueue.enqueueAndForget(async()=>XH(await HI(r),i,s)),s.promise}(Ft(t),e)}function rT(t,e,n){const r=n.docs.get(e._key),i=new va(t);return new Ui(t,i,e._key,r,new Po(n.hasPendingWrites,n.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dK={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let fK=class{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=_a(e)}set(e,n,r){this._verifyNotCommitted();const i=os(e,this._firestore),s=Dg(i.converter,n,r),o=bg(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,r);return this._mutations.push(o.toMutation(i._key,qe.none())),this}update(e,n,r,...i){this._verifyNotCommitted();const s=os(e,this._firestore);let o;return o=typeof(n=j(n))=="string"||n instanceof $s?YI(this._dataReader,"WriteBatch.update",s._key,n,r,i):QI(this._dataReader,"WriteBatch.update",s._key,n),this._mutations.push(o.toMutation(s._key,qe.exists(!0))),this}delete(e){this._verifyNotCommitted();const n=os(e,this._firestore);return this._mutations=this._mutations.concat(new du(n._key,qe.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new D(A.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function os(t,e){if((t=j(t)).firestore!==e)throw new D(A.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let pK=class extends class{constructor(n,r){this._firestore=n,this._transaction=r,this._dataReader=_a(n)}get(n){const r=os(n,this._firestore),i=new tK(this._firestore);return this._transaction.lookup([r._key]).then(s=>{if(!s||s.length!==1)return W();const o=s[0];if(o.isFoundDocument())return new Ah(this._firestore,i,o.key,o,r.converter);if(o.isNoDocument())return new Ah(this._firestore,i,r._key,null,r.converter);throw W()})}set(n,r,i){const s=os(n,this._firestore),o=Dg(s.converter,r,i),a=bg(this._dataReader,"Transaction.set",s._key,o,s.converter!==null,i);return this._transaction.set(s._key,a),this}update(n,r,i,...s){const o=os(n,this._firestore);let a;return a=typeof(r=j(r))=="string"||r instanceof $s?YI(this._dataReader,"Transaction.update",o._key,r,i,s):QI(this._dataReader,"Transaction.update",o._key,r),this._transaction.update(o._key,a),this}delete(n){const r=os(n,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,n){super(e,n),this._firestore=e}get(e){const n=os(e,this._firestore),r=new va(this._firestore);return super.get(e).then(i=>new Ui(this._firestore,r,n._key,i._document,new Po(!1,!1),n.converter))}};function mK(t,e,n){t=ve(t,ot);const r=Object.assign(Object.assign({},dK),n);return function(s){if(s.maxAttempts<1)throw new D(A.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(s,o,a){const l=new Dt;return s.asyncQueue.enqueueAndForget(async()=>{const u=await yG(s);new gG(s.asyncQueue,u,a,o,l).run()}),l.promise}(Ft(t),i=>e(new pK(t,i)),r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gK(){return new yd("deleteField")}function _K(){return new KI("serverTimestamp")}function yK(...t){return new zG("arrayUnion",t)}function vK(...t){return new jG("arrayRemove",t)}function wK(t){return new qG("increment",t)}(function(e,n=!0){(function(i){uu=i})(hi),ii(new on("firestore",(r,{instanceIdentifier:i,options:s})=>{const o=r.getProvider("app").getImmediate(),a=new ot(new RW(r.getProvider("auth-internal")),new kW(r.getProvider("app-check-internal")),function(u,c){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new D(A.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ms(u.options.projectId,c)}(o,i),o);return s=Object.assign({useFetchStreams:n},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),Vn($C,"4.1.2",e),Vn($C,"4.1.2","esm2017")})();const EK="@firebase/firestore-compat",IK="0.3.16";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iT(t,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new D("invalid-argument",`Invalid options passed to function ${t}(): You cannot specify both "merge" and "mergeFields".`);return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HR(){if(typeof Uint8Array>"u")throw new D("unimplemented","Uint8Arrays are not available in this environment.")}function GR(){if(!n8())throw new D("unimplemented","Blobs are unavailable in Firestore in this environment.")}let NL=class Ow{constructor(e){this._delegate=e}static fromBase64String(e){return GR(),new Ow(ai.fromBase64String(e))}static fromUint8Array(e){return HR(),new Ow(ai.fromUint8Array(e))}toBase64(){return GR(),this._delegate.toBase64()}toUint8Array(){return HR(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lw(t){return TK(t,["next","error","complete"])}function TK(t,e){if(typeof t!="object"||t===null)return!1;const n=t;for(const r of e)if(r in n&&typeof n[r]=="function")return!0;return!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SK{enableIndexedDbPersistence(e,n){return xG(e._delegate,{forceOwnership:n})}enableMultiTabIndexedDbPersistence(e){return NG(e._delegate)}clearIndexedDbPersistence(e){return DG(e._delegate)}}class DL{constructor(e,n,r){this._delegate=n,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof Ms||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const n=this._delegate._getSettings();!e.merge&&n.host!==e.host&&Lr("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},n),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,n,r={}){RG(this._delegate,e,n,r)}enableNetwork(){return LG(this._delegate)}disableNetwork(){return MG(this._delegate)}enablePersistence(e){let n=!1,r=!1;return e&&(n=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,iL("synchronizeTabs",n,"experimentalForceOwningTab",r)),n?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return OG(this._delegate)}onSnapshotsInSync(e){return hK(this._delegate,e)}get app(){if(!this._appCompat)throw new D("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new jl(this,uL(this._delegate,e))}catch(n){throw hn(n,"collection()","Firestore.collection()")}}doc(e){try{return new ar(this,Jp(this._delegate,e))}catch(n){throw hn(n,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new kh(this,AG(this._delegate,e))}catch(n){throw hn(n,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return mK(this._delegate,n=>e(new OL(this,n)))}batch(){return Ft(this._delegate),new LL(new fK(this._delegate,e=>wd(this._delegate,e)))}loadBundle(e){return VG(this._delegate,e)}namedQuery(e){return FG(this._delegate,e).then(n=>n?new kh(this,n):null)}}class Og extends nT{constructor(e){super(),this.firestore=e}convertBytes(e){return new NL(new ai(e))}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return ar.forKey(n,this.firestore,null)}}function CK(t){IW(t)}class OL{constructor(e,n){this._firestore=e,this._delegate=n,this._userDataWriter=new Og(e)}get(e){const n=bo(e);return this._delegate.get(n).then(r=>new Ph(this._firestore,new Ui(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,n.converter)))}set(e,n,r){const i=bo(e);return r?(iT("Transaction.set",r),this._delegate.set(i,n,r)):this._delegate.set(i,n),this}update(e,n,r,...i){const s=bo(e);return arguments.length===2?this._delegate.update(s,n):this._delegate.update(s,n,r,...i),this}delete(e){const n=bo(e);return this._delegate.delete(n),this}}class LL{constructor(e){this._delegate=e}set(e,n,r){const i=bo(e);return r?(iT("WriteBatch.set",r),this._delegate.set(i,n,r)):this._delegate.set(i,n),this}update(e,n,r,...i){const s=bo(e);return arguments.length===2?this._delegate.update(s,n):this._delegate.update(s,n,r,...i),this}delete(e){const n=bo(e);return this._delegate.delete(n),this}commit(){return this._delegate.commit()}}class sa{constructor(e,n,r){this._firestore=e,this._userDataWriter=n,this._delegate=r}fromFirestore(e,n){const r=new bc(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new bh(this._firestore,r),n??{})}toFirestore(e,n){return n?this._delegate.toFirestore(e,n):this._delegate.toFirestore(e)}static getInstance(e,n){const r=sa.INSTANCES;let i=r.get(e);i||(i=new WeakMap,r.set(e,i));let s=i.get(n);return s||(s=new sa(e,new Og(e),n),i.set(n,s)),s}}sa.INSTANCES=new WeakMap;class ar{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new Og(e)}static forPath(e,n,r){if(e.length%2!==0)throw new D("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new ar(n,new Xe(n._delegate,r,new $(e)))}static forKey(e,n,r){return new ar(n,new Xe(n._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new jl(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new jl(this.firestore,uL(this._delegate,e))}catch(n){throw hn(n,"collection()","DocumentReference.collection()")}}isEqual(e){return e=j(e),e instanceof Xe?cL(this._delegate,e):!1}set(e,n){n=iT("DocumentReference.set",n);try{return n?qR(this._delegate,e,n):qR(this._delegate,e)}catch(r){throw hn(r,"setDoc()","DocumentReference.set()")}}update(e,n,...r){try{return arguments.length===1?WR(this._delegate,e):WR(this._delegate,e,n,...r)}catch(i){throw hn(i,"updateDoc()","DocumentReference.update()")}}delete(){return uK(this._delegate)}onSnapshot(...e){const n=ML(e),r=VL(e,i=>new Ph(this.firestore,new Ui(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return xL(this._delegate,n,r)}get(e){let n;return(e==null?void 0:e.source)==="cache"?n=iK(this._delegate):(e==null?void 0:e.source)==="server"?n=sK(this._delegate):n=rK(this._delegate),n.then(r=>new Ph(this.firestore,new Ui(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new ar(this.firestore,e?this._delegate.withConverter(sa.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function hn(t,e,n){return t.message=t.message.replace(e,n),t}function ML(t){for(const e of t)if(typeof e=="object"&&!Lw(e))return e;return{}}function VL(t,e){var n,r;let i;return Lw(t[0])?i=t[0]:Lw(t[1])?i=t[1]:typeof t[0]=="function"?i={next:t[0],error:t[1],complete:t[2]}:i={next:t[1],error:t[2],complete:t[3]},{next:s=>{i.next&&i.next(e(s))},error:(n=i.error)===null||n===void 0?void 0:n.bind(i),complete:(r=i.complete)===null||r===void 0?void 0:r.bind(i)}}class Ph{constructor(e,n){this._firestore=e,this._delegate=n}get ref(){return new ar(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,n){return this._delegate.get(e,n)}isEqual(e){return kL(this._delegate,e._delegate)}}class bh extends Ph{data(e){const n=this._delegate.data(e);return TW(n!==void 0),n}}let kh=class Fr{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new Og(e)}where(e,n,r){try{return new Fr(this.firestore,Zi(this._delegate,GG(e,n,r)))}catch(i){throw hn(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,n){try{return new Fr(this.firestore,Zi(this._delegate,KG(e,n)))}catch(r){throw hn(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new Fr(this.firestore,Zi(this._delegate,QG(e)))}catch(n){throw hn(n,"limit()","Query.limit()")}}limitToLast(e){try{return new Fr(this.firestore,Zi(this._delegate,YG(e)))}catch(n){throw hn(n,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new Fr(this.firestore,Zi(this._delegate,XG(...e)))}catch(n){throw hn(n,"startAt()","Query.startAt()")}}startAfter(...e){try{return new Fr(this.firestore,Zi(this._delegate,JG(...e)))}catch(n){throw hn(n,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new Fr(this.firestore,Zi(this._delegate,ZG(...e)))}catch(n){throw hn(n,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new Fr(this.firestore,Zi(this._delegate,eK(...e)))}catch(n){throw hn(n,"endAt()","Query.endAt()")}}isEqual(e){return hL(this._delegate,e._delegate)}get(e){let n;return(e==null?void 0:e.source)==="cache"?n=aK(this._delegate):(e==null?void 0:e.source)==="server"?n=lK(this._delegate):n=oK(this._delegate),n.then(r=>new Mw(this.firestore,new Bs(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){const n=ML(e),r=VL(e,i=>new Mw(this.firestore,new Bs(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return xL(this._delegate,n,r)}withConverter(e){return new Fr(this.firestore,e?this._delegate.withConverter(sa.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};class RK{constructor(e,n){this._firestore=e,this._delegate=n}get type(){return this._delegate.type}get doc(){return new bh(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class Mw{constructor(e,n){this._firestore=e,this._delegate=n}get query(){return new kh(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new bh(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(n=>new RK(this._firestore,n))}forEach(e,n){this._delegate.forEach(r=>{e.call(n,new bh(this._firestore,r))})}isEqual(e){return kL(this._delegate,e._delegate)}}class jl extends kh{constructor(e,n){super(e,n),this.firestore=e,this._delegate=n}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new ar(this.firestore,e):null}doc(e){try{return e===void 0?new ar(this.firestore,Jp(this._delegate)):new ar(this.firestore,Jp(this._delegate,e))}catch(n){throw hn(n,"doc()","CollectionReference.doc()")}}add(e){return cK(this._delegate,e).then(n=>new ar(this.firestore,n))}isEqual(e){return cL(this._delegate,e._delegate)}withConverter(e){return new jl(this.firestore,e?this._delegate.withConverter(sa.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function bo(t){return ve(t,Xe)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sT{constructor(...e){this._delegate=new $s(...e)}static documentId(){return new sT(ut.keyField().canonicalString())}isEqual(e){return e=j(e),e instanceof $s?this._delegate._internalPath.isEqual(e._internalPath):!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wo{constructor(e){this._delegate=e}static serverTimestamp(){const e=_K();return e._methodName="FieldValue.serverTimestamp",new wo(e)}static delete(){const e=gK();return e._methodName="FieldValue.delete",new wo(e)}static arrayUnion(...e){const n=yK(...e);return n._methodName="FieldValue.arrayUnion",new wo(n)}static arrayRemove(...e){const n=vK(...e);return n._methodName="FieldValue.arrayRemove",new wo(n)}static increment(e){const n=wK(e);return n._methodName="FieldValue.increment",new wo(n)}isEqual(e){return this._delegate.isEqual(e._delegate)}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AK={Firestore:DL,GeoPoint:Ag,Timestamp:He,Blob:NL,Transaction:OL,WriteBatch:LL,DocumentReference:ar,DocumentSnapshot:Ph,Query:kh,QueryDocumentSnapshot:bh,QuerySnapshot:Mw,CollectionReference:jl,FieldPath:sT,FieldValue:wo,setLogLevel:CK,CACHE_SIZE_UNLIMITED:kG};function PK(t,e){t.INTERNAL.registerComponent(new on("firestore-compat",n=>{const r=n.getProvider("app-compat").getImmediate(),i=n.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},AK)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bK(t){PK(t,(e,n)=>new DL(e,n,new SK)),t.registerVersion(EK,IK)}bK(di);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FL="firebasestorage.googleapis.com",UL="storageBucket",kK=2*60*1e3,xK=10*60*1e3,NK=1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tt extends en{constructor(e,n,r=0){super(Ry(e),`Firebase Storage: ${n} (${Ry(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,tt.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Ry(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var ze;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(ze||(ze={}));function Ry(t){return"storage/"+t}function oT(){const t="An unknown error occurred, please check the error payload for server response.";return new tt(ze.UNKNOWN,t)}function DK(t){return new tt(ze.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function OK(t){return new tt(ze.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function LK(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new tt(ze.UNAUTHENTICATED,t)}function MK(){return new tt(ze.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function VK(t){return new tt(ze.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function $L(){return new tt(ze.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function BL(){return new tt(ze.CANCELED,"User canceled the upload/download.")}function FK(t){return new tt(ze.INVALID_URL,"Invalid URL '"+t+"'.")}function UK(t){return new tt(ze.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function $K(){return new tt(ze.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+UL+"' property when initializing the app?")}function zL(){return new tt(ze.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function BK(){return new tt(ze.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.")}function zK(){return new tt(ze.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function jK(t){return new tt(ze.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function fl(t){return new tt(ze.INVALID_ARGUMENT,t)}function jL(){return new tt(ze.APP_DELETED,"The Firebase app was deleted.")}function qL(t){return new tt(ze.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function kc(t,e){return new tt(ze.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function Hu(t){throw new tt(ze.INTERNAL_ERROR,"Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zt{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=Zt.makeFromUrl(e,n)}catch{return new Zt(e,"")}if(r.path==="")return r;throw UK(e)}static makeFromUrl(e,n){let r=null;const i="([A-Za-z0-9.\\-_]+)";function s(C){C.path.charAt(C.path.length-1)==="/"&&(C.path_=C.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+i+o,"i"),l={bucket:1,path:3};function u(C){C.path_=decodeURIComponent(C.path)}const c="v[A-Za-z0-9_]+",h=n.replace(/[.]/g,"\\."),f="(/([^?#]*).*)?$",g=new RegExp(`^https?://${h}/${c}/b/${i}/o${f}`,"i"),_={bucket:1,path:3},w=n===FL?"(?:storage.googleapis.com|storage.cloud.google.com)":n,T="([^?#]*)",v=new RegExp(`^https?://${w}/${i}/${T}`,"i"),I=[{regex:a,indices:l,postModify:s},{regex:g,indices:_,postModify:u},{regex:v,indices:{bucket:1,path:2},postModify:u}];for(let C=0;C<I.length;C++){const P=I[C],b=P.regex.exec(e);if(b){const k=b[P.indices.bucket];let F=b[P.indices.path];F||(F=""),r=new Zt(k,F),P.postModify(r);break}}if(r==null)throw FK(e);return r}}class qK{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WK(t,e,n){let r=1,i=null,s=null,o=!1,a=0;function l(){return a===2}let u=!1;function c(...T){u||(u=!0,e.apply(null,T))}function h(T){i=setTimeout(()=>{i=null,t(g,l())},T)}function f(){s&&clearTimeout(s)}function g(T,...v){if(u){f();return}if(T){f(),c.call(null,T,...v);return}if(l()||o){f(),c.call(null,T,...v);return}r<64&&(r*=2);let I;a===1?(a=2,I=0):I=(r+Math.random())*1e3,h(I)}let _=!1;function w(T){_||(_=!0,f(),!u&&(i!==null?(T||(a=2),clearTimeout(i),h(0)):T||(a=1)))}return h(0),s=setTimeout(()=>{o=!0,w(!0)},n),w}function HK(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GK(t){return t!==void 0}function KK(t){return typeof t=="function"}function QK(t){return typeof t=="object"&&!Array.isArray(t)}function Lg(t){return typeof t=="string"||t instanceof String}function KR(t){return aT()&&t instanceof Blob}function aT(){return typeof Blob<"u"&&!$m()}function Vw(t,e,n,r){if(r<e)throw fl(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw fl(`Invalid value for '${t}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function io(t,e,n){let r=e;return n==null&&(r=`https://${e}`),`${n}://${r}/v0${t}`}function WL(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const i=e(r)+"="+e(t[r]);n=n+i+"&"}return n=n.slice(0,-1),n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Uo;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(Uo||(Uo={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HL(t,e){const n=t>=500&&t<600,i=[408,429].indexOf(t)!==-1,s=e.indexOf(t)!==-1;return n||i||s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YK{constructor(e,n,r,i,s,o,a,l,u,c,h,f=!0){this.url_=e,this.method_=n,this.headers_=r,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=l,this.timeout_=u,this.progressCallback_=c,this.connectionFactory_=h,this.retry=f,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((g,_)=>{this.resolve_=g,this.reject_=_,this.start_()})}start_(){const e=(r,i)=>{if(i){r(!1,new ff(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const o=a=>{const l=a.loaded,u=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,u)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;const a=s.getErrorCode()===Uo.NO_ERROR,l=s.getStatus();if(!a||HL(l,this.additionalRetryCodes_)&&this.retry){const c=s.getErrorCode()===Uo.ABORT;r(!1,new ff(!1,null,c));return}const u=this.successCodes_.indexOf(l)!==-1;r(!0,new ff(u,s))})},n=(r,i)=>{const s=this.resolve_,o=this.reject_,a=i.connection;if(i.wasSuccessCode)try{const l=this.callback_(a,a.getResponse());GK(l)?s(l):s()}catch(l){o(l)}else if(a!==null){const l=oT();l.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,l)):o(l)}else if(i.canceled){const l=this.appDelete_?jL():BL();o(l)}else{const l=$L();o(l)}};this.canceled_?n(!1,new ff(!1,null,!0)):this.backoffId_=WK(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&HK(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class ff{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function XK(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function JK(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function ZK(t,e){e&&(t["X-Firebase-GMPID"]=e)}function e7(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function t7(t,e,n,r,i,s,o=!0){const a=WL(t.urlParams),l=t.url+a,u=Object.assign({},t.headers);return ZK(u,e),XK(u,n),JK(u,s),e7(u,r),new YK(l,t.method,u,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,i,o)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n7(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function r7(...t){const e=n7();if(e!==void 0){const n=new e;for(let r=0;r<t.length;r++)n.append(t[r]);return n.getBlob()}else{if(aT())return new Blob(t);throw new tt(ze.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function i7(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function s7(t){if(typeof atob>"u")throw jK("base-64");return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lr={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Ay{constructor(e,n){this.data=e,this.contentType=n||null}}function GL(t,e){switch(t){case lr.RAW:return new Ay(KL(e));case lr.BASE64:case lr.BASE64URL:return new Ay(QL(t,e));case lr.DATA_URL:return new Ay(a7(e),l7(e))}throw oT()}function KL(t){const e=[];for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const s=r,o=t.charCodeAt(++n);r=65536|(s&1023)<<10|o&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function o7(t){let e;try{e=decodeURIComponent(t)}catch{throw kc(lr.DATA_URL,"Malformed data URL.")}return KL(e)}function QL(t,e){switch(t){case lr.BASE64:{const i=e.indexOf("-")!==-1,s=e.indexOf("_")!==-1;if(i||s)throw kc(t,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case lr.BASE64URL:{const i=e.indexOf("+")!==-1,s=e.indexOf("/")!==-1;if(i||s)throw kc(t,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=s7(e)}catch(i){throw i.message.includes("polyfill")?i:kc(t,"Invalid character found")}const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}class YL{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw kc(lr.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=n[1]||null;r!=null&&(this.base64=u7(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function a7(t){const e=new YL(t);return e.base64?QL(lr.BASE64,e.rest):o7(e.rest)}function l7(t){return new YL(t).contentType}function u7(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wi{constructor(e,n){let r=0,i="";KR(e)?(this.data_=e,r=e.size,i=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=i}size(){return this.size_}type(){return this.type_}slice(e,n){if(KR(this.data_)){const r=this.data_,i=i7(r,e,n);return i===null?null:new wi(i)}else{const r=new Uint8Array(this.data_.buffer,e,n-e);return new wi(r,!0)}}static getBlob(...e){if(aT()){const n=e.map(r=>r instanceof wi?r.data_:r);return new wi(r7.apply(null,n))}else{const n=e.map(o=>Lg(o)?GL(lr.RAW,o).data:o.data_);let r=0;n.forEach(o=>{r+=o.byteLength});const i=new Uint8Array(r);let s=0;return n.forEach(o=>{for(let a=0;a<o.length;a++)i[s++]=o[a]}),new wi(i,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lT(t){let e;try{e=JSON.parse(t)}catch{return null}return QK(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c7(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function h7(t,e){const n=e.split("/").filter(r=>r.length>0).join("/");return t.length===0?n:t+"/"+n}function XL(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function d7(t,e){return e}class un{constructor(e,n,r,i){this.server=e,this.local=n||e,this.writable=!!r,this.xform=i||d7}}let pf=null;function f7(t){return!Lg(t)||t.length<2?t:XL(t)}function Mg(){if(pf)return pf;const t=[];t.push(new un("bucket")),t.push(new un("generation")),t.push(new un("metageneration")),t.push(new un("name","fullPath",!0));function e(s,o){return f7(o)}const n=new un("name");n.xform=e,t.push(n);function r(s,o){return o!==void 0?Number(o):o}const i=new un("size");return i.xform=r,t.push(i),t.push(new un("timeCreated")),t.push(new un("updated")),t.push(new un("md5Hash",null,!0)),t.push(new un("cacheControl",null,!0)),t.push(new un("contentDisposition",null,!0)),t.push(new un("contentEncoding",null,!0)),t.push(new un("contentLanguage",null,!0)),t.push(new un("contentType",null,!0)),t.push(new un("metadata","customMetadata",!0)),pf=t,pf}function p7(t,e){function n(){const r=t.bucket,i=t.fullPath,s=new Zt(r,i);return e._makeStorageReference(s)}Object.defineProperty(t,"ref",{get:n})}function m7(t,e,n){const r={};r.type="file";const i=n.length;for(let s=0;s<i;s++){const o=n[s];r[o.local]=o.xform(r,e[o.server])}return p7(r,t),r}function JL(t,e,n){const r=lT(e);return r===null?null:m7(t,r,n)}function g7(t,e,n,r){const i=lT(e);if(i===null||!Lg(i.downloadTokens))return null;const s=i.downloadTokens;if(s.length===0)return null;const o=encodeURIComponent;return s.split(",").map(u=>{const c=t.bucket,h=t.fullPath,f="/b/"+o(c)+"/o/"+o(h),g=io(f,n,r),_=WL({alt:"media",token:u});return g+_})[0]}function uT(t,e){const n={},r=e.length;for(let i=0;i<r;i++){const s=e[i];s.writable&&(n[s.server]=t[s.local])}return JSON.stringify(n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QR="prefixes",YR="items";function _7(t,e,n){const r={prefixes:[],items:[],nextPageToken:n.nextPageToken};if(n[QR])for(const i of n[QR]){const s=i.replace(/\/$/,""),o=t._makeStorageReference(new Zt(e,s));r.prefixes.push(o)}if(n[YR])for(const i of n[YR]){const s=t._makeStorageReference(new Zt(e,i.name));r.items.push(s)}return r}function y7(t,e,n){const r=lT(n);return r===null?null:_7(t,e,r)}class Gi{constructor(e,n,r,i){this.url=e,this.method=n,this.handler=r,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ni(t){if(!t)throw oT()}function Vg(t,e){function n(r,i){const s=JL(t,i,e);return ni(s!==null),s}return n}function v7(t,e){function n(r,i){const s=y7(t,e,i);return ni(s!==null),s}return n}function w7(t,e){function n(r,i){const s=JL(t,i,e);return ni(s!==null),g7(s,i,t.host,t._protocol)}return n}function _u(t){function e(n,r){let i;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?i=MK():i=LK():n.getStatus()===402?i=OK(t.bucket):n.getStatus()===403?i=VK(t.path):i=r,i.status=n.getStatus(),i.serverResponse=r.serverResponse,i}return e}function Fg(t){const e=_u(t);function n(r,i){let s=e(r,i);return r.getStatus()===404&&(s=DK(t.path)),s.serverResponse=i.serverResponse,s}return n}function ZL(t,e,n){const r=e.fullServerUrl(),i=io(r,t.host,t._protocol),s="GET",o=t.maxOperationRetryTime,a=new Gi(i,s,Vg(t,n),o);return a.errorHandler=Fg(e),a}function E7(t,e,n,r,i){const s={};e.isRoot?s.prefix="":s.prefix=e.path+"/",n&&n.length>0&&(s.delimiter=n),r&&(s.pageToken=r),i&&(s.maxResults=i);const o=e.bucketOnlyServerUrl(),a=io(o,t.host,t._protocol),l="GET",u=t.maxOperationRetryTime,c=new Gi(a,l,v7(t,e.bucket),u);return c.urlParams=s,c.errorHandler=_u(e),c}function I7(t,e,n){const r=e.fullServerUrl(),i=io(r,t.host,t._protocol),s="GET",o=t.maxOperationRetryTime,a=new Gi(i,s,w7(t,n),o);return a.errorHandler=Fg(e),a}function T7(t,e,n,r){const i=e.fullServerUrl(),s=io(i,t.host,t._protocol),o="PATCH",a=uT(n,r),l={"Content-Type":"application/json; charset=utf-8"},u=t.maxOperationRetryTime,c=new Gi(s,o,Vg(t,r),u);return c.headers=l,c.body=a,c.errorHandler=Fg(e),c}function S7(t,e){const n=e.fullServerUrl(),r=io(n,t.host,t._protocol),i="DELETE",s=t.maxOperationRetryTime;function o(l,u){}const a=new Gi(r,i,o,s);return a.successCodes=[200,204],a.errorHandler=Fg(e),a}function C7(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function e2(t,e,n){const r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=C7(null,e)),r}function R7(t,e,n,r,i){const s=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function a(){let I="";for(let C=0;C<2;C++)I=I+Math.random().toString().slice(2);return I}const l=a();o["Content-Type"]="multipart/related; boundary="+l;const u=e2(e,r,i),c=uT(u,n),h="--"+l+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+c+`\r
--`+l+`\r
Content-Type: `+u.contentType+`\r
\r
`,f=`\r
--`+l+"--",g=wi.getBlob(h,r,f);if(g===null)throw zL();const _={name:u.fullPath},w=io(s,t.host,t._protocol),T="POST",v=t.maxUploadRetryTime,y=new Gi(w,T,Vg(t,n),v);return y.urlParams=_,y.headers=o,y.body=g.uploadData(),y.errorHandler=_u(e),y}class em{constructor(e,n,r,i){this.current=e,this.total=n,this.finalized=!!r,this.metadata=i||null}}function cT(t,e){let n=null;try{n=t.getResponseHeader("X-Goog-Upload-Status")}catch{ni(!1)}return ni(!!n&&(e||["active"]).indexOf(n)!==-1),n}function A7(t,e,n,r,i){const s=e.bucketOnlyServerUrl(),o=e2(e,r,i),a={name:o.fullPath},l=io(s,t.host,t._protocol),u="POST",c={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${r.size()}`,"X-Goog-Upload-Header-Content-Type":o.contentType,"Content-Type":"application/json; charset=utf-8"},h=uT(o,n),f=t.maxUploadRetryTime;function g(w){cT(w);let T;try{T=w.getResponseHeader("X-Goog-Upload-URL")}catch{ni(!1)}return ni(Lg(T)),T}const _=new Gi(l,u,g,f);return _.urlParams=a,_.headers=c,_.body=h,_.errorHandler=_u(e),_}function P7(t,e,n,r){const i={"X-Goog-Upload-Command":"query"};function s(u){const c=cT(u,["active","final"]);let h=null;try{h=u.getResponseHeader("X-Goog-Upload-Size-Received")}catch{ni(!1)}h||ni(!1);const f=Number(h);return ni(!isNaN(f)),new em(f,r.size(),c==="final")}const o="POST",a=t.maxUploadRetryTime,l=new Gi(n,o,s,a);return l.headers=i,l.errorHandler=_u(e),l}const XR=256*1024;function b7(t,e,n,r,i,s,o,a){const l=new em(0,0);if(o?(l.current=o.current,l.total=o.total):(l.current=0,l.total=r.size()),r.size()!==l.total)throw BK();const u=l.total-l.current;let c=u;i>0&&(c=Math.min(c,i));const h=l.current,f=h+c;let g="";c===0?g="finalize":u===c?g="upload, finalize":g="upload";const _={"X-Goog-Upload-Command":g,"X-Goog-Upload-Offset":`${l.current}`},w=r.slice(h,f);if(w===null)throw zL();function T(C,P){const b=cT(C,["active","final"]),k=l.current+c,F=r.size();let re;return b==="final"?re=Vg(e,s)(C,P):re=null,new em(k,F,b==="final",re)}const v="POST",y=e.maxUploadRetryTime,I=new Gi(n,v,T,y);return I.headers=_,I.body=w.uploadData(),I.progressCallback=a||null,I.errorHandler=_u(t),I}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k7={STATE_CHANGED:"state_changed"},dn={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function Py(t){switch(t){case"running":case"pausing":case"canceling":return dn.RUNNING;case"paused":return dn.PAUSED;case"success":return dn.SUCCESS;case"canceled":return dn.CANCELED;case"error":return dn.ERROR;default:return dn.ERROR}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x7{constructor(e,n,r){if(KK(e)||n!=null||r!=null)this.next=e,this.error=n??void 0,this.complete=r??void 0;else{const s=e;this.next=s.next,this.error=s.error,this.complete=s.complete}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Na(t){return(...e)=>{Promise.resolve().then(()=>t(...e))}}class N7{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Uo.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Uo.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Uo.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,r,i){if(this.sent_)throw Hu("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(n,e,!0),i!==void 0)for(const s in i)i.hasOwnProperty(s)&&this.xhr_.setRequestHeader(s,i[s].toString());return r!==void 0?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Hu("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Hu("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Hu("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Hu("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class D7 extends N7{initXhr(){this.xhr_.responseType="text"}}function Gr(){return new D7}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t2{constructor(e,n,r=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=n,this._metadata=r,this._mappings=Mg(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=i=>{if(this._request=void 0,this._chunkMultiplier=1,i._codeEquals(ze.CANCELED))this._needToFetchStatus=!0,this.completeTransitions_();else{const s=this.isExponentialBackoffExpired();if(HL(i.status,[]))if(s)i=$L();else{this.sleepTime=Math.max(this.sleepTime*2,NK),this._needToFetchStatus=!0,this.completeTransitions_();return}this._error=i,this._transition("error")}},this._metadataErrorHandler=i=>{this._request=void 0,i._codeEquals(ze.CANCELED)?this.completeTransitions_():(this._error=i,this._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise((i,s)=>{this._resolve=i,this._reject=s,this._start()}),this._promise.then(null,()=>{})}isExponentialBackoffExpired(){return this.sleepTime>this.maxSleepTime}_makeProgressCallback(){const e=this._transferred;return n=>this._updateProgress(e+n)}_shouldDoResumable(e){return e.size()>256*1024}_start(){this._state==="running"&&this._request===void 0&&(this._resumable?this._uploadUrl===void 0?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout(()=>{this.pendingTimeout=void 0,this._continueUpload()},this.sleepTime):this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([n,r])=>{switch(this._state){case"running":e(n,r);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused");break}})}_createResumable(){this._resolveToken((e,n)=>{const r=A7(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(r,Gr,e,n);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._uploadUrl=s,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){const e=this._uploadUrl;this._resolveToken((n,r)=>{const i=P7(this._ref.storage,this._ref._location,e,this._blob),s=this._ref.storage._makeRequest(i,Gr,n,r);this._request=s,s.getPromise().then(o=>{o=o,this._request=void 0,this._updateProgress(o.current),this._needToFetchStatus=!1,o.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){const e=XR*this._chunkMultiplier,n=new em(this._transferred,this._blob.size()),r=this._uploadUrl;this._resolveToken((i,s)=>{let o;try{o=b7(this._ref._location,this._ref.storage,r,this._blob,e,this._mappings,n,this._makeProgressCallback())}catch(l){this._error=l,this._transition("error");return}const a=this._ref.storage._makeRequest(o,Gr,i,s,!1);this._request=a,a.getPromise().then(l=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(l.current),l.finalized?(this._metadata=l.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){XR*this._chunkMultiplier*2<32*1024*1024&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((e,n)=>{const r=ZL(this._ref.storage,this._ref._location,this._mappings),i=this._ref.storage._makeRequest(r,Gr,e,n);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._metadata=s,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((e,n)=>{const r=R7(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(r,Gr,e,n);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._metadata=s,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(e){const n=this._transferred;this._transferred=e,this._transferred!==n&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,this._request!==void 0?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":const n=this._state==="paused";this._state=e,n&&(this._notifyObservers(),this._start());break;case"paused":this._state=e,this._notifyObservers();break;case"canceled":this._error=BL(),this._state=e,this._notifyObservers();break;case"error":this._state=e,this._notifyObservers();break;case"success":this._state=e,this._notifyObservers();break}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start();break}}get snapshot(){const e=Py(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,n,r,i){const s=new x7(n||void 0,r||void 0,i||void 0);return this._addObserver(s),()=>{this._removeObserver(s)}}then(e,n){return this._promise.then(e,n)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){const n=this._observers.indexOf(e);n!==-1&&this._observers.splice(n,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(n=>{this._notifyObserver(n)})}_finishPromise(){if(this._resolve!==void 0){let e=!0;switch(Py(this._state)){case dn.SUCCESS:Na(this._resolve.bind(null,this.snapshot))();break;case dn.CANCELED:case dn.ERROR:const n=this._reject;Na(n.bind(null,this._error))();break;default:e=!1;break}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(Py(this._state)){case dn.RUNNING:case dn.PAUSED:e.next&&Na(e.next.bind(e,this.snapshot))();break;case dn.SUCCESS:e.complete&&Na(e.complete.bind(e))();break;case dn.CANCELED:case dn.ERROR:e.error&&Na(e.error.bind(e,this._error))();break;default:e.error&&Na(e.error.bind(e,this._error))()}}resume(){const e=this._state==="paused"||this._state==="pausing";return e&&this._transition("running"),e}pause(){const e=this._state==="running";return e&&this._transition("pausing"),e}cancel(){const e=this._state==="running"||this._state==="pausing";return e&&this._transition("canceling"),e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ug=class Fw{constructor(e,n){this._service=e,n instanceof Zt?this._location=n:this._location=Zt.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new Fw(e,n)}get root(){const e=new Zt(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return XL(this._location.path)}get storage(){return this._service}get parent(){const e=c7(this._location.path);if(e===null)return null;const n=new Zt(this._location.bucket,e);return new Fw(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw qL(e)}};function O7(t,e,n){return t._throwIfRoot("uploadBytesResumable"),new t2(t,new wi(e),n)}function L7(t){const e={prefixes:[],items:[]};return n2(t,e).then(()=>e)}async function n2(t,e,n){const i=await r2(t,{pageToken:n});e.prefixes.push(...i.prefixes),e.items.push(...i.items),i.nextPageToken!=null&&await n2(t,e,i.nextPageToken)}function r2(t,e){e!=null&&typeof e.maxResults=="number"&&Vw("options.maxResults",1,1e3,e.maxResults);const n=e||{},r=E7(t.storage,t._location,"/",n.pageToken,n.maxResults);return t.storage.makeRequestWithTokens(r,Gr)}function M7(t){t._throwIfRoot("getMetadata");const e=ZL(t.storage,t._location,Mg());return t.storage.makeRequestWithTokens(e,Gr)}function V7(t,e){t._throwIfRoot("updateMetadata");const n=T7(t.storage,t._location,e,Mg());return t.storage.makeRequestWithTokens(n,Gr)}function F7(t){t._throwIfRoot("getDownloadURL");const e=I7(t.storage,t._location,Mg());return t.storage.makeRequestWithTokens(e,Gr).then(n=>{if(n===null)throw zK();return n})}function U7(t){t._throwIfRoot("deleteObject");const e=S7(t.storage,t._location);return t.storage.makeRequestWithTokens(e,Gr)}function i2(t,e){const n=h7(t._location.path,e),r=new Zt(t._location.bucket,n);return new Ug(t.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $7(t){return/^[A-Za-z]+:\/\//.test(t)}function B7(t,e){return new Ug(t,e)}function s2(t,e){if(t instanceof hT){const n=t;if(n._bucket==null)throw $K();const r=new Ug(n,n._bucket);return e!=null?s2(r,e):r}else return e!==void 0?i2(t,e):t}function z7(t,e){if(e&&$7(e)){if(t instanceof hT)return B7(t,e);throw fl("To use ref(service, url), the first argument must be a Storage instance.")}else return s2(t,e)}function JR(t,e){const n=e==null?void 0:e[UL];return n==null?null:Zt.makeFromBucketSpec(n,t)}function j7(t,e,n,r={}){t.host=`${e}:${n}`,t._protocol="http";const{mockUserToken:i}=r;i&&(t._overrideAuthToken=typeof i=="string"?i:f0(i,t.app.options.projectId))}class hT{constructor(e,n,r,i,s){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=i,this._firebaseVersion=s,this._bucket=null,this._host=FL,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=kK,this._maxUploadRetryTime=xK,this._requests=new Set,i!=null?this._bucket=Zt.makeFromBucketSpec(i,this._host):this._bucket=JR(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Zt.makeFromBucketSpec(this._url,e):this._bucket=JR(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){Vw("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){Vw("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Ug(this,e)}_makeRequest(e,n,r,i,s=!0){if(this._deleted)return new qK(jL());{const o=t7(e,this._appId,r,i,n,this._firebaseVersion,s);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,n){const[r,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,i).getPromise()}}const ZR="@firebase/storage",eA="0.11.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q7="storage";function W7(t,e,n){return t=j(t),O7(t,e,n)}function H7(t){return t=j(t),M7(t)}function G7(t,e){return t=j(t),V7(t,e)}function K7(t,e){return t=j(t),r2(t,e)}function Q7(t){return t=j(t),L7(t)}function Y7(t){return t=j(t),F7(t)}function X7(t){return t=j(t),U7(t)}function tA(t,e){return t=j(t),z7(t,e)}function J7(t,e){return i2(t,e)}function Z7(t,e,n,r={}){j7(t,e,n,r)}function eQ(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),i=t.getProvider("app-check-internal");return new hT(n,r,i,e,hi)}function tQ(){ii(new on(q7,eQ,"PUBLIC").setMultipleInstances(!0)),Vn(ZR,eA,""),Vn(ZR,eA,"esm2017")}tQ();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mf{constructor(e,n,r){this._delegate=e,this.task=n,this.ref=r}get bytesTransferred(){return this._delegate.bytesTransferred}get metadata(){return this._delegate.metadata}get state(){return this._delegate.state}get totalBytes(){return this._delegate.totalBytes}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nA{constructor(e,n){this._delegate=e,this._ref=n,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}get snapshot(){return new mf(this._delegate.snapshot,this,this._ref)}then(e,n){return this._delegate.then(r=>{if(e)return e(new mf(r,this,this._ref))},n)}on(e,n,r,i){let s;return n&&(typeof n=="function"?s=o=>n(new mf(o,this,this._ref)):s={next:n.next?o=>n.next(new mf(o,this,this._ref)):void 0,complete:n.complete||void 0,error:n.error||void 0}),this._delegate.on(e,s,r||void 0,i||void 0)}}class rA{constructor(e,n){this._delegate=e,this._service=n}get prefixes(){return this._delegate.prefixes.map(e=>new xi(e,this._service))}get items(){return this._delegate.items.map(e=>new xi(e,this._service))}get nextPageToken(){return this._delegate.nextPageToken||null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *  http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xi{constructor(e,n){this._delegate=e,this.storage=n}get name(){return this._delegate.name}get bucket(){return this._delegate.bucket}get fullPath(){return this._delegate.fullPath}toString(){return this._delegate.toString()}child(e){const n=J7(this._delegate,e);return new xi(n,this.storage)}get root(){return new xi(this._delegate.root,this.storage)}get parent(){const e=this._delegate.parent;return e==null?null:new xi(e,this.storage)}put(e,n){return this._throwIfRoot("put"),new nA(W7(this._delegate,e,n),this)}putString(e,n=lr.RAW,r){this._throwIfRoot("putString");const i=GL(n,e),s=Object.assign({},r);return s.contentType==null&&i.contentType!=null&&(s.contentType=i.contentType),new nA(new t2(this._delegate,new wi(i.data,!0),s),this)}listAll(){return Q7(this._delegate).then(e=>new rA(e,this.storage))}list(e){return K7(this._delegate,e||void 0).then(n=>new rA(n,this.storage))}getMetadata(){return H7(this._delegate)}updateMetadata(e){return G7(this._delegate,e)}getDownloadURL(){return Y7(this._delegate)}delete(){return this._throwIfRoot("delete"),X7(this._delegate)}_throwIfRoot(e){if(this._delegate._location.path==="")throw qL(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o2{constructor(e,n){this.app=e,this._delegate=n}get maxOperationRetryTime(){return this._delegate.maxOperationRetryTime}get maxUploadRetryTime(){return this._delegate.maxUploadRetryTime}ref(e){if(iA(e))throw fl("ref() expected a child path but got a URL, use refFromURL instead.");return new xi(tA(this._delegate,e),this)}refFromURL(e){if(!iA(e))throw fl("refFromURL() expected a full URL but got a child path, use ref() instead.");try{Zt.makeFromUrl(e,this._delegate.host)}catch{throw fl("refFromUrl() expected a valid full URL but got an invalid one.")}return new xi(tA(this._delegate,e),this)}setMaxUploadRetryTime(e){this._delegate.maxUploadRetryTime=e}setMaxOperationRetryTime(e){this._delegate.maxOperationRetryTime=e}useEmulator(e,n,r={}){Z7(this._delegate,e,n,r)}}function iA(t){return/^[A-Za-z]+:\/\//.test(t)}const nQ="@firebase/storage-compat",rQ="0.3.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iQ="storage-compat";function sQ(t,{instanceIdentifier:e}){const n=t.getProvider("app-compat").getImmediate(),r=t.getProvider("storage").getImmediate({identifier:e});return new o2(n,r)}function oQ(t){const e={TaskState:dn,TaskEvent:k7,StringFormat:lr,Storage:o2,Reference:xi};t.INTERNAL.registerComponent(new on(iQ,sQ,"PUBLIC").setServiceProps(e).setMultipleInstances(!0)),t.registerVersion(nQ,rQ)}oQ(di);const sA="@firebase/database",oA="1.0.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let a2="";function l2(t){a2=t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aQ{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,n){n==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),Et(n))}get(e){const n=this.domStorage_.getItem(this.prefixedName_(e));return n==null?null:nh(n)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lQ{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,n){n==null?delete this.cache_[e]:this.cache_[e]=n}get(e){return Qn(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u2=function(t){try{if(typeof window<"u"&&typeof window[t]<"u"){const e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new aQ(e)}}catch{}return new lQ},ko=u2("localStorage"),Uw=u2("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pl=new nu("@firebase/database"),c2=function(){let t=1;return function(){return t++}}(),h2=function(t){const e=Z3(t),n=new Y3;n.update(e);const r=n.digest();return h0.encodeByteArray(r)},Ed=function(...t){let e="";for(let n=0;n<t.length;n++){const r=t[n];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=Ed.apply(null,r):typeof r=="object"?e+=Et(r):e+=r,e+=" "}return e};let $o=null,aA=!0;const d2=function(t,e){V(!e||t===!0||t===!1,"Can't turn on custom loggers persistently."),t===!0?(pl.logLevel=pe.VERBOSE,$o=pl.log.bind(pl),e&&Uw.set("logging_enabled",!0)):typeof t=="function"?$o=t:($o=null,Uw.remove("logging_enabled"))},xt=function(...t){if(aA===!0&&(aA=!1,$o===null&&Uw.get("logging_enabled")===!0&&d2(!0)),$o){const e=Ed.apply(null,t);$o(e)}},Id=function(t){return function(...e){xt(t,...e)}},$w=function(...t){const e="FIREBASE INTERNAL ERROR: "+Ed(...t);pl.error(e)},li=function(...t){const e=`FIREBASE FATAL ERROR: ${Ed(...t)}`;throw pl.error(e),new Error(e)},rn=function(...t){const e="FIREBASE WARNING: "+Ed(...t);pl.warn(e)},uQ=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&rn("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},$g=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},cQ=function(t){if(document.readyState==="complete")t();else{let e=!1;const n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},zs="[MIN_NAME]",$i="[MAX_NAME]",wa=function(t,e){if(t===e)return 0;if(t===zs||e===$i)return-1;if(e===zs||t===$i)return 1;{const n=lA(t),r=lA(e);return n!==null?r!==null?n-r===0?t.length-e.length:n-r:-1:r!==null?1:t<e?-1:1}},hQ=function(t,e){return t===e?0:t<e?-1:1},Gu=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+Et(e))},dT=function(t){if(typeof t!="object"||t===null)return Et(t);const e=[];for(const r in t)e.push(r);e.sort();let n="{";for(let r=0;r<e.length;r++)r!==0&&(n+=","),n+=Et(e[r]),n+=":",n+=dT(t[e[r]]);return n+="}",n},f2=function(t,e){const n=t.length;if(n<=e)return[t];const r=[];for(let i=0;i<n;i+=e)i+e>n?r.push(t.substring(i,n)):r.push(t.substring(i,i+e));return r};function Lt(t,e){for(const n in t)t.hasOwnProperty(n)&&e(n,t[n])}const p2=function(t){V(!$g(t),"Invalid JSON number");const e=11,n=52,r=(1<<e-1)-1;let i,s,o,a,l;t===0?(s=0,o=0,i=1/t===-1/0?1:0):(i=t<0,t=Math.abs(t),t>=Math.pow(2,1-r)?(a=Math.min(Math.floor(Math.log(t)/Math.LN2),r),s=a+r,o=Math.round(t*Math.pow(2,n-a)-Math.pow(2,n))):(s=0,o=Math.round(t/Math.pow(2,1-r-n))));const u=[];for(l=n;l;l-=1)u.push(o%2?1:0),o=Math.floor(o/2);for(l=e;l;l-=1)u.push(s%2?1:0),s=Math.floor(s/2);u.push(i?1:0),u.reverse();const c=u.join("");let h="";for(l=0;l<64;l+=8){let f=parseInt(c.substr(l,8),2).toString(16);f.length===1&&(f="0"+f),h=h+f}return h.toLowerCase()},dQ=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},fQ=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function pQ(t,e){let n="Unknown Error";t==="too_big"?n="The data requested exceeds the maximum size that can be accessed with a single request.":t==="permission_denied"?n="Client doesn't have permission to access the desired data.":t==="unavailable"&&(n="The service is unavailable");const r=new Error(t+" at "+e._path.toString()+": "+n);return r.code=t.toUpperCase(),r}const mQ=new RegExp("^-?(0*)\\d{1,10}$"),gQ=-2147483648,_Q=2147483647,lA=function(t){if(mQ.test(t)){const e=Number(t);if(e>=gQ&&e<=_Q)return e}return null},yu=function(t){try{t()}catch(e){setTimeout(()=>{const n=e.stack||"";throw rn("Exception was thrown by user callback.",n),e},Math.floor(0))}},yQ=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},xc=function(t,e){const n=setTimeout(t,e);return typeof n=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(n):typeof n=="object"&&n.unref&&n.unref(),n};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vQ{constructor(e,n){this.appName_=e,this.appCheckProvider=n,this.appCheck=n==null?void 0:n.getImmediate({optional:!0}),this.appCheck||n==null||n.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((n,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){var n;(n=this.appCheckProvider)===null||n===void 0||n.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){rn(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wQ{constructor(e,n,r){this.appName_=e,this.firebaseOptions_=n,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(n=>n&&n.code==="auth/token-not-initialized"?(xt("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(n=>n.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(n=>n.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',rn(e)}}class ml{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}ml.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fT="5",m2="v",g2="s",_2="r",y2="f",v2=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,w2="ls",E2="p",Bw="ac",I2="websocket",T2="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S2{constructor(e,n,r,i,s=!1,o="",a=!1,l=!1){this.secure=n,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=l,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=ko.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&ko.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${n}`}}function EQ(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function C2(t,e,n){V(typeof e=="string","typeof type must == string"),V(typeof n=="object","typeof params must == object");let r;if(e===I2)r=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===T2)r=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);EQ(t)&&(n.ns=t.namespace);const i=[];return Lt(n,(s,o)=>{i.push(s+"="+o)}),r+i.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IQ{constructor(){this.counters_={}}incrementCounter(e,n=1){Qn(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=n}get(){return L3(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const by={},ky={};function pT(t){const e=t.toString();return by[e]||(by[e]=new IQ),by[e]}function TQ(t,e){const n=t.toString();return ky[n]||(ky[n]=e()),ky[n]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SQ{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,n){this.closeAfterResponse=e,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,n){for(this.pendingResponses[e]=n;this.pendingResponses[this.currentResponseNum];){const r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&yu(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uA="start",CQ="close",RQ="pLPCommand",AQ="pRTLPCB",R2="id",A2="pw",P2="ser",PQ="cb",bQ="seg",kQ="ts",xQ="d",NQ="dframe",b2=1870,k2=30,DQ=b2-k2,OQ=25e3,LQ=3e4;class hs{constructor(e,n,r,i,s,o,a){this.connId=e,this.repoInfo=n,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Id(e),this.stats_=pT(n),this.urlFn=l=>(this.appCheckToken&&(l[Bw]=this.appCheckToken),C2(n,T2,l))}open(e,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new SQ(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(LQ)),cQ(()=>{if(this.isClosed_)return;this.scriptTagHolder=new mT((...s)=>{const[o,a,l,u,c]=s;if(this.incrementIncomingBytes_(s),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===uA)this.id=a,this.password=l;else if(o===CQ)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...s)=>{const[o,a]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);const r={};r[uA]="t",r[P2]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[PQ]=this.scriptTagHolder.uniqueCallbackIdentifier),r[m2]=fT,this.transportSessionId&&(r[g2]=this.transportSessionId),this.lastSessionId&&(r[w2]=this.lastSessionId),this.applicationId&&(r[E2]=this.applicationId),this.appCheckToken&&(r[Bw]=this.appCheckToken),typeof location<"u"&&location.hostname&&v2.test(location.hostname)&&(r[_2]=y2);const i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){hs.forceAllow_=!0}static forceDisallow(){hs.forceDisallow_=!0}static isAvailable(){return hs.forceAllow_?!0:!hs.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!dQ()&&!fQ()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const n=Et(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const r=Jk(n),i=f2(r,DQ);for(let s=0;s<i.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[s]),this.curSegmentNum++}addDisconnectPingFrame(e,n){this.myDisconnFrame=document.createElement("iframe");const r={};r[NQ]="t",r[R2]=e,r[A2]=n,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const n=Et(e).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}}class mT{constructor(e,n,r,i){this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=c2(),window[RQ+this.uniqueCallbackIdentifier]=e,window[AQ+this.uniqueCallbackIdentifier]=n,this.myIFrame=mT.createIFrame_();let s="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(s='<script>document.domain="'+document.domain+'";<\/script>');const o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){xt("frame writing exception"),a.stack&&xt(a.stack),xt(a)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||xt("No IE domain setting required")}catch{const r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,n){for(this.myID=e,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[R2]=this.myID,e[A2]=this.myPW,e[P2]=this.currentSerial;let n=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+k2+r.length<=b2;){const o=this.pendingSegs.shift();r=r+"&"+bQ+i+"="+o.seg+"&"+kQ+i+"="+o.ts+"&"+xQ+i+"="+o.d,i++}return n=n+r,this.addLongPollTag_(n,this.currentSerial),!0}else return!1}enqueueSegment(e,n,r){this.pendingSegs.push({seg:e,ts:n,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,n){this.outstandingRequests.add(n);const r=()=>{this.outstandingRequests.delete(n),this.newRequest_()},i=setTimeout(r,Math.floor(OQ)),s=()=>{clearTimeout(i),r()};this.addTag(e,s)}addTag(e,n){setTimeout(()=>{try{if(!this.sendNewPolls)return;const r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){const i=r.readyState;(!i||i==="loaded"||i==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),n())},r.onerror=()=>{xt("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MQ=16384,VQ=45e3;let tm=null;typeof MozWebSocket<"u"?tm=MozWebSocket:typeof WebSocket<"u"&&(tm=WebSocket);class sr{constructor(e,n,r,i,s,o,a){this.connId=e,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Id(this.connId),this.stats_=pT(n),this.connURL=sr.connectionURL_(n,o,a,i,r),this.nodeAdmin=n.nodeAdmin}static connectionURL_(e,n,r,i,s){const o={};return o[m2]=fT,typeof location<"u"&&location.hostname&&v2.test(location.hostname)&&(o[_2]=y2),n&&(o[g2]=n),r&&(o[w2]=r),i&&(o[Bw]=i),s&&(o[E2]=s),C2(e,I2,o)}open(e,n){this.onDisconnect=n,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,ko.set("previous_websocket_failure",!0);try{let r;nx(),this.mySock=new tm(this.connURL,[],r)}catch(r){this.log_("Error instantiating WebSocket.");const i=r.message||r.data;i&&this.log_(i),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=r=>{this.handleIncomingFrame(r)},this.mySock.onerror=r=>{this.log_("WebSocket error.  Closing connection.");const i=r.message||r.data;i&&this.log_(i),this.onClosed_()}}start(){}static forceDisallow(){sr.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const n=/Android ([0-9]{0,}\.[0-9]{0,})/,r=navigator.userAgent.match(n);r&&r.length>1&&parseFloat(r[1])<4.4&&(e=!0)}return!e&&tm!==null&&!sr.forceDisallow_}static previouslyFailed(){return ko.isInMemoryStorage||ko.get("previous_websocket_failure")===!0}markConnectionHealthy(){ko.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const n=this.frames.join("");this.frames=null;const r=nh(n);this.onMessage(r)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(V(this.frames===null,"We already have a frame buffer"),e.length<=6){const n=Number(e);if(!isNaN(n))return this.handleNewFrameCount_(n),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const n=e.data;if(this.bytesReceived+=n.length,this.stats_.incrementCounter("bytes_received",n.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(n);else{const r=this.extractFrameCount_(n);r!==null&&this.appendFrame_(r)}}send(e){this.resetKeepAlive();const n=Et(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const r=f2(n,MQ);r.length>1&&this.sendString_(String(r.length));for(let i=0;i<r.length;i++)this.sendString_(r[i])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(VQ))}sendString_(e){try{this.mySock.send(e)}catch(n){this.log_("Exception thrown from WebSocket.send():",n.message||n.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}sr.responsesRequiredToBeHealthy=2;sr.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ql{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[hs,sr]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(e){const n=sr&&sr.isAvailable();let r=n&&!sr.previouslyFailed();if(e.webSocketOnly&&(n||rn("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),r=!0),r)this.transports_=[sr];else{const i=this.transports_=[];for(const s of ql.ALL_TRANSPORTS)s&&s.isAvailable()&&i.push(s);ql.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}ql.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FQ=6e4,UQ=5e3,$Q=10*1024,BQ=100*1024,xy="t",cA="d",zQ="s",hA="r",jQ="e",dA="o",fA="a",pA="n",mA="p",qQ="h";class WQ{constructor(e,n,r,i,s,o,a,l,u,c){this.id=e,this.repoInfo_=n,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=s,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=l,this.onKill_=u,this.lastSessionId=c,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Id("c:"+this.id+":"),this.transportManager_=new ql(n),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,r)},Math.floor(0));const i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=xc(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>BQ?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>$Q?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return n=>{e===this.conn_?this.onConnectionLost_(n):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return n=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(n):e===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(e){const n={t:"d",d:e};this.sendData_(n)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(xy in e){const n=e[xy];n===fA?this.upgradeIfSecondaryHealthy_():n===hA?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===dA&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const n=Gu("t",e),r=Gu("d",e);if(n==="c")this.onSecondaryControl_(r);else if(n==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+n)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:mA,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:fA,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:pA,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const n=Gu("t",e),r=Gu("d",e);n==="c"?this.onControl_(r):n==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const n=Gu(xy,e);if(cA in e){const r=e[cA];if(n===qQ){const i=Object.assign({},r);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(n===pA){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===zQ?this.onConnectionShutdown_(r):n===hA?this.onReset_(r):n===jQ?$w("Server Error: "+r):n===dA?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):$w("Unknown control packet command: "+n)}}onHandshake_(e){const n=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),fT!==r&&rn("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),xc(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(FQ))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,n){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):xc(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(UQ))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:mA,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(ko.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x2{put(e,n,r,i){}merge(e,n,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,n,r){}onDisconnectMerge(e,n,r){}onDisconnectCancel(e,n){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N2{constructor(e){this.allowedEvents_=e,this.listeners_={},V(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...n){if(Array.isArray(this.listeners_[e])){const r=[...this.listeners_[e]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,n)}}on(e,n,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:n,context:r});const i=this.getInitialEvent(e);i&&n.apply(r,i)}off(e,n,r){this.validateEventType_(e);const i=this.listeners_[e]||[];for(let s=0;s<i.length;s++)if(i[s].callback===n&&(!r||r===i[s].context)){i.splice(s,1);return}}validateEventType_(e){V(this.allowedEvents_.find(n=>n===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nm extends N2{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!p0()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new nm}getInitialEvent(e){return V(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gA=32,_A=768;class Se{constructor(e,n){if(n===void 0){this.pieces_=e.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=n}toString(){let e="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(e+="/"+this.pieces_[n]);return e||"/"}}function Ee(){return new Se("")}function ue(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function js(t){return t.pieces_.length-t.pieceNum_}function ke(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new Se(t.pieces_,e)}function gT(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function HQ(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)t.pieces_[n]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}function xh(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function D2(t){if(t.pieceNum_>=t.pieces_.length)return null;const e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new Se(e,0)}function We(t,e){const n=[];for(let r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);if(e instanceof Se)for(let r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);else{const r=e.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&n.push(r[i])}return new Se(n,0)}function ce(t){return t.pieceNum_>=t.pieces_.length}function pn(t,e){const n=ue(t),r=ue(e);if(n===null)return e;if(n===r)return pn(ke(t),ke(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function GQ(t,e){const n=xh(t,0),r=xh(e,0);for(let i=0;i<n.length&&i<r.length;i++){const s=wa(n[i],r[i]);if(s!==0)return s}return n.length===r.length?0:n.length<r.length?-1:1}function _T(t,e){if(js(t)!==js(e))return!1;for(let n=t.pieceNum_,r=e.pieceNum_;n<=t.pieces_.length;n++,r++)if(t.pieces_[n]!==e.pieces_[r])return!1;return!0}function ur(t,e){let n=t.pieceNum_,r=e.pieceNum_;if(js(t)>js(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[r])return!1;++n,++r}return!0}class KQ{constructor(e,n){this.errorPrefix_=n,this.parts_=xh(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=zm(this.parts_[r]);O2(this)}}function QQ(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=zm(e),O2(t)}function YQ(t){const e=t.parts_.pop();t.byteLength_-=zm(e),t.parts_.length>0&&(t.byteLength_-=1)}function O2(t){if(t.byteLength_>_A)throw new Error(t.errorPrefix_+"has a key path longer than "+_A+" bytes ("+t.byteLength_+").");if(t.parts_.length>gA)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+gA+") or object contains a cycle "+mo(t))}function mo(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yT extends N2{constructor(){super(["visible"]);let e,n;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(n="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(n="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(n="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(n="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{const r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new yT}getInitialEvent(e){return V(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ku=1e3,XQ=60*5*1e3,yA=30*1e3,JQ=1.3,ZQ=3e4,eY="server_kill",vA=3;class Ni extends x2{constructor(e,n,r,i,s,o,a,l){if(super(),this.repoInfo_=e,this.applicationId_=n,this.onDataUpdate_=r,this.onConnectStatus_=i,this.onServerInfoUpdate_=s,this.authTokenProvider_=o,this.appCheckTokenProvider_=a,this.authOverride_=l,this.id=Ni.nextPersistentConnectionId_++,this.log_=Id("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Ku,this.maxReconnectDelay_=XQ,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,l&&!nx())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");yT.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&nm.getInstance().on("online",this.onOnline_,this)}sendRequest(e,n,r){const i=++this.requestNumber_,s={r:i,a:e,b:n};this.log_(Et(s)),V(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(s),r&&(this.requestCBHash_[i]=r)}get(e){this.initConnection_();const n=new Rn,i={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:o=>{const a=o.d;o.s==="ok"?n.resolve(a):n.reject(a)}};this.outstandingGets_.push(i),this.outstandingGetCount_++;const s=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(s),n.promise}listen(e,n,r,i){this.initConnection_();const s=e._queryIdentifier,o=e._path.toString();this.log_("Listen called for "+o+" "+s),this.listens.has(o)||this.listens.set(o,new Map),V(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),V(!this.listens.get(o).has(s),"listen() called twice for same path/queryId.");const a={onComplete:i,hashFn:n,query:e,tag:r};this.listens.get(o).set(s,a),this.connected_&&this.sendListen_(a)}sendGet_(e){const n=this.outstandingGets_[e];this.sendRequest("g",n.request,r=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),n.onComplete&&n.onComplete(r)})}sendListen_(e){const n=e.query,r=n._path.toString(),i=n._queryIdentifier;this.log_("Listen on "+r+" for "+i);const s={p:r},o="q";e.tag&&(s.q=n._queryObject,s.t=e.tag),s.h=e.hashFn(),this.sendRequest(o,s,a=>{const l=a.d,u=a.s;Ni.warnOnListenWarnings_(l,n),(this.listens.get(r)&&this.listens.get(r).get(i))===e&&(this.log_("listen response",a),u!=="ok"&&this.removeListen_(r,i),e.onComplete&&e.onComplete(u,l))})}static warnOnListenWarnings_(e,n){if(e&&typeof e=="object"&&Qn(e,"w")){const r=Ho(e,"w");if(Array.isArray(r)&&~r.indexOf("no_index")){const i='".indexOn": "'+n._queryParams.getIndex().toString()+'"',s=n._path.toString();rn(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${i} at ${s} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||Q3(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=yA)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,n=K3(e)?"auth":"gauth",r={cred:e};this.authOverride_===null?r.noauth=!0:typeof this.authOverride_=="object"&&(r.authvar=this.authOverride_),this.sendRequest(n,r,i=>{const s=i.s,o=i.d||"error";this.authToken_===e&&(s==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(s,o))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const n=e.s,r=e.d||"error";n==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(n,r)})}unlisten(e,n){const r=e._path.toString(),i=e._queryIdentifier;this.log_("Unlisten called for "+r+" "+i),V(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(r,i)&&this.connected_&&this.sendUnlisten_(r,i,e._queryObject,n)}sendUnlisten_(e,n,r,i){this.log_("Unlisten on "+e+" for "+n);const s={p:e},o="n";i&&(s.q=r,s.t=i),this.sendRequest(o,s)}onDisconnectPut(e,n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,n,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:n,onComplete:r})}onDisconnectMerge(e,n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,n,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:n,onComplete:r})}onDisconnectCancel(e,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:n})}sendOnDisconnect_(e,n,r,i){const s={p:n,d:r};this.log_("onDisconnect "+e,s),this.sendRequest(e,s,o=>{i&&setTimeout(()=>{i(o.s,o.d)},Math.floor(0))})}put(e,n,r,i){this.putInternal("p",e,n,r,i)}merge(e,n,r,i){this.putInternal("m",e,n,r,i)}putInternal(e,n,r,i,s){this.initConnection_();const o={p:n,d:r};s!==void 0&&(o.h=s),this.outstandingPuts_.push({action:e,request:o,onComplete:i}),this.outstandingPutCount_++;const a=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(a):this.log_("Buffering put: "+n)}sendPut_(e){const n=this.outstandingPuts_[e].action,r=this.outstandingPuts_[e].request,i=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(n,r,s=>{this.log_(n+" response",s),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),i&&i(s.s,s.d)})}reportStats(e){if(this.connected_){const n={c:e};this.log_("reportStats",n),this.sendRequest("s",n,r=>{if(r.s!=="ok"){const s=r.d;this.log_("reportStats","Error sending stats: "+s)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+Et(e));const n=e.r,r=this.requestCBHash_[n];r&&(delete this.requestCBHash_[n],r(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,n){this.log_("handleServerMessage",e,n),e==="d"?this.onDataUpdate_(n.p,n.d,!1,n.t):e==="m"?this.onDataUpdate_(n.p,n.d,!0,n.t):e==="c"?this.onListenRevoked_(n.p,n.q):e==="ac"?this.onAuthRevoked_(n.s,n.d):e==="apc"?this.onAppCheckRevoked_(n.s,n.d):e==="sd"?this.onSecurityDebugPacket_(n):$w("Unrecognized action received from server: "+Et(e)+`
Are you using the latest client?`)}onReady_(e,n){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=n,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){V(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Ku,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=Ku,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>ZQ&&(this.reconnectDelay_=Ku),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=new Date().getTime()-this.lastConnectionAttemptTime_;let n=Math.max(0,this.reconnectDelay_-e);n=Math.random()*n,this.log_("Trying to reconnect in "+n+"ms"),this.scheduleConnect_(n),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*JQ)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),i=this.id+":"+Ni.nextConnectionId_++,s=this.lastSessionId;let o=!1,a=null;const l=function(){a?a.close():(o=!0,r())},u=function(h){V(a,"sendRequest call when we're not connected not allowed."),a.sendRequest(h)};this.realtime_={close:l,sendRequest:u};const c=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[h,f]=await Promise.all([this.authTokenProvider_.getToken(c),this.appCheckTokenProvider_.getToken(c)]);o?xt("getToken() completed but was canceled"):(xt("getToken() completed. Creating connection."),this.authToken_=h&&h.accessToken,this.appCheckToken_=f&&f.token,a=new WQ(i,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,n,r,g=>{rn(g+" ("+this.repoInfo_.toString()+")"),this.interrupt(eY)},s))}catch(h){this.log_("Failed to get token: "+h),o||(this.repoInfo_.nodeAdmin&&rn(h),l())}}}interrupt(e){xt("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){xt("Resuming connection for reason: "+e),delete this.interruptReasons_[e],Rp(this.interruptReasons_)&&(this.reconnectDelay_=Ku,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const n=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:n})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const n=this.outstandingPuts_[e];n&&"h"in n.request&&n.queued&&(n.onComplete&&n.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,n){let r;n?r=n.map(s=>dT(s)).join("$"):r="default";const i=this.removeListen_(e,r);i&&i.onComplete&&i.onComplete("permission_denied")}removeListen_(e,n){const r=new Se(e).toString();let i;if(this.listens.has(r)){const s=this.listens.get(r);i=s.get(n),s.delete(n),s.size===0&&this.listens.delete(r)}else i=void 0;return i}onAuthRevoked_(e,n){xt("Auth token revoked: "+e+"/"+n),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=vA&&(this.reconnectDelay_=yA,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,n){xt("App check token revoked: "+e+"/"+n),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=vA&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const n of e.values())this.sendListen_(n);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let n="js";e["sdk."+n+"."+a2.replace(/\./g,"-")]=1,p0()?e["framework.cordova"]=1:Bm()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=nm.getInstance().currentlyOnline();return Rp(this.interruptReasons_)&&e}}Ni.nextPersistentConnectionId_=0;Ni.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class he{constructor(e,n){this.name=e,this.node=n}static Wrap(e,n){return new he(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bg{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,n){const r=new he(zs,e),i=new he(zs,n);return this.compare(r,i)!==0}minPost(){return he.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let gf;class L2 extends Bg{static get __EMPTY_NODE(){return gf}static set __EMPTY_NODE(e){gf=e}compare(e,n){return wa(e.name,n.name)}isDefinedOn(e){throw tu("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,n){return!1}minPost(){return he.MIN}maxPost(){return new he($i,gf)}makePost(e,n){return V(typeof e=="string","KeyIndex indexValue must always be a string."),new he(e,gf)}toString(){return".key"}}const ri=new L2;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _f{constructor(e,n,r,i,s=null){this.isReverse_=i,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=n?r(e.key,n):1,i&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(e.key,e.value):n={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class kt{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??kt.RED,this.left=i??Nn.EMPTY_NODE,this.right=s??Nn.EMPTY_NODE}copy(e,n,r,i,s){return new kt(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const s=r(e,i.key);return s<0?i=i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i=i.copy(null,n,null,null,null):i=i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp_()}removeMin_(){if(this.left.isEmpty())return Nn.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,n){let r,i;if(r=this,n(e,r.key)<0)!r.left.isEmpty()&&!r.left.isRed_()&&!r.left.left.isRed_()&&(r=r.moveRedLeft_()),r=r.copy(null,null,null,r.left.remove(e,n),null);else{if(r.left.isRed_()&&(r=r.rotateRight_()),!r.right.isEmpty()&&!r.right.isRed_()&&!r.right.left.isRed_()&&(r=r.moveRedRight_()),n(e,r.key)===0){if(r.right.isEmpty())return Nn.EMPTY_NODE;i=r.right.min_(),r=r.copy(i.key,i.value,null,null,r.right.removeMin_())}r=r.copy(null,null,null,null,r.right.remove(e,n))}return r.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,kt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,kt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}kt.RED=!0;kt.BLACK=!1;class tY{copy(e,n,r,i,s){return this}insert(e,n,r){return new kt(e,n,null)}remove(e,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class Nn{constructor(e,n=Nn.EMPTY_NODE){this.comparator_=e,this.root_=n}insert(e,n){return new Nn(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,kt.BLACK,null,null))}remove(e){return new Nn(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,kt.BLACK,null,null))}get(e){let n,r=this.root_;for(;!r.isEmpty();){if(n=this.comparator_(e,r.key),n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}getPredecessorKey(e){let n,r=this.root_,i=null;for(;!r.isEmpty();)if(n=this.comparator_(e,r.key),n===0){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else n<0?r=r.left:n>0&&(i=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new _f(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,n){return new _f(this.root_,e,this.comparator_,!1,n)}getReverseIteratorFrom(e,n){return new _f(this.root_,e,this.comparator_,!0,n)}getReverseIterator(e){return new _f(this.root_,null,this.comparator_,!0,e)}}Nn.EMPTY_NODE=new tY;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nY(t,e){return wa(t.name,e.name)}function vT(t,e){return wa(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let zw;function rY(t){zw=t}const M2=function(t){return typeof t=="number"?"number:"+p2(t):"string:"+t},V2=function(t){if(t.isLeafNode()){const e=t.val();V(typeof e=="string"||typeof e=="number"||typeof e=="object"&&Qn(e,".sv"),"Priority must be a string or number.")}else V(t===zw||t.isEmpty(),"priority of unexpected type.");V(t===zw||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let wA;class St{constructor(e,n=St.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=n,this.lazyHash_=null,V(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),V2(this.priorityNode_)}static set __childrenNodeConstructor(e){wA=e}static get __childrenNodeConstructor(){return wA}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new St(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:St.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return ce(e)?this:ue(e)===".priority"?this.priorityNode_:St.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,n){return null}updateImmediateChild(e,n){return e===".priority"?this.updatePriority(n):n.isEmpty()&&e!==".priority"?this:St.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,n).updatePriority(this.priorityNode_)}updateChild(e,n){const r=ue(e);return r===null?n:n.isEmpty()&&r!==".priority"?this:(V(r!==".priority"||js(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(r,St.__childrenNodeConstructor.EMPTY_NODE.updateChild(ke(e),n)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,n){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+M2(this.priorityNode_.val())+":");const n=typeof this.value_;e+=n+":",n==="number"?e+=p2(this.value_):e+=this.value_,this.lazyHash_=h2(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===St.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof St.__childrenNodeConstructor?-1:(V(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const n=typeof e.value_,r=typeof this.value_,i=St.VALUE_TYPE_ORDER.indexOf(n),s=St.VALUE_TYPE_ORDER.indexOf(r);return V(i>=0,"Unknown leaf type: "+n),V(s>=0,"Unknown leaf type: "+r),i===s?r==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:s-i}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const n=e;return this.value_===n.value_&&this.priorityNode_.equals(n.priorityNode_)}else return!1}}St.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let F2,U2;function iY(t){F2=t}function sY(t){U2=t}class oY extends Bg{compare(e,n){const r=e.node.getPriority(),i=n.node.getPriority(),s=r.compareTo(i);return s===0?wa(e.name,n.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,n){return!e.getPriority().equals(n.getPriority())}minPost(){return he.MIN}maxPost(){return new he($i,new St("[PRIORITY-POST]",U2))}makePost(e,n){const r=F2(e);return new he(n,new St("[PRIORITY-POST]",r))}toString(){return".priority"}}const Oe=new oY;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aY=Math.log(2);class lY{constructor(e){const n=s=>parseInt(Math.log(s)/aY,10),r=s=>parseInt(Array(s+1).join("1"),2);this.count=n(e+1),this.current_=this.count-1;const i=r(this.count);this.bits_=e+1&i}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const rm=function(t,e,n,r){t.sort(e);const i=function(l,u){const c=u-l;let h,f;if(c===0)return null;if(c===1)return h=t[l],f=n?n(h):h,new kt(f,h.node,kt.BLACK,null,null);{const g=parseInt(c/2,10)+l,_=i(l,g),w=i(g+1,u);return h=t[g],f=n?n(h):h,new kt(f,h.node,kt.BLACK,_,w)}},s=function(l){let u=null,c=null,h=t.length;const f=function(_,w){const T=h-_,v=h;h-=_;const y=i(T+1,v),I=t[T],C=n?n(I):I;g(new kt(C,I.node,w,null,y))},g=function(_){u?(u.left=_,u=_):(c=_,u=_)};for(let _=0;_<l.count;++_){const w=l.nextBitIsOne(),T=Math.pow(2,l.count-(_+1));w?f(T,kt.BLACK):(f(T,kt.BLACK),f(T,kt.RED))}return c},o=new lY(t.length),a=s(o);return new Nn(r||e,a)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ny;const Da={};class Ri{constructor(e,n){this.indexes_=e,this.indexSet_=n}static get Default(){return V(Da&&Oe,"ChildrenNode.ts has not been loaded"),Ny=Ny||new Ri({".priority":Da},{".priority":Oe}),Ny}get(e){const n=Ho(this.indexes_,e);if(!n)throw new Error("No index defined for "+e);return n instanceof Nn?n:null}hasIndex(e){return Qn(this.indexSet_,e.toString())}addIndex(e,n){V(e!==ri,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const r=[];let i=!1;const s=n.getIterator(he.Wrap);let o=s.getNext();for(;o;)i=i||e.isDefinedOn(o.node),r.push(o),o=s.getNext();let a;i?a=rm(r,e.getCompare()):a=Da;const l=e.toString(),u=Object.assign({},this.indexSet_);u[l]=e;const c=Object.assign({},this.indexes_);return c[l]=a,new Ri(c,u)}addToIndexes(e,n){const r=Ap(this.indexes_,(i,s)=>{const o=Ho(this.indexSet_,s);if(V(o,"Missing index implementation for "+s),i===Da)if(o.isDefinedOn(e.node)){const a=[],l=n.getIterator(he.Wrap);let u=l.getNext();for(;u;)u.name!==e.name&&a.push(u),u=l.getNext();return a.push(e),rm(a,o.getCompare())}else return Da;else{const a=n.get(e.name);let l=i;return a&&(l=l.remove(new he(e.name,a))),l.insert(e,e.node)}});return new Ri(r,this.indexSet_)}removeFromIndexes(e,n){const r=Ap(this.indexes_,i=>{if(i===Da)return i;{const s=n.get(e.name);return s?i.remove(new he(e.name,s)):i}});return new Ri(r,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Qu;class Z{constructor(e,n,r){this.children_=e,this.priorityNode_=n,this.indexMap_=r,this.lazyHash_=null,this.priorityNode_&&V2(this.priorityNode_),this.children_.isEmpty()&&V(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return Qu||(Qu=new Z(new Nn(vT),null,Ri.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Qu}updatePriority(e){return this.children_.isEmpty()?this:new Z(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const n=this.children_.get(e);return n===null?Qu:n}}getChild(e){const n=ue(e);return n===null?this:this.getImmediateChild(n).getChild(ke(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,n){if(V(n,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(n);{const r=new he(e,n);let i,s;n.isEmpty()?(i=this.children_.remove(e),s=this.indexMap_.removeFromIndexes(r,this.children_)):(i=this.children_.insert(e,n),s=this.indexMap_.addToIndexes(r,this.children_));const o=i.isEmpty()?Qu:this.priorityNode_;return new Z(i,o,s)}}updateChild(e,n){const r=ue(e);if(r===null)return n;{V(ue(e)!==".priority"||js(e)===1,".priority must be the last token in a path");const i=this.getImmediateChild(r).updateChild(ke(e),n);return this.updateImmediateChild(r,i)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const n={};let r=0,i=0,s=!0;if(this.forEachChild(Oe,(o,a)=>{n[o]=a.val(e),r++,s&&Z.INTEGER_REGEXP_.test(o)?i=Math.max(i,Number(o)):s=!1}),!e&&s&&i<2*r){const o=[];for(const a in n)o[a]=n[a];return o}else return e&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+M2(this.getPriority().val())+":"),this.forEachChild(Oe,(n,r)=>{const i=r.hash();i!==""&&(e+=":"+n+":"+i)}),this.lazyHash_=e===""?"":h2(e)}return this.lazyHash_}getPredecessorChildName(e,n,r){const i=this.resolveIndex_(r);if(i){const s=i.getPredecessorKey(new he(e,n));return s?s.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const n=this.resolveIndex_(e);if(n){const r=n.minKey();return r&&r.name}else return this.children_.minKey()}getFirstChild(e){const n=this.getFirstChildName(e);return n?new he(n,this.children_.get(n)):null}getLastChildName(e){const n=this.resolveIndex_(e);if(n){const r=n.maxKey();return r&&r.name}else return this.children_.maxKey()}getLastChild(e){const n=this.getLastChildName(e);return n?new he(n,this.children_.get(n)):null}forEachChild(e,n){const r=this.resolveIndex_(e);return r?r.inorderTraversal(i=>n(i.name,i.node)):this.children_.inorderTraversal(n)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,n){const r=this.resolveIndex_(n);if(r)return r.getIteratorFrom(e,i=>i);{const i=this.children_.getIteratorFrom(e.name,he.Wrap);let s=i.peek();for(;s!=null&&n.compare(s,e)<0;)i.getNext(),s=i.peek();return i}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,n){const r=this.resolveIndex_(n);if(r)return r.getReverseIteratorFrom(e,i=>i);{const i=this.children_.getReverseIteratorFrom(e.name,he.Wrap);let s=i.peek();for(;s!=null&&n.compare(s,e)>0;)i.getNext(),s=i.peek();return i}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===Td?-1:0}withIndex(e){if(e===ri||this.indexMap_.hasIndex(e))return this;{const n=this.indexMap_.addIndex(e,this.children_);return new Z(this.children_,this.priorityNode_,n)}}isIndexed(e){return e===ri||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const n=e;if(this.getPriority().equals(n.getPriority()))if(this.children_.count()===n.children_.count()){const r=this.getIterator(Oe),i=n.getIterator(Oe);let s=r.getNext(),o=i.getNext();for(;s&&o;){if(s.name!==o.name||!s.node.equals(o.node))return!1;s=r.getNext(),o=i.getNext()}return s===null&&o===null}else return!1;else return!1}}resolveIndex_(e){return e===ri?null:this.indexMap_.get(e.toString())}}Z.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class uY extends Z{constructor(){super(new Nn(vT),Z.EMPTY_NODE,Ri.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return Z.EMPTY_NODE}isEmpty(){return!1}}const Td=new uY;Object.defineProperties(he,{MIN:{value:new he(zs,Z.EMPTY_NODE)},MAX:{value:new he($i,Td)}});L2.__EMPTY_NODE=Z.EMPTY_NODE;St.__childrenNodeConstructor=Z;rY(Td);sY(Td);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cY=!0;function Qe(t,e=null){if(t===null)return Z.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),V(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){const n=t;return new St(n,Qe(e))}if(!(t instanceof Array)&&cY){const n=[];let r=!1;if(Lt(t,(o,a)=>{if(o.substring(0,1)!=="."){const l=Qe(a);l.isEmpty()||(r=r||!l.getPriority().isEmpty(),n.push(new he(o,l)))}}),n.length===0)return Z.EMPTY_NODE;const s=rm(n,nY,o=>o.name,vT);if(r){const o=rm(n,Oe.getCompare());return new Z(s,Qe(e),new Ri({".priority":o},{".priority":Oe}))}else return new Z(s,Qe(e),Ri.Default)}else{let n=Z.EMPTY_NODE;return Lt(t,(r,i)=>{if(Qn(t,r)&&r.substring(0,1)!=="."){const s=Qe(i);(s.isLeafNode()||!s.isEmpty())&&(n=n.updateImmediateChild(r,s))}}),n.updatePriority(Qe(e))}}iY(Qe);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wT extends Bg{constructor(e){super(),this.indexPath_=e,V(!ce(e)&&ue(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,n){const r=this.extractChild(e.node),i=this.extractChild(n.node),s=r.compareTo(i);return s===0?wa(e.name,n.name):s}makePost(e,n){const r=Qe(e),i=Z.EMPTY_NODE.updateChild(this.indexPath_,r);return new he(n,i)}maxPost(){const e=Z.EMPTY_NODE.updateChild(this.indexPath_,Td);return new he($i,e)}toString(){return xh(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hY extends Bg{compare(e,n){const r=e.node.compareTo(n.node);return r===0?wa(e.name,n.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,n){return!e.equals(n)}minPost(){return he.MIN}maxPost(){return he.MAX}makePost(e,n){const r=Qe(e);return new he(n,r)}toString(){return".value"}}const ET=new hY;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $2(t){return{type:"value",snapshotNode:t}}function Wl(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function Nh(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function Dh(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}function dY(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IT{constructor(e){this.index_=e}updateChild(e,n,r,i,s,o){V(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const a=e.getImmediateChild(n);return a.getChild(i).equals(r.getChild(i))&&a.isEmpty()===r.isEmpty()||(o!=null&&(r.isEmpty()?e.hasChild(n)?o.trackChildChange(Nh(n,a)):V(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(Wl(n,r)):o.trackChildChange(Dh(n,r,a))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(n,r).withIndex(this.index_)}updateFullNode(e,n,r){return r!=null&&(e.isLeafNode()||e.forEachChild(Oe,(i,s)=>{n.hasChild(i)||r.trackChildChange(Nh(i,s))}),n.isLeafNode()||n.forEachChild(Oe,(i,s)=>{if(e.hasChild(i)){const o=e.getImmediateChild(i);o.equals(s)||r.trackChildChange(Dh(i,s,o))}else r.trackChildChange(Wl(i,s))})),n.withIndex(this.index_)}updatePriority(e,n){return e.isEmpty()?Z.EMPTY_NODE:e.updatePriority(n)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oh{constructor(e){this.indexedFilter_=new IT(e.getIndex()),this.index_=e.getIndex(),this.startPost_=Oh.getStartPost_(e),this.endPost_=Oh.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const n=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,r=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return n&&r}updateChild(e,n,r,i,s,o){return this.matches(new he(n,r))||(r=Z.EMPTY_NODE),this.indexedFilter_.updateChild(e,n,r,i,s,o)}updateFullNode(e,n,r){n.isLeafNode()&&(n=Z.EMPTY_NODE);let i=n.withIndex(this.index_);i=i.updatePriority(Z.EMPTY_NODE);const s=this;return n.forEachChild(Oe,(o,a)=>{s.matches(new he(o,a))||(i=i.updateImmediateChild(o,Z.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const n=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),n)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const n=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),n)}else return e.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fY{constructor(e){this.withinDirectionalStart=n=>this.reverse_?this.withinEndPost(n):this.withinStartPost(n),this.withinDirectionalEnd=n=>this.reverse_?this.withinStartPost(n):this.withinEndPost(n),this.withinStartPost=n=>{const r=this.index_.compare(this.rangedFilter_.getStartPost(),n);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=n=>{const r=this.index_.compare(n,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new Oh(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,n,r,i,s,o){return this.rangedFilter_.matches(new he(n,r))||(r=Z.EMPTY_NODE),e.getImmediateChild(n).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,n,r,i,s,o):this.fullLimitUpdateChild_(e,n,r,s,o)}updateFullNode(e,n,r){let i;if(n.isLeafNode()||n.isEmpty())i=Z.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<n.numChildren()&&n.isIndexed(this.index_)){i=Z.EMPTY_NODE.withIndex(this.index_);let s;this.reverse_?s=n.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):s=n.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;s.hasNext()&&o<this.limit_;){const a=s.getNext();if(this.withinDirectionalStart(a))if(this.withinDirectionalEnd(a))i=i.updateImmediateChild(a.name,a.node),o++;else break;else continue}}else{i=n.withIndex(this.index_),i=i.updatePriority(Z.EMPTY_NODE);let s;this.reverse_?s=i.getReverseIterator(this.index_):s=i.getIterator(this.index_);let o=0;for(;s.hasNext();){const a=s.getNext();o<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?o++:i=i.updateImmediateChild(a.name,Z.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,n,r,i,s){let o;if(this.reverse_){const h=this.index_.getCompare();o=(f,g)=>h(g,f)}else o=this.index_.getCompare();const a=e;V(a.numChildren()===this.limit_,"");const l=new he(n,r),u=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),c=this.rangedFilter_.matches(l);if(a.hasChild(n)){const h=a.getImmediateChild(n);let f=i.getChildAfterChild(this.index_,u,this.reverse_);for(;f!=null&&(f.name===n||a.hasChild(f.name));)f=i.getChildAfterChild(this.index_,f,this.reverse_);const g=f==null?1:o(f,l);if(c&&!r.isEmpty()&&g>=0)return s!=null&&s.trackChildChange(Dh(n,r,h)),a.updateImmediateChild(n,r);{s!=null&&s.trackChildChange(Nh(n,h));const w=a.updateImmediateChild(n,Z.EMPTY_NODE);return f!=null&&this.rangedFilter_.matches(f)?(s!=null&&s.trackChildChange(Wl(f.name,f.node)),w.updateImmediateChild(f.name,f.node)):w}}else return r.isEmpty()?e:c&&o(u,l)>=0?(s!=null&&(s.trackChildChange(Nh(u.name,u.node)),s.trackChildChange(Wl(n,r))),a.updateImmediateChild(n,r).updateImmediateChild(u.name,Z.EMPTY_NODE)):e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zg{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Oe}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return V(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return V(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:zs}hasEnd(){return this.endSet_}getIndexEndValue(){return V(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return V(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:$i}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return V(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Oe}copy(){const e=new zg;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function pY(t){return t.loadsAllData()?new IT(t.getIndex()):t.hasLimit()?new fY(t):new Oh(t)}function mY(t,e){const n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="l",n}function gY(t,e){const n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="r",n}function jw(t,e,n){const r=t.copy();return r.startSet_=!0,e===void 0&&(e=null),r.indexStartValue_=e,n!=null?(r.startNameSet_=!0,r.indexStartName_=n):(r.startNameSet_=!1,r.indexStartName_=""),r}function _Y(t,e,n){let r;return t.index_===ri||n?r=jw(t,e,n):r=jw(t,e,$i),r.startAfterSet_=!0,r}function qw(t,e,n){const r=t.copy();return r.endSet_=!0,e===void 0&&(e=null),r.indexEndValue_=e,n!==void 0?(r.endNameSet_=!0,r.indexEndName_=n):(r.endNameSet_=!1,r.indexEndName_=""),r}function yY(t,e,n){let r;return t.index_===ri||n?r=qw(t,e,n):r=qw(t,e,zs),r.endBeforeSet_=!0,r}function jg(t,e){const n=t.copy();return n.index_=e,n}function EA(t){const e={};if(t.isDefault())return e;let n;if(t.index_===Oe?n="$priority":t.index_===ET?n="$value":t.index_===ri?n="$key":(V(t.index_ instanceof wT,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=Et(n),t.startSet_){const r=t.startAfterSet_?"startAfter":"startAt";e[r]=Et(t.indexStartValue_),t.startNameSet_&&(e[r]+=","+Et(t.indexStartName_))}if(t.endSet_){const r=t.endBeforeSet_?"endBefore":"endAt";e[r]=Et(t.indexEndValue_),t.endNameSet_&&(e[r]+=","+Et(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function IA(t){const e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_),e.sin=!t.startAfterSet_),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_),e.ein=!t.endBeforeSet_),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;n===""&&(t.isViewFromLeft()?n="l":n="r"),e.vf=n}return t.index_!==Oe&&(e.i=t.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class im extends x2{constructor(e,n,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=n,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=Id("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,n){return n!==void 0?"tag$"+n:(V(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,n,r,i){const s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);const o=im.getListenId_(e,r),a={};this.listens_[o]=a;const l=EA(e._queryParams);this.restRequest_(s+".json",l,(u,c)=>{let h=c;if(u===404&&(h=null,u=null),u===null&&this.onDataUpdate_(s,h,!1,r),Ho(this.listens_,o)===a){let f;u?u===401?f="permission_denied":f="rest_error:"+u:f="ok",i(f,null)}})}unlisten(e,n){const r=im.getListenId_(e,n);delete this.listens_[r]}get(e){const n=EA(e._queryParams),r=e._path.toString(),i=new Rn;return this.restRequest_(r+".json",n,(s,o)=>{let a=o;s===404&&(a=null,s=null),s===null?(this.onDataUpdate_(r,a,!1,null),i.resolve(a)):i.reject(new Error(a))}),i.promise}refreshAuthToken(e){}restRequest_(e,n={},r){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,s])=>{i&&i.accessToken&&(n.auth=i.accessToken),s&&s.token&&(n.ac=s.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+da(n);this.log_("Sending REST request for "+o);const a=new XMLHttpRequest;a.onreadystatechange=()=>{if(r&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let l=null;if(a.status>=200&&a.status<300){try{l=nh(a.responseText)}catch{rn("Failed to parse JSON response for "+o+": "+a.responseText)}r(null,l)}else a.status!==401&&a.status!==404&&rn("Got unsuccessful REST response for "+o+" Status: "+a.status),r(a.status);r=null}},a.open("GET",o,!0),a.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vY{constructor(){this.rootNode_=Z.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,n){this.rootNode_=this.rootNode_.updateChild(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sm(){return{value:null,children:new Map}}function vu(t,e,n){if(ce(e))t.value=n,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,n);else{const r=ue(e);t.children.has(r)||t.children.set(r,sm());const i=t.children.get(r);e=ke(e),vu(i,e,n)}}function Ww(t,e){if(ce(e))return t.value=null,t.children.clear(),!0;if(t.value!==null){if(t.value.isLeafNode())return!1;{const n=t.value;return t.value=null,n.forEachChild(Oe,(r,i)=>{vu(t,new Se(r),i)}),Ww(t,e)}}else if(t.children.size>0){const n=ue(e);return e=ke(e),t.children.has(n)&&Ww(t.children.get(n),e)&&t.children.delete(n),t.children.size===0}else return!0}function Hw(t,e,n){t.value!==null?n(e,t.value):wY(t,(r,i)=>{const s=new Se(e.toString()+"/"+r);Hw(i,s,n)})}function wY(t,e){t.children.forEach((n,r)=>{e(r,n)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EY{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),n=Object.assign({},e);return this.last_&&Lt(this.last_,(r,i)=>{n[r]=n[r]-i}),this.last_=e,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TA=10*1e3,IY=30*1e3,TY=5*60*1e3;class SY{constructor(e,n){this.server_=n,this.statsToReport_={},this.statsListener_=new EY(e);const r=TA+(IY-TA)*Math.random();xc(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){const e=this.statsListener_.get(),n={};let r=!1;Lt(e,(i,s)=>{s>0&&Qn(this.statsToReport_,i)&&(n[i]=s,r=!0)}),r&&this.server_.reportStats(n),xc(this.reportStats_.bind(this),Math.floor(Math.random()*2*TY))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ar;(function(t){t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(Ar||(Ar={}));function TT(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function ST(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function CT(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class om{constructor(e,n,r){this.path=e,this.affectedTree=n,this.revert=r,this.type=Ar.ACK_USER_WRITE,this.source=TT()}operationForChild(e){if(ce(this.path)){if(this.affectedTree.value!=null)return V(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const n=this.affectedTree.subtree(new Se(e));return new om(Ee(),n,this.revert)}}else return V(ue(this.path)===e,"operationForChild called for unrelated child."),new om(ke(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lh{constructor(e,n){this.source=e,this.path=n,this.type=Ar.LISTEN_COMPLETE}operationForChild(e){return ce(this.path)?new Lh(this.source,Ee()):new Lh(this.source,ke(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oa{constructor(e,n,r){this.source=e,this.path=n,this.snap=r,this.type=Ar.OVERWRITE}operationForChild(e){return ce(this.path)?new oa(this.source,Ee(),this.snap.getImmediateChild(e)):new oa(this.source,ke(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hl{constructor(e,n,r){this.source=e,this.path=n,this.children=r,this.type=Ar.MERGE}operationForChild(e){if(ce(this.path)){const n=this.children.subtree(new Se(e));return n.isEmpty()?null:n.value?new oa(this.source,Ee(),n.value):new Hl(this.source,Ee(),n)}else return V(ue(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new Hl(this.source,ke(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qs{constructor(e,n,r){this.node_=e,this.fullyInitialized_=n,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(ce(e))return this.isFullyInitialized()&&!this.filtered_;const n=ue(e);return this.isCompleteForChild(n)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CY{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function RY(t,e,n,r){const i=[],s=[];return e.forEach(o=>{o.type==="child_changed"&&t.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(dY(o.childName,o.snapshotNode))}),Yu(t,i,"child_removed",e,r,n),Yu(t,i,"child_added",e,r,n),Yu(t,i,"child_moved",s,r,n),Yu(t,i,"child_changed",e,r,n),Yu(t,i,"value",e,r,n),i}function Yu(t,e,n,r,i,s){const o=r.filter(a=>a.type===n);o.sort((a,l)=>PY(t,a,l)),o.forEach(a=>{const l=AY(t,a,s);i.forEach(u=>{u.respondsTo(a.type)&&e.push(u.createEvent(l,t.query_))})})}function AY(t,e,n){return e.type==="value"||e.type==="child_removed"||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function PY(t,e,n){if(e.childName==null||n.childName==null)throw tu("Should only compare child_ events.");const r=new he(e.childName,e.snapshotNode),i=new he(n.childName,n.snapshotNode);return t.index_.compare(r,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qg(t,e){return{eventCache:t,serverCache:e}}function Nc(t,e,n,r){return qg(new qs(e,n,r),t.serverCache)}function B2(t,e,n,r){return qg(t.eventCache,new qs(e,n,r))}function am(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function aa(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Dy;const bY=()=>(Dy||(Dy=new Nn(hQ)),Dy);class Ne{constructor(e,n=bY()){this.value=e,this.children=n}static fromObject(e){let n=new Ne(null);return Lt(e,(r,i)=>{n=n.set(new Se(r),i)}),n}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,n){if(this.value!=null&&n(this.value))return{path:Ee(),value:this.value};if(ce(e))return null;{const r=ue(e),i=this.children.get(r);if(i!==null){const s=i.findRootMostMatchingPathAndValue(ke(e),n);return s!=null?{path:We(new Se(r),s.path),value:s.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(ce(e))return this;{const n=ue(e),r=this.children.get(n);return r!==null?r.subtree(ke(e)):new Ne(null)}}set(e,n){if(ce(e))return new Ne(n,this.children);{const r=ue(e),s=(this.children.get(r)||new Ne(null)).set(ke(e),n),o=this.children.insert(r,s);return new Ne(this.value,o)}}remove(e){if(ce(e))return this.children.isEmpty()?new Ne(null):new Ne(null,this.children);{const n=ue(e),r=this.children.get(n);if(r){const i=r.remove(ke(e));let s;return i.isEmpty()?s=this.children.remove(n):s=this.children.insert(n,i),this.value===null&&s.isEmpty()?new Ne(null):new Ne(this.value,s)}else return this}}get(e){if(ce(e))return this.value;{const n=ue(e),r=this.children.get(n);return r?r.get(ke(e)):null}}setTree(e,n){if(ce(e))return n;{const r=ue(e),s=(this.children.get(r)||new Ne(null)).setTree(ke(e),n);let o;return s.isEmpty()?o=this.children.remove(r):o=this.children.insert(r,s),new Ne(this.value,o)}}fold(e){return this.fold_(Ee(),e)}fold_(e,n){const r={};return this.children.inorderTraversal((i,s)=>{r[i]=s.fold_(We(e,i),n)}),n(e,this.value,r)}findOnPath(e,n){return this.findOnPath_(e,Ee(),n)}findOnPath_(e,n,r){const i=this.value?r(n,this.value):!1;if(i)return i;if(ce(e))return null;{const s=ue(e),o=this.children.get(s);return o?o.findOnPath_(ke(e),We(n,s),r):null}}foreachOnPath(e,n){return this.foreachOnPath_(e,Ee(),n)}foreachOnPath_(e,n,r){if(ce(e))return this;{this.value&&r(n,this.value);const i=ue(e),s=this.children.get(i);return s?s.foreachOnPath_(ke(e),We(n,i),r):new Ne(null)}}foreach(e){this.foreach_(Ee(),e)}foreach_(e,n){this.children.inorderTraversal((r,i)=>{i.foreach_(We(e,r),n)}),this.value&&n(e,this.value)}foreachChild(e){this.children.inorderTraversal((n,r)=>{r.value&&e(n,r.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xr{constructor(e){this.writeTree_=e}static empty(){return new xr(new Ne(null))}}function Dc(t,e,n){if(ce(e))return new xr(new Ne(n));{const r=t.writeTree_.findRootMostValueAndPath(e);if(r!=null){const i=r.path;let s=r.value;const o=pn(i,e);return s=s.updateChild(o,n),new xr(t.writeTree_.set(i,s))}else{const i=new Ne(n),s=t.writeTree_.setTree(e,i);return new xr(s)}}}function Gw(t,e,n){let r=t;return Lt(n,(i,s)=>{r=Dc(r,We(e,i),s)}),r}function SA(t,e){if(ce(e))return xr.empty();{const n=t.writeTree_.setTree(e,new Ne(null));return new xr(n)}}function Kw(t,e){return Ea(t,e)!=null}function Ea(t,e){const n=t.writeTree_.findRootMostValueAndPath(e);return n!=null?t.writeTree_.get(n.path).getChild(pn(n.path,e)):null}function CA(t){const e=[],n=t.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild(Oe,(r,i)=>{e.push(new he(r,i))}):t.writeTree_.children.inorderTraversal((r,i)=>{i.value!=null&&e.push(new he(r,i.value))}),e}function Cs(t,e){if(ce(e))return t;{const n=Ea(t,e);return n!=null?new xr(new Ne(n)):new xr(t.writeTree_.subtree(e))}}function Qw(t){return t.writeTree_.isEmpty()}function Gl(t,e){return z2(Ee(),t.writeTree_,e)}function z2(t,e,n){if(e.value!=null)return n.updateChild(t,e.value);{let r=null;return e.children.inorderTraversal((i,s)=>{i===".priority"?(V(s.value!==null,"Priority writes must always be leaf nodes"),r=s.value):n=z2(We(t,i),s,n)}),!n.getChild(t).isEmpty()&&r!==null&&(n=n.updateChild(We(t,".priority"),r)),n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wg(t,e){return H2(e,t)}function kY(t,e,n,r,i){V(r>t.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),t.allWrites.push({path:e,snap:n,writeId:r,visible:i}),i&&(t.visibleWrites=Dc(t.visibleWrites,e,n)),t.lastWriteId=r}function xY(t,e,n,r){V(r>t.lastWriteId,"Stacking an older merge on top of newer ones"),t.allWrites.push({path:e,children:n,writeId:r,visible:!0}),t.visibleWrites=Gw(t.visibleWrites,e,n),t.lastWriteId=r}function NY(t,e){for(let n=0;n<t.allWrites.length;n++){const r=t.allWrites[n];if(r.writeId===e)return r}return null}function DY(t,e){const n=t.allWrites.findIndex(a=>a.writeId===e);V(n>=0,"removeWrite called with nonexistent writeId.");const r=t.allWrites[n];t.allWrites.splice(n,1);let i=r.visible,s=!1,o=t.allWrites.length-1;for(;i&&o>=0;){const a=t.allWrites[o];a.visible&&(o>=n&&OY(a,r.path)?i=!1:ur(r.path,a.path)&&(s=!0)),o--}if(i){if(s)return LY(t),!0;if(r.snap)t.visibleWrites=SA(t.visibleWrites,r.path);else{const a=r.children;Lt(a,l=>{t.visibleWrites=SA(t.visibleWrites,We(r.path,l))})}return!0}else return!1}function OY(t,e){if(t.snap)return ur(t.path,e);for(const n in t.children)if(t.children.hasOwnProperty(n)&&ur(We(t.path,n),e))return!0;return!1}function LY(t){t.visibleWrites=j2(t.allWrites,MY,Ee()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function MY(t){return t.visible}function j2(t,e,n){let r=xr.empty();for(let i=0;i<t.length;++i){const s=t[i];if(e(s)){const o=s.path;let a;if(s.snap)ur(n,o)?(a=pn(n,o),r=Dc(r,a,s.snap)):ur(o,n)&&(a=pn(o,n),r=Dc(r,Ee(),s.snap.getChild(a)));else if(s.children){if(ur(n,o))a=pn(n,o),r=Gw(r,a,s.children);else if(ur(o,n))if(a=pn(o,n),ce(a))r=Gw(r,Ee(),s.children);else{const l=Ho(s.children,ue(a));if(l){const u=l.getChild(ke(a));r=Dc(r,Ee(),u)}}}else throw tu("WriteRecord should have .snap or .children")}}return r}function q2(t,e,n,r,i){if(!r&&!i){const s=Ea(t.visibleWrites,e);if(s!=null)return s;{const o=Cs(t.visibleWrites,e);if(Qw(o))return n;if(n==null&&!Kw(o,Ee()))return null;{const a=n||Z.EMPTY_NODE;return Gl(o,a)}}}else{const s=Cs(t.visibleWrites,e);if(!i&&Qw(s))return n;if(!i&&n==null&&!Kw(s,Ee()))return null;{const o=function(u){return(u.visible||i)&&(!r||!~r.indexOf(u.writeId))&&(ur(u.path,e)||ur(e,u.path))},a=j2(t.allWrites,o,e),l=n||Z.EMPTY_NODE;return Gl(a,l)}}}function VY(t,e,n){let r=Z.EMPTY_NODE;const i=Ea(t.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(Oe,(s,o)=>{r=r.updateImmediateChild(s,o)}),r;if(n){const s=Cs(t.visibleWrites,e);return n.forEachChild(Oe,(o,a)=>{const l=Gl(Cs(s,new Se(o)),a);r=r.updateImmediateChild(o,l)}),CA(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}else{const s=Cs(t.visibleWrites,e);return CA(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}}function FY(t,e,n,r,i){V(r||i,"Either existingEventSnap or existingServerSnap must exist");const s=We(e,n);if(Kw(t.visibleWrites,s))return null;{const o=Cs(t.visibleWrites,s);return Qw(o)?i.getChild(n):Gl(o,i.getChild(n))}}function UY(t,e,n,r){const i=We(e,n),s=Ea(t.visibleWrites,i);if(s!=null)return s;if(r.isCompleteForChild(n)){const o=Cs(t.visibleWrites,i);return Gl(o,r.getNode().getImmediateChild(n))}else return null}function $Y(t,e){return Ea(t.visibleWrites,e)}function BY(t,e,n,r,i,s,o){let a;const l=Cs(t.visibleWrites,e),u=Ea(l,Ee());if(u!=null)a=u;else if(n!=null)a=Gl(l,n);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){const c=[],h=o.getCompare(),f=s?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o);let g=f.getNext();for(;g&&c.length<i;)h(g,r)!==0&&c.push(g),g=f.getNext();return c}else return[]}function zY(){return{visibleWrites:xr.empty(),allWrites:[],lastWriteId:-1}}function lm(t,e,n,r){return q2(t.writeTree,t.treePath,e,n,r)}function RT(t,e){return VY(t.writeTree,t.treePath,e)}function RA(t,e,n,r){return FY(t.writeTree,t.treePath,e,n,r)}function um(t,e){return $Y(t.writeTree,We(t.treePath,e))}function jY(t,e,n,r,i,s){return BY(t.writeTree,t.treePath,e,n,r,i,s)}function AT(t,e,n){return UY(t.writeTree,t.treePath,e,n)}function W2(t,e){return H2(We(t.treePath,e),t.writeTree)}function H2(t,e){return{treePath:t,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qY{constructor(){this.changeMap=new Map}trackChildChange(e){const n=e.type,r=e.childName;V(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),V(r!==".priority","Only non-priority child changes can be tracked.");const i=this.changeMap.get(r);if(i){const s=i.type;if(n==="child_added"&&s==="child_removed")this.changeMap.set(r,Dh(r,e.snapshotNode,i.snapshotNode));else if(n==="child_removed"&&s==="child_added")this.changeMap.delete(r);else if(n==="child_removed"&&s==="child_changed")this.changeMap.set(r,Nh(r,i.oldSnap));else if(n==="child_changed"&&s==="child_added")this.changeMap.set(r,Wl(r,e.snapshotNode));else if(n==="child_changed"&&s==="child_changed")this.changeMap.set(r,Dh(r,e.snapshotNode,i.oldSnap));else throw tu("Illegal combination of changes: "+e+" occurred after "+i)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WY{getCompleteChild(e){return null}getChildAfterChild(e,n,r){return null}}const G2=new WY;class PT{constructor(e,n,r=null){this.writes_=e,this.viewCache_=n,this.optCompleteServerCache_=r}getCompleteChild(e){const n=this.viewCache_.eventCache;if(n.isCompleteForChild(e))return n.getNode().getImmediateChild(e);{const r=this.optCompleteServerCache_!=null?new qs(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return AT(this.writes_,e,r)}}getChildAfterChild(e,n,r){const i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:aa(this.viewCache_),s=jY(this.writes_,i,n,1,r,e);return s.length===0?null:s[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HY(t){return{filter:t}}function GY(t,e){V(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),V(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function KY(t,e,n,r,i){const s=new qY;let o,a;if(n.type===Ar.OVERWRITE){const u=n;u.source.fromUser?o=Yw(t,e,u.path,u.snap,r,i,s):(V(u.source.fromServer,"Unknown source."),a=u.source.tagged||e.serverCache.isFiltered()&&!ce(u.path),o=cm(t,e,u.path,u.snap,r,i,a,s))}else if(n.type===Ar.MERGE){const u=n;u.source.fromUser?o=YY(t,e,u.path,u.children,r,i,s):(V(u.source.fromServer,"Unknown source."),a=u.source.tagged||e.serverCache.isFiltered(),o=Xw(t,e,u.path,u.children,r,i,a,s))}else if(n.type===Ar.ACK_USER_WRITE){const u=n;u.revert?o=ZY(t,e,u.path,r,i,s):o=XY(t,e,u.path,u.affectedTree,r,i,s)}else if(n.type===Ar.LISTEN_COMPLETE)o=JY(t,e,n.path,r,s);else throw tu("Unknown operation type: "+n.type);const l=s.getChanges();return QY(e,o,l),{viewCache:o,changes:l}}function QY(t,e,n){const r=e.eventCache;if(r.isFullyInitialized()){const i=r.getNode().isLeafNode()||r.getNode().isEmpty(),s=am(t);(n.length>0||!t.eventCache.isFullyInitialized()||i&&!r.getNode().equals(s)||!r.getNode().getPriority().equals(s.getPriority()))&&n.push($2(am(e)))}}function K2(t,e,n,r,i,s){const o=e.eventCache;if(um(r,n)!=null)return e;{let a,l;if(ce(n))if(V(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const u=aa(e),c=u instanceof Z?u:Z.EMPTY_NODE,h=RT(r,c);a=t.filter.updateFullNode(e.eventCache.getNode(),h,s)}else{const u=lm(r,aa(e));a=t.filter.updateFullNode(e.eventCache.getNode(),u,s)}else{const u=ue(n);if(u===".priority"){V(js(n)===1,"Can't have a priority with additional path components");const c=o.getNode();l=e.serverCache.getNode();const h=RA(r,n,c,l);h!=null?a=t.filter.updatePriority(c,h):a=o.getNode()}else{const c=ke(n);let h;if(o.isCompleteForChild(u)){l=e.serverCache.getNode();const f=RA(r,n,o.getNode(),l);f!=null?h=o.getNode().getImmediateChild(u).updateChild(c,f):h=o.getNode().getImmediateChild(u)}else h=AT(r,u,e.serverCache);h!=null?a=t.filter.updateChild(o.getNode(),u,h,c,i,s):a=o.getNode()}}return Nc(e,a,o.isFullyInitialized()||ce(n),t.filter.filtersNodes())}}function cm(t,e,n,r,i,s,o,a){const l=e.serverCache;let u;const c=o?t.filter:t.filter.getIndexedFilter();if(ce(n))u=c.updateFullNode(l.getNode(),r,null);else if(c.filtersNodes()&&!l.isFiltered()){const g=l.getNode().updateChild(n,r);u=c.updateFullNode(l.getNode(),g,null)}else{const g=ue(n);if(!l.isCompleteForPath(n)&&js(n)>1)return e;const _=ke(n),T=l.getNode().getImmediateChild(g).updateChild(_,r);g===".priority"?u=c.updatePriority(l.getNode(),T):u=c.updateChild(l.getNode(),g,T,_,G2,null)}const h=B2(e,u,l.isFullyInitialized()||ce(n),c.filtersNodes()),f=new PT(i,h,s);return K2(t,h,n,i,f,a)}function Yw(t,e,n,r,i,s,o){const a=e.eventCache;let l,u;const c=new PT(i,e,s);if(ce(n))u=t.filter.updateFullNode(e.eventCache.getNode(),r,o),l=Nc(e,u,!0,t.filter.filtersNodes());else{const h=ue(n);if(h===".priority")u=t.filter.updatePriority(e.eventCache.getNode(),r),l=Nc(e,u,a.isFullyInitialized(),a.isFiltered());else{const f=ke(n),g=a.getNode().getImmediateChild(h);let _;if(ce(f))_=r;else{const w=c.getCompleteChild(h);w!=null?gT(f)===".priority"&&w.getChild(D2(f)).isEmpty()?_=w:_=w.updateChild(f,r):_=Z.EMPTY_NODE}if(g.equals(_))l=e;else{const w=t.filter.updateChild(a.getNode(),h,_,f,c,o);l=Nc(e,w,a.isFullyInitialized(),t.filter.filtersNodes())}}}return l}function AA(t,e){return t.eventCache.isCompleteForChild(e)}function YY(t,e,n,r,i,s,o){let a=e;return r.foreach((l,u)=>{const c=We(n,l);AA(e,ue(c))&&(a=Yw(t,a,c,u,i,s,o))}),r.foreach((l,u)=>{const c=We(n,l);AA(e,ue(c))||(a=Yw(t,a,c,u,i,s,o))}),a}function PA(t,e,n){return n.foreach((r,i)=>{e=e.updateChild(r,i)}),e}function Xw(t,e,n,r,i,s,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let l=e,u;ce(n)?u=r:u=new Ne(null).setTree(n,r);const c=e.serverCache.getNode();return u.children.inorderTraversal((h,f)=>{if(c.hasChild(h)){const g=e.serverCache.getNode().getImmediateChild(h),_=PA(t,g,f);l=cm(t,l,new Se(h),_,i,s,o,a)}}),u.children.inorderTraversal((h,f)=>{const g=!e.serverCache.isCompleteForChild(h)&&f.value===null;if(!c.hasChild(h)&&!g){const _=e.serverCache.getNode().getImmediateChild(h),w=PA(t,_,f);l=cm(t,l,new Se(h),w,i,s,o,a)}}),l}function XY(t,e,n,r,i,s,o){if(um(i,n)!=null)return e;const a=e.serverCache.isFiltered(),l=e.serverCache;if(r.value!=null){if(ce(n)&&l.isFullyInitialized()||l.isCompleteForPath(n))return cm(t,e,n,l.getNode().getChild(n),i,s,a,o);if(ce(n)){let u=new Ne(null);return l.getNode().forEachChild(ri,(c,h)=>{u=u.set(new Se(c),h)}),Xw(t,e,n,u,i,s,a,o)}else return e}else{let u=new Ne(null);return r.foreach((c,h)=>{const f=We(n,c);l.isCompleteForPath(f)&&(u=u.set(c,l.getNode().getChild(f)))}),Xw(t,e,n,u,i,s,a,o)}}function JY(t,e,n,r,i){const s=e.serverCache,o=B2(e,s.getNode(),s.isFullyInitialized()||ce(n),s.isFiltered());return K2(t,o,n,r,G2,i)}function ZY(t,e,n,r,i,s){let o;if(um(r,n)!=null)return e;{const a=new PT(r,e,i),l=e.eventCache.getNode();let u;if(ce(n)||ue(n)===".priority"){let c;if(e.serverCache.isFullyInitialized())c=lm(r,aa(e));else{const h=e.serverCache.getNode();V(h instanceof Z,"serverChildren would be complete if leaf node"),c=RT(r,h)}c=c,u=t.filter.updateFullNode(l,c,s)}else{const c=ue(n);let h=AT(r,c,e.serverCache);h==null&&e.serverCache.isCompleteForChild(c)&&(h=l.getImmediateChild(c)),h!=null?u=t.filter.updateChild(l,c,h,ke(n),a,s):e.eventCache.getNode().hasChild(c)?u=t.filter.updateChild(l,c,Z.EMPTY_NODE,ke(n),a,s):u=l,u.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=lm(r,aa(e)),o.isLeafNode()&&(u=t.filter.updateFullNode(u,o,s)))}return o=e.serverCache.isFullyInitialized()||um(r,Ee())!=null,Nc(e,u,o,t.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eX{constructor(e,n){this.query_=e,this.eventRegistrations_=[];const r=this.query_._queryParams,i=new IT(r.getIndex()),s=pY(r);this.processor_=HY(s);const o=n.serverCache,a=n.eventCache,l=i.updateFullNode(Z.EMPTY_NODE,o.getNode(),null),u=s.updateFullNode(Z.EMPTY_NODE,a.getNode(),null),c=new qs(l,o.isFullyInitialized(),i.filtersNodes()),h=new qs(u,a.isFullyInitialized(),s.filtersNodes());this.viewCache_=qg(h,c),this.eventGenerator_=new CY(this.query_)}get query(){return this.query_}}function tX(t){return t.viewCache_.serverCache.getNode()}function nX(t){return am(t.viewCache_)}function rX(t,e){const n=aa(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!ce(e)&&!n.getImmediateChild(ue(e)).isEmpty())?n.getChild(e):null}function bA(t){return t.eventRegistrations_.length===0}function iX(t,e){t.eventRegistrations_.push(e)}function kA(t,e,n){const r=[];if(n){V(e==null,"A cancel should cancel all event registrations.");const i=t.query._path;t.eventRegistrations_.forEach(s=>{const o=s.createCancelEvent(n,i);o&&r.push(o)})}if(e){let i=[];for(let s=0;s<t.eventRegistrations_.length;++s){const o=t.eventRegistrations_[s];if(!o.matches(e))i.push(o);else if(e.hasAnyCallback()){i=i.concat(t.eventRegistrations_.slice(s+1));break}}t.eventRegistrations_=i}else t.eventRegistrations_=[];return r}function xA(t,e,n,r){e.type===Ar.MERGE&&e.source.queryId!==null&&(V(aa(t.viewCache_),"We should always have a full cache before handling merges"),V(am(t.viewCache_),"Missing event cache, even though we have a server cache"));const i=t.viewCache_,s=KY(t.processor_,i,e,n,r);return GY(t.processor_,s.viewCache),V(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=s.viewCache,Q2(t,s.changes,s.viewCache.eventCache.getNode(),null)}function sX(t,e){const n=t.viewCache_.eventCache,r=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(Oe,(s,o)=>{r.push(Wl(s,o))}),n.isFullyInitialized()&&r.push($2(n.getNode())),Q2(t,r,n.getNode(),e)}function Q2(t,e,n,r){const i=r?[r]:t.eventRegistrations_;return RY(t.eventGenerator_,e,n,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let hm;class Y2{constructor(){this.views=new Map}}function oX(t){V(!hm,"__referenceConstructor has already been defined"),hm=t}function aX(){return V(hm,"Reference.ts has not been loaded"),hm}function lX(t){return t.views.size===0}function bT(t,e,n,r){const i=e.source.queryId;if(i!==null){const s=t.views.get(i);return V(s!=null,"SyncTree gave us an op for an invalid query."),xA(s,e,n,r)}else{let s=[];for(const o of t.views.values())s=s.concat(xA(o,e,n,r));return s}}function X2(t,e,n,r,i){const s=e._queryIdentifier,o=t.views.get(s);if(!o){let a=lm(n,i?r:null),l=!1;a?l=!0:r instanceof Z?(a=RT(n,r),l=!1):(a=Z.EMPTY_NODE,l=!1);const u=qg(new qs(a,l,!1),new qs(r,i,!1));return new eX(e,u)}return o}function uX(t,e,n,r,i,s){const o=X2(t,e,r,i,s);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,o),iX(o,n),sX(o,n)}function cX(t,e,n,r){const i=e._queryIdentifier,s=[];let o=[];const a=Ws(t);if(i==="default")for(const[l,u]of t.views.entries())o=o.concat(kA(u,n,r)),bA(u)&&(t.views.delete(l),u.query._queryParams.loadsAllData()||s.push(u.query));else{const l=t.views.get(i);l&&(o=o.concat(kA(l,n,r)),bA(l)&&(t.views.delete(i),l.query._queryParams.loadsAllData()||s.push(l.query)))}return a&&!Ws(t)&&s.push(new(aX())(e._repo,e._path)),{removed:s,events:o}}function J2(t){const e=[];for(const n of t.views.values())n.query._queryParams.loadsAllData()||e.push(n);return e}function Rs(t,e){let n=null;for(const r of t.views.values())n=n||rX(r,e);return n}function Z2(t,e){if(e._queryParams.loadsAllData())return Hg(t);{const r=e._queryIdentifier;return t.views.get(r)}}function eM(t,e){return Z2(t,e)!=null}function Ws(t){return Hg(t)!=null}function Hg(t){for(const e of t.views.values())if(e.query._queryParams.loadsAllData())return e;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let dm;function hX(t){V(!dm,"__referenceConstructor has already been defined"),dm=t}function dX(){return V(dm,"Reference.ts has not been loaded"),dm}let fX=1;class NA{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Ne(null),this.pendingWriteTree_=zY(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function kT(t,e,n,r,i){return kY(t.pendingWriteTree_,e,n,r,i),i?wu(t,new oa(TT(),e,n)):[]}function pX(t,e,n,r){xY(t.pendingWriteTree_,e,n,r);const i=Ne.fromObject(n);return wu(t,new Hl(TT(),e,i))}function ds(t,e,n=!1){const r=NY(t.pendingWriteTree_,e);if(DY(t.pendingWriteTree_,e)){let s=new Ne(null);return r.snap!=null?s=s.set(Ee(),!0):Lt(r.children,o=>{s=s.set(new Se(o),!0)}),wu(t,new om(r.path,s,n))}else return[]}function Sd(t,e,n){return wu(t,new oa(ST(),e,n))}function mX(t,e,n){const r=Ne.fromObject(n);return wu(t,new Hl(ST(),e,r))}function gX(t,e){return wu(t,new Lh(ST(),e))}function _X(t,e,n){const r=xT(t,n);if(r){const i=NT(r),s=i.path,o=i.queryId,a=pn(s,e),l=new Lh(CT(o),a);return DT(t,s,l)}else return[]}function fm(t,e,n,r,i=!1){const s=e._path,o=t.syncPointTree_.get(s);let a=[];if(o&&(e._queryIdentifier==="default"||eM(o,e))){const l=cX(o,e,n,r);lX(o)&&(t.syncPointTree_=t.syncPointTree_.remove(s));const u=l.removed;if(a=l.events,!i){const c=u.findIndex(f=>f._queryParams.loadsAllData())!==-1,h=t.syncPointTree_.findOnPath(s,(f,g)=>Ws(g));if(c&&!h){const f=t.syncPointTree_.subtree(s);if(!f.isEmpty()){const g=wX(f);for(let _=0;_<g.length;++_){const w=g[_],T=w.query,v=iM(t,w);t.listenProvider_.startListening(Oc(T),Mh(t,T),v.hashFn,v.onComplete)}}}!h&&u.length>0&&!r&&(c?t.listenProvider_.stopListening(Oc(e),null):u.forEach(f=>{const g=t.queryToTagMap.get(Kg(f));t.listenProvider_.stopListening(Oc(f),g)}))}EX(t,u)}return a}function tM(t,e,n,r){const i=xT(t,r);if(i!=null){const s=NT(i),o=s.path,a=s.queryId,l=pn(o,e),u=new oa(CT(a),l,n);return DT(t,o,u)}else return[]}function yX(t,e,n,r){const i=xT(t,r);if(i){const s=NT(i),o=s.path,a=s.queryId,l=pn(o,e),u=Ne.fromObject(n),c=new Hl(CT(a),l,u);return DT(t,o,c)}else return[]}function Jw(t,e,n,r=!1){const i=e._path;let s=null,o=!1;t.syncPointTree_.foreachOnPath(i,(f,g)=>{const _=pn(f,i);s=s||Rs(g,_),o=o||Ws(g)});let a=t.syncPointTree_.get(i);a?(o=o||Ws(a),s=s||Rs(a,Ee())):(a=new Y2,t.syncPointTree_=t.syncPointTree_.set(i,a));let l;s!=null?l=!0:(l=!1,s=Z.EMPTY_NODE,t.syncPointTree_.subtree(i).foreachChild((g,_)=>{const w=Rs(_,Ee());w&&(s=s.updateImmediateChild(g,w))}));const u=eM(a,e);if(!u&&!e._queryParams.loadsAllData()){const f=Kg(e);V(!t.queryToTagMap.has(f),"View does not exist, but we have a tag");const g=IX();t.queryToTagMap.set(f,g),t.tagToQueryMap.set(g,f)}const c=Wg(t.pendingWriteTree_,i);let h=uX(a,e,n,c,s,l);if(!u&&!o&&!r){const f=Z2(a,e);h=h.concat(TX(t,e,f))}return h}function Gg(t,e,n){const i=t.pendingWriteTree_,s=t.syncPointTree_.findOnPath(e,(o,a)=>{const l=pn(o,e),u=Rs(a,l);if(u)return u});return q2(i,e,s,n,!0)}function vX(t,e){const n=e._path;let r=null;t.syncPointTree_.foreachOnPath(n,(u,c)=>{const h=pn(u,n);r=r||Rs(c,h)});let i=t.syncPointTree_.get(n);i?r=r||Rs(i,Ee()):(i=new Y2,t.syncPointTree_=t.syncPointTree_.set(n,i));const s=r!=null,o=s?new qs(r,!0,!1):null,a=Wg(t.pendingWriteTree_,e._path),l=X2(i,e,a,s?o.getNode():Z.EMPTY_NODE,s);return nX(l)}function wu(t,e){return nM(e,t.syncPointTree_,null,Wg(t.pendingWriteTree_,Ee()))}function nM(t,e,n,r){if(ce(t.path))return rM(t,e,n,r);{const i=e.get(Ee());n==null&&i!=null&&(n=Rs(i,Ee()));let s=[];const o=ue(t.path),a=t.operationForChild(o),l=e.children.get(o);if(l&&a){const u=n?n.getImmediateChild(o):null,c=W2(r,o);s=s.concat(nM(a,l,u,c))}return i&&(s=s.concat(bT(i,t,r,n))),s}}function rM(t,e,n,r){const i=e.get(Ee());n==null&&i!=null&&(n=Rs(i,Ee()));let s=[];return e.children.inorderTraversal((o,a)=>{const l=n?n.getImmediateChild(o):null,u=W2(r,o),c=t.operationForChild(o);c&&(s=s.concat(rM(c,a,l,u)))}),i&&(s=s.concat(bT(i,t,r,n))),s}function iM(t,e){const n=e.query,r=Mh(t,n);return{hashFn:()=>(tX(e)||Z.EMPTY_NODE).hash(),onComplete:i=>{if(i==="ok")return r?_X(t,n._path,r):gX(t,n._path);{const s=pQ(i,n);return fm(t,n,null,s)}}}}function Mh(t,e){const n=Kg(e);return t.queryToTagMap.get(n)}function Kg(t){return t._path.toString()+"$"+t._queryIdentifier}function xT(t,e){return t.tagToQueryMap.get(e)}function NT(t){const e=t.indexOf("$");return V(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new Se(t.substr(0,e))}}function DT(t,e,n){const r=t.syncPointTree_.get(e);V(r,"Missing sync point for query tag that we're tracking");const i=Wg(t.pendingWriteTree_,e);return bT(r,n,i,null)}function wX(t){return t.fold((e,n,r)=>{if(n&&Ws(n))return[Hg(n)];{let i=[];return n&&(i=J2(n)),Lt(r,(s,o)=>{i=i.concat(o)}),i}})}function Oc(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(dX())(t._repo,t._path):t}function EX(t,e){for(let n=0;n<e.length;++n){const r=e[n];if(!r._queryParams.loadsAllData()){const i=Kg(r),s=t.queryToTagMap.get(i);t.queryToTagMap.delete(i),t.tagToQueryMap.delete(s)}}}function IX(){return fX++}function TX(t,e,n){const r=e._path,i=Mh(t,e),s=iM(t,n),o=t.listenProvider_.startListening(Oc(e),i,s.hashFn,s.onComplete),a=t.syncPointTree_.subtree(r);if(i)V(!Ws(a.value),"If we're adding a query, it shouldn't be shadowed");else{const l=a.fold((u,c,h)=>{if(!ce(u)&&c&&Ws(c))return[Hg(c).query];{let f=[];return c&&(f=f.concat(J2(c).map(g=>g.query))),Lt(h,(g,_)=>{f=f.concat(_)}),f}});for(let u=0;u<l.length;++u){const c=l[u];t.listenProvider_.stopListening(Oc(c),Mh(t,c))}}return o}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OT{constructor(e){this.node_=e}getImmediateChild(e){const n=this.node_.getImmediateChild(e);return new OT(n)}node(){return this.node_}}class LT{constructor(e,n){this.syncTree_=e,this.path_=n}getImmediateChild(e){const n=We(this.path_,e);return new LT(this.syncTree_,n)}node(){return Gg(this.syncTree_,this.path_)}}const SX=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},DA=function(t,e,n){if(!t||typeof t!="object")return t;if(V(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return CX(t[".sv"],e,n);if(typeof t[".sv"]=="object")return RX(t[".sv"],e);V(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},CX=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:V(!1,"Unexpected server value: "+t)}},RX=function(t,e,n){t.hasOwnProperty("increment")||V(!1,"Unexpected server value: "+JSON.stringify(t,null,2));const r=t.increment;typeof r!="number"&&V(!1,"Unexpected increment value: "+r);const i=e.node();if(V(i!==null&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;const o=i.getValue();return typeof o!="number"?r:o+r},sM=function(t,e,n,r){return VT(e,new LT(n,t),r)},MT=function(t,e,n){return VT(t,new OT(e),n)};function VT(t,e,n){const r=t.getPriority().val(),i=DA(r,e.getImmediateChild(".priority"),n);let s;if(t.isLeafNode()){const o=t,a=DA(o.getValue(),e,n);return a!==o.getValue()||i!==o.getPriority().val()?new St(a,Qe(i)):t}else{const o=t;return s=o,i!==o.getPriority().val()&&(s=s.updatePriority(new St(i))),o.forEachChild(Oe,(a,l)=>{const u=VT(l,e.getImmediateChild(a),n);u!==l&&(s=s.updateImmediateChild(a,u))}),s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FT{constructor(e="",n=null,r={children:{},childCount:0}){this.name=e,this.parent=n,this.node=r}}function Qg(t,e){let n=e instanceof Se?e:new Se(e),r=t,i=ue(n);for(;i!==null;){const s=Ho(r.node.children,i)||{children:{},childCount:0};r=new FT(i,r,s),n=ke(n),i=ue(n)}return r}function Ia(t){return t.node.value}function UT(t,e){t.node.value=e,Zw(t)}function oM(t){return t.node.childCount>0}function AX(t){return Ia(t)===void 0&&!oM(t)}function Yg(t,e){Lt(t.node.children,(n,r)=>{e(new FT(n,t,r))})}function aM(t,e,n,r){n&&!r&&e(t),Yg(t,i=>{aM(i,e,!0,r)}),n&&r&&e(t)}function PX(t,e,n){let r=n?t:t.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function Cd(t){return new Se(t.parent===null?t.name:Cd(t.parent)+"/"+t.name)}function Zw(t){t.parent!==null&&bX(t.parent,t.name,t)}function bX(t,e,n){const r=AX(n),i=Qn(t.node.children,e);r&&i?(delete t.node.children[e],t.node.childCount--,Zw(t)):!r&&!i&&(t.node.children[e]=n.node,t.node.childCount++,Zw(t))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kX=/[\[\].#$\/\u0000-\u001F\u007F]/,xX=/[\[\].#$\u0000-\u001F\u007F]/,Oy=10*1024*1024,Xg=function(t){return typeof t=="string"&&t.length!==0&&!kX.test(t)},lM=function(t){return typeof t=="string"&&t.length!==0&&!xX.test(t)},NX=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),lM(t)},Vh=function(t){return t===null||typeof t=="string"||typeof t=="number"&&!$g(t)||t&&typeof t=="object"&&Qn(t,".sv")},ui=function(t,e,n,r){r&&e===void 0||Rd(Mn(t,"value"),e,n)},Rd=function(t,e,n){const r=n instanceof Se?new KQ(n,t):n;if(e===void 0)throw new Error(t+"contains undefined "+mo(r));if(typeof e=="function")throw new Error(t+"contains a function "+mo(r)+" with contents = "+e.toString());if($g(e))throw new Error(t+"contains "+e.toString()+" "+mo(r));if(typeof e=="string"&&e.length>Oy/3&&zm(e)>Oy)throw new Error(t+"contains a string greater than "+Oy+" utf8 bytes "+mo(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let i=!1,s=!1;if(Lt(e,(o,a)=>{if(o===".value")i=!0;else if(o!==".priority"&&o!==".sv"&&(s=!0,!Xg(o)))throw new Error(t+" contains an invalid key ("+o+") "+mo(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);QQ(r,o),Rd(t,a,r),YQ(r)}),i&&s)throw new Error(t+' contains ".value" child '+mo(r)+" in addition to actual children.")}},DX=function(t,e){let n,r;for(n=0;n<e.length;n++){r=e[n];const s=xh(r);for(let o=0;o<s.length;o++)if(!(s[o]===".priority"&&o===s.length-1)){if(!Xg(s[o]))throw new Error(t+"contains an invalid key ("+s[o]+") in path "+r.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(GQ);let i=null;for(n=0;n<e.length;n++){if(r=e[n],i!==null&&ur(i,r))throw new Error(t+"contains a path "+i.toString()+" that is ancestor of another path "+r.toString());i=r}},uM=function(t,e,n,r){if(r&&e===void 0)return;const i=Mn(t,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(i+" must be an object containing the children to replace.");const s=[];Lt(e,(o,a)=>{const l=new Se(o);if(Rd(i,a,We(n,l)),gT(l)===".priority"&&!Vh(a))throw new Error(i+"contains an invalid value for '"+l.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(l)}),DX(i,s)},$T=function(t,e,n){if(!(n&&e===void 0)){if($g(e))throw new Error(Mn(t,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!Vh(e))throw new Error(Mn(t,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},Ad=function(t,e,n,r){if(!(r&&n===void 0)&&!Xg(n))throw new Error(Mn(t,e)+'was an invalid key = "'+n+`".  Firebase keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]").`)},Fh=function(t,e,n,r){if(!(r&&n===void 0)&&!lM(n))throw new Error(Mn(t,e)+'was an invalid path = "'+n+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},OX=function(t,e,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),Fh(t,e,n,r)},cr=function(t,e){if(ue(e)===".info")throw new Error(t+" failed = Can't modify data under /.info/")},cM=function(t,e){const n=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!Xg(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!NX(n))throw new Error(Mn(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LX{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function Jg(t,e){let n=null;for(let r=0;r<e.length;r++){const i=e[r],s=i.getPath();n!==null&&!_T(s,n.path)&&(t.eventLists_.push(n),n=null),n===null&&(n={events:[],path:s}),n.events.push(i)}n&&t.eventLists_.push(n)}function hM(t,e,n){Jg(t,n),dM(t,r=>_T(r,e))}function Jn(t,e,n){Jg(t,n),dM(t,r=>ur(r,e)||ur(e,r))}function dM(t,e){t.recursionDepth_++;let n=!0;for(let r=0;r<t.eventLists_.length;r++){const i=t.eventLists_[r];if(i){const s=i.path;e(s)?(MX(t.eventLists_[r]),t.eventLists_[r]=null):n=!1}}n&&(t.eventLists_=[]),t.recursionDepth_--}function MX(t){for(let e=0;e<t.events.length;e++){const n=t.events[e];if(n!==null){t.events[e]=null;const r=n.getEventRunner();$o&&xt("event: "+n.toString()),yu(r)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fM="repo_interrupt",VX=25;class FX{constructor(e,n,r,i){this.repoInfo_=e,this.forceRestClient_=n,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new LX,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=sm(),this.transactionQueueTree_=new FT,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function UX(t,e,n){if(t.stats_=pT(t.repoInfo_),t.forceRestClient_||yQ())t.server_=new im(t.repoInfo_,(r,i,s,o)=>{OA(t,r,i,s,o)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>LA(t,!0),0);else{if(typeof n<"u"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Et(n)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}t.persistentConnection_=new Ni(t.repoInfo_,e,(r,i,s,o)=>{OA(t,r,i,s,o)},r=>{LA(t,r)},r=>{$X(t,r)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(r=>{t.server_.refreshAuthToken(r)}),t.appCheckProvider_.addTokenChangeListener(r=>{t.server_.refreshAppCheckToken(r.token)}),t.statsReporter_=TQ(t.repoInfo_,()=>new SY(t.stats_,t.server_)),t.infoData_=new vY,t.infoSyncTree_=new NA({startListening:(r,i,s,o)=>{let a=[];const l=t.infoData_.getNode(r._path);return l.isEmpty()||(a=Sd(t.infoSyncTree_,r._path,l),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),BT(t,"connected",!1),t.serverSyncTree_=new NA({startListening:(r,i,s,o)=>(t.server_.listen(r,s,i,(a,l)=>{const u=o(a,l);Jn(t.eventQueue_,r._path,u)}),[]),stopListening:(r,i)=>{t.server_.unlisten(r,i)}})}function pM(t){const n=t.infoData_.getNode(new Se(".info/serverTimeOffset")).val()||0;return new Date().getTime()+n}function Pd(t){return SX({timestamp:pM(t)})}function OA(t,e,n,r,i){t.dataUpdateCount++;const s=new Se(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let o=[];if(i)if(r){const l=Ap(n,u=>Qe(u));o=yX(t.serverSyncTree_,s,l,i)}else{const l=Qe(n);o=tM(t.serverSyncTree_,s,l,i)}else if(r){const l=Ap(n,u=>Qe(u));o=mX(t.serverSyncTree_,s,l)}else{const l=Qe(n);o=Sd(t.serverSyncTree_,s,l)}let a=s;o.length>0&&(a=Kl(t,s)),Jn(t.eventQueue_,a,o)}function LA(t,e){BT(t,"connected",e),e===!1&&jX(t)}function $X(t,e){Lt(e,(n,r)=>{BT(t,n,r)})}function BT(t,e,n){const r=new Se("/.info/"+e),i=Qe(n);t.infoData_.updateSnapshot(r,i);const s=Sd(t.infoSyncTree_,r,i);Jn(t.eventQueue_,r,s)}function Zg(t){return t.nextWriteId_++}function BX(t,e,n){const r=vX(t.serverSyncTree_,e);return r!=null?Promise.resolve(r):t.server_.get(e).then(i=>{const s=Qe(i).withIndex(e._queryParams.getIndex());Jw(t.serverSyncTree_,e,n,!0);let o;if(e._queryParams.loadsAllData())o=Sd(t.serverSyncTree_,e._path,s);else{const a=Mh(t.serverSyncTree_,e);o=tM(t.serverSyncTree_,e._path,s,a)}return Jn(t.eventQueue_,e._path,o),fm(t.serverSyncTree_,e,n,null,!0),s},i=>(Eu(t,"get for query "+Et(e)+" failed: "+i),Promise.reject(new Error(i))))}function zT(t,e,n,r,i){Eu(t,"set",{path:e.toString(),value:n,priority:r});const s=Pd(t),o=Qe(n,r),a=Gg(t.serverSyncTree_,e),l=MT(o,a,s),u=Zg(t),c=kT(t.serverSyncTree_,e,l,u,!0);Jg(t.eventQueue_,c),t.server_.put(e.toString(),o.val(!0),(f,g)=>{const _=f==="ok";_||rn("set at "+e+" failed: "+f);const w=ds(t.serverSyncTree_,u,!_);Jn(t.eventQueue_,e,w),Hs(t,i,f,g)});const h=qT(t,e);Kl(t,h),Jn(t.eventQueue_,h,[])}function zX(t,e,n,r){Eu(t,"update",{path:e.toString(),value:n});let i=!0;const s=Pd(t),o={};if(Lt(n,(a,l)=>{i=!1,o[a]=sM(We(e,a),Qe(l),t.serverSyncTree_,s)}),i)xt("update() called with empty data.  Don't do anything."),Hs(t,r,"ok",void 0);else{const a=Zg(t),l=pX(t.serverSyncTree_,e,o,a);Jg(t.eventQueue_,l),t.server_.merge(e.toString(),n,(u,c)=>{const h=u==="ok";h||rn("update at "+e+" failed: "+u);const f=ds(t.serverSyncTree_,a,!h),g=f.length>0?Kl(t,e):e;Jn(t.eventQueue_,g,f),Hs(t,r,u,c)}),Lt(n,u=>{const c=qT(t,We(e,u));Kl(t,c)}),Jn(t.eventQueue_,e,[])}}function jX(t){Eu(t,"onDisconnectEvents");const e=Pd(t),n=sm();Hw(t.onDisconnect_,Ee(),(i,s)=>{const o=sM(i,s,t.serverSyncTree_,e);vu(n,i,o)});let r=[];Hw(n,Ee(),(i,s)=>{r=r.concat(Sd(t.serverSyncTree_,i,s));const o=qT(t,i);Kl(t,o)}),t.onDisconnect_=sm(),Jn(t.eventQueue_,Ee(),r)}function qX(t,e,n){t.server_.onDisconnectCancel(e.toString(),(r,i)=>{r==="ok"&&Ww(t.onDisconnect_,e),Hs(t,n,r,i)})}function MA(t,e,n,r){const i=Qe(n);t.server_.onDisconnectPut(e.toString(),i.val(!0),(s,o)=>{s==="ok"&&vu(t.onDisconnect_,e,i),Hs(t,r,s,o)})}function WX(t,e,n,r,i){const s=Qe(n,r);t.server_.onDisconnectPut(e.toString(),s.val(!0),(o,a)=>{o==="ok"&&vu(t.onDisconnect_,e,s),Hs(t,i,o,a)})}function HX(t,e,n,r){if(Rp(n)){xt("onDisconnect().update() called with empty data.  Don't do anything."),Hs(t,r,"ok",void 0);return}t.server_.onDisconnectMerge(e.toString(),n,(i,s)=>{i==="ok"&&Lt(n,(o,a)=>{const l=Qe(a);vu(t.onDisconnect_,We(e,o),l)}),Hs(t,r,i,s)})}function GX(t,e,n){let r;ue(e._path)===".info"?r=Jw(t.infoSyncTree_,e,n):r=Jw(t.serverSyncTree_,e,n),hM(t.eventQueue_,e._path,r)}function eE(t,e,n){let r;ue(e._path)===".info"?r=fm(t.infoSyncTree_,e,n):r=fm(t.serverSyncTree_,e,n),hM(t.eventQueue_,e._path,r)}function mM(t){t.persistentConnection_&&t.persistentConnection_.interrupt(fM)}function KX(t){t.persistentConnection_&&t.persistentConnection_.resume(fM)}function Eu(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),xt(n,...e)}function Hs(t,e,n,r){e&&yu(()=>{if(n==="ok")e(null);else{const i=(n||"error").toUpperCase();let s=i;r&&(s+=": "+r);const o=new Error(s);o.code=i,e(o)}})}function QX(t,e,n,r,i,s){Eu(t,"transaction on "+e);const o={path:e,update:n,onComplete:r,status:null,order:c2(),applyLocally:s,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},a=jT(t,e,void 0);o.currentInputSnapshot=a;const l=o.update(a.val());if(l===void 0)o.unwatcher(),o.currentOutputSnapshotRaw=null,o.currentOutputSnapshotResolved=null,o.onComplete&&o.onComplete(null,!1,o.currentInputSnapshot);else{Rd("transaction failed: Data returned ",l,o.path),o.status=0;const u=Qg(t.transactionQueueTree_,e),c=Ia(u)||[];c.push(o),UT(u,c);let h;typeof l=="object"&&l!==null&&Qn(l,".priority")?(h=Ho(l,".priority"),V(Vh(h),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):h=(Gg(t.serverSyncTree_,e)||Z.EMPTY_NODE).getPriority().val();const f=Pd(t),g=Qe(l,h),_=MT(g,a,f);o.currentOutputSnapshotRaw=g,o.currentOutputSnapshotResolved=_,o.currentWriteId=Zg(t);const w=kT(t.serverSyncTree_,e,_,o.currentWriteId,o.applyLocally);Jn(t.eventQueue_,e,w),e_(t,t.transactionQueueTree_)}}function jT(t,e,n){return Gg(t.serverSyncTree_,e,n)||Z.EMPTY_NODE}function e_(t,e=t.transactionQueueTree_){if(e||t_(t,e),Ia(e)){const n=_M(t,e);V(n.length>0,"Sending zero length transaction queue"),n.every(i=>i.status===0)&&YX(t,Cd(e),n)}else oM(e)&&Yg(e,n=>{e_(t,n)})}function YX(t,e,n){const r=n.map(u=>u.currentWriteId),i=jT(t,e,r);let s=i;const o=i.hash();for(let u=0;u<n.length;u++){const c=n[u];V(c.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),c.status=1,c.retryCount++;const h=pn(e,c.path);s=s.updateChild(h,c.currentOutputSnapshotRaw)}const a=s.val(!0),l=e;t.server_.put(l.toString(),a,u=>{Eu(t,"transaction put response",{path:l.toString(),status:u});let c=[];if(u==="ok"){const h=[];for(let f=0;f<n.length;f++)n[f].status=2,c=c.concat(ds(t.serverSyncTree_,n[f].currentWriteId)),n[f].onComplete&&h.push(()=>n[f].onComplete(null,!0,n[f].currentOutputSnapshotResolved)),n[f].unwatcher();t_(t,Qg(t.transactionQueueTree_,e)),e_(t,t.transactionQueueTree_),Jn(t.eventQueue_,e,c);for(let f=0;f<h.length;f++)yu(h[f])}else{if(u==="datastale")for(let h=0;h<n.length;h++)n[h].status===3?n[h].status=4:n[h].status=0;else{rn("transaction at "+l.toString()+" failed: "+u);for(let h=0;h<n.length;h++)n[h].status=4,n[h].abortReason=u}Kl(t,e)}},o)}function Kl(t,e){const n=gM(t,e),r=Cd(n),i=_M(t,n);return XX(t,i,r),r}function XX(t,e,n){if(e.length===0)return;const r=[];let i=[];const o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){const l=e[a],u=pn(n,l.path);let c=!1,h;if(V(u!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),l.status===4)c=!0,h=l.abortReason,i=i.concat(ds(t.serverSyncTree_,l.currentWriteId,!0));else if(l.status===0)if(l.retryCount>=VX)c=!0,h="maxretry",i=i.concat(ds(t.serverSyncTree_,l.currentWriteId,!0));else{const f=jT(t,l.path,o);l.currentInputSnapshot=f;const g=e[a].update(f.val());if(g!==void 0){Rd("transaction failed: Data returned ",g,l.path);let _=Qe(g);typeof g=="object"&&g!=null&&Qn(g,".priority")||(_=_.updatePriority(f.getPriority()));const T=l.currentWriteId,v=Pd(t),y=MT(_,f,v);l.currentOutputSnapshotRaw=_,l.currentOutputSnapshotResolved=y,l.currentWriteId=Zg(t),o.splice(o.indexOf(T),1),i=i.concat(kT(t.serverSyncTree_,l.path,y,l.currentWriteId,l.applyLocally)),i=i.concat(ds(t.serverSyncTree_,T,!0))}else c=!0,h="nodata",i=i.concat(ds(t.serverSyncTree_,l.currentWriteId,!0))}Jn(t.eventQueue_,n,i),i=[],c&&(e[a].status=2,function(f){setTimeout(f,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(h==="nodata"?r.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):r.push(()=>e[a].onComplete(new Error(h),!1,null))))}t_(t,t.transactionQueueTree_);for(let a=0;a<r.length;a++)yu(r[a]);e_(t,t.transactionQueueTree_)}function gM(t,e){let n,r=t.transactionQueueTree_;for(n=ue(e);n!==null&&Ia(r)===void 0;)r=Qg(r,n),e=ke(e),n=ue(e);return r}function _M(t,e){const n=[];return yM(t,e,n),n.sort((r,i)=>r.order-i.order),n}function yM(t,e,n){const r=Ia(e);if(r)for(let i=0;i<r.length;i++)n.push(r[i]);Yg(e,i=>{yM(t,i,n)})}function t_(t,e){const n=Ia(e);if(n){let r=0;for(let i=0;i<n.length;i++)n[i].status!==2&&(n[r]=n[i],r++);n.length=r,UT(e,n.length>0?n:void 0)}Yg(e,r=>{t_(t,r)})}function qT(t,e){const n=Cd(gM(t,e)),r=Qg(t.transactionQueueTree_,e);return PX(r,i=>{Ly(t,i)}),Ly(t,r),aM(r,i=>{Ly(t,i)}),n}function Ly(t,e){const n=Ia(e);if(n){const r=[];let i=[],s=-1;for(let o=0;o<n.length;o++)n[o].status===3||(n[o].status===1?(V(s===o-1,"All SENT items should be at beginning of queue."),s=o,n[o].status=3,n[o].abortReason="set"):(V(n[o].status===0,"Unexpected transaction status in abort"),n[o].unwatcher(),i=i.concat(ds(t.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&r.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));s===-1?UT(e,void 0):n.length=s+1,Jn(t.eventQueue_,Cd(e),i);for(let o=0;o<r.length;o++)yu(r[o])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JX(t){let e="";const n=t.split("/");for(let r=0;r<n.length;r++)if(n[r].length>0){let i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}function ZX(t){const e={};t.charAt(0)==="?"&&(t=t.substring(1));for(const n of t.split("&")){if(n.length===0)continue;const r=n.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):rn(`Invalid query segment '${n}' in query '${t}'`)}return e}const tE=function(t,e){const n=eJ(t),r=n.namespace;n.domain==="firebase.com"&&li(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&n.domain!=="localhost"&&li("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||uQ();const i=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new S2(n.host,n.secure,r,i,e,"",r!==n.subdomain),path:new Se(n.pathString)}},eJ=function(t){let e="",n="",r="",i="",s="",o=!0,a="https",l=443;if(typeof t=="string"){let u=t.indexOf("//");u>=0&&(a=t.substring(0,u-1),t=t.substring(u+2));let c=t.indexOf("/");c===-1&&(c=t.length);let h=t.indexOf("?");h===-1&&(h=t.length),e=t.substring(0,Math.min(c,h)),c<h&&(i=JX(t.substring(c,h)));const f=ZX(t.substring(Math.min(t.length,h)));u=e.indexOf(":"),u>=0?(o=a==="https"||a==="wss",l=parseInt(e.substring(u+1),10)):u=e.length;const g=e.slice(0,u);if(g.toLowerCase()==="localhost")n="localhost";else if(g.split(".").length<=2)n=g;else{const _=e.indexOf(".");r=e.substring(0,_).toLowerCase(),n=e.substring(_+1),s=r}"ns"in f&&(s=f.ns)}return{host:e,port:l,domain:n,subdomain:r,secure:o,scheme:a,pathString:i,namespace:s}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VA="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",tJ=function(){let t=0;const e=[];return function(n){const r=n===t;t=n;let i;const s=new Array(8);for(i=7;i>=0;i--)s[i]=VA.charAt(n%64),n=Math.floor(n/64);V(n===0,"Cannot push at time == 0");let o=s.join("");if(r){for(i=11;i>=0&&e[i]===63;i--)e[i]=0;e[i]++}else for(i=0;i<12;i++)e[i]=Math.floor(Math.random()*64);for(i=0;i<12;i++)o+=VA.charAt(e[i]);return V(o.length===20,"nextPushId: Length should be 20."),o}}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vM{constructor(e,n,r,i){this.eventType=e,this.eventRegistration=n,this.snapshot=r,this.prevName=i}getPath(){const e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+Et(this.snapshot.exportVal())}}class wM{constructor(e,n,r){this.eventRegistration=e,this.error=n,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WT{constructor(e,n){this.snapshotCallback=e,this.cancelCallback=n}onValue(e,n){this.snapshotCallback.call(null,e,n)}onCancel(e){return V(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let nJ=class{constructor(e,n){this._repo=e,this._path=n}cancel(){const e=new Rn;return qX(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){cr("OnDisconnect.remove",this._path);const e=new Rn;return MA(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){cr("OnDisconnect.set",this._path),ui("OnDisconnect.set",e,this._path,!1);const n=new Rn;return MA(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}setWithPriority(e,n){cr("OnDisconnect.setWithPriority",this._path),ui("OnDisconnect.setWithPriority",e,this._path,!1),$T("OnDisconnect.setWithPriority",n,!1);const r=new Rn;return WX(this._repo,this._path,e,n,r.wrapCallback(()=>{})),r.promise}update(e){cr("OnDisconnect.update",this._path),uM("OnDisconnect.update",e,this._path,!1);const n=new Rn;return HX(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Un{constructor(e,n,r,i){this._repo=e,this._path=n,this._queryParams=r,this._orderByCalled=i}get key(){return ce(this._path)?null:gT(this._path)}get ref(){return new _r(this._repo,this._path)}get _queryIdentifier(){const e=IA(this._queryParams),n=dT(e);return n==="{}"?"default":n}get _queryObject(){return IA(this._queryParams)}isEqual(e){if(e=j(e),!(e instanceof Un))return!1;const n=this._repo===e._repo,r=_T(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return n&&r&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+HQ(this._path)}}function n_(t,e){if(t._orderByCalled===!0)throw new Error(e+": You can't combine multiple orderBy calls.")}function so(t){let e=null,n=null;if(t.hasStart()&&(e=t.getIndexStartValue()),t.hasEnd()&&(n=t.getIndexEndValue()),t.getIndex()===ri){const r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(t.hasStart()){if(t.getIndexStartName()!==zs)throw new Error(r);if(typeof e!="string")throw new Error(i)}if(t.hasEnd()){if(t.getIndexEndName()!==$i)throw new Error(r);if(typeof n!="string")throw new Error(i)}}else if(t.getIndex()===Oe){if(e!=null&&!Vh(e)||n!=null&&!Vh(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(V(t.getIndex()instanceof wT||t.getIndex()===ET,"unknown index type."),e!=null&&typeof e=="object"||n!=null&&typeof n=="object")throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function r_(t){if(t.hasStart()&&t.hasEnd()&&t.hasLimit()&&!t.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}class _r extends Un{constructor(e,n){super(e,n,new zg,!1)}get parent(){const e=D2(this._path);return e===null?null:new _r(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}let i_=class nE{constructor(e,n,r){this._node=e,this.ref=n,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const n=new Se(e),r=la(this.ref,e);return new nE(this._node.getChild(n),r,Oe)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(r,i)=>e(new nE(i,la(this.ref,r),Oe)))}hasChild(e){const n=new Se(e);return!this._node.getChild(n).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}};function EM(t,e){return t=j(t),t._checkNotDeleted("ref"),e!==void 0?la(t._root,e):t._root}function FA(t,e){t=j(t),t._checkNotDeleted("refFromURL");const n=tE(e,t._repo.repoInfo_.nodeAdmin);cM("refFromURL",n);const r=n.repoInfo;return!t._repo.repoInfo_.isCustomHost()&&r.host!==t._repo.repoInfo_.host&&li("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+t._repo.repoInfo_.host+")"),EM(t,n.path.toString())}function la(t,e){return t=j(t),ue(t._path)===null?OX("child","path",e,!1):Fh("child","path",e,!1),new _r(t._repo,We(t._path,e))}function rJ(t,e){t=j(t),cr("push",t._path),ui("push",e,t._path,!0);const n=pM(t._repo),r=tJ(n),i=la(t,r),s=la(t,r);let o;return e!=null?o=HT(s,e).then(()=>s):o=Promise.resolve(s),i.then=o.then.bind(o),i.catch=o.then.bind(o,void 0),i}function iJ(t){return cr("remove",t._path),HT(t,null)}function HT(t,e){t=j(t),cr("set",t._path),ui("set",e,t._path,!1);const n=new Rn;return zT(t._repo,t._path,e,null,n.wrapCallback(()=>{})),n.promise}function sJ(t,e){t=j(t),cr("setPriority",t._path),$T("setPriority",e,!1);const n=new Rn;return zT(t._repo,We(t._path,".priority"),e,null,n.wrapCallback(()=>{})),n.promise}function oJ(t,e,n){if(cr("setWithPriority",t._path),ui("setWithPriority",e,t._path,!1),$T("setWithPriority",n,!1),t.key===".length"||t.key===".keys")throw"setWithPriority failed: "+t.key+" is a read-only object.";const r=new Rn;return zT(t._repo,t._path,e,n,r.wrapCallback(()=>{})),r.promise}function aJ(t,e){uM("update",e,t._path,!1);const n=new Rn;return zX(t._repo,t._path,e,n.wrapCallback(()=>{})),n.promise}function lJ(t){t=j(t);const e=new WT(()=>{}),n=new bd(e);return BX(t._repo,t,n).then(r=>new i_(r,new _r(t._repo,t._path),t._queryParams.getIndex()))}class bd{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,n){const r=n._queryParams.getIndex();return new vM("value",this,new i_(e.snapshotNode,new _r(n._repo,n._path),r))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new wM(this,e,n):null}matches(e){return e instanceof bd?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}class s_{constructor(e,n){this.eventType=e,this.callbackContext=n}respondsTo(e){let n=e==="children_added"?"child_added":e;return n=n==="children_removed"?"child_removed":n,this.eventType===n}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new wM(this,e,n):null}createEvent(e,n){V(e.childName!=null,"Child events should have a childName.");const r=la(new _r(n._repo,n._path),e.childName),i=n._queryParams.getIndex();return new vM(e.type,this,new i_(e.snapshotNode,r,i),e.prevName)}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof s_?this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)):!1}hasAnyCallback(){return!!this.callbackContext}}function kd(t,e,n,r,i){let s;if(typeof r=="object"&&(s=void 0,i=r),typeof r=="function"&&(s=r),i&&i.onlyOnce){const l=n,u=(c,h)=>{eE(t._repo,t,a),l(c,h)};u.userCallback=n.userCallback,u.context=n.context,n=u}const o=new WT(n,s||void 0),a=e==="value"?new bd(o):new s_(e,o);return GX(t._repo,t,a),()=>eE(t._repo,t,a)}function rE(t,e,n,r){return kd(t,"value",e,n,r)}function UA(t,e,n,r){return kd(t,"child_added",e,n,r)}function $A(t,e,n,r){return kd(t,"child_changed",e,n,r)}function BA(t,e,n,r){return kd(t,"child_moved",e,n,r)}function zA(t,e,n,r){return kd(t,"child_removed",e,n,r)}function jA(t,e,n){let r=null;const i=n?new WT(n):null;e==="value"?r=new bd(i):e&&(r=new s_(e,i)),eE(t._repo,t,r)}class Mr{}class IM extends Mr{constructor(e,n){super(),this._value=e,this._key=n}_apply(e){ui("endAt",this._value,e._path,!0);const n=qw(e._queryParams,this._value,this._key);if(r_(n),so(n),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Un(e._repo,e._path,n,e._orderByCalled)}}function uJ(t,e){return Ad("endAt","key",e,!0),new IM(t,e)}class cJ extends Mr{constructor(e,n){super(),this._value=e,this._key=n}_apply(e){ui("endBefore",this._value,e._path,!1);const n=yY(e._queryParams,this._value,this._key);if(r_(n),so(n),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Un(e._repo,e._path,n,e._orderByCalled)}}function hJ(t,e){return Ad("endBefore","key",e,!0),new cJ(t,e)}class TM extends Mr{constructor(e,n){super(),this._value=e,this._key=n}_apply(e){ui("startAt",this._value,e._path,!0);const n=jw(e._queryParams,this._value,this._key);if(r_(n),so(n),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new Un(e._repo,e._path,n,e._orderByCalled)}}function dJ(t=null,e){return Ad("startAt","key",e,!0),new TM(t,e)}class fJ extends Mr{constructor(e,n){super(),this._value=e,this._key=n}_apply(e){ui("startAfter",this._value,e._path,!1);const n=_Y(e._queryParams,this._value,this._key);if(r_(n),so(n),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new Un(e._repo,e._path,n,e._orderByCalled)}}function pJ(t,e){return Ad("startAfter","key",e,!0),new fJ(t,e)}class mJ extends Mr{constructor(e){super(),this._limit=e}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new Un(e._repo,e._path,mY(e._queryParams,this._limit),e._orderByCalled)}}function gJ(t){if(typeof t!="number"||Math.floor(t)!==t||t<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new mJ(t)}class _J extends Mr{constructor(e){super(),this._limit=e}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new Un(e._repo,e._path,gY(e._queryParams,this._limit),e._orderByCalled)}}function yJ(t){if(typeof t!="number"||Math.floor(t)!==t||t<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new _J(t)}class vJ extends Mr{constructor(e){super(),this._path=e}_apply(e){n_(e,"orderByChild");const n=new Se(this._path);if(ce(n))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");const r=new wT(n),i=jg(e._queryParams,r);return so(i),new Un(e._repo,e._path,i,!0)}}function wJ(t){if(t==="$key")throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if(t==="$priority")throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if(t==="$value")throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return Fh("orderByChild","path",t,!1),new vJ(t)}class EJ extends Mr{_apply(e){n_(e,"orderByKey");const n=jg(e._queryParams,ri);return so(n),new Un(e._repo,e._path,n,!0)}}function IJ(){return new EJ}class TJ extends Mr{_apply(e){n_(e,"orderByPriority");const n=jg(e._queryParams,Oe);return so(n),new Un(e._repo,e._path,n,!0)}}function SJ(){return new TJ}class CJ extends Mr{_apply(e){n_(e,"orderByValue");const n=jg(e._queryParams,ET);return so(n),new Un(e._repo,e._path,n,!0)}}function RJ(){return new CJ}class AJ extends Mr{constructor(e,n){super(),this._value=e,this._key=n}_apply(e){if(ui("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new IM(this._value,this._key)._apply(new TM(this._value,this._key)._apply(e))}}function PJ(t,e){return Ad("equalTo","key",e,!0),new AJ(t,e)}function Er(t,...e){let n=j(t);for(const r of e)n=r._apply(n);return n}oX(_r);hX(_r);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bJ="FIREBASE_DATABASE_EMULATOR_HOST",iE={};let kJ=!1;function xJ(t,e,n,r){t.repoInfo_=new S2(`${e}:${n}`,!1,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams,!0),r&&(t.authTokenProvider_=r)}function SM(t,e,n,r,i){let s=r||t.options.databaseURL;s===void 0&&(t.options.projectId||li("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),xt("Using default host for project ",t.options.projectId),s=`${t.options.projectId}-default-rtdb.firebaseio.com`);let o=tE(s,i),a=o.repoInfo,l,u;typeof process<"u"&&process.env&&(u=process.env[bJ]),u?(l=!0,s=`http://${u}?ns=${a.namespace}`,o=tE(s,i),a=o.repoInfo):l=!o.repoInfo.secure;const c=i&&l?new ml(ml.OWNER):new wQ(t.name,t.options,e);cM("Invalid Firebase Database URL",o),ce(o.path)||li("Database URL must point to the root of a Firebase Database (not including a child path).");const h=DJ(a,t,c,new vQ(t.name,n));return new OJ(h,t)}function NJ(t,e){const n=iE[e];(!n||n[t.key]!==t)&&li(`Database ${e}(${t.repoInfo_}) has already been deleted.`),mM(t),delete n[t.key]}function DJ(t,e,n,r){let i=iE[e.name];i||(i={},iE[e.name]=i);let s=i[t.toURLString()];return s&&li("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new FX(t,kJ,n,r),i[t.toURLString()]=s,s}let OJ=class{constructor(e,n){this._repoInternal=e,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(UX(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new _r(this._repo,Ee())),this._rootInternal}_delete(){return this._rootInternal!==null&&(NJ(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&li("Cannot call "+e+" on a deleted database.")}};function CM(){ql.IS_TRANSPORT_INITIALIZED&&rn("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function LJ(){CM(),hs.forceDisallow()}function MJ(){CM(),sr.forceDisallow(),hs.forceAllow()}function VJ(t,e,n,r={}){t=j(t),t._checkNotDeleted("useEmulator"),t._instanceStarted&&li("Cannot call useEmulator() after instance has already been initialized.");const i=t._repoInternal;let s;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&li('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new ml(ml.OWNER);else if(r.mockUserToken){const o=typeof r.mockUserToken=="string"?r.mockUserToken:f0(r.mockUserToken,t.app.options.projectId);s=new ml(o)}xJ(i,e,n,s)}function FJ(t){t=j(t),t._checkNotDeleted("goOffline"),mM(t._repo)}function UJ(t){t=j(t),t._checkNotDeleted("goOnline"),KX(t._repo)}function $J(t,e){d2(t,e)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BJ(t){l2(hi),ii(new on("database",(e,{instanceIdentifier:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return SM(r,i,s,n)},"PUBLIC").setMultipleInstances(!0)),Vn(sA,oA,t),Vn(sA,oA,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zJ={".sv":"timestamp"};function jJ(){return zJ}function qJ(t){return{".sv":{increment:t}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let WJ=class{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}};function HJ(t,e,n){var r;if(t=j(t),cr("Reference.transaction",t._path),t.key===".length"||t.key===".keys")throw"Reference.transaction failed: "+t.key+" is a read-only object.";const i=(r=n==null?void 0:n.applyLocally)!==null&&r!==void 0?r:!0,s=new Rn,o=(l,u,c)=>{let h=null;l?s.reject(l):(h=new i_(c,new _r(t._repo,t._path),Oe),s.resolve(new WJ(u,h)))},a=rE(t,()=>{});return QX(t._repo,t._path,e,o,a,i),s.promise}Ni.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};Ni.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};BJ();const GJ="@firebase/database-compat",KJ="1.0.1";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QJ=new nu("@firebase/database-compat"),RM=function(t){const e="FIREBASE WARNING: "+t;QJ.warn(e)};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YJ=function(t,e,n,r){if(!(r&&n===void 0)&&typeof n!="boolean")throw new Error(Mn(t,e)+"must be a boolean.")},XJ=function(t,e,n){if(!(n&&e===void 0))switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(Mn(t,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JJ{constructor(e){this._delegate=e}cancel(e){te("OnDisconnect.cancel",0,1,arguments.length),Pt("OnDisconnect.cancel","onComplete",e,!0);const n=this._delegate.cancel();return e&&n.then(()=>e(null),r=>e(r)),n}remove(e){te("OnDisconnect.remove",0,1,arguments.length),Pt("OnDisconnect.remove","onComplete",e,!0);const n=this._delegate.remove();return e&&n.then(()=>e(null),r=>e(r)),n}set(e,n){te("OnDisconnect.set",1,2,arguments.length),Pt("OnDisconnect.set","onComplete",n,!0);const r=this._delegate.set(e);return n&&r.then(()=>n(null),i=>n(i)),r}setWithPriority(e,n,r){te("OnDisconnect.setWithPriority",2,3,arguments.length),Pt("OnDisconnect.setWithPriority","onComplete",r,!0);const i=this._delegate.setWithPriority(e,n);return r&&i.then(()=>r(null),s=>r(s)),i}update(e,n){if(te("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){const i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,RM("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Pt("OnDisconnect.update","onComplete",n,!0);const r=this._delegate.update(e);return n&&r.then(()=>n(null),i=>n(i)),r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZJ{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return te("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class As{constructor(e,n){this._database=e,this._delegate=n}val(){return te("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return te("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return te("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return te("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return te("DataSnapshot.child",0,1,arguments.length),e=String(e),Fh("DataSnapshot.child","path",e,!1),new As(this._database,this._delegate.child(e))}hasChild(e){return te("DataSnapshot.hasChild",1,1,arguments.length),Fh("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)}getPriority(){return te("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return te("DataSnapshot.forEach",1,1,arguments.length),Pt("DataSnapshot.forEach","action",e,!1),this._delegate.forEach(n=>e(new As(this._database,n)))}hasChildren(){return te("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return te("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return te("DataSnapshot.ref",0,0,arguments.length),new jn(this._database,this._delegate.ref)}get ref(){return this.getRef()}}class $t{constructor(e,n){this.database=e,this._delegate=n}on(e,n,r,i){var s;te("Query.on",2,4,arguments.length),Pt("Query.on","callback",n,!1);const o=$t.getCancelAndContextArgs_("Query.on",r,i),a=(u,c)=>{n.call(o.context,new As(this.database,u),c)};a.userCallback=n,a.context=o.context;const l=(s=o.cancel)===null||s===void 0?void 0:s.bind(o.context);switch(e){case"value":return rE(this._delegate,a,l),n;case"child_added":return UA(this._delegate,a,l),n;case"child_removed":return zA(this._delegate,a,l),n;case"child_changed":return $A(this._delegate,a,l),n;case"child_moved":return BA(this._delegate,a,l),n;default:throw new Error(Mn("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,n,r){if(te("Query.off",0,3,arguments.length),XJ("Query.off",e,!0),Pt("Query.off","callback",n,!0),J1("Query.off","context",r,!0),n){const i=()=>{};i.userCallback=n,i.context=r,jA(this._delegate,e,i)}else jA(this._delegate,e)}get(){return lJ(this._delegate).then(e=>new As(this.database,e))}once(e,n,r,i){te("Query.once",1,4,arguments.length),Pt("Query.once","callback",n,!0);const s=$t.getCancelAndContextArgs_("Query.once",r,i),o=new Rn,a=(u,c)=>{const h=new As(this.database,u);n&&n.call(s.context,h,c),o.resolve(h)};a.userCallback=n,a.context=s.context;const l=u=>{s.cancel&&s.cancel.call(s.context,u),o.reject(u)};switch(e){case"value":rE(this._delegate,a,l,{onlyOnce:!0});break;case"child_added":UA(this._delegate,a,l,{onlyOnce:!0});break;case"child_removed":zA(this._delegate,a,l,{onlyOnce:!0});break;case"child_changed":$A(this._delegate,a,l,{onlyOnce:!0});break;case"child_moved":BA(this._delegate,a,l,{onlyOnce:!0});break;default:throw new Error(Mn("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return o.promise}limitToFirst(e){return te("Query.limitToFirst",1,1,arguments.length),new $t(this.database,Er(this._delegate,gJ(e)))}limitToLast(e){return te("Query.limitToLast",1,1,arguments.length),new $t(this.database,Er(this._delegate,yJ(e)))}orderByChild(e){return te("Query.orderByChild",1,1,arguments.length),new $t(this.database,Er(this._delegate,wJ(e)))}orderByKey(){return te("Query.orderByKey",0,0,arguments.length),new $t(this.database,Er(this._delegate,IJ()))}orderByPriority(){return te("Query.orderByPriority",0,0,arguments.length),new $t(this.database,Er(this._delegate,SJ()))}orderByValue(){return te("Query.orderByValue",0,0,arguments.length),new $t(this.database,Er(this._delegate,RJ()))}startAt(e=null,n){return te("Query.startAt",0,2,arguments.length),new $t(this.database,Er(this._delegate,dJ(e,n)))}startAfter(e=null,n){return te("Query.startAfter",0,2,arguments.length),new $t(this.database,Er(this._delegate,pJ(e,n)))}endAt(e=null,n){return te("Query.endAt",0,2,arguments.length),new $t(this.database,Er(this._delegate,uJ(e,n)))}endBefore(e=null,n){return te("Query.endBefore",0,2,arguments.length),new $t(this.database,Er(this._delegate,hJ(e,n)))}equalTo(e,n){return te("Query.equalTo",1,2,arguments.length),new $t(this.database,Er(this._delegate,PJ(e,n)))}toString(){return te("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return te("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if(te("Query.isEqual",1,1,arguments.length),!(e instanceof $t)){const n="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(n)}return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,n,r){const i={cancel:void 0,context:void 0};if(n&&r)i.cancel=n,Pt(e,"cancel",i.cancel,!0),i.context=r,J1(e,"context",i.context,!0);else if(n)if(typeof n=="object"&&n!==null)i.context=n;else if(typeof n=="function")i.cancel=n;else throw new Error(Mn(e,"cancelOrContext")+" must either be a cancel callback or a context object.");return i}get ref(){return new jn(this.database,new _r(this._delegate._repo,this._delegate._path))}}class jn extends $t{constructor(e,n){super(e,new Un(n._repo,n._path,new zg,!1)),this.database=e,this._delegate=n}getKey(){return te("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return te("Reference.child",1,1,arguments.length),typeof e=="number"&&(e=String(e)),new jn(this.database,la(this._delegate,e))}getParent(){te("Reference.parent",0,0,arguments.length);const e=this._delegate.parent;return e?new jn(this.database,e):null}getRoot(){return te("Reference.root",0,0,arguments.length),new jn(this.database,this._delegate.root)}set(e,n){te("Reference.set",1,2,arguments.length),Pt("Reference.set","onComplete",n,!0);const r=HT(this._delegate,e);return n&&r.then(()=>n(null),i=>n(i)),r}update(e,n){if(te("Reference.update",1,2,arguments.length),Array.isArray(e)){const i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,RM("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}cr("Reference.update",this._delegate._path),Pt("Reference.update","onComplete",n,!0);const r=aJ(this._delegate,e);return n&&r.then(()=>n(null),i=>n(i)),r}setWithPriority(e,n,r){te("Reference.setWithPriority",2,3,arguments.length),Pt("Reference.setWithPriority","onComplete",r,!0);const i=oJ(this._delegate,e,n);return r&&i.then(()=>r(null),s=>r(s)),i}remove(e){te("Reference.remove",0,1,arguments.length),Pt("Reference.remove","onComplete",e,!0);const n=iJ(this._delegate);return e&&n.then(()=>e(null),r=>e(r)),n}transaction(e,n,r){te("Reference.transaction",1,3,arguments.length),Pt("Reference.transaction","transactionUpdate",e,!1),Pt("Reference.transaction","onComplete",n,!0),YJ("Reference.transaction","applyLocally",r,!0);const i=HJ(this._delegate,e,{applyLocally:r}).then(s=>new ZJ(s.committed,new As(this.database,s.snapshot)));return n&&i.then(s=>n(null,s.committed,s.snapshot),s=>n(s,!1,null)),i}setPriority(e,n){te("Reference.setPriority",1,2,arguments.length),Pt("Reference.setPriority","onComplete",n,!0);const r=sJ(this._delegate,e);return n&&r.then(()=>n(null),i=>n(i)),r}push(e,n){te("Reference.push",0,2,arguments.length),Pt("Reference.push","onComplete",n,!0);const r=rJ(this._delegate,e),i=r.then(o=>new jn(this.database,o));n&&i.then(()=>n(null),o=>n(o));const s=new jn(this.database,r);return s.then=i.then.bind(i),s.catch=i.catch.bind(i,void 0),s}onDisconnect(){return cr("Reference.onDisconnect",this._delegate._path),new JJ(new nJ(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uh{constructor(e,n){this._delegate=e,this.app=n,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:LJ,forceLongPolling:MJ}}useEmulator(e,n,r={}){VJ(this._delegate,e,n,r)}ref(e){if(te("database.ref",0,1,arguments.length),e instanceof jn){const n=FA(this._delegate,e.toString());return new jn(this,n)}else{const n=EM(this._delegate,e);return new jn(this,n)}}refFromURL(e){te("database.refFromURL",1,1,arguments.length);const r=FA(this._delegate,e);return new jn(this,r)}goOffline(){return te("database.goOffline",0,0,arguments.length),FJ(this._delegate)}goOnline(){return te("database.goOnline",0,0,arguments.length),UJ(this._delegate)}}Uh.ServerValue={TIMESTAMP:jJ(),increment:t=>qJ(t)};function eZ({app:t,url:e,version:n,customAuthImpl:r,customAppCheckImpl:i,namespace:s,nodeAdmin:o=!1}){l2(n);const a=new sx("database-standalone"),l=new Bv("auth-internal",a);l.setComponent(new on("auth-internal",()=>r,"PRIVATE"));let u;return i&&(u=new Bv("app-check-internal",a),u.setComponent(new on("app-check-internal",()=>i,"PRIVATE"))),{instance:new Uh(SM(t,l,u,e,o),t),namespace:s}}var tZ=Object.freeze({__proto__:null,initStandalone:eZ});/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nZ=Uh.ServerValue;function rZ(t){t.INTERNAL.registerComponent(new on("database-compat",(e,{instanceIdentifier:n})=>{const r=e.getProvider("app-compat").getImmediate(),i=e.getProvider("database").getImmediate({identifier:n});return new Uh(i,r)},"PUBLIC").setServiceProps({Reference:jn,Query:$t,Database:Uh,DataSnapshot:As,enableLogging:$J,INTERNAL:tZ,ServerValue:nZ}).setMultipleInstances(!0)),t.registerVersion(GJ,KJ)}rZ(di);const iZ={apiKey:"AIzaSyA5KRybIC6bTXaxUfLew-CM2VdPH4YG8fA",authDomain:"whatsapp-clone-a78a2.firebaseapp.com",projectId:"whatsapp-clone-a78a2",storageBucket:"whatsapp-clone-a78a2.appspot.com",messagingSenderId:"334764400513",appId:"1:334764400513:web:73612535f8cc8229a79280",measurementId:"G-RG9L4WZSZG"},sZ=di.initializeApp(iZ);sZ.firestore();const oZ=di.auth(),aZ=new di.auth.GoogleAuthProvider,lZ={user:null},AM={SET_USER:"SET_USER"},uZ=(t,e)=>e.type==AM.SET_USER?{...t,user:e.user}:t,cZ=()=>{const[t,e]=gt.useContext(Hh),n=async()=>{try{const r=await oZ.signInWithPopup(aZ);e({type:AM.SET_USER,user:r.user})}catch(r){console.log(r)}};return K.jsx(hZ,{children:K.jsxs("div",{className:"container",children:[K.jsx(N3,{className:"icon"}),K.jsx("div",{className:"text",children:K.jsx("h1",{children:"sign in to messaging app"})}),K.jsx("button",{onClick:n,children:"sign in with google"})]})})},hZ=Zl.div`
    background: #f8f8f8;
    height: 100vh;
    width: 100vw;
    display: grid;
    place-items:center;

    .icon{
        font-size:3rem;
        margin-bottom: 2rem;
    }
    .container{
        padding: 6rem;
        text-align:center;
        background: white;
        border-radius: 1rem;
        box-shadow: -1px 4px 20px -6px rgba(0, 0, 0, 0.75);
        color: green;
        
    }

    .text{
        text-transform:capitalize;
    }
    .container img{
        object-fit:contain;
        height: 5rem;
        margin-bottom: 3rem;
    }

    .container button {
        margin-top: 3rem;
        text-transform: inherit;
        background: #0a8d48;
        color:white;
        border:none;
        padding: 1rem;
        border-radius: 3rem;
        font-size: 1rem;
        text-transform:capitalize;
    }
`,dZ=()=>{gt.useState(null);const[t,e]=gt.useState([]),[n,r]=gt.useContext(Hh),i=async()=>{const s=await Kk.get("/messages/sync");e(s.data)};return gt.useEffect(()=>{i()},[]),gt.useEffect(()=>{const o=new x3("9d98ad2d5ba915745f7c",{cluster:"eu"}).subscribe("messages");return o.bind("inserted",a=>{console.log(a),e([...t,a])}),()=>{o.unbind_all(),o.unsubscribe()}},[t]),K.jsx(fZ,{children:n.user?K.jsxs("div",{className:"app-center",children:[K.jsx(cB,{messages:t}),K.jsx(P3,{messages:t})]}):K.jsx(cZ,{})})},fZ=Zl.div`
  display:grid;
  place-items:center;
  height:100vh;
  background: #dadbd3;

  .app-center{
    display:grid;
    grid-template-columns: auto 1fr;
    background:#ededed;
    margin-top:-50px;
    height:90vh;
    width:90vw;
    box-shadow: -1px 4px 20px -6px rgba(0, 0, 0, 0.75)
  }
`;My.createRoot(document.getElementById("root")).render(K.jsx(Hn.StrictMode,{children:K.jsx(uB,{reducer:uZ,initialState:lZ,children:K.jsx(dZ,{})})}));
